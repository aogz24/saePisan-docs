<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>saePisan Documentation</title>
    <style>
        @media print {
            .page-break { page-break-before: always; }
            .no-print { display: none; }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .cover-page {
            text-align: center;
            padding: 100px 0;
            border-bottom: 3px solid #007acc;
            margin-bottom: 50px;
        }
        
        .cover-title {
            font-size: 48px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .cover-subtitle {
            font-size: 24px;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        
        .cover-info {
            font-size: 16px;
            color: #95a5a6;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
        }
        
        .toc {
            background-color: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 50px;
        }
        
        .toc h2 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 8px 0;
            padding: 8px;
            border-left: 4px solid #ecf0f1;
            background-color: white;
        }
        
        .toc .folder {
            font-weight: bold;
            color: #2980b9;
            background-color: #e3f2fd;
            border-left-color: #2980b9;
            margin-top: 15px;
        }
        
        .toc .file {
            margin-left: 30px;
            font-size: 14px;
            color: #555;
        }
        
        .file-section {
            margin-bottom: 50px;
            border: 1px solid #e1e8ed;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .file-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .file-path {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
            font-family: 'Courier New', monospace;
        }
        
        .file-content {
            padding: 30px;
            background-color: #fafafa;
        }
        
        .file-content h1, .file-content h2, .file-content h3 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .file-content h1 { font-size: 28px; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .file-content h2 { font-size: 22px; }
        .file-content h3 { font-size: 18px; }
        .file-content h4 { font-size: 16px; }
        
        .file-content code {
            background-color: #f1f2f6;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #e74c3c;
        }
        
        .file-content pre {
            background-color: #2f3640;
            color: #f5f6fa;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .file-content pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        
        .file-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
        }
        
        .file-content th, .file-content td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .file-content th {
            background-color: #f2f2f2;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .file-content tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .error-content {
            color: #e74c3c;
            background-color: #fadbd8;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #e74c3c;
        }
        
        .stats {
            background-color: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #27ae60;
            margin: 20px 0;
        }
        
        .nav-button {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        
        .nav-button:hover {
            background-color: #2980b9;
        }
    </style>
</head>
<body>
    <div class="cover-page">
        <div class="cover-title">ğŸ“š DsaePisan Documentation</div>
        <div class="cover-info">
            <p><strong>ğŸ“… Created at:</strong> 19 July 2025, 08:36</p>
        </div>
    </div>
    
    <div class="stats">
        <h3>ğŸ“Š Statistik Dokumentasi</h3>
        <p><strong>Created At:</strong> 19 July 2025, 08:36</p>
    </div>
    <div class="toc"><h2>ğŸ“‘ List of Contents </h2><ul><li class="folder">ğŸ“ Root (2 files)</li><li class="file">ğŸ“„ <a href="#file_5_0">index.html</a> <small>(index.html)</small></li><li class="file">ğŸ“„ <a href="#file_5_1">main.html</a> <small>(main.html)</small></li><li class="folder">ğŸ“ controller (2 files)</li><li class="file">ğŸ“„ <a href="#file_2_0">FileController.html</a> <small>(controller/FileController.html)</small></li><li class="file">ğŸ“„ <a href="#file_3_1">index.html</a> <small>(controller/index.html)</small></li><li class="folder">ğŸ“ controller/Eksploration (2 files)</li><li class="file">ğŸ“„ <a href="#file_1_0">EksplorationController.html</a> <small>(controller/Eksploration/EksplorationController.html)</small></li><li class="file">ğŸ“„ <a href="#file_1_1">index.html</a> <small>(controller/Eksploration/index.html)</small></li><li class="folder">ğŸ“ controller/Graph (2 files)</li><li class="file">ğŸ“„ <a href="#file_3_0">GraphController.html</a> <small>(controller/Graph/GraphController.html)</small></li><li class="file">ğŸ“„ <a href="#file_3_1">index.html</a> <small>(controller/Graph/index.html)</small></li><li class="folder">ğŸ“ controller/modelling (6 files)</li><li class="file">ğŸ“„ <a href="#file_4_0">ProjectionController.html</a> <small>(controller/modelling/ProjectionController.html)</small></li><li class="file">ğŸ“„ <a href="#file_4_1">SaeController.html</a> <small>(controller/modelling/SaeController.html)</small></li><li class="file">ğŸ“„ <a href="#file_4_2">SaeEblupUnitController.html</a> <small>(controller/modelling/SaeEblupUnitController.html)</small></li><li class="file">ğŸ“„ <a href="#file_4_3">SaeHBcontroller.html</a> <small>(controller/modelling/SaeHBcontroller.html)</small></li><li class="file">ğŸ“„ <a href="#file_4_4">SaePseudoController.html</a> <small>(controller/modelling/SaePseudoController.html)</small></li><li class="file">ğŸ“„ <a href="#file_4_5">index.html</a> <small>(controller/modelling/index.html)</small></li><li class="folder">ğŸ“ model (17 files)</li><li class="file">ğŸ“„ <a href="#file_6_0">BoxPlot.html</a> <small>(model/BoxPlot.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_1">CorrelationMatrix.html</a> <small>(model/CorrelationMatrix.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_2">Histogram.html</a> <small>(model/Histogram.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_3">LinePlot.html</a> <small>(model/LinePlot.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_4">Multicollinearity.html</a> <small>(model/Multicollinearity.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_5">NormalityTest.html</a> <small>(model/NormalityTest.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_6">ProjectionModel.html</a> <small>(model/ProjectionModel.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_7">SaeEblup.html</a> <small>(model/SaeEblup.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_8">SaeEblupPseudo.html</a> <small>(model/SaeEblupPseudo.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_9">SaeEblupUnit.html</a> <small>(model/SaeEblupUnit.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_10">SaeHB.html</a> <small>(model/SaeHB.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_11">SaeModelling.html</a> <small>(model/SaeModelling.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_12">Scatterplot.html</a> <small>(model/Scatterplot.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_13">SummaryData.html</a> <small>(model/SummaryData.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_14">TableModel.html</a> <small>(model/TableModel.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_15">VariableSelection.html</a> <small>(model/VariableSelection.html)</small></li><li class="file">ğŸ“„ <a href="#file_6_16">index.html</a> <small>(model/index.html)</small></li><li class="folder">ğŸ“ service (4 files)</li><li class="file">ğŸ“„ <a href="#file_7_0">EditColumn.html</a> <small>(service/EditColumn.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_1">compute.html</a> <small>(service/compute.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_2">convert_df.html</a> <small>(service/convert_df.html)</small></li><li class="file">ğŸ“„ <a href="#file_10_3">index.html</a> <small>(service/index.html)</small></li><li class="folder">ğŸ“ service/command (8 files)</li><li class="file">ğŸ“„ <a href="#file_8_0">AddColumnCommand.html</a> <small>(service/command/AddColumnCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_1">AddRowCommand.html</a> <small>(service/command/AddRowCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_2">ChangeColumnTypeCommand.html</a> <small>(service/command/ChangeColumnTypeCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_3">DeleteColumnsCommand.html</a> <small>(service/command/DeleteColumnsCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_4">DeleteRowsCommand.html</a> <small>(service/command/DeleteRowsCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_5">EditDataCommand.html</a> <small>(service/command/EditDataCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_6">RenameColumnCommand.html</a> <small>(service/command/RenameColumnCommand.html)</small></li><li class="file">ğŸ“„ <a href="#file_8_7">index.html</a> <small>(service/command/index.html)</small></li><li class="folder">ğŸ“ service/exploration (6 files)</li><li class="file">ğŸ“„ <a href="#file_9_0">CorrelationMatrix.html</a> <small>(service/exploration/CorrelationMatrix.html)</small></li><li class="file">ğŸ“„ <a href="#file_9_1">Multicollinearity.html</a> <small>(service/exploration/Multicollinearity.html)</small></li><li class="file">ğŸ“„ <a href="#file_9_2">NormalityTest.html</a> <small>(service/exploration/NormalityTest.html)</small></li><li class="file">ğŸ“„ <a href="#file_9_3">SummaryData.html</a> <small>(service/exploration/SummaryData.html)</small></li><li class="file">ğŸ“„ <a href="#file_9_4">VariableSelection.html</a> <small>(service/exploration/VariableSelection.html)</small></li><li class="file">ğŸ“„ <a href="#file_9_5">index.html</a> <small>(service/exploration/index.html)</small></li><li class="folder">ğŸ“ service/graph (5 files)</li><li class="file">ğŸ“„ <a href="#file_10_0">BoxPlot.html</a> <small>(service/graph/BoxPlot.html)</small></li><li class="file">ğŸ“„ <a href="#file_10_1">Histogram.html</a> <small>(service/graph/Histogram.html)</small></li><li class="file">ğŸ“„ <a href="#file_10_2">Lineplot.html</a> <small>(service/graph/Lineplot.html)</small></li><li class="file">ğŸ“„ <a href="#file_10_3">Scatterplot.html</a> <small>(service/graph/Scatterplot.html)</small></li><li class="file">ğŸ“„ <a href="#file_10_4">index.html</a> <small>(service/graph/index.html)</small></li><li class="folder">ğŸ“ service/main (3 files)</li><li class="file">ğŸ“„ <a href="#file_11_0">CheckEnviroment.html</a> <small>(service/main/CheckEnviroment.html)</small></li><li class="file">ğŸ“„ <a href="#file_11_1">LoadingR.html</a> <small>(service/main/LoadingR.html)</small></li><li class="file">ğŸ“„ <a href="#file_11_2">index.html</a> <small>(service/main/index.html)</small></li><li class="folder">ğŸ“ service/modelling (6 files)</li><li class="file">ğŸ“„ <a href="#file_12_0">ProjectionService.html</a> <small>(service/modelling/ProjectionService.html)</small></li><li class="file">ğŸ“„ <a href="#file_12_1">SaeEblupArea.html</a> <small>(service/modelling/SaeEblupArea.html)</small></li><li class="file">ğŸ“„ <a href="#file_12_2">SaeEblupPseudo.html</a> <small>(service/modelling/SaeEblupPseudo.html)</small></li><li class="file">ğŸ“„ <a href="#file_12_3">SaeEblupUnit.html</a> <small>(service/modelling/SaeEblupUnit.html)</small></li><li class="file">ğŸ“„ <a href="#file_12_4">SaeHBArea.html</a> <small>(service/modelling/SaeHBArea.html)</small></li><li class="file">ğŸ“„ <a href="#file_12_5">index.html</a> <small>(service/modelling/index.html)</small></li><li class="folder">ğŸ“ service/modelling/running_model (7 files)</li><li class="file">ğŸ“„ <a href="#file_13_0">Projection.html</a> <small>(service/modelling/running_model/Projection.html)</small></li><li class="file">ğŸ“„ <a href="#file_13_1">SaeEblupArea.html</a> <small>(service/modelling/running_model/SaeEblupArea.html)</small></li><li class="file">ğŸ“„ <a href="#file_13_2">SaeEblupPseudo.html</a> <small>(service/modelling/running_model/SaeEblupPseudo.html)</small></li><li class="file">ğŸ“„ <a href="#file_13_3">SaeEblupUnit.html</a> <small>(service/modelling/running_model/SaeEblupUnit.html)</small></li><li class="file">ğŸ“„ <a href="#file_13_4">SaeHBArea.html</a> <small>(service/modelling/running_model/SaeHBArea.html)</small></li><li class="file">ğŸ“„ <a href="#file_13_5">convert_df.html</a> <small>(service/modelling/running_model/convert_df.html)</small></li><li class="file">ğŸ“„ <a href="#file_13_6">index.html</a> <small>(service/modelling/running_model/index.html)</small></li><li class="folder">ğŸ“ service/table (7 files)</li><li class="file">ğŸ“„ <a href="#file_14_0">AddColumn.html</a> <small>(service/table/AddColumn.html)</small></li><li class="file">ğŸ“„ <a href="#file_14_1">AddRow.html</a> <small>(service/table/AddRow.html)</small></li><li class="file">ğŸ“„ <a href="#file_14_2">DeleteColumn.html</a> <small>(service/table/DeleteColumn.html)</small></li><li class="file">ğŸ“„ <a href="#file_14_3">DeleteRow.html</a> <small>(service/table/DeleteRow.html)</small></li><li class="file">ğŸ“„ <a href="#file_14_4">GoToColumn.html</a> <small>(service/table/GoToColumn.html)</small></li><li class="file">ğŸ“„ <a href="#file_14_5">GoToRow.html</a> <small>(service/table/GoToRow.html)</small></li><li class="file">ğŸ“„ <a href="#file_14_6">index.html</a> <small>(service/table/index.html)</small></li><li class="folder">ğŸ“ service/utils (4 files)</li><li class="file">ğŸ“„ <a href="#file_15_0">convert.html</a> <small>(service/utils/convert.html)</small></li><li class="file">ğŸ“„ <a href="#file_15_1">enable_disable.html</a> <small>(service/utils/enable_disable.html)</small></li><li class="file">ğŸ“„ <a href="#file_15_2">index.html</a> <small>(service/utils/index.html)</small></li><li class="file">ğŸ“„ <a href="#file_15_3">utils.html</a> <small>(service/utils/utils.html)</small></li><li class="folder">ğŸ“ view (3 files)</li><li class="file">ğŸ“„ <a href="#file_16_0">EditColumnDialog.html</a> <small>(view/EditColumnDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_16_1">MainWindow.html</a> <small>(view/MainWindow.html)</small></li><li class="file">ğŸ“„ <a href="#file_19_2">index.html</a> <small>(view/index.html)</small></li><li class="folder">ğŸ“ view/components (16 files)</li><li class="file">ğŸ“„ <a href="#file_17_0">AboutDialog.html</a> <small>(view/components/AboutDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_1">ComputeVariableDialog.html</a> <small>(view/components/ComputeVariableDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_2">ConsoleDialog.html</a> <small>(view/components/ConsoleDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_3">CsvDialogOption.html</a> <small>(view/components/CsvDialogOption.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_4">CustomToast.html</a> <small>(view/components/CustomToast.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_5">DragDropListView.html</a> <small>(view/components/DragDropListView.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_6">ExcelDialogOption.html</a> <small>(view/components/ExcelDialogOption.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_7">MenuContext.html</a> <small>(view/components/MenuContext.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_8">ModelingSaeEblupAreaDialog.html</a> <small>(view/components/ModelingSaeEblupAreaDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_9">ModelingSaeEblupPseudoDialog.html</a> <small>(view/components/ModelingSaeEblupPseudoDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_10">ModelingSaeEblupUnitDialog.html</a> <small>(view/components/ModelingSaeEblupUnitDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_11">ModellingSaeHBDialog.html</a> <small>(view/components/ModellingSaeHBDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_12">ModellingSaeHbNormal.html</a> <small>(view/components/ModellingSaeHbNormal.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_13">ProjectionDialog.html</a> <small>(view/components/ProjectionDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_17_14">SplashScreen.html</a> <small>(view/components/SplashScreen.html)</small></li><li class="file">ğŸ“„ <a href="#file_19_15">index.html</a> <small>(view/components/index.html)</small></li><li class="folder">ğŸ“ view/components/exploration (6 files)</li><li class="file">ğŸ“„ <a href="#file_18_0">CorrelationMatrikDialog.html</a> <small>(view/components/exploration/CorrelationMatrikDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_18_1">MulticollinearityDialog.html</a> <small>(view/components/exploration/MulticollinearityDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_18_2">NormalityTestDialog.html</a> <small>(view/components/exploration/NormalityTestDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_18_3">SummaryDataDialog.html</a> <small>(view/components/exploration/SummaryDataDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_18_4">VariableSelectionDialog.html</a> <small>(view/components/exploration/VariableSelectionDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_18_5">index.html</a> <small>(view/components/exploration/index.html)</small></li><li class="folder">ğŸ“ view/components/graph (5 files)</li><li class="file">ğŸ“„ <a href="#file_19_0">BoxPlotDialog.html</a> <small>(view/components/graph/BoxPlotDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_19_1">HistogramDialog.html</a> <small>(view/components/graph/HistogramDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_19_2">LinePlotDialog.html</a> <small>(view/components/graph/LinePlotDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_19_3">ScatterPlotDialog.html</a> <small>(view/components/graph/ScatterPlotDialog.html)</small></li><li class="file">ğŸ“„ <a href="#file_19_4">index.html</a> <small>(view/components/graph/index.html)</small></li></ul></div>
            <div class="file-section page-break" id="file_0_0">
                <div class="file-header">
                    <div>ğŸ“„ EksplorationController</div>
                    <div class="file-path">controller/Eksploration/EksplorationController.html (20.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.Eksploration.EksplorationController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.Eksploration.EksplorationController.CorrelationMatrixController"><code class="flex name class">
<span>class <span class="ident">CorrelationMatrixController</span></span>
<span>(</span><span>CorrelationMatrixModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CorrelationMatrixController:
    &#34;&#34;&#34;_summary_data_controller
    Controller class for handling correlation matrix.
    This class is responsible for interfacing with the CorrelationMatrixModel
    to generate correlation matrix using provided R scripts.
    Attributes:
        CorrelationMatrixModel: An instance of the CorrelationMatrixModel class.
    Methods:
        __init__(CorrelationMatrixModel):
            Initializes the CorrelationMatrixController with the given model.
        run_model(r_script):
            Executes the correlation matrix generation using the provided R script
    &#34;&#34;&#34;
    def __init__(self, CorrelationMatrixModel):
        self.CorrelationMatrixModel = CorrelationMatrixModel
    
    def run_model(self, r_script):
        self.CorrelationMatrixModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p>_summary_data_controller
Controller class for handling correlation matrix.
This class is responsible for interfacing with the CorrelationMatrixModel
to generate correlation matrix using provided R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>CorrelationMatrixModel</code></strong></dt>
<dd>An instance of the CorrelationMatrixModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(CorrelationMatrixModel):
Initializes the CorrelationMatrixController with the given model.
run_model(r_script):
Executes the correlation matrix generation using the provided R script</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Eksploration.EksplorationController.CorrelationMatrixController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.CorrelationMatrixModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Eksploration.EksplorationController.MulticollinearityController"><code class="flex name class">
<span>class <span class="ident">MulticollinearityController</span></span>
<span>(</span><span>multicollinearityModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MulticollinearityController:
    &#34;&#34;&#34;_summary_data_controller
    Controller class for handling multicollinearity.
    This class is responsible for interfacing with the MulticollinearityModel
    to generate multicollinearity using provided R scripts.
    Attributes:
        MulticollinearityModel: An instance of the MulticollinearityModel class.
    Methods:
        __init__(MulticollinearityModel):
            Initializes the MulticollinearityController with the given model.
        run_model(r_script):
    &#34;&#34;&#34;
    def __init__(self, multicollinearityModel):
        self.MulticollinearityModel = multicollinearityModel
    
    def run_model(self, r_script):
        self.MulticollinearityModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p>_summary_data_controller
Controller class for handling multicollinearity.
This class is responsible for interfacing with the MulticollinearityModel
to generate multicollinearity using provided R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>MulticollinearityModel</code></strong></dt>
<dd>An instance of the MulticollinearityModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(MulticollinearityModel):
Initializes the MulticollinearityController with the given model.
run_model(r_script):</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Eksploration.EksplorationController.MulticollinearityController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.MulticollinearityModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Eksploration.EksplorationController.NormalityTestController"><code class="flex name class">
<span>class <span class="ident">NormalityTestController</span></span>
<span>(</span><span>NormalityTestModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class NormalityTestController:
    
    &#34;&#34;&#34;
    Controller class for handling normality tests.
    This class is responsible for interfacing with the NormalityTestModel
    to run normality tests using provided R scripts.
    Attributes:
        NormalityTestModel: An instance of the NormalityTestModel class.
    Methods:
        __init__(NormalityTestModel):
            Initializes the NormalityTestController with the given model.
        run_model(r_script):
            Executes the normality test using the provided R script.
    &#34;&#34;&#34;
    def __init__(self,NormalityTestModel):
        self.NormalityTestModel = NormalityTestModel

    def run_model(self, r_script):
        self.NormalityTestModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p>Controller class for handling normality tests.
This class is responsible for interfacing with the NormalityTestModel
to run normality tests using provided R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>NormalityTestModel</code></strong></dt>
<dd>An instance of the NormalityTestModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(NormalityTestModel):
Initializes the NormalityTestController with the given model.
run_model(r_script):
Executes the normality test using the provided R script.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Eksploration.EksplorationController.NormalityTestController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.NormalityTestModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Eksploration.EksplorationController.SummaryDataController"><code class="flex name class">
<span>class <span class="ident">SummaryDataController</span></span>
<span>(</span><span>SummaryData)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SummaryDataController:
    &#34;&#34;&#34;_summary_data_controller
    Controller class for handling summary data.
    This class is responsible for interfacing with the SummaryDataModel
    to generate summary data using provided R scripts.
    Attributes:
        SummaryData: An instance of the SummaryDataModel class.
    Methods:
        __init__(SummaryData):
            Initializes the SummaryDataController with the given model.
        run_model(r_script):
            Executes the summary data generation using the provided R script
    &#34;&#34;&#34;
    def __init__(self, SummaryData):
        self.SummaryData = SummaryData
    
    def run_model(self, r_script):
        self.SummaryData.run_model(r_script)</code></pre>
</details>
<div class="desc"><p>_summary_data_controller
Controller class for handling summary data.
This class is responsible for interfacing with the SummaryDataModel
to generate summary data using provided R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>SummaryData</code></strong></dt>
<dd>An instance of the SummaryDataModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(SummaryData):
Initializes the SummaryDataController with the given model.
run_model(r_script):
Executes the summary data generation using the provided R script</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Eksploration.EksplorationController.SummaryDataController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.SummaryData.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Eksploration.EksplorationController.VariableSelectionController"><code class="flex name class">
<span>class <span class="ident">VariableSelectionController</span></span>
<span>(</span><span>VariableSelectionModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class VariableSelectionController:
    &#34;&#34;&#34;_summary_data_controller
    Controller class for handling variable selection.
    This class is responsible for interfacing with the VariableSelectionModel
    to generate variable selection using provided R scripts.
    Attributes:
        VariableSelectionModel: An instance of the VariableSelectionModel class.
    Methods:
        __init__(VariableSelectionModel):
            Initializes the VariableSelectionController with the given model.
        run_model(r_script):
            Executes the variable selection generation using the provided R
    &#34;&#34;&#34;
    def __init__(self, VariableSelectionModel):
        self.VariableSelectionModel = VariableSelectionModel
    
    def run_model(self, r_script):
        self.VariableSelectionModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p>_summary_data_controller
Controller class for handling variable selection.
This class is responsible for interfacing with the VariableSelectionModel
to generate variable selection using provided R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>VariableSelectionModel</code></strong></dt>
<dd>An instance of the VariableSelectionModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(VariableSelectionModel):
Initializes the VariableSelectionController with the given model.
run_model(r_script):
Executes the variable selection generation using the provided R</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Eksploration.EksplorationController.VariableSelectionController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.VariableSelectionModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.Eksploration" href="index.html">saePisan.controller.Eksploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.Eksploration.EksplorationController.CorrelationMatrixController" href="#saePisan.controller.Eksploration.EksplorationController.CorrelationMatrixController">CorrelationMatrixController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Eksploration.EksplorationController.CorrelationMatrixController.run_model" href="#saePisan.controller.Eksploration.EksplorationController.CorrelationMatrixController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Eksploration.EksplorationController.MulticollinearityController" href="#saePisan.controller.Eksploration.EksplorationController.MulticollinearityController">MulticollinearityController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Eksploration.EksplorationController.MulticollinearityController.run_model" href="#saePisan.controller.Eksploration.EksplorationController.MulticollinearityController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Eksploration.EksplorationController.NormalityTestController" href="#saePisan.controller.Eksploration.EksplorationController.NormalityTestController">NormalityTestController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Eksploration.EksplorationController.NormalityTestController.run_model" href="#saePisan.controller.Eksploration.EksplorationController.NormalityTestController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Eksploration.EksplorationController.SummaryDataController" href="#saePisan.controller.Eksploration.EksplorationController.SummaryDataController">SummaryDataController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Eksploration.EksplorationController.SummaryDataController.run_model" href="#saePisan.controller.Eksploration.EksplorationController.SummaryDataController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Eksploration.EksplorationController.VariableSelectionController" href="#saePisan.controller.Eksploration.EksplorationController.VariableSelectionController">VariableSelectionController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Eksploration.EksplorationController.VariableSelectionController.run_model" href="#saePisan.controller.Eksploration.EksplorationController.VariableSelectionController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_1">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">controller/Eksploration/index.html (7.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.Eksploration</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.controller.Eksploration.EksplorationController" href="EksplorationController.html">saePisan.controller.Eksploration.EksplorationController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller" href="../index.html">saePisan.controller</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.controller.Eksploration.EksplorationController" href="EksplorationController.html">saePisan.controller.Eksploration.EksplorationController</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_2">
                <div class="file-header">
                    <div>ğŸ“„ FileController</div>
                    <div class="file-path">controller/FileController.html (53.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.FileController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.FileController.FileController"><code class="flex name class">
<span>class <span class="ident">FileController</span></span>
<span>(</span><span>model1, model2, view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FileController:
    &#34;&#34;&#34;
    Controller class to handle file operations such as loading, saving, and exporting data.
    Attributes:
        model1: The first data model.
        model2: The second data model.
        view: The view component of the MVC architecture.
    Methods:
        __init__(model1, model2, view):
            Initializes the FileController with the given models and view.
        load_file():
            Loads a CSV or Excel file into the first model.
        save_data():
            Saves data from the first model to a file in various formats (CSV, Excel, JSON, Text).
        save_data_output():
            Saves data from the second model to a file in various formats (CSV, Excel, JSON, Text).
        save_as_csv(file_path, model):
            Saves data from the given model as a CSV file.
        save_as_excel(file_path, model):
            Saves data from the given model as an Excel file.
        save_as_json(file_path, model):
            Saves data from the given model as a JSON file.
        save_as_txt(file_path, model):
            Saves data from the given model as a text file with tab-separated values.
        export_output_to_pdf():
            Exports the content of all widgets in the output layout to a PDF file.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, view):
        self.model1 = model1
        self.model2 = model2
        self.view = view

        # Hubungkan menu bar dengan fungsi
        self.view.load_action.triggered.connect(self.load_file)
        self.view.save_action.triggered.connect(self.save_data)
        self.view.save_data_output_action.triggered.connect(self.save_data_output)
        self.view.actionLoad_file.triggered.connect(self.load_file)
        self.view.actionSave_Data.triggered.connect(self.save_data)
        self.view.save_output_pdf.triggered.connect(self.export_output_to_pdf)
        self.view.recent_data.triggered.connect(self.view.load_temp_data)
        self.view.load_secondary_data.triggered.connect(self.load_secondary_data)  

    def open_file(self):
        &#34;&#34;&#34;Open file CSV, Excel, atau Text and load to first model&#34;&#34;&#34;
        file_path, selected_filter = QFileDialog.getOpenFileName(
            self.view, &#34;Open File&#34;, &#34;&#34;,
            &#34;CSV Files (*.csv);;Excel Files (*.xlsx);;Text Files (*.txt);;TSV Files (*.tsv);;JSON Files (*.json)&#34;
        )

        if not file_path:  # Jika file tidak dipilih
            return

        try:
            if selected_filter in [&#34;CSV Files (*.csv)&#34;, &#34;Text Files (*.txt)&#34;, &#34;TSV Files (*.tsv)&#34;]:
                dialog = CSVOptionsDialog(self.view)
                dialog.file_path = file_path
                dialog.file_label.setText(f&#34;Selected: {file_path}&#34;)
                dialog.update_preview()
                file_path, separator, header = dialog.get_csv_options()

                if not file_path:  # Jika file tidak dipilih
                    return
                
                if separator == r&#34;\t&#34;:  # Jika input adalah string literal &#34;\t&#34;
                    separator = &#34;\t&#34;

                # Baca data dari CSV dengan atau tanpa header
                if header:
                    data = pl.read_csv(file_path, separator=separator, ignore_errors=True, has_header=True, null_values=[&#34;NA&#34;, &#34;NULL&#34;, &#34;na&#34;, &#34;null&#34;])
                else:
                    data = pl.read_csv(file_path, separator=separator, ignore_errors=True, has_header=False, null_values=[&#34;NA&#34;, &#34;NULL&#34;, &#34;na&#34;, &#34;null&#34;])
                    data.columns = [f&#34;Column {i+1}&#34; for i in range(data.shape[1])]
            
            elif selected_filter == &#34;Excel Files (*.xlsx)&#34;:
                dialog = ExcelOptionsDialog(self.view)
                dialog.file_path = file_path
                import pandas as pd
                xls = pd.ExcelFile(file_path)
                dialog.sheet_names = xls.sheet_names
                dialog.sheet_combo.addItems(dialog.sheet_names)
                dialog.file_label.setText(f&#34;Selected: {file_path}&#34;)
                dialog.update_preview()
                
                file_path, selected_sheet, hdr = dialog.get_excel_options()
                
                if not file_path or not selected_sheet:  # Jika file tidak dipilih
                    return
                data = pl.read_excel(file_path, sheet_name=selected_sheet, has_header=hdr)
                
            elif selected_filter == &#34;JSON Files (*.json)&#34;:
                data = pl.read_json(file_path)
            
            return data
        except Exception as e:
            QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to load file: {str(e)}&#34;)
    
    def load_file(self):
        &#34;&#34;&#34;Load file CSV, Excel, atau Text to first model (Sheet 1) and update tabel.&#34;&#34;&#34;
        data = self.open_file()
        if data is None:
            return
        else:    
            self.model1.set_data(data)
            self.view.update_table(1, self.model1)
            QMessageBox.information(self.view, &#34;Success&#34;, &#34;File loaded successfully!&#34;)
            self.view.autosave_data()
        
    
    def load_secondary_data(self):
        &#34;&#34;&#34;_summary_
        Load file CSV, Excel, atau Text to first model (Sheet 2) for secondary data and update tabel.
        &#34;&#34;&#34;
        main_df = self.model1.get_data()
        if main_df is None:
            QMessageBox.warning(self.view, &#34;Warning&#34;, &#34;No data loaded in Sheet 1. Please load data first.&#34;)
            return
        data = self.open_file()
        if data is None:
            return

        class MergeOptionDialog(QDialog):
            def __init__(self, parent=None):
                super().__init__(parent)
                self.setWindowTitle(&#34;Select Merge Method&#34;)
                layout = QVBoxLayout(self)
                label = QLabel(&#34;Select data merge method:&#34;, self)
                self.combo = QComboBox(self)
                self.combo.addItems([&#34;Horizontal&#34;, &#34;Diagonal&#34;])
                explanation = QLabel(
                    &#34;&lt;b&gt;Explanation:&lt;/b&gt;&lt;br&gt;&#34;
                    &#34;&lt;b&gt;Horizontal (Merge Columns):&lt;/b&gt; Combines data horizontally by adding columns from the second file to the main file. &#34;
                    &#34;If there are columns with the same name, the columns from the second file will be suffixed with &#39;_duplicate&#39;.&lt;br&gt;&lt;br&gt;&#34;
                    &#34;&lt;b&gt;Diagonal (Merge ColRows):&lt;/b&gt; Combines data vertically by adding rows where column has same name and adding columns where column has different name from the second file to the main file. &#34;
                    &#34;If the number of columns is different, the columns will be automatically adjusted.&#34;
                )
                explanation.setWordWrap(True)
                ok_btn = QPushButton(&#34;OK&#34;, self)
                ok_btn.clicked.connect(self.accept)
                layout.addWidget(label)
                layout.addWidget(self.combo)
                layout.addWidget(ok_btn)
                layout.addWidget(explanation)
                layout.setAlignment(Qt.AlignmentFlag.AlignTop)
                self.setLayout(layout)

            def get_option(self):
                return self.combo.currentIndex()

        dialog = MergeOptionDialog(self.view)
        if dialog.exec():
            option = dialog.get_option()
        else:
            return
        if option == 0:
            common_cols = set(main_df.columns) &amp; set(data.columns)
            rename_map = {col: f&#34;{col}_duplicate&#34; for col in common_cols}
            data = data.rename(rename_map)
            merged_data = pl.concat([main_df, data], how=&#34;horizontal&#34;)
        else:
            for col in set(main_df.columns) &amp; set(data.columns):
                main_dtype = main_df[col].dtype
                try:
                    data = data.with_columns(pl.col(col).cast(main_dtype, strict=False))
                except Exception as e:
                    QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to cast column &#39;{col}&#39;: {e}&#34;)
            merged_data = pl.concat([main_df, data], how=&#34;diagonal&#34;)
        self.model1.set_data(merged_data)
        self.view.update_table(1, self.model1)
        self.view.autosave_data()
        
    def save_data(self):
        &#34;&#34;&#34;Save data from the first model (Sheet 1).&#34;&#34;&#34;
        file_path, selected_filter = QFileDialog.getSaveFileName(
            self.view, &#34;Save File&#34;, &#34;&#34;,
            &#34;CSV Files (*.csv);;Excel Files (*.xlsx);;JSON Files (*.json);;Text Files (*.txt)&#34;
        )
        
        if file_path:

            try:
                if selected_filter == &#34;CSV Files (*.csv)&#34;:
                    self.save_as_csv(file_path, self.model1)
                elif selected_filter == &#34;Excel Files (*.xlsx)&#34;:
                    self.save_as_excel(file_path, self.model1)
                elif selected_filter == &#34;JSON Files (*.json)&#34;:
                    self.save_as_json(file_path, self.model1)
                elif selected_filter == &#34;Text Files (*.txt)&#34;:
                    self.save_as_txt(file_path, self.model1)

                QMessageBox.information(self.view, &#34;Success&#34;, &#34;File saved successfully!&#34;)
            except Exception as e:
                QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to save file: {str(e)}&#34;)

    def save_data_output(self):
        &#34;&#34;&#34;Save data from the first model (Sheet 1).&#34;&#34;&#34;
        file_path, selected_filter = QFileDialog.getSaveFileName(
            self.view, &#34;Save Output Data&#34;, &#34;&#34;,
            &#34;CSV Files (*.csv);;Excel Files (*.xlsx);;JSON Files (*.json);;Text Files (*.txt)&#34;
        )
        
        if file_path:

            try:
                if selected_filter == &#34;CSV Files (*.csv)&#34;:
                    self.save_as_csv(file_path, self.model2)
                elif selected_filter == &#34;Excel Files (*.xlsx)&#34;:
                    self.save_as_excel(file_path, self.model2)
                elif selected_filter == &#34;JSON Files (*.json)&#34;:
                    self.save_as_json(file_path, self.model2)
                elif selected_filter == &#34;Text Files (*.txt)&#34;:
                    self.save_as_txt(file_path, self.model2)

                QMessageBox.information(self.view, &#34;Success&#34;, &#34;Output file saved successfully!&#34;)
            except Exception as e:
                QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to save file: {str(e)}&#34;)

    def save_as_csv(self, file_path, model):
        &#34;&#34;&#34;Save data as CSV.&#34;&#34;&#34;
        data = model.get_data()
        data.write_csv(file_path)

    def save_as_excel(self, file_path, model):
        &#34;&#34;&#34;Save data as Excel.&#34;&#34;&#34;
        data = model.get_data()
        data.write_excel(file_path)

    def save_as_json(self, file_path, model):
        &#34;&#34;&#34;Save data as JSON.&#34;&#34;&#34;
        data = model.get_data()
        data.write_json(file_path, orient=&#34;records&#34;, lines=True)

    def save_as_txt(self, file_path, model):
        &#34;&#34;&#34;Save data as file teks.&#34;&#34;&#34;
        data = model.get_data()
        data.write_csv(file_path, separator=&#34;\t&#34;)


    def export_output_to_pdf(self):
        &#34;&#34;&#34;Export the content of all widgets in the output layout to a PDF file (menggunakan reportlab untuk tabel).&#34;&#34;&#34;
        file_path, _ = QFileDialog.getSaveFileName(
            self.view, &#34;Save PDF&#34;, &#34;&#34;, &#34;PDF Files (*.pdf)&#34;
        )

        if not file_path:
            return
        
        def add_footer(canvas, doc):
            canvas.saveState()
            import datetime
            timestamp = datetime.datetime.now().strftime(&#34;%H:%M:%S %d-%m-%Y&#34;)
            footer_text = f&#34;Generated by saePisan at {timestamp}&#34;
            canvas.setFont(&#34;Helvetica-Oblique&#34;, 8)
            width, height = A4
            canvas.drawRightString(width - 30, 20, footer_text)
            canvas.restoreState()
        
        doc = SimpleDocTemplate(
            file_path, pagesize=A4, leftMargin=30, rightMargin=30, topMargin=40, bottomMargin=40
        )
        frame = Frame(doc.leftMargin, doc.bottomMargin, doc.width, doc.height, id=&#39;normal&#39;)
        doc.addPageTemplates([PageTemplate(id=&#39;footer&#39;, frames=frame, onPage=add_footer)])
        
        elements = []
        styles = getSampleStyleSheet()
        normal_style = styles[&#34;Normal&#34;]
        
        for i in range(self.view.output_layout.count()):
            item = self.view.output_layout.itemAt(i)
            widget = item.widget()
            if widget is None:
                continue

            if isinstance(widget, QFrame):
                for j in range(widget.layout().count()):
                    sub_widget = widget.layout().itemAt(j).widget()
                    if isinstance(sub_widget, QLabel) and &#34;&lt;b&gt;R Script:&lt;/b&gt;&#34; in sub_widget.text():
                        script_box = widget.layout().itemAt(j + 1).widget()
                        text = script_box.toPlainText()
                        elements.append(Paragraph(&#34;R Script:&#34;, styles[&#34;Heading4&#34;]))
                        script_style = ParagraphStyle(
                            name=&#34;ScriptStyle&#34;,
                            parent=styles[&#34;Normal&#34;],
                            fontName=&#34;Courier&#34;,
                            fontSize=9,
                            leading=12,
                        )
                        elements.append(Paragraph(text.replace(&#34;\n&#34;, &#34;&lt;br/&gt;&#34;), script_style))
                        elements.append(Spacer(1, 12))
                    elif isinstance(sub_widget, QLabel) and &#34;Output&#34; in sub_widget.text():
                        result_box = widget.layout().itemAt(j + 1).widget()
                        if isinstance(result_box, QTextEdit):
                            text = result_box.toPlainText()
                            elements.append(Paragraph(&#34;Output:&#34;, styles[&#34;Heading4&#34;]))
                            elements.append(Paragraph(text.replace(&#34;\n&#34;, &#34;&lt;br/&gt;&#34;), normal_style))
                            elements.append(Spacer(1, 12))
                        else:
                            elements.append(Paragraph(&#34;Output:&#34;, styles[&#34;Heading4&#34;]))
                            elements.append(Spacer(1, 12))
                    elif isinstance(sub_widget, QTableView):
                        model = sub_widget.model()
                        if model:
                            columns = [model.headerData(col, Qt.Orientation.Horizontal) for col in range(model.columnCount())]
                            data_rows = []
                            max_col_lens = [len(str(col)) for col in columns]
                            for row in range(model.rowCount()):
                                row_data = []
                                for row in range(model.rowCount()):
                                    row_data = []
                                    for col in range(model.columnCount()):
                                        index = model.index(row, col)
                                        value = model.data(index)
                                        value_str = str(value)
                                        try:
                                            float_val = float(value)
                                            if &#39;.&#39; in value_str and len(value_str) &gt; max_col_lens[col]:
                                                value_str = f&#34;{float_val:.5f}&#34;
                                        except Exception:
                                            pass
                                        row_data.append(value_str)
                                        if len(value_str) &gt; max_col_lens[col]:
                                            max_col_lens[col] = len(value_str)
                                    data_rows.append(row_data)
                            if data_rows:
                                table_data = [columns] + data_rows
                                total_len = sum(max_col_lens)
                                max_width = doc.width
                                col_widths = [
                                    max(40, (l / total_len) * max_width) for l in max_col_lens
                                ]
                                table = Table(table_data, repeatRows=1, colWidths=col_widths)
                                table.setStyle(TableStyle([
                                    (&#39;BACKGROUND&#39;, (0, 0), (-1, 0), colors.lightgrey),
                                    (&#39;TEXTCOLOR&#39;, (0, 0), (-1, 0), colors.black),
                                    (&#39;ALIGN&#39;, (0, 0), (-1, -1), &#39;LEFT&#39;),
                                    (&#39;FONTNAME&#39;, (0, 0), (-1, 0), &#39;Helvetica-Bold&#39;),
                                    (&#39;FONTSIZE&#39;, (0, 0), (-1, -1), 8),
                                    (&#39;BOTTOMPADDING&#39;, (0, 0), (-1, 0), 6),
                                    (&#39;GRID&#39;, (0, 0), (-1, -1), 0.5, colors.grey),
                                    (&#39;VALIGN&#39;, (0, 0), (-1, -1), &#39;TOP&#39;),
                                ]))
                                elements.append(table)
                                elements.append(Spacer(1, 12))
                    elif isinstance(sub_widget, QLabel) and &#34;&lt;b&gt;Plot:&lt;/b&gt;&#34; in sub_widget.text():
                        for k in range(j + 1, widget.layout().count()):
                            plot_label = widget.layout().itemAt(k).widget()
                            if isinstance(plot_label, QLabel):
                                pixmap = plot_label.pixmap()
                                if pixmap:
                                    buffer = QBuffer()
                                    buffer.open(QIODevice.OpenModeFlag.ReadWrite)
                                    pixmap.toImage().save(buffer, &#34;PNG&#34;)
                                    buffer.seek(0)
                                    # Resize image to fit page width if needed
                                    img_width = min(400, doc.width)
                                    img_height = 250 * (img_width / 400)  # maintain aspect ratio
                                    img = Image(io.BytesIO(buffer.data()), width=img_width, height=img_height)
                                    elements.append(img)
                                    elements.append(Spacer(1, 12))
                    elif isinstance(sub_widget, QLabel):
                        text = sub_widget.text().replace(&#34;&lt;b&gt;&#34;, &#34;&#34;).replace(&#34;&lt;/b&gt;&#34;, &#34;&#34;)
                        text = text.replace(&#34;&lt;i&gt;&#34;, &#34;&#34;).replace(&#34;&lt;/i&gt;&#34;, &#34;&#34;)
                        if &#34;Summary of&#34; in sub_widget.text():
                            summary_style = ParagraphStyle(
                                name=&#34;SummaryHeading&#34;,
                                parent=styles[&#34;Heading1&#34;],
                                alignment=TA_CENTER,
                                fontName=&#34;Helvetica-Bold&#34;
                            )
                            elements.append(Paragraph(text, summary_style))
                            elements.append(Spacer(1, 12))
                        elif &#34;Generated on&#34; in sub_widget.text():
                            generated_style = ParagraphStyle(
                                name=&#34;GeneratedHeading&#34;,
                                parent=styles[&#34;Normal&#34;],
                                alignment=2,
                                fontName=&#34;Helvetica-Oblique&#34;,  # Italic
                                fontSize=10,
                                textColor=colors.black
                            )
                            elements.append(Paragraph(text, generated_style))
                            elements.append(Spacer(1, 12))
                        else:
                            elements.append(Paragraph(text, normal_style))
                            elements.append(Spacer(1, 12))

        doc.build(elements)
        QMessageBox.information(self.view, &#34;Success&#34;, &#34;PDF exported successfully!&#34;)</code></pre>
</details>
<div class="desc"><p>Controller class to handle file operations such as loading, saving, and exporting data.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model1</code></strong></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong></dt>
<dd>The second data model.</dd>
<dt><strong><code>view</code></strong></dt>
<dd>The view component of the MVC architecture.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(model1, model2, view):
Initializes the FileController with the given models and view.
load_file():
Loads a CSV or Excel file into the first model.
save_data():
Saves data from the first model to a file in various formats (CSV, Excel, JSON, Text).
save_data_output():
Saves data from the second model to a file in various formats (CSV, Excel, JSON, Text).
save_as_csv(file_path, model):
Saves data from the given model as a CSV file.
save_as_excel(file_path, model):
Saves data from the given model as an Excel file.
save_as_json(file_path, model):
Saves data from the given model as a JSON file.
save_as_txt(file_path, model):
Saves data from the given model as a text file with tab-separated values.
export_output_to_pdf():
Exports the content of all widgets in the output layout to a PDF file.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.FileController.FileController.export_output_to_pdf"><code class="name flex">
<span>def <span class="ident">export_output_to_pdf</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def export_output_to_pdf(self):
    &#34;&#34;&#34;Export the content of all widgets in the output layout to a PDF file (menggunakan reportlab untuk tabel).&#34;&#34;&#34;
    file_path, _ = QFileDialog.getSaveFileName(
        self.view, &#34;Save PDF&#34;, &#34;&#34;, &#34;PDF Files (*.pdf)&#34;
    )

    if not file_path:
        return
    
    def add_footer(canvas, doc):
        canvas.saveState()
        import datetime
        timestamp = datetime.datetime.now().strftime(&#34;%H:%M:%S %d-%m-%Y&#34;)
        footer_text = f&#34;Generated by saePisan at {timestamp}&#34;
        canvas.setFont(&#34;Helvetica-Oblique&#34;, 8)
        width, height = A4
        canvas.drawRightString(width - 30, 20, footer_text)
        canvas.restoreState()
    
    doc = SimpleDocTemplate(
        file_path, pagesize=A4, leftMargin=30, rightMargin=30, topMargin=40, bottomMargin=40
    )
    frame = Frame(doc.leftMargin, doc.bottomMargin, doc.width, doc.height, id=&#39;normal&#39;)
    doc.addPageTemplates([PageTemplate(id=&#39;footer&#39;, frames=frame, onPage=add_footer)])
    
    elements = []
    styles = getSampleStyleSheet()
    normal_style = styles[&#34;Normal&#34;]
    
    for i in range(self.view.output_layout.count()):
        item = self.view.output_layout.itemAt(i)
        widget = item.widget()
        if widget is None:
            continue

        if isinstance(widget, QFrame):
            for j in range(widget.layout().count()):
                sub_widget = widget.layout().itemAt(j).widget()
                if isinstance(sub_widget, QLabel) and &#34;&lt;b&gt;R Script:&lt;/b&gt;&#34; in sub_widget.text():
                    script_box = widget.layout().itemAt(j + 1).widget()
                    text = script_box.toPlainText()
                    elements.append(Paragraph(&#34;R Script:&#34;, styles[&#34;Heading4&#34;]))
                    script_style = ParagraphStyle(
                        name=&#34;ScriptStyle&#34;,
                        parent=styles[&#34;Normal&#34;],
                        fontName=&#34;Courier&#34;,
                        fontSize=9,
                        leading=12,
                    )
                    elements.append(Paragraph(text.replace(&#34;\n&#34;, &#34;&lt;br/&gt;&#34;), script_style))
                    elements.append(Spacer(1, 12))
                elif isinstance(sub_widget, QLabel) and &#34;Output&#34; in sub_widget.text():
                    result_box = widget.layout().itemAt(j + 1).widget()
                    if isinstance(result_box, QTextEdit):
                        text = result_box.toPlainText()
                        elements.append(Paragraph(&#34;Output:&#34;, styles[&#34;Heading4&#34;]))
                        elements.append(Paragraph(text.replace(&#34;\n&#34;, &#34;&lt;br/&gt;&#34;), normal_style))
                        elements.append(Spacer(1, 12))
                    else:
                        elements.append(Paragraph(&#34;Output:&#34;, styles[&#34;Heading4&#34;]))
                        elements.append(Spacer(1, 12))
                elif isinstance(sub_widget, QTableView):
                    model = sub_widget.model()
                    if model:
                        columns = [model.headerData(col, Qt.Orientation.Horizontal) for col in range(model.columnCount())]
                        data_rows = []
                        max_col_lens = [len(str(col)) for col in columns]
                        for row in range(model.rowCount()):
                            row_data = []
                            for row in range(model.rowCount()):
                                row_data = []
                                for col in range(model.columnCount()):
                                    index = model.index(row, col)
                                    value = model.data(index)
                                    value_str = str(value)
                                    try:
                                        float_val = float(value)
                                        if &#39;.&#39; in value_str and len(value_str) &gt; max_col_lens[col]:
                                            value_str = f&#34;{float_val:.5f}&#34;
                                    except Exception:
                                        pass
                                    row_data.append(value_str)
                                    if len(value_str) &gt; max_col_lens[col]:
                                        max_col_lens[col] = len(value_str)
                                data_rows.append(row_data)
                        if data_rows:
                            table_data = [columns] + data_rows
                            total_len = sum(max_col_lens)
                            max_width = doc.width
                            col_widths = [
                                max(40, (l / total_len) * max_width) for l in max_col_lens
                            ]
                            table = Table(table_data, repeatRows=1, colWidths=col_widths)
                            table.setStyle(TableStyle([
                                (&#39;BACKGROUND&#39;, (0, 0), (-1, 0), colors.lightgrey),
                                (&#39;TEXTCOLOR&#39;, (0, 0), (-1, 0), colors.black),
                                (&#39;ALIGN&#39;, (0, 0), (-1, -1), &#39;LEFT&#39;),
                                (&#39;FONTNAME&#39;, (0, 0), (-1, 0), &#39;Helvetica-Bold&#39;),
                                (&#39;FONTSIZE&#39;, (0, 0), (-1, -1), 8),
                                (&#39;BOTTOMPADDING&#39;, (0, 0), (-1, 0), 6),
                                (&#39;GRID&#39;, (0, 0), (-1, -1), 0.5, colors.grey),
                                (&#39;VALIGN&#39;, (0, 0), (-1, -1), &#39;TOP&#39;),
                            ]))
                            elements.append(table)
                            elements.append(Spacer(1, 12))
                elif isinstance(sub_widget, QLabel) and &#34;&lt;b&gt;Plot:&lt;/b&gt;&#34; in sub_widget.text():
                    for k in range(j + 1, widget.layout().count()):
                        plot_label = widget.layout().itemAt(k).widget()
                        if isinstance(plot_label, QLabel):
                            pixmap = plot_label.pixmap()
                            if pixmap:
                                buffer = QBuffer()
                                buffer.open(QIODevice.OpenModeFlag.ReadWrite)
                                pixmap.toImage().save(buffer, &#34;PNG&#34;)
                                buffer.seek(0)
                                # Resize image to fit page width if needed
                                img_width = min(400, doc.width)
                                img_height = 250 * (img_width / 400)  # maintain aspect ratio
                                img = Image(io.BytesIO(buffer.data()), width=img_width, height=img_height)
                                elements.append(img)
                                elements.append(Spacer(1, 12))
                elif isinstance(sub_widget, QLabel):
                    text = sub_widget.text().replace(&#34;&lt;b&gt;&#34;, &#34;&#34;).replace(&#34;&lt;/b&gt;&#34;, &#34;&#34;)
                    text = text.replace(&#34;&lt;i&gt;&#34;, &#34;&#34;).replace(&#34;&lt;/i&gt;&#34;, &#34;&#34;)
                    if &#34;Summary of&#34; in sub_widget.text():
                        summary_style = ParagraphStyle(
                            name=&#34;SummaryHeading&#34;,
                            parent=styles[&#34;Heading1&#34;],
                            alignment=TA_CENTER,
                            fontName=&#34;Helvetica-Bold&#34;
                        )
                        elements.append(Paragraph(text, summary_style))
                        elements.append(Spacer(1, 12))
                    elif &#34;Generated on&#34; in sub_widget.text():
                        generated_style = ParagraphStyle(
                            name=&#34;GeneratedHeading&#34;,
                            parent=styles[&#34;Normal&#34;],
                            alignment=2,
                            fontName=&#34;Helvetica-Oblique&#34;,  # Italic
                            fontSize=10,
                            textColor=colors.black
                        )
                        elements.append(Paragraph(text, generated_style))
                        elements.append(Spacer(1, 12))
                    else:
                        elements.append(Paragraph(text, normal_style))
                        elements.append(Spacer(1, 12))

    doc.build(elements)
    QMessageBox.information(self.view, &#34;Success&#34;, &#34;PDF exported successfully!&#34;)</code></pre>
</details>
<div class="desc"><p>Export the content of all widgets in the output layout to a PDF file (menggunakan reportlab untuk tabel).</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.load_file"><code class="name flex">
<span>def <span class="ident">load_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load_file(self):
    &#34;&#34;&#34;Load file CSV, Excel, atau Text to first model (Sheet 1) and update tabel.&#34;&#34;&#34;
    data = self.open_file()
    if data is None:
        return
    else:    
        self.model1.set_data(data)
        self.view.update_table(1, self.model1)
        QMessageBox.information(self.view, &#34;Success&#34;, &#34;File loaded successfully!&#34;)
        self.view.autosave_data()</code></pre>
</details>
<div class="desc"><p>Load file CSV, Excel, atau Text to first model (Sheet 1) and update tabel.</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.load_secondary_data"><code class="name flex">
<span>def <span class="ident">load_secondary_data</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load_secondary_data(self):
    &#34;&#34;&#34;_summary_
    Load file CSV, Excel, atau Text to first model (Sheet 2) for secondary data and update tabel.
    &#34;&#34;&#34;
    main_df = self.model1.get_data()
    if main_df is None:
        QMessageBox.warning(self.view, &#34;Warning&#34;, &#34;No data loaded in Sheet 1. Please load data first.&#34;)
        return
    data = self.open_file()
    if data is None:
        return

    class MergeOptionDialog(QDialog):
        def __init__(self, parent=None):
            super().__init__(parent)
            self.setWindowTitle(&#34;Select Merge Method&#34;)
            layout = QVBoxLayout(self)
            label = QLabel(&#34;Select data merge method:&#34;, self)
            self.combo = QComboBox(self)
            self.combo.addItems([&#34;Horizontal&#34;, &#34;Diagonal&#34;])
            explanation = QLabel(
                &#34;&lt;b&gt;Explanation:&lt;/b&gt;&lt;br&gt;&#34;
                &#34;&lt;b&gt;Horizontal (Merge Columns):&lt;/b&gt; Combines data horizontally by adding columns from the second file to the main file. &#34;
                &#34;If there are columns with the same name, the columns from the second file will be suffixed with &#39;_duplicate&#39;.&lt;br&gt;&lt;br&gt;&#34;
                &#34;&lt;b&gt;Diagonal (Merge ColRows):&lt;/b&gt; Combines data vertically by adding rows where column has same name and adding columns where column has different name from the second file to the main file. &#34;
                &#34;If the number of columns is different, the columns will be automatically adjusted.&#34;
            )
            explanation.setWordWrap(True)
            ok_btn = QPushButton(&#34;OK&#34;, self)
            ok_btn.clicked.connect(self.accept)
            layout.addWidget(label)
            layout.addWidget(self.combo)
            layout.addWidget(ok_btn)
            layout.addWidget(explanation)
            layout.setAlignment(Qt.AlignmentFlag.AlignTop)
            self.setLayout(layout)

        def get_option(self):
            return self.combo.currentIndex()

    dialog = MergeOptionDialog(self.view)
    if dialog.exec():
        option = dialog.get_option()
    else:
        return
    if option == 0:
        common_cols = set(main_df.columns) &amp; set(data.columns)
        rename_map = {col: f&#34;{col}_duplicate&#34; for col in common_cols}
        data = data.rename(rename_map)
        merged_data = pl.concat([main_df, data], how=&#34;horizontal&#34;)
    else:
        for col in set(main_df.columns) &amp; set(data.columns):
            main_dtype = main_df[col].dtype
            try:
                data = data.with_columns(pl.col(col).cast(main_dtype, strict=False))
            except Exception as e:
                QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to cast column &#39;{col}&#39;: {e}&#34;)
        merged_data = pl.concat([main_df, data], how=&#34;diagonal&#34;)
    self.model1.set_data(merged_data)
    self.view.update_table(1, self.model1)
    self.view.autosave_data()</code></pre>
</details>
<div class="desc"><p><em>summary</em>
Load file CSV, Excel, atau Text to first model (Sheet 2) for secondary data and update tabel.</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.open_file"><code class="name flex">
<span>def <span class="ident">open_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_file(self):
    &#34;&#34;&#34;Open file CSV, Excel, atau Text and load to first model&#34;&#34;&#34;
    file_path, selected_filter = QFileDialog.getOpenFileName(
        self.view, &#34;Open File&#34;, &#34;&#34;,
        &#34;CSV Files (*.csv);;Excel Files (*.xlsx);;Text Files (*.txt);;TSV Files (*.tsv);;JSON Files (*.json)&#34;
    )

    if not file_path:  # Jika file tidak dipilih
        return

    try:
        if selected_filter in [&#34;CSV Files (*.csv)&#34;, &#34;Text Files (*.txt)&#34;, &#34;TSV Files (*.tsv)&#34;]:
            dialog = CSVOptionsDialog(self.view)
            dialog.file_path = file_path
            dialog.file_label.setText(f&#34;Selected: {file_path}&#34;)
            dialog.update_preview()
            file_path, separator, header = dialog.get_csv_options()

            if not file_path:  # Jika file tidak dipilih
                return
            
            if separator == r&#34;\t&#34;:  # Jika input adalah string literal &#34;\t&#34;
                separator = &#34;\t&#34;

            # Baca data dari CSV dengan atau tanpa header
            if header:
                data = pl.read_csv(file_path, separator=separator, ignore_errors=True, has_header=True, null_values=[&#34;NA&#34;, &#34;NULL&#34;, &#34;na&#34;, &#34;null&#34;])
            else:
                data = pl.read_csv(file_path, separator=separator, ignore_errors=True, has_header=False, null_values=[&#34;NA&#34;, &#34;NULL&#34;, &#34;na&#34;, &#34;null&#34;])
                data.columns = [f&#34;Column {i+1}&#34; for i in range(data.shape[1])]
        
        elif selected_filter == &#34;Excel Files (*.xlsx)&#34;:
            dialog = ExcelOptionsDialog(self.view)
            dialog.file_path = file_path
            import pandas as pd
            xls = pd.ExcelFile(file_path)
            dialog.sheet_names = xls.sheet_names
            dialog.sheet_combo.addItems(dialog.sheet_names)
            dialog.file_label.setText(f&#34;Selected: {file_path}&#34;)
            dialog.update_preview()
            
            file_path, selected_sheet, hdr = dialog.get_excel_options()
            
            if not file_path or not selected_sheet:  # Jika file tidak dipilih
                return
            data = pl.read_excel(file_path, sheet_name=selected_sheet, has_header=hdr)
            
        elif selected_filter == &#34;JSON Files (*.json)&#34;:
            data = pl.read_json(file_path)
        
        return data
    except Exception as e:
        QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to load file: {str(e)}&#34;)</code></pre>
</details>
<div class="desc"><p>Open file CSV, Excel, atau Text and load to first model</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.save_as_csv"><code class="name flex">
<span>def <span class="ident">save_as_csv</span></span>(<span>self, file_path, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_as_csv(self, file_path, model):
    &#34;&#34;&#34;Save data as CSV.&#34;&#34;&#34;
    data = model.get_data()
    data.write_csv(file_path)</code></pre>
</details>
<div class="desc"><p>Save data as CSV.</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.save_as_excel"><code class="name flex">
<span>def <span class="ident">save_as_excel</span></span>(<span>self, file_path, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_as_excel(self, file_path, model):
    &#34;&#34;&#34;Save data as Excel.&#34;&#34;&#34;
    data = model.get_data()
    data.write_excel(file_path)</code></pre>
</details>
<div class="desc"><p>Save data as Excel.</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.save_as_json"><code class="name flex">
<span>def <span class="ident">save_as_json</span></span>(<span>self, file_path, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_as_json(self, file_path, model):
    &#34;&#34;&#34;Save data as JSON.&#34;&#34;&#34;
    data = model.get_data()
    data.write_json(file_path, orient=&#34;records&#34;, lines=True)</code></pre>
</details>
<div class="desc"><p>Save data as JSON.</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.save_as_txt"><code class="name flex">
<span>def <span class="ident">save_as_txt</span></span>(<span>self, file_path, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_as_txt(self, file_path, model):
    &#34;&#34;&#34;Save data as file teks.&#34;&#34;&#34;
    data = model.get_data()
    data.write_csv(file_path, separator=&#34;\t&#34;)</code></pre>
</details>
<div class="desc"><p>Save data as file teks.</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.save_data"><code class="name flex">
<span>def <span class="ident">save_data</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_data(self):
    &#34;&#34;&#34;Save data from the first model (Sheet 1).&#34;&#34;&#34;
    file_path, selected_filter = QFileDialog.getSaveFileName(
        self.view, &#34;Save File&#34;, &#34;&#34;,
        &#34;CSV Files (*.csv);;Excel Files (*.xlsx);;JSON Files (*.json);;Text Files (*.txt)&#34;
    )
    
    if file_path:

        try:
            if selected_filter == &#34;CSV Files (*.csv)&#34;:
                self.save_as_csv(file_path, self.model1)
            elif selected_filter == &#34;Excel Files (*.xlsx)&#34;:
                self.save_as_excel(file_path, self.model1)
            elif selected_filter == &#34;JSON Files (*.json)&#34;:
                self.save_as_json(file_path, self.model1)
            elif selected_filter == &#34;Text Files (*.txt)&#34;:
                self.save_as_txt(file_path, self.model1)

            QMessageBox.information(self.view, &#34;Success&#34;, &#34;File saved successfully!&#34;)
        except Exception as e:
            QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to save file: {str(e)}&#34;)</code></pre>
</details>
<div class="desc"><p>Save data from the first model (Sheet 1).</p></div>
</dd>
<dt id="saePisan.controller.FileController.FileController.save_data_output"><code class="name flex">
<span>def <span class="ident">save_data_output</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_data_output(self):
    &#34;&#34;&#34;Save data from the first model (Sheet 1).&#34;&#34;&#34;
    file_path, selected_filter = QFileDialog.getSaveFileName(
        self.view, &#34;Save Output Data&#34;, &#34;&#34;,
        &#34;CSV Files (*.csv);;Excel Files (*.xlsx);;JSON Files (*.json);;Text Files (*.txt)&#34;
    )
    
    if file_path:

        try:
            if selected_filter == &#34;CSV Files (*.csv)&#34;:
                self.save_as_csv(file_path, self.model2)
            elif selected_filter == &#34;Excel Files (*.xlsx)&#34;:
                self.save_as_excel(file_path, self.model2)
            elif selected_filter == &#34;JSON Files (*.json)&#34;:
                self.save_as_json(file_path, self.model2)
            elif selected_filter == &#34;Text Files (*.txt)&#34;:
                self.save_as_txt(file_path, self.model2)

            QMessageBox.information(self.view, &#34;Success&#34;, &#34;Output file saved successfully!&#34;)
        except Exception as e:
            QMessageBox.critical(self.view, &#34;Error&#34;, f&#34;Failed to save file: {str(e)}&#34;)</code></pre>
</details>
<div class="desc"><p>Save data from the first model (Sheet 1).</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller" href="index.html">saePisan.controller</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.FileController.FileController" href="#saePisan.controller.FileController.FileController">FileController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.FileController.FileController.export_output_to_pdf" href="#saePisan.controller.FileController.FileController.export_output_to_pdf">export_output_to_pdf</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.load_file" href="#saePisan.controller.FileController.FileController.load_file">load_file</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.load_secondary_data" href="#saePisan.controller.FileController.FileController.load_secondary_data">load_secondary_data</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.open_file" href="#saePisan.controller.FileController.FileController.open_file">open_file</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.save_as_csv" href="#saePisan.controller.FileController.FileController.save_as_csv">save_as_csv</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.save_as_excel" href="#saePisan.controller.FileController.FileController.save_as_excel">save_as_excel</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.save_as_json" href="#saePisan.controller.FileController.FileController.save_as_json">save_as_json</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.save_as_txt" href="#saePisan.controller.FileController.FileController.save_as_txt">save_as_txt</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.save_data" href="#saePisan.controller.FileController.FileController.save_data">save_data</a></code></li>
<li><code><a title="saePisan.controller.FileController.FileController.save_data_output" href="#saePisan.controller.FileController.FileController.save_data_output">save_data_output</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_3">
                <div class="file-header">
                    <div>ğŸ“„ GraphController</div>
                    <div class="file-path">controller/Graph/GraphController.html (16.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.Graph.GraphController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.Graph.GraphController.BoxPlotController"><code class="flex name class">
<span>class <span class="ident">BoxPlotController</span></span>
<span>(</span><span>BoxPlotModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BoxPlotController:
    &#34;&#34;&#34;_summary_box_plot_controller_
    This class is responsible for controlling the BoxPlotModel.
    Attributes:
        BoxPlotModel (BoxPlotModel): An instance of the BoxPlotModel class.
    Methods:
        __init__(BoxPlotModel):
            Initializes the BoxPlotController with a BoxPlotModel instance.
        run_model(r_script):
            Executes the run_model method of the BoxPlotModel with the provided
            R script.
    &#34;&#34;&#34;
    def __init__(self, BoxPlotModel):
        self.BoxPlotModel = BoxPlotModel
    
    def run_model(self, r_script):
        self.BoxPlotModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p><em>summary_box_plot_controller</em>
This class is responsible for controlling the BoxPlotModel.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>BoxPlotModel</code></strong> :&ensp;<code>BoxPlotModel</code></dt>
<dd>An instance of the BoxPlotModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(BoxPlotModel):
Initializes the BoxPlotController with a BoxPlotModel instance.
run_model(r_script):
Executes the run_model method of the BoxPlotModel with the provided
R script.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Graph.GraphController.BoxPlotController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.BoxPlotModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Graph.GraphController.HistogramController"><code class="flex name class">
<span>class <span class="ident">HistogramController</span></span>
<span>(</span><span>HistogramModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class HistogramController:
    &#34;&#34;&#34;_summary_histogram_controller_
    This class is responsible for controlling the HistogramModel.
    Attributes:
        HistogramModel (HistogramModel): An instance of the HistogramModel class.
    Methods:
        __init__(HistogramModel):
            Initializes the HistogramController with a HistogramModel instance.
        run_model(r_script):
            Executes the run_model method of the HistogramModel with the provided
            R script.
    &#34;&#34;&#34;
    def __init__(self, HistogramModel):
        self.HistogramModel = HistogramModel
    
    def run_model(self, r_script):
        self.HistogramModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p><em>summary_histogram_controller</em>
This class is responsible for controlling the HistogramModel.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>HistogramModel</code></strong> :&ensp;<code>HistogramModel</code></dt>
<dd>An instance of the HistogramModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(HistogramModel):
Initializes the HistogramController with a HistogramModel instance.
run_model(r_script):
Executes the run_model method of the HistogramModel with the provided
R script.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Graph.GraphController.HistogramController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.HistogramModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Graph.GraphController.LinePlotController"><code class="flex name class">
<span>class <span class="ident">LinePlotController</span></span>
<span>(</span><span>LinePlotModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LinePlotController:
    &#34;&#34;&#34;_summary_line_plot_controller_
    This class is responsible for controlling the LinePlotModel.
    Attributes:
        LinePlotModel (LinePlotModel): An instance of the LinePlotModel class.
    Methods:
        __init__(LinePlotModel):
            Initializes the LinePlotController with a LinePlotModel instance.
        run_model(r_script):
            Executes the run_model method of the LinePlotModel with the provided R script.
    &#34;&#34;&#34;
    def __init__(self, LinePlotModel):
        self.LinePlotModel = LinePlotModel
    
    def run_model(self, r_script):
        self.LinePlotModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p><em>summary_line_plot_controller</em>
This class is responsible for controlling the LinePlotModel.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>LinePlotModel</code></strong> :&ensp;<code>LinePlotModel</code></dt>
<dd>An instance of the LinePlotModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(LinePlotModel):
Initializes the LinePlotController with a LinePlotModel instance.
run_model(r_script):
Executes the run_model method of the LinePlotModel with the provided R script.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Graph.GraphController.LinePlotController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.LinePlotModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.controller.Graph.GraphController.ScatterPlotController"><code class="flex name class">
<span>class <span class="ident">ScatterPlotController</span></span>
<span>(</span><span>ScatterPlotModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ScatterPlotController:
    &#34;&#34;&#34;_summary_scatter_plot_controller_
    This class is responsible for controlling the ScatterPlotModel.
    Attributes:
        ScatterPlotModel (ScatterPlotModel): An instance of the ScatterPlotModel class.
    Methods:
        __init__(ScatterPlotModel):
            Initializes the ScatterPlotController with a ScatterPlotModel instance.
        run_model(r_script):
            Executes the run_model method of the ScatterPlotModel with the provided R script.
    &#34;&#34;&#34;
    def __init__(self, ScatterPlotModel):
        self.ScatterPlotModel = ScatterPlotModel
    
    def run_model(self, r_script):
        self.ScatterPlotModel.run_model(r_script)</code></pre>
</details>
<div class="desc"><p><em>summary_scatter_plot_controller</em>
This class is responsible for controlling the ScatterPlotModel.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>ScatterPlotModel</code></strong> :&ensp;<code>ScatterPlotModel</code></dt>
<dd>An instance of the ScatterPlotModel class.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(ScatterPlotModel):
Initializes the ScatterPlotController with a ScatterPlotModel instance.
run_model(r_script):
Executes the run_model method of the ScatterPlotModel with the provided R script.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.Graph.GraphController.ScatterPlotController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.ScatterPlotModel.run_model(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.Graph" href="index.html">saePisan.controller.Graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.Graph.GraphController.BoxPlotController" href="#saePisan.controller.Graph.GraphController.BoxPlotController">BoxPlotController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Graph.GraphController.BoxPlotController.run_model" href="#saePisan.controller.Graph.GraphController.BoxPlotController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Graph.GraphController.HistogramController" href="#saePisan.controller.Graph.GraphController.HistogramController">HistogramController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Graph.GraphController.HistogramController.run_model" href="#saePisan.controller.Graph.GraphController.HistogramController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Graph.GraphController.LinePlotController" href="#saePisan.controller.Graph.GraphController.LinePlotController">LinePlotController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Graph.GraphController.LinePlotController.run_model" href="#saePisan.controller.Graph.GraphController.LinePlotController.run_model">run_model</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.controller.Graph.GraphController.ScatterPlotController" href="#saePisan.controller.Graph.GraphController.ScatterPlotController">ScatterPlotController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.Graph.GraphController.ScatterPlotController.run_model" href="#saePisan.controller.Graph.GraphController.ScatterPlotController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_4">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">controller/Graph/index.html (7.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.Graph</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.controller.Graph.GraphController" href="GraphController.html">saePisan.controller.Graph.GraphController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller" href="../index.html">saePisan.controller</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.controller.Graph.GraphController" href="GraphController.html">saePisan.controller.Graph.GraphController</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_5">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">controller/index.html (8.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.controller.Eksploration" href="Eksploration/index.html">saePisan.controller.Eksploration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.FileController" href="FileController.html">saePisan.controller.FileController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.Graph" href="Graph/index.html">saePisan.controller.Graph</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.modelling" href="modelling/index.html">saePisan.controller.modelling</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan" href="../index.html">saePisan</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.controller.Eksploration" href="Eksploration/index.html">saePisan.controller.Eksploration</a></code></li>
<li><code><a title="saePisan.controller.FileController" href="FileController.html">saePisan.controller.FileController</a></code></li>
<li><code><a title="saePisan.controller.Graph" href="Graph/index.html">saePisan.controller.Graph</a></code></li>
<li><code><a title="saePisan.controller.modelling" href="modelling/index.html">saePisan.controller.modelling</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_6">
                <div class="file-header">
                    <div>ğŸ“„ ProjectionController</div>
                    <div class="file-path">controller/modelling/ProjectionController.html (9.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.modelling.ProjectionController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.modelling.ProjectionController.ProjectionController"><code class="flex name class">
<span>class <span class="ident">ProjectionController</span></span>
<span>(</span><span>projectionModel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ProjectionController:
    &#34;&#34;&#34;
    Controller class for handling projection model operations.
    Attributes:
        projectionModel: An instance of the projection model to be used.
    Methods:
        run_model(r_script):
            Executes the projection model with the provided R script.
            Args:
                r_script (str): The R script to be executed by the projection model.
            Returns:
                tuple: A tuple containing the result, error, and dataframe from the model execution.
    &#34;&#34;&#34;
    
    def __init__(self, projectionModel):
        self.projectionModel = projectionModel
    
    def run_model(self, r_script):
        result, error, df = self.projectionModel.run_model(r_script)
        return result, error, df</code></pre>
</details>
<div class="desc"><p>Controller class for handling projection model operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>projectionModel</code></strong></dt>
<dd>An instance of the projection model to be used.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script):
Executes the projection model with the provided R script.
Args:
r_script (str): The R script to be executed by the projection model.
Returns:
tuple: A tuple containing the result, error, and dataframe from the model execution.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.modelling.ProjectionController.ProjectionController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    result, error, df = self.projectionModel.run_model(r_script)
    return result, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.modelling" href="index.html">saePisan.controller.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.modelling.ProjectionController.ProjectionController" href="#saePisan.controller.modelling.ProjectionController.ProjectionController">ProjectionController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.modelling.ProjectionController.ProjectionController.run_model" href="#saePisan.controller.modelling.ProjectionController.ProjectionController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_7">
                <div class="file-header">
                    <div>ğŸ“„ SaeController</div>
                    <div class="file-path">controller/modelling/SaeController.html (9.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.modelling.SaeController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.modelling.SaeController.SaeController"><code class="flex name class">
<span>class <span class="ident">SaeController</span></span>
<span>(</span><span>SAEmodel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeController:
    &#34;&#34;&#34;
    Controller class for handling SAE model operations.
    Attributes:
        SAEmodel: An instance of the SAE model to be used for running scripts.
    Methods:
        __init__(SAEmodel):
            Initializes the SaeController with the given SAE model.
        run_model(r_script):
            Executes the given R script using the SAE model and returns the result, error, and dataframe.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Initializes the SaeController with the given SAE model.
    Args:
        SAEmodel: An instance of the SAE model.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Executes the given R script using the SAE model.
    Args:
        r_script (str): The R script to be executed.
    Returns:
        tuple: A tuple containing the result, error, and dataframe from the SAE model execution.
    &#34;&#34;&#34;
    
    def __init__(self, SAEmodel):
        self.SAEmodel = SAEmodel
    
    def run_model(self, r_script):
        result, error, df = self.SAEmodel.run_model(r_script)
        return result, error, df</code></pre>
</details>
<div class="desc"><p>Controller class for handling SAE model operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>SAEmodel</code></strong></dt>
<dd>An instance of the SAE model to be used for running scripts.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(SAEmodel):
Initializes the SaeController with the given SAE model.
run_model(r_script):
Executes the given R script using the SAE model and returns the result, error, and dataframe.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.modelling.SaeController.SaeController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    result, error, df = self.SAEmodel.run_model(r_script)
    return result, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.modelling" href="index.html">saePisan.controller.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.modelling.SaeController.SaeController" href="#saePisan.controller.modelling.SaeController.SaeController">SaeController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.modelling.SaeController.SaeController.run_model" href="#saePisan.controller.modelling.SaeController.SaeController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_8">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupUnitController</div>
                    <div class="file-path">controller/modelling/SaeEblupUnitController.html (10.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.modelling.SaeEblupUnitController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.modelling.SaeEblupUnitController.SaeEblupUnitController"><code class="flex name class">
<span>class <span class="ident">SaeEblupUnitController</span></span>
<span>(</span><span>SAEmodel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeEblupUnitController:
    &#34;&#34;&#34;
    Controller class for running Small Area Estimation (SAE) models using EBLUP (Empirical Best Linear Unbiased Prediction).
    Attributes:
        SAEmodel: An instance of a class that provides the `run_model` method to execute the SAE model.
    Methods:
        __init__(SAEmodel):
            Initializes the SaeEblupUnitController with the given SAE model instance.
        run_model(r_script):
            Executes the SAE model using the provided R script.
            Args:
                r_script (str): The R script to be executed by the SAE model.
            Returns:
                tuple: A tuple containing the result, error, and dataframe (df) from the model execution.
    &#34;&#34;&#34;
    
    def __init__(self, SAEmodel):
        self.SAEmodel = SAEmodel
    
    def run_model(self, r_script):
        results, error, df = self.SAEmodel.run_model(r_script)
        return results, error, df</code></pre>
</details>
<div class="desc"><p>Controller class for running Small Area Estimation (SAE) models using EBLUP (Empirical Best Linear Unbiased Prediction).</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>SAEmodel</code></strong></dt>
<dd>An instance of a class that provides the <code>run_model</code> method to execute the SAE model.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(SAEmodel):
Initializes the SaeEblupUnitController with the given SAE model instance.
run_model(r_script):
Executes the SAE model using the provided R script.
Args:
r_script (str): The R script to be executed by the SAE model.
Returns:
tuple: A tuple containing the result, error, and dataframe (df) from the model execution.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.modelling.SaeEblupUnitController.SaeEblupUnitController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    results, error, df = self.SAEmodel.run_model(r_script)
    return results, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.modelling" href="index.html">saePisan.controller.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.modelling.SaeEblupUnitController.SaeEblupUnitController" href="#saePisan.controller.modelling.SaeEblupUnitController.SaeEblupUnitController">SaeEblupUnitController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.modelling.SaeEblupUnitController.SaeEblupUnitController.run_model" href="#saePisan.controller.modelling.SaeEblupUnitController.SaeEblupUnitController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_0_9">
                <div class="file-header">
                    <div>ğŸ“„ SaeHBcontroller</div>
                    <div class="file-path">controller/modelling/SaeHBcontroller.html (9.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.modelling.SaeHBcontroller</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.modelling.SaeHBcontroller.SaeHBController"><code class="flex name class">
<span>class <span class="ident">SaeHBController</span></span>
<span>(</span><span>SAEmodel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeHBController:
    &#34;&#34;&#34;
    Controller class for handling SAE model operations.
    Attributes:
        SAEmodel: An instance of the SAE model to be controlled.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Initializes the SaeHBController with the given SAE model.
    Args:
        SAEmodel: The SAE model instance to be used by the controller.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Runs the SAE model using the provided R script.
    Args:
        r_script (str): The R script to be executed by the SAE model.
    Returns:
        tuple: A tuple containing the result, error, and dataframe (df) from the model execution.
    &#34;&#34;&#34;
    
    def __init__(self, SAEmodel):
        self.SAEmodel = SAEmodel
    
    def run_model(self, r_script):
        result, error, df, plot_paths = self.SAEmodel.run_model(r_script)
        return result, error, df, plot_paths</code></pre>
</details>
<div class="desc"><p>Controller class for handling SAE model operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>SAEmodel</code></strong></dt>
<dd>An instance of the SAE model to be controlled.</dd>
</dl></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.modelling.SaeHBcontroller.SaeHBController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    result, error, df, plot_paths = self.SAEmodel.run_model(r_script)
    return result, error, df, plot_paths</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.modelling" href="index.html">saePisan.controller.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.modelling.SaeHBcontroller.SaeHBController" href="#saePisan.controller.modelling.SaeHBcontroller.SaeHBController">SaeHBController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.modelling.SaeHBcontroller.SaeHBController.run_model" href="#saePisan.controller.modelling.SaeHBcontroller.SaeHBController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_0">
                <div class="file-header">
                    <div>ğŸ“„ SaePseudoController</div>
                    <div class="file-path">controller/modelling/SaePseudoController.html (9.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.modelling.SaePseudoController</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.controller.modelling.SaePseudoController.SaePseudoController"><code class="flex name class">
<span>class <span class="ident">SaePseudoController</span></span>
<span>(</span><span>SAEmodel)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaePseudoController:
    &#34;&#34;&#34;
    A controller class for running SAE models using R scripts.
    Attributes:
        SAEmodel: An instance of the SAE model to be used.
    Methods:
        run_model(r_script):
            Executes the SAE model with the provided R script and returns the result, error, and dataframe.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Initializes the SaePseudoController with the given SAE model.
    Args:
        SAEmodel: An instance of the SAE model to be used.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Executes the SAE model with the provided R script.
    Args:
        r_script (str): The R script to be executed.
    Returns:
        tuple: A tuple containing the result, error, and dataframe from the model execution.
    &#34;&#34;&#34;
    
    def __init__(self, SAEmodel):
        self.SAEmodel = SAEmodel
    
    def run_model(self, r_script):
        result, error, df = self.SAEmodel.run_model(r_script)
        return result, error, df</code></pre>
</details>
<div class="desc"><p>A controller class for running SAE models using R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>SAEmodel</code></strong></dt>
<dd>An instance of the SAE model to be used.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script):
Executes the SAE model with the provided R script and returns the result, error, and dataframe.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.controller.modelling.SaePseudoController.SaePseudoController.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    result, error, df = self.SAEmodel.run_model(r_script)
    return result, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller.modelling" href="index.html">saePisan.controller.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.controller.modelling.SaePseudoController.SaePseudoController" href="#saePisan.controller.modelling.SaePseudoController.SaePseudoController">SaePseudoController</a></code></h4>
<ul class="">
<li><code><a title="saePisan.controller.modelling.SaePseudoController.SaePseudoController.run_model" href="#saePisan.controller.modelling.SaePseudoController.SaePseudoController.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_1">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">controller/modelling/index.html (8.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.controller.modelling</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.controller.modelling.ProjectionController" href="ProjectionController.html">saePisan.controller.modelling.ProjectionController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.modelling.SaeController" href="SaeController.html">saePisan.controller.modelling.SaeController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.modelling.SaeEblupUnitController" href="SaeEblupUnitController.html">saePisan.controller.modelling.SaeEblupUnitController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.modelling.SaeHBcontroller" href="SaeHBcontroller.html">saePisan.controller.modelling.SaeHBcontroller</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.controller.modelling.SaePseudoController" href="SaePseudoController.html">saePisan.controller.modelling.SaePseudoController</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.controller" href="../index.html">saePisan.controller</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.controller.modelling.ProjectionController" href="ProjectionController.html">saePisan.controller.modelling.ProjectionController</a></code></li>
<li><code><a title="saePisan.controller.modelling.SaeController" href="SaeController.html">saePisan.controller.modelling.SaeController</a></code></li>
<li><code><a title="saePisan.controller.modelling.SaeEblupUnitController" href="SaeEblupUnitController.html">saePisan.controller.modelling.SaeEblupUnitController</a></code></li>
<li><code><a title="saePisan.controller.modelling.SaeHBcontroller" href="SaeHBcontroller.html">saePisan.controller.modelling.SaeHBcontroller</a></code></li>
<li><code><a title="saePisan.controller.modelling.SaePseudoController" href="SaePseudoController.html">saePisan.controller.modelling.SaePseudoController</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_2">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">index.html (7.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.controller" href="controller/index.html">saePisan.controller</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.main" href="main.html">saePisan.main</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model" href="model/index.html">saePisan.model</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service" href="service/index.html">saePisan.service</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view" href="view/index.html">saePisan.view</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.controller" href="controller/index.html">saePisan.controller</a></code></li>
<li><code><a title="saePisan.main" href="main.html">saePisan.main</a></code></li>
<li><code><a title="saePisan.model" href="model/index.html">saePisan.model</a></code></li>
<li><code><a title="saePisan.service" href="service/index.html">saePisan.service</a></code></li>
<li><code><a title="saePisan.view" href="view/index.html">saePisan.view</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_3">
                <div class="file-header">
                    <div>ğŸ“„ main</div>
                    <div class="file-path">main.html (10.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.main</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.main.load_stylesheet"><code class="name flex">
<span>def <span class="ident">load_stylesheet</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load_stylesheet():
    &#34;&#34;&#34;
    Fungsi untuk memuat stylesheet dari file .qss.
    &#34;&#34;&#34;
    stylesheet_path = os.path.join(os.path.dirname(__file__), &#39;assets&#39;, &#39;style&#39;, &#39;style.qss&#39;)
    if os.path.exists(stylesheet_path):
        with open(stylesheet_path, &#39;r&#39;) as file:
            return file.read()
    else:
        print(f&#34;Stylesheet tidak ditemukan di {stylesheet_path}&#34;)
        return &#34;&#34;</code></pre>
</details>
<div class="desc"><p>Fungsi untuk memuat stylesheet dari file .qss.</p></div>
</dd>
<dt id="saePisan.main.main"><code class="name flex">
<span>def <span class="ident">main</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def main():
    
    # Inisialisasi aplikasi PyQt
    app = QApplication(sys.argv)

    # Buat dan tampilkan splash screen
    splash_pix = QPixmap(os.path.join(os.path.dirname(__file__), &#39;assets&#39;, &#39;splash.png&#39;))
    splash = SplashScreen(splash_pix)
    splash.show()
    
    # Cek dan siapkan lingkungan R
    path = os.path.join(os.path.dirname(__file__), &#39;R&#39;, &#39;R-4.4.2&#39;)
    original_path = os.path.dirname(__file__)
    import warnings
    warnings.filterwarnings(&#34;ignore&#34;, message=&#34;The symbol &#39;quartz&#39; is not in this R namespace/package.&#34;)
    check_environment(path, original_path)
    
    from service.main.LoadingR import loadR  # Load modul R setelah check_environment

    loadR(splash)
    
    from view.MainWindow import MainWindow
    splash.update_message()

    # Inisialisasi view dan controller
    view = MainWindow()  # Tampilan utama aplikasi
    view.setWindowFlags(view.windowFlags() | Qt.WindowType.WindowStaysOnTopHint)  # Set window flag to be on top initially
    view.show()
    view.setWindowFlags(view.windowFlags() &amp; ~Qt.WindowType.WindowStaysOnTopHint)  # Remove the always on top flag
    controller = FileController(view.model1, view.model2, view)
    
    app.setStyleSheet(view.load_stylesheet_with_font_size(14))

    def load_stylesheet():
        # Gunakan jalur relatif untuk mengakses style.qss
        stylesheet_path = os.path.join(os.path.dirname(__file__), &#39;assets&#39;,&#39;style&#39;, &#39;style.qss&#39;)
        with open(stylesheet_path, &#39;r&#39;) as file:
            return file.read()

    # Muat dan terapkan stylesheet global untuk aplikasi
    app.setStyleSheet(load_stylesheet())  # Terapkan ke seluruh aplikasi

    app.styleHints().setColorScheme(Qt.ColorScheme.Light);
    
    # Set icon aplikasi
    view.setWindowIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;assets&#39;, &#39;icon.svg&#39;)))

    # Muat stylesheet
    stylesheet = load_stylesheet()
    if stylesheet:
        view.setStyleSheet(stylesheet)

    # Tampilkan window utama
    splash.update_message()
    view.show()
    splash.finish(view)

    # Mulai aplikasi
    sys.exit(app.exec())</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan" href="index.html">saePisan</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.main.load_stylesheet" href="#saePisan.main.load_stylesheet">load_stylesheet</a></code></li>
<li><code><a title="saePisan.main.main" href="#saePisan.main.main">main</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_4">
                <div class="file-header">
                    <div>ğŸ“„ BoxPlot</div>
                    <div class="file-path">model/BoxPlot.html (10.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.BoxPlot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.BoxPlot.BoxPlot"><code class="flex name class">
<span>class <span class="ident">BoxPlot</span></span>
<span>(</span><span>model1, model2, view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BoxPlot:
    &#34;&#34;&#34;
    A class used to represent a BoxPlot.
    Attributes
    ----------
    model1 : object
        The first model to be used in the box plot.
    model2 : object
        The second model to be used in the box plot.
    view : object
        The view associated with the box plot.
    plot : object, optional
        The plot object, initialized as None.
    result : object, optional
        The result of the box plot, initialized as None.
    error : bool, optional
        A flag indicating if there was an error, initialized as False.
    Methods
    -------
    run_model(r_script)
        Runs the box plot model using the provided R script.
    activate_R()
        Activates the R environment using rpy2.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, view):
        self.model1 = model1
        self.model2 = model2
        self.view = view
        self.plot = None
        self.result = None
        self.error = False

    def run_model(self, r_script):
        self.r_script = r_script
        run_box_plot(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent a BoxPlot.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be used in the box plot.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be used in the box plot.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the box plot.</dd>
<dt><strong><code>plot</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The plot object, initialized as None.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The result of the box plot, initialized as None.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>A flag indicating if there was an error, initialized as False.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script)
Runs the box plot model using the provided R script.
activate_R()
Activates the R environment using rpy2.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.BoxPlot.BoxPlot.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.BoxPlot.BoxPlot.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_box_plot(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.BoxPlot.BoxPlot" href="#saePisan.model.BoxPlot.BoxPlot">BoxPlot</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.BoxPlot.BoxPlot.activate_R" href="#saePisan.model.BoxPlot.BoxPlot.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.BoxPlot.BoxPlot.run_model" href="#saePisan.model.BoxPlot.BoxPlot.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_5">
                <div class="file-header">
                    <div>ğŸ“„ CorrelationMatrix</div>
                    <div class="file-path">model/CorrelationMatrix.html (11.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.CorrelationMatrix</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.CorrelationMatrix.CorrelationMatrix"><code class="flex name class">
<span>class <span class="ident">CorrelationMatrix</span></span>
<span>(</span><span>model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CorrelationMatrix:
    &#34;&#34;&#34;
    A class to represent a correlation matrix model.
    Attributes
    ----------
    model1 : object
        The first model to be used in the correlation matrix.
    model2 : object
        The second model to be used in the correlation matrix.
    view : object
        The view associated with the correlation matrix.
    result : str
        The result of the correlation matrix computation.
    plot : object, optional
        The plot of the correlation matrix (default is None).
    error : bool
        A flag indicating if there was an error during computation (default is False).
    Methods
    -------
    run_model(r_script):
        Runs the correlation matrix model using the provided R script.
    activate_R():
        Activates the R environment using rpy2.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.result =&#34;&#34;
        self.plot = None
        self.error = False

    def run_model(self, r_script):
        self.r_script = r_script
        run_correlation_matrix(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class to represent a correlation matrix model.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be used in the correlation matrix.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be used in the correlation matrix.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the correlation matrix.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>str</code></dt>
<dd>The result of the correlation matrix computation.</dd>
<dt><strong><code>plot</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The plot of the correlation matrix (default is None).</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there was an error during computation (default is False).</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script):
Runs the correlation matrix model using the provided R script.
activate_R():
Activates the R environment using rpy2.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.CorrelationMatrix.CorrelationMatrix.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.CorrelationMatrix.CorrelationMatrix.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_correlation_matrix(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.CorrelationMatrix.CorrelationMatrix" href="#saePisan.model.CorrelationMatrix.CorrelationMatrix">CorrelationMatrix</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.CorrelationMatrix.CorrelationMatrix.activate_R" href="#saePisan.model.CorrelationMatrix.CorrelationMatrix.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.CorrelationMatrix.CorrelationMatrix.run_model" href="#saePisan.model.CorrelationMatrix.CorrelationMatrix.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_6">
                <div class="file-header">
                    <div>ğŸ“„ Histogram</div>
                    <div class="file-path">model/Histogram.html (10.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.Histogram</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.Histogram.Histogram"><code class="flex name class">
<span>class <span class="ident">Histogram</span></span>
<span>(</span><span>model1, model2, view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Histogram:
    &#34;&#34;&#34;
    A class used to represent a Histogram model.
    Attributes
    ----------
    model1 : object
        The first model to be used in the histogram.
    model2 : object
        The second model to be used in the histogram.
    view : object
        The view associated with the histogram.
    plot : object, optional
        The plot object for the histogram (default is None).
    result : object, optional
        The result of the histogram computation (default is None).
    error : object, optional
        Any error encountered during the histogram computation (default is None).
    Methods
    -------
    run_model(r_script)
        Runs the histogram model using the provided R script.
    activate_R()
        Activates the R environment using rpy2&#39;s pandas2ri.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, view):
        self.model1 = model1
        self.model2 = model2
        self.view = view
        self.plot = None
        self.result = None
        self.error = None

    def run_model(self, r_script):
        self.r_script = r_script
        run_histogram(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent a Histogram model.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be used in the histogram.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be used in the histogram.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the histogram.</dd>
<dt><strong><code>plot</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The plot object for the histogram (default is None).</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The result of the histogram computation (default is None).</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>Any error encountered during the histogram computation (default is None).</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script)
Runs the histogram model using the provided R script.
activate_R()
Activates the R environment using rpy2's pandas2ri.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.Histogram.Histogram.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.Histogram.Histogram.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_histogram(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.Histogram.Histogram" href="#saePisan.model.Histogram.Histogram">Histogram</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.Histogram.Histogram.activate_R" href="#saePisan.model.Histogram.Histogram.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.Histogram.Histogram.run_model" href="#saePisan.model.Histogram.Histogram.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_7">
                <div class="file-header">
                    <div>ğŸ“„ LinePlot</div>
                    <div class="file-path">model/LinePlot.html (11.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.LinePlot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.LinePlot.Lineplot"><code class="flex name class">
<span>class <span class="ident">Lineplot</span></span>
<span>(</span><span>model1, model2, view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Lineplot:
    &#34;&#34;&#34;
    A class used to represent a Line Plot.
    Attributes
    ----------
    model1 : object
        The first model to be used in the line plot.
    model2 : object
        The second model to be used in the line plot.
    view : object
        The view associated with the line plot.
    plot : object, optional
        The plot object, initialized as None.
    error : bool
        A flag indicating if there was an error, initialized as False.
    result : object, optional
        The result of the line plot, initialized as None.
    Methods
    -------
    __init__(model1, model2, view)
        Initializes the Lineplot with the given models and view.
    run_model(r_script)
        Runs the line plot model using the provided R script.
    activate_R()
        Activates the R environment using rpy2.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, view):
        self.model1 = model1
        self.model2 = model2
        self.view = view
        self.plot = None
        self.error = False
        self.result = None

    def run_model(self, r_script):
        self.r_script = r_script
        run_lineplot(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent a Line Plot.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be used in the line plot.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be used in the line plot.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the line plot.</dd>
<dt><strong><code>plot</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The plot object, initialized as None.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there was an error, initialized as False.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The result of the line plot, initialized as None.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(model1, model2, view)
Initializes the Lineplot with the given models and view.
run_model(r_script)
Runs the line plot model using the provided R script.
activate_R()
Activates the R environment using rpy2.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.LinePlot.Lineplot.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.LinePlot.Lineplot.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_lineplot(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.LinePlot.Lineplot" href="#saePisan.model.LinePlot.Lineplot">Lineplot</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.LinePlot.Lineplot.activate_R" href="#saePisan.model.LinePlot.Lineplot.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.LinePlot.Lineplot.run_model" href="#saePisan.model.LinePlot.Lineplot.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_8">
                <div class="file-header">
                    <div>ğŸ“„ Multicollinearity</div>
                    <div class="file-path">model/Multicollinearity.html (11.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.Multicollinearity</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.Multicollinearity.Multicollinearity"><code class="flex name class">
<span>class <span class="ident">Multicollinearity</span></span>
<span>(</span><span>model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Multicollinearity:
    &#34;&#34;&#34;
    A class to handle multicollinearity analysis using R scripts.
    Attributes
    ----------
    model1 : object
        The first model to be analyzed.
    model2 : object
        The second model to be analyzed.
    view : object
        The view component for displaying results.
    result : str
        The result of the multicollinearity analysis.
    reg_model : bool
        A flag indicating if the regression model is set.
    error : bool
        A flag indicating if there was an error during analysis.
    Methods
    -------
    __init__(model1, model2, view)
        Initializes the Multicollinearity class with the given models and view.
    run_model(r_script)
        Runs the multicollinearity analysis using the provided R script.
    activate_R()
        Activates the R environment for running R scripts.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.result =&#34;&#34;
        self.reg_model = False
        self.error = False

    def run_model(self, r_script):
        self.r_script = r_script
        run_multicollinearity(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class to handle multicollinearity analysis using R scripts.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be analyzed.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be analyzed.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view component for displaying results.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>str</code></dt>
<dd>The result of the multicollinearity analysis.</dd>
<dt><strong><code>reg_model</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if the regression model is set.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there was an error during analysis.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(model1, model2, view)
Initializes the Multicollinearity class with the given models and view.
run_model(r_script)
Runs the multicollinearity analysis using the provided R script.
activate_R()
Activates the R environment for running R scripts.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.Multicollinearity.Multicollinearity.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.Multicollinearity.Multicollinearity.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_multicollinearity(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.Multicollinearity.Multicollinearity" href="#saePisan.model.Multicollinearity.Multicollinearity">Multicollinearity</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.Multicollinearity.Multicollinearity.activate_R" href="#saePisan.model.Multicollinearity.Multicollinearity.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.Multicollinearity.Multicollinearity.run_model" href="#saePisan.model.Multicollinearity.Multicollinearity.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_1_9">
                <div class="file-header">
                    <div>ğŸ“„ NormalityTest</div>
                    <div class="file-path">model/NormalityTest.html (11.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.NormalityTest</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.NormalityTest.NormalityTest"><code class="flex name class">
<span>class <span class="ident">NormalityTest</span></span>
<span>(</span><span>model1, model2, selected_columns)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class NormalityTest:
    &#34;&#34;&#34;
    A class used to perform normality tests on given models and selected columns.
    Attributes
    ----------
    model1 : object
        The first model to be tested.
    model2 : object
        The second model to be tested.
    selected_columns : list
        The columns selected for the normality test.
    view : object
        The view associated with the normality test.
    result : str
        The result of the normality test.
    plot : object
        The plot generated from the normality test.
    error : bool
        A flag indicating if there was an error during the normality test.
    Methods
    -------
    run_model(r_script)
        Runs the normality test using the provided R script.
    activate_R()
        Activates the R environment for running the normality test.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, selected_columns):
        self.model1 = model1
        self.model2 = model2
        self.selected_columns = selected_columns
        self.result =&#34;&#34;
        self.plot = None
        self.error = False

    def run_model(self, r_script):
        self.r_script = r_script
        run_normality_test(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to perform normality tests on given models and selected columns.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be tested.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be tested.</dd>
<dt><strong><code>selected_columns</code></strong> :&ensp;<code>list</code></dt>
<dd>The columns selected for the normality test.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the normality test.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>str</code></dt>
<dd>The result of the normality test.</dd>
<dt><strong><code>plot</code></strong> :&ensp;<code>object</code></dt>
<dd>The plot generated from the normality test.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there was an error during the normality test.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script)
Runs the normality test using the provided R script.
activate_R()
Activates the R environment for running the normality test.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.NormalityTest.NormalityTest.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.NormalityTest.NormalityTest.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_normality_test(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.NormalityTest.NormalityTest" href="#saePisan.model.NormalityTest.NormalityTest">NormalityTest</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.NormalityTest.NormalityTest.activate_R" href="#saePisan.model.NormalityTest.NormalityTest.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.NormalityTest.NormalityTest.run_model" href="#saePisan.model.NormalityTest.NormalityTest.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_0">
                <div class="file-header">
                    <div>ğŸ“„ ProjectionModel</div>
                    <div class="file-path">model/ProjectionModel.html (10.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.ProjectionModel</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.ProjectionModel.Projection"><code class="flex name class">
<span>class <span class="ident">Projection</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Projection(SaeModelling):
    &#34;&#34;&#34;
    A class used to represent a Projection model which inherits from SaeModelling.
    Methods
    -------
    __init__(*args, **kwargs)
        Initializes the Projection model with given arguments.
    run_model(r_script)
        Executes the projection model using the provided R script.
        Parameters:
        r_script (str): The R script to be executed.
        Returns:
        tuple: A tuple containing the result, error, and dataframe from the model execution.
    get_model2()
        Retrieves the second model attribute.
        Returns:
        object: The second model attribute.
    &#34;&#34;&#34;
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
    
    def run_model(self, r_script):
        self.r_script = r_script
        result, error, df = run_model_projection(self)
        return result, error, df
    
    def get_model2(self):
        return self.model2</code></pre>
</details>
<div class="desc"><p>A class used to represent a Projection model which inherits from SaeModelling.
Methods</p>
<hr>
<p><strong>init</strong>(<em>args, </em>*kwargs)
Initializes the Projection model with given arguments.
run_model(r_script)
Executes the projection model using the provided R script.
Parameters:
r_script (str): The R script to be executed.
Returns:
tuple: A tuple containing the result, error, and dataframe from the model execution.
get_model2()
Retrieves the second model attribute.
Returns:
object: The second model attribute.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>model.SaeModelling.SaeModelling</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.ProjectionModel.Projection.get_model2"><code class="name flex">
<span>def <span class="ident">get_model2</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_model2(self):
    return self.model2</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.ProjectionModel.Projection.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    result, error, df = run_model_projection(self)
    return result, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.ProjectionModel.Projection" href="#saePisan.model.ProjectionModel.Projection">Projection</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.ProjectionModel.Projection.get_model2" href="#saePisan.model.ProjectionModel.Projection.get_model2">get_model2</a></code></li>
<li><code><a title="saePisan.model.ProjectionModel.Projection.run_model" href="#saePisan.model.ProjectionModel.Projection.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_1">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblup</div>
                    <div class="file-path">model/SaeEblup.html (10.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.SaeEblup</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.SaeEblup.SaeEblup"><code class="flex name class">
<span>class <span class="ident">SaeEblup</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeEblup(SaeModelling):
    &#34;&#34;&#34;
    SaeEblup is a class that extends SaeModelling to run EBLUP (Empirical Best Linear Unbiased Prediction) models.
    Methods
    -------
    __init__(*args, **kwargs)
        Initializes the SaeEblup instance with given arguments.
    run_model(r_script)
        Executes the EBLUP model using the provided R script.
        Parameters:
        r_script (str): The R script to be executed.
        Returns:
        tuple: A tuple containing the result, error, and dataframe from the model execution.
    get_model2()
        Retrieves the model2 attribute.
        Returns:
        object: The model2 attribute.
    &#34;&#34;&#34;
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
    
    def run_model(self, r_script):
        self.r_script = r_script
        result, error, df = run_model_eblup_area(self)
        return result, error, df
    
    def get_model2(self):
        return self.model2</code></pre>
</details>
<div class="desc"><p>SaeEblup is a class that extends SaeModelling to run EBLUP (Empirical Best Linear Unbiased Prediction) models.
Methods</p>
<hr>
<p><strong>init</strong>(<em>args, </em>*kwargs)
Initializes the SaeEblup instance with given arguments.
run_model(r_script)
Executes the EBLUP model using the provided R script.
Parameters:
r_script (str): The R script to be executed.
Returns:
tuple: A tuple containing the result, error, and dataframe from the model execution.
get_model2()
Retrieves the model2 attribute.
Returns:
object: The model2 attribute.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>model.SaeModelling.SaeModelling</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.SaeEblup.SaeEblup.get_model2"><code class="name flex">
<span>def <span class="ident">get_model2</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_model2(self):
    return self.model2</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.SaeEblup.SaeEblup.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    result, error, df = run_model_eblup_area(self)
    return result, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.SaeEblup.SaeEblup" href="#saePisan.model.SaeEblup.SaeEblup">SaeEblup</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.SaeEblup.SaeEblup.get_model2" href="#saePisan.model.SaeEblup.SaeEblup.get_model2">get_model2</a></code></li>
<li><code><a title="saePisan.model.SaeEblup.SaeEblup.run_model" href="#saePisan.model.SaeEblup.SaeEblup.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_2">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupPseudo</div>
                    <div class="file-path">model/SaeEblupPseudo.html (10.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.SaeEblupPseudo</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.SaeEblupPseudo.SaeEblupPseudo"><code class="flex name class">
<span>class <span class="ident">SaeEblupPseudo</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeEblupPseudo(SaeModelling):
    &#34;&#34;&#34;
    SaeEblupPseudo is a class that extends SaeModelling to implement the EBLUP (Empirical Best Linear Unbiased Predictor) pseudo model.
    Methods
    -------
    __init__(*args, **kwargs)
        Initializes the SaeEblupPseudo instance with given arguments.
    run_model(r_script)
        Executes the EBLUP pseudo model using the provided R script.
        Parameters
        ----------
        r_script : str
            The R script to be executed.
        Returns
        -------
        result : Any
            The result of the model execution.
        error : Any
            Any error encountered during the model execution.
        df : pandas.DataFrame
            The dataframe resulting from the model execution.
    get_model2()
        Returns the model2 attribute.
        Returns
        -------
        Any
            The model2 attribute.
    &#34;&#34;&#34;
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
    
    def run_model(self, r_script):
        self.r_script = r_script
        result, error, df = run_model_eblup_pseudo(self)
        return result, error, df
    
    def get_model2(self):
        return self.model2</code></pre>
</details>
<div class="desc"><p>SaeEblupPseudo is a class that extends SaeModelling to implement the EBLUP (Empirical Best Linear Unbiased Predictor) pseudo model.
Methods</p>
<hr>
<p><strong>init</strong>(<em>args, </em>*kwargs)
Initializes the SaeEblupPseudo instance with given arguments.
run_model(r_script)
Executes the EBLUP pseudo model using the provided R script.
Parameters
----------
r_script : str
The R script to be executed.
Returns
-------
result : Any
The result of the model execution.
error : Any
Any error encountered during the model execution.
df : pandas.DataFrame
The dataframe resulting from the model execution.
get_model2()
Returns the model2 attribute.
Returns
-------
Any
The model2 attribute.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>model.SaeModelling.SaeModelling</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.SaeEblupPseudo.SaeEblupPseudo.get_model2"><code class="name flex">
<span>def <span class="ident">get_model2</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_model2(self):
    return self.model2</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.SaeEblupPseudo.SaeEblupPseudo.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    result, error, df = run_model_eblup_pseudo(self)
    return result, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.SaeEblupPseudo.SaeEblupPseudo" href="#saePisan.model.SaeEblupPseudo.SaeEblupPseudo">SaeEblupPseudo</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.SaeEblupPseudo.SaeEblupPseudo.get_model2" href="#saePisan.model.SaeEblupPseudo.SaeEblupPseudo.get_model2">get_model2</a></code></li>
<li><code><a title="saePisan.model.SaeEblupPseudo.SaeEblupPseudo.run_model" href="#saePisan.model.SaeEblupPseudo.SaeEblupPseudo.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_3">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupUnit</div>
                    <div class="file-path">model/SaeEblupUnit.html (10.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.SaeEblupUnit</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.SaeEblupUnit.SaeEblupUnit"><code class="flex name class">
<span>class <span class="ident">SaeEblupUnit</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeEblupUnit(SaeModelling):
    &#34;&#34;&#34;
    SaeEblupUnit is a class that extends SaeModelling to run EBLUP (Empirical Best Linear Unbiased Prediction) models.
    Methods
    -------
    __init__(*args, **kwargs)
        Initializes the SaeEblupUnit instance with given arguments.
    run_model(r_script)
        Runs the EBLUP model using the provided R script.
        Parameters
        ----------
        r_script : str
            The R script to be executed for running the EBLUP model.
        Returns
        -------
        result : Any
            The result of the EBLUP model execution.
        error : Any
            Any error encountered during the model execution.
        df : pandas.DataFrame
            The dataframe containing the results of the model execution.
    get_model2()
        Returns the model2 attribute.
        Returns
        -------
        model2 : Any
            The model2 attribute of the instance.
    &#34;&#34;&#34;
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
    
    def run_model(self, r_script):
        self.r_script = r_script
        results, error, df = run_model_eblup_unit(self)
        return results, error, df
    
    def get_model2(self):
        return self.model2</code></pre>
</details>
<div class="desc"><p>SaeEblupUnit is a class that extends SaeModelling to run EBLUP (Empirical Best Linear Unbiased Prediction) models.
Methods</p>
<hr>
<p><strong>init</strong>(<em>args, </em>*kwargs)
Initializes the SaeEblupUnit instance with given arguments.
run_model(r_script)
Runs the EBLUP model using the provided R script.
Parameters
----------
r_script : str
The R script to be executed for running the EBLUP model.
Returns
-------
result : Any
The result of the EBLUP model execution.
error : Any
Any error encountered during the model execution.
df : pandas.DataFrame
The dataframe containing the results of the model execution.
get_model2()
Returns the model2 attribute.
Returns
-------
model2 : Any
The model2 attribute of the instance.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>model.SaeModelling.SaeModelling</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.SaeEblupUnit.SaeEblupUnit.get_model2"><code class="name flex">
<span>def <span class="ident">get_model2</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_model2(self):
    return self.model2</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.SaeEblupUnit.SaeEblupUnit.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    results, error, df = run_model_eblup_unit(self)
    return results, error, df</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.SaeEblupUnit.SaeEblupUnit" href="#saePisan.model.SaeEblupUnit.SaeEblupUnit">SaeEblupUnit</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.SaeEblupUnit.SaeEblupUnit.get_model2" href="#saePisan.model.SaeEblupUnit.SaeEblupUnit.get_model2">get_model2</a></code></li>
<li><code><a title="saePisan.model.SaeEblupUnit.SaeEblupUnit.run_model" href="#saePisan.model.SaeEblupUnit.SaeEblupUnit.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_4">
                <div class="file-header">
                    <div>ğŸ“„ SaeHB</div>
                    <div class="file-path">model/SaeHB.html (10.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.SaeHB</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.SaeHB.SaeHB"><code class="flex name class">
<span>class <span class="ident">SaeHB</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeHB(SaeModelling):
    &#34;&#34;&#34;
    SaeHB class that extends SaeModelling to run hierarchical Bayesian models.
    Methods
    -------
    __init__(*args, **kwargs)
        Initializes the SaeHB class with given arguments.
    run_model(r_script)
        Runs the hierarchical Bayesian model using the provided R script.
    get_model2()
        Returns the model2 attribute.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Initializes the SaeHB class with given arguments.
    Parameters
    ----------
    *args : tuple
        Variable length argument list.
    **kwargs : dict
        Arbitrary keyword arguments.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Runs the hierarchical Bayesian model using the provided R script.
    Parameters
    ----------
    r_script : str
        The R script to be used for running the model.
    Returns
    -------
    result : Any
        The result of the model run.
    error : Any
        Any error encountered during the model run.
    df : pandas.DataFrame
        The dataframe resulting from the model run.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Returns the model2 attribute.
    Returns
    -------
    Any
        The model2 attribute.
    &#34;&#34;&#34;
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        
    def run_model(self, r_script):
        self.r_script = r_script
        result, error, df, plot_paths = run_model_hb_area(self)
        return result, error, df, plot_paths
    
    def get_model2(self):
        return self.model2</code></pre>
</details>
<div class="desc"><p>SaeHB class that extends SaeModelling to run hierarchical Bayesian models.
Methods</p>
<hr>
<p><strong>init</strong>(<em>args, </em>*kwargs)
Initializes the SaeHB class with given arguments.
run_model(r_script)
Runs the hierarchical Bayesian model using the provided R script.
get_model2()
Returns the model2 attribute.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>model.SaeModelling.SaeModelling</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.SaeHB.SaeHB.get_model2"><code class="name flex">
<span>def <span class="ident">get_model2</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_model2(self):
    return self.model2</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.SaeHB.SaeHB.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    result, error, df, plot_paths = run_model_hb_area(self)
    return result, error, df, plot_paths</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.SaeHB.SaeHB" href="#saePisan.model.SaeHB.SaeHB">SaeHB</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.SaeHB.SaeHB.get_model2" href="#saePisan.model.SaeHB.SaeHB.get_model2">get_model2</a></code></li>
<li><code><a title="saePisan.model.SaeHB.SaeHB.run_model" href="#saePisan.model.SaeHB.SaeHB.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_5">
                <div class="file-header">
                    <div>ğŸ“„ SaeModelling</div>
                    <div class="file-path">model/SaeModelling.html (9.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.SaeModelling</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.SaeModelling.SaeModelling"><code class="flex name class">
<span>class <span class="ident">SaeModelling</span></span>
<span>(</span><span>model1, model2, view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SaeModelling:
    &#34;&#34;&#34;
    A class used to represent the SAE Modelling.
    Attributes
    ----------
    model1 : object
        The first model used in the SAE Modelling.
    model2 : object
        The second model used in the SAE Modelling.
    view : object
        The view associated with the SAE Modelling.
    error : bool
        A flag indicating if there is an error in the SAE Modelling.
    Methods
    -------
    activate_R():
        Activates the R environment for use with pandas dataframes.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, view):
        self.model1 = model1
        self.model2 = model2
        self.view = view
        self.error = False
        
    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent the SAE Modelling.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model used in the SAE Modelling.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model used in the SAE Modelling.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the SAE Modelling.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there is an error in the SAE Modelling.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>activate_R():
Activates the R environment for use with pandas dataframes.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.SaeModelling.SaeModelling.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.SaeModelling.SaeModelling" href="#saePisan.model.SaeModelling.SaeModelling">SaeModelling</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.SaeModelling.SaeModelling.activate_R" href="#saePisan.model.SaeModelling.SaeModelling.activate_R">activate_R</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_6">
                <div class="file-header">
                    <div>ğŸ“„ Scatterplot</div>
                    <div class="file-path">model/Scatterplot.html (11.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.Scatterplot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.Scatterplot.Scatterplot"><code class="flex name class">
<span>class <span class="ident">Scatterplot</span></span>
<span>(</span><span>model1, model2, view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Scatterplot:
    &#34;&#34;&#34;
    A class used to represent a Scatterplot model.
    Attributes
    ----------
    model1 : object
        The first model to be used in the scatterplot.
    model2 : object
        The second model to be used in the scatterplot.
    view : object
        The view associated with the scatterplot.
    plot : object, optional
        The plot object, initialized as None.
    error : object, optional
        The error object, initialized as None.
    result : object, optional
        The result object, initialized as None.
    Methods
    -------
    run_model(r_script)
        Runs the scatterplot model using the provided R script.
    activate_R()
        Activates the R environment using rpy2&#39;s pandas2ri.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Constructs all the necessary attributes for the Scatterplot object.
    Parameters
    ----------
    model1 : object
        The first model to be used in the scatterplot.
    model2 : object
        The second model to be used in the scatterplot.
    view : object
        The view associated with the scatterplot.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Runs the scatterplot model using the provided R script.
    Parameters
    ----------
    r_script : str
        The R script to be used for running the scatterplot model.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Activates the R environment using rpy2&#39;s pandas2ri.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2, view):
        self.model1 = model1
        self.model2 = model2
        self.view = view
        self.plot = None
        self.error = None
        self.result = None

    def run_model(self, r_script):
        self.r_script = r_script
        run_scatterplot(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent a Scatterplot model.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model to be used in the scatterplot.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model to be used in the scatterplot.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the scatterplot.</dd>
<dt><strong><code>plot</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The plot object, initialized as None.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The error object, initialized as None.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>object</code>, optional</dt>
<dd>The result object, initialized as None.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script)
Runs the scatterplot model using the provided R script.
activate_R()
Activates the R environment using rpy2's pandas2ri.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.Scatterplot.Scatterplot.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.Scatterplot.Scatterplot.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_scatterplot(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.Scatterplot.Scatterplot" href="#saePisan.model.Scatterplot.Scatterplot">Scatterplot</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.Scatterplot.Scatterplot.activate_R" href="#saePisan.model.Scatterplot.Scatterplot.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.Scatterplot.Scatterplot.run_model" href="#saePisan.model.Scatterplot.Scatterplot.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_7">
                <div class="file-header">
                    <div>ğŸ“„ SummaryData</div>
                    <div class="file-path">model/SummaryData.html (11.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.SummaryData</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.SummaryData.SummaryData"><code class="flex name class">
<span>class <span class="ident">SummaryData</span></span>
<span>(</span><span>model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SummaryData:
    &#34;&#34;&#34;
    A class used to represent the summary data model.
    Attributes
    ----------
    model1 : object
        The first model used in the summary data.
    model2 : object
        The second model used in the summary data.
    view : object
        The view associated with the summary data.
    result : str
        The result of the summary data processing.
    error : bool
        A flag indicating if there was an error during processing.
    Methods
    -------
    run_model(r_script)
        Executes the summary data model using the provided R script.
    activate_R()
        Activates the R environment for data processing using rpy2.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Constructs all the necessary attributes for the SummaryData object.
    Parameters
    ----------
    model1 : object
        The first model used in the summary data.
    model2 : object
        The second model used in the summary data.
    view : object
        The view associated with the summary data.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Executes the summary data model using the provided R script.
    Parameters
    ----------
    r_script : str
        The R script to be executed.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Activates the R environment for data processing using rpy2.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.result = None
        self.error = False

    def run_model(self, r_script):
        self.r_script = r_script
        run_summary_data(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent the summary data model.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model used in the summary data.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model used in the summary data.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the summary data.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>str</code></dt>
<dd>The result of the summary data processing.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there was an error during processing.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script)
Executes the summary data model using the provided R script.
activate_R()
Activates the R environment for data processing using rpy2.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.SummaryData.SummaryData.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.SummaryData.SummaryData.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_summary_data(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.SummaryData.SummaryData" href="#saePisan.model.SummaryData.SummaryData">SummaryData</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.SummaryData.SummaryData.activate_R" href="#saePisan.model.SummaryData.SummaryData.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.SummaryData.SummaryData.run_model" href="#saePisan.model.SummaryData.SummaryData.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_8">
                <div class="file-header">
                    <div>ğŸ“„ TableModel</div>
                    <div class="file-path">model/TableModel.html (57.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.TableModel</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.TableModel.TableModel"><code class="flex name class">
<span>class <span class="ident">TableModel</span></span>
<span>(</span><span>data, batch_size=100)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TableModel(QtCore.QAbstractTableModel):
    &#34;&#34;&#34;A custom table model for handling data in a Qt application with support for undo/redo operations.
    Attributes:
        _data (pl.DataFrame): The data to be displayed in the table.
        undo_stack (QUndoStack): Stack to manage undo/redo operations.
        batch_size (int): Number of rows to load initially.
        loaded_rows (int): Number of rows currently loaded.
    Methods:
        __init__(data, batch_size=100):
            Initializes the table model with data and batch size.
        data(index, role):
            Returns the data for the given index and role.
        rowCount(_):
            Returns the number of rows in the table.
        columnCount(_):
            Returns the number of columns in the table.
        headerData(section, orientation, role):
            Returns the header data for the given section, orientation, and role.
        flags(_):
            Returns the item flags for the table.
        setData(index, value, role=Qt.ItemDataRole.EditRole):
            Sets the data for the given index and role.
        set_data(new_data):
            Sets the entire data for the table.
        get_data():
            Returns the current data of the table.
        copy(index):
            Copies the data at the given index to the clipboard.
        paste(index):
            Pastes the data from the clipboard to the given index.
        undo():
            Undoes the last operation.
        redo():
            Redoes the last undone operation.
        canFetchMore(_):
            Checks if more rows can be fetched.
        fetchMore(_):
            Fetches more rows to be displayed in the table.
        addRowsBefore(index, count):
            Adds rows before the given index.
        addRowsAfter(index, count):
            Adds rows after the given index.
        addColumnBefore(index, count):
            Adds columns before the given index.
        addColumnAfter(index, count):
            Adds columns after the given index.
        deleteRows(start_row, count):
            Deletes rows starting from the given row index.
        deleteColumns(start_column, count):
            Deletes columns starting from the given column index.
        rename_column(column_index, new_name):
            Renames the column at the given index to the new name.
        get_column_type(column_index):
            Returns the data type of the column at the given index.
        set_column_type(column_index, new_type):
            Sets the data type of the column at the given index to the new type.&#34;&#34;&#34;
    
    def __init__(self, data, batch_size=100):
        super().__init__()
        self._data = data
        self.undo_stack = QUndoStack()
        self.batch_size = batch_size
        self.loaded_rows = min(batch_size, self._data.shape[0])

    def data(self, index, role):
        if role == Qt.ItemDataRole.DisplayRole or role == Qt.ItemDataRole.EditRole:
            value = self._data[index.row(), index.column()]
            return &#34;&#34; if value is None else str(value)

    def rowCount(self, _):
        return self.loaded_rows

    def columnCount(self, _):
        return self._data.shape[1]

    def headerData(self, section, orientation, role):
        if role == Qt.ItemDataRole.DisplayRole:
            if orientation == Qt.Orientation.Horizontal:
                if section &lt; len(self._data.columns):
                    column_name = self._data.columns[section]
                    return f&#34;{column_name}&#34;
                return &#34;&#34;
            if orientation == Qt.Orientation.Vertical:
                return str(section + 1)
        elif role == Qt.ItemDataRole.DecorationRole or role == Qt.ItemDataRole.DisplayRole:
            if orientation == Qt.Orientation.Horizontal:
                if section &lt; len(self._data.columns):
                    column_name = self._data.columns[section]
                    dtype = self._data[column_name].dtype
                    if dtype == pl.Utf8:
                        return QtGui.QIcon(&#34;assets/nominal.svg&#34;)
                    elif dtype == pl.Null:
                        return QtGui.QIcon(&#34;assets/null.svg&#34;)
                    else:
                        return QtGui.QIcon(&#34;assets/numeric.svg&#34;)
        return None

    def flags(self, _):
        return (
            Qt.ItemFlag.ItemIsSelectable
            | Qt.ItemFlag.ItemIsEnabled
            | Qt.ItemFlag.ItemIsEditable
        )

    def setData(self, index, value, role=Qt.ItemDataRole.EditRole):
        if role == Qt.ItemDataRole.EditRole:
            row = index.row()
            column = index.column()

            column_name = self._data.columns[column]
            dtype = self._data[column_name].dtype

            old_value = self._data[row, column]
            
            if dtype == pl.Null:
                if isinstance(value, str):
                    val_strip = value.strip()
                    val_dot = val_strip.replace(&#39;,&#39;, &#39;.&#39;)
                    try:
                        float_val = float(val_dot)
                        if &#39;.&#39; in val_dot:
                            new_dtype = pl.Float64
                            value = float_val
                        else:
                            new_dtype = pl.Int64
                            value = int(float_val)
                    except ValueError:
                        new_dtype = pl.Utf8
                elif isinstance(value, float):
                    new_dtype = pl.Float64
                elif isinstance(value, int):
                    new_dtype = pl.Int64
                else:
                    new_dtype = pl.Utf8
                self._data = self._data.with_columns([pl.col(column_name).cast(new_dtype)])
                dtype = new_dtype

            if dtype == pl.Float64:
                try:
                    if isinstance(value, str):
                        if value.count(&#39;,&#39;) == 1 and value.replace(&#39;,&#39;, &#39;&#39;).isdigit():
                            value = value.replace(&#39;,&#39;, &#39;.&#39;)
                        value = float(value) if value is not None else None
                        
                except ValueError:
                    error_dialog = QtWidgets.QMessageBox()
                    error_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                    error_dialog.setText(f&#34;Invalid value: {value} for column {column_name}. Expected a numeric value.&#34;)
                    error_dialog.setInformativeText(&#34;Do you want to set the column as a string?&#34;)
                    error_dialog.setWindowTitle(&#34;Invalid Input&#34;)
                    error_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                    error_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                    ret = error_dialog.exec()

                    if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                        dtype = pl.Utf8
                        self._data = self._data.with_columns([pl.col(column_name).cast(dtype)])
                    else:
                        return False

            if dtype == pl.Int64:
                try:
                    if isinstance(value, str):
                        value = int(value) if value is not None else None
                except ValueError:
                    error_dialog = QtWidgets.QMessageBox()
                    error_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                    error_dialog.setText(f&#34;Invalid value: {value} for column {column_name}. Expected an integer value.&#34;)
                    error_dialog.setInformativeText(&#34;Do you want to set column to a string?&#34;)
                    error_dialog.setWindowTitle(&#34;Invalid Input&#34;)
                    error_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                    error_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                    ret = error_dialog.exec()

                    if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                        dtype = pl.Utf8
                        self._data = self._data.with_columns([pl.col(column_name).cast(dtype)])
                    else:
                        return False

            self._data[row, column] = value
            self.dataChanged.emit(index, index)
            command = EditDataCommand(self, row, column, old_value, value)  # Pass row, column to command
            self.undo_stack.push(command)
            return True
        return False


    def set_data(self, new_data):
        if isinstance(new_data, pl.DataFrame):
            self.beginResetModel()
            self._data = new_data
            self.loaded_rows = min(self.batch_size, self._data.shape[0])
            self.endResetModel()
        else:
            raise ValueError(&#34;Data must be a Polars DataFrame&#34;)
    
    def get_data(self):
        return self._data

    def copy(self, index):
        if index.isValid():
            value = self.data(index, Qt.ItemDataRole.DisplayRole)
            clipboard = QtGui.QGuiApplication.clipboard()
            clipboard.setText(value)

    def paste(self, index):
        if index.isValid():
            clipboard = QtGui.QGuiApplication.clipboard()
            value = clipboard.text()
            self.setData(index, value)

    def undo(self):
        self.undo_stack.undo()

    def redo(self):
        self.undo_stack.redo()

    def canFetchMore(self, _):
        return self.loaded_rows &lt; self._data.shape[0]

    def fetchMore(self, _):
        if self.loaded_rows &gt;= self._data.shape[0]:
            return
        remaining_rows = self._data.shape[0] - self.loaded_rows
        rows_to_fetch = min(self.batch_size, remaining_rows)
        self.beginInsertRows(QtCore.QModelIndex(), self.loaded_rows, self.loaded_rows + rows_to_fetch - 1)
        self.loaded_rows += rows_to_fetch
        self.endInsertRows()
    
    def addRowsBefore(self, index, count):
        if index.isValid() and count &gt; 0:
            row = index.row()
            new_rows = [{col: None if self._data[col].dtype in [pl.Int64, pl.Float64, pl.Null] else &#34;&#34; for col in self._data.columns} for _ in range(count)]
            self.beginInsertRows(QtCore.QModelIndex(), row, row + count - 1)
            self._data = pl.concat([self._data[:row], pl.DataFrame(new_rows), self._data[row:]])
            self.loaded_rows += count
            self.endInsertRows()
            command = AddRowsCommand(self, row, new_rows)
            self.undo_stack.push(command)

    def addRowsAfter(self, index, count):
        if index.isValid() and count &gt; 0:
            row = index.row() + 1
            new_rows = [{col: None if self._data[col].dtype in [pl.Int64, pl.Float64, pl.Null] else &#34;&#34; for col in self._data.columns} for _ in range(count)]
            self.beginInsertRows(QtCore.QModelIndex(), row, row + count - 1)
            self._data = pl.concat([self._data[:row], pl.DataFrame(new_rows), self._data[row:]])
            self.loaded_rows += count
            self.endInsertRows()
            command = AddRowsCommand(self, row, new_rows)
            self.undo_stack.push(command)
    
    def addColumnBefore(self, index, count):
        if index.isValid() and count &gt; 0:
            column = index.column()
            new_columns = {f&#34;new_col_{i}&#34;: [None] * self._data.shape[0] for i in range(count)}
            self.beginResetModel()
            self._data = pl.concat([self._data[:, :column], pl.DataFrame(new_columns), self._data[:, column:]], how=&#34;horizontal&#34;)
            self.endResetModel()
            column_names = list(new_columns.keys())  # Extract column names
            new_columns_data = list(new_columns.values())  # Extract column data
            command = AddColumnCommand(self, column_names, new_columns_data)
            self.undo_stack.push(command)

    def addColumnAfter(self, index, count):
        if index.isValid() and count &gt; 0:
            column = index.column() + 1
            new_columns = {f&#34;new_col_{i}&#34;: [None] * self._data.shape[0] for i in range(count)}
            self.beginResetModel()
            self._data = pl.concat([self._data[:, :column], pl.DataFrame(new_columns), self._data[:, column:]], how=&#34;horizontal&#34;)
            self.endResetModel()
            column_names = list(new_columns.keys())
            new_columns_data = list(new_columns.values())
            command = AddColumnCommand(self, column_names, new_columns_data)
            self.undo_stack.push(command)
    
    def deleteRows(self, start_row, count):
        if start_row &gt;= 0 and count &gt; 0:
            old_rows = self._data[start_row:start_row + count].to_dict(as_series=False)
            self.beginRemoveRows(QtCore.QModelIndex(), start_row, start_row + count - 1)
            self._data = pl.concat([self._data[:start_row], self._data[start_row + count:]])
            self.loaded_rows -= count
            self.endRemoveRows()
            command = DeleteRowsCommand(self, start_row, old_rows)
            self.undo_stack.push(command)

    def deleteColumns(self, start_column, count):
        &#34;&#34;&#34;
        Deletes columns starting from `start_column` and spanning `count` columns.

        Args:
            start_column (int): The starting column index to delete.
            count (int): The number of columns to delete.
        &#34;&#34;&#34;
        if start_column &gt;= 0 and count &gt; 0:
            # Store original column order
            original_order = self._data.columns

            # Store the deleted columns and their data
            old_columns = {
                self._data.columns[i]: self._data[:, i].to_list()
                for i in range(start_column, start_column + count)
            }
            self.beginResetModel()
            columns_to_keep = [
                col for i, col in enumerate(self._data.columns)
                if i &lt; start_column or i &gt;= start_column + count
            ]
            self._data = self._data.select(columns_to_keep)
            self.endResetModel()

            # Create a DeleteColumnsCommand and push it to the undo stack
            command = DeleteColumnsCommand(self, start_column, old_columns, original_order)
            self.undo_stack.push(command)

    
    def rename_column(self, column_index, new_name):
        if isinstance(column_index, int) and 0 &lt;= column_index &lt; len(self._data.columns):
            old_name = self._data.columns[column_index]
            self.beginResetModel()
            self._data = self._data.rename({old_name: new_name})
            self.endResetModel()
            command = RenameColumnCommand(self, column_index, old_name, new_name)
            self.undo_stack.push(command)
    
    def get_column_type(self, column_index):
        if isinstance(column_index, int) and 0 &lt;= column_index &lt; len(self._data.columns):
            column_name = self._data.columns[column_index]
            return self._data[column_name].dtype
        return None

    def set_column_type(self, column_index, new_type):
        if isinstance(column_index, int) and 0 &lt;= column_index &lt; len(self._data.columns):
            column_name = self._data.columns[column_index]
            old_dtype = self._data[column_name].dtype
            old_data = self._data[column_name].to_list()

            if new_type == &#34;String&#34;:
                new_dtype = pl.Utf8
            elif new_type == &#34;Integer&#34;:
                if self._data[column_name].dtype == pl.Utf8:
                    try:
                        warning_dialog = QtWidgets.QMessageBox()
                        warning_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                        warning_dialog.setText(f&#34;The current data type of column {column_name} is String. Converting to Integer will result in loss of non-numeric data.&#34;)
                        warning_dialog.setInformativeText(&#34;Do you want to proceed with the conversion?&#34;)
                        warning_dialog.setWindowTitle(&#34;Data Type Conversion Warning&#34;)
                        warning_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                        warning_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                        ret = warning_dialog.exec()

                        if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                            self._data = self._data.with_columns([
                                pl.when(pl.col(column_name).str.contains(r&#39;\d&#39;))
                                .then(pl.col(column_name).str.extract(r&#39;(\d+)&#39;).cast(pl.Int64))
                                .otherwise(pl.lit(None).cast(pl.Int64))
                            ])
                        else:
                            return
                    except Exception:
                        raise ValueError(f&#34;Cannot convert column {column_name} to Integer&#34;)
                new_dtype = pl.Int64
            elif new_type == &#34;Float&#34;:
                if self._data[column_name].dtype == pl.Utf8:
                    try:
                        warning_dialog = QtWidgets.QMessageBox()
                        warning_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                        warning_dialog.setText(f&#34;The current data type of column {column_name} is String. Converting to Float will result in loss of non-numeric data.&#34;)
                        warning_dialog.setInformativeText(&#34;Do you want to proceed with the conversion?&#34;)
                        warning_dialog.setWindowTitle(&#34;Data Type Conversion Warning&#34;)
                        warning_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                        warning_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                        ret = warning_dialog.exec()

                        if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                            self._data = self._data.with_columns([
                                pl.when(pl.col(column_name).str.contains(r&#39;^\d+(\.\d+)?$&#39;) | pl.col(column_name).str.contains(r&#39;^\d+(,\d+)?$&#39;))
                                .then(pl.col(column_name).str.replace(&#34;,&#34;, &#34;.&#34;).cast(pl.Float64, strict=False))
                                .otherwise(pl.lit(None).cast(pl.Float64))
                            ])
                        else:
                            return
                    except Exception:
                        raise ValueError(f&#34;Cannot convert column {column_name} to Float&#34;)
                new_dtype = pl.Float64
            else:
                raise ValueError(&#34;Unsupported data type&#34;)

            self.beginResetModel()
            self._data = self._data.with_columns([pl.col(column_name).cast(new_dtype)])
            self.endResetModel()

            command = ChangeColumnTypeCommand(self, column_index, old_dtype, new_dtype, old_data, self._data[column_name].to_list())
            self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"><p>A custom table model for handling data in a Qt application with support for undo/redo operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>_data</code></strong> :&ensp;<code>pl.DataFrame</code></dt>
<dd>The data to be displayed in the table.</dd>
<dt><strong><code>undo_stack</code></strong> :&ensp;<code>QUndoStack</code></dt>
<dd>Stack to manage undo/redo operations.</dd>
<dt><strong><code>batch_size</code></strong> :&ensp;<code>int</code></dt>
<dd>Number of rows to load initially.</dd>
<dt><strong><code>loaded_rows</code></strong> :&ensp;<code>int</code></dt>
<dd>Number of rows currently loaded.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(data, batch_size=100):
Initializes the table model with data and batch size.
data(index, role):
Returns the data for the given index and role.
rowCount(<em>):
Returns the number of rows in the table.
columnCount(</em>):
Returns the number of columns in the table.
headerData(section, orientation, role):
Returns the header data for the given section, orientation, and role.
flags(<em>):
Returns the item flags for the table.
setData(index, value, role=Qt.ItemDataRole.EditRole):
Sets the data for the given index and role.
set_data(new_data):
Sets the entire data for the table.
get_data():
Returns the current data of the table.
copy(index):
Copies the data at the given index to the clipboard.
paste(index):
Pastes the data from the clipboard to the given index.
undo():
Undoes the last operation.
redo():
Redoes the last undone operation.
canFetchMore(</em>):
Checks if more rows can be fetched.
fetchMore(_):
Fetches more rows to be displayed in the table.
addRowsBefore(index, count):
Adds rows before the given index.
addRowsAfter(index, count):
Adds rows after the given index.
addColumnBefore(index, count):
Adds columns before the given index.
addColumnAfter(index, count):
Adds columns after the given index.
deleteRows(start_row, count):
Deletes rows starting from the given row index.
deleteColumns(start_column, count):
Deletes columns starting from the given column index.
rename_column(column_index, new_name):
Renames the column at the given index to the new name.
get_column_type(column_index):
Returns the data type of the column at the given index.
set_column_type(column_index, new_type):
Sets the data type of the column at the given index to the new type.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtCore.QAbstractTableModel</li>
<li>PyQt6.QtCore.QAbstractItemModel</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.TableModel.TableModel.addColumnAfter"><code class="name flex">
<span>def <span class="ident">addColumnAfter</span></span>(<span>self, index, count)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def addColumnAfter(self, index, count):
    if index.isValid() and count &gt; 0:
        column = index.column() + 1
        new_columns = {f&#34;new_col_{i}&#34;: [None] * self._data.shape[0] for i in range(count)}
        self.beginResetModel()
        self._data = pl.concat([self._data[:, :column], pl.DataFrame(new_columns), self._data[:, column:]], how=&#34;horizontal&#34;)
        self.endResetModel()
        column_names = list(new_columns.keys())
        new_columns_data = list(new_columns.values())
        command = AddColumnCommand(self, column_names, new_columns_data)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.addColumnBefore"><code class="name flex">
<span>def <span class="ident">addColumnBefore</span></span>(<span>self, index, count)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def addColumnBefore(self, index, count):
    if index.isValid() and count &gt; 0:
        column = index.column()
        new_columns = {f&#34;new_col_{i}&#34;: [None] * self._data.shape[0] for i in range(count)}
        self.beginResetModel()
        self._data = pl.concat([self._data[:, :column], pl.DataFrame(new_columns), self._data[:, column:]], how=&#34;horizontal&#34;)
        self.endResetModel()
        column_names = list(new_columns.keys())  # Extract column names
        new_columns_data = list(new_columns.values())  # Extract column data
        command = AddColumnCommand(self, column_names, new_columns_data)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.addRowsAfter"><code class="name flex">
<span>def <span class="ident">addRowsAfter</span></span>(<span>self, index, count)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def addRowsAfter(self, index, count):
    if index.isValid() and count &gt; 0:
        row = index.row() + 1
        new_rows = [{col: None if self._data[col].dtype in [pl.Int64, pl.Float64, pl.Null] else &#34;&#34; for col in self._data.columns} for _ in range(count)]
        self.beginInsertRows(QtCore.QModelIndex(), row, row + count - 1)
        self._data = pl.concat([self._data[:row], pl.DataFrame(new_rows), self._data[row:]])
        self.loaded_rows += count
        self.endInsertRows()
        command = AddRowsCommand(self, row, new_rows)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.addRowsBefore"><code class="name flex">
<span>def <span class="ident">addRowsBefore</span></span>(<span>self, index, count)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def addRowsBefore(self, index, count):
    if index.isValid() and count &gt; 0:
        row = index.row()
        new_rows = [{col: None if self._data[col].dtype in [pl.Int64, pl.Float64, pl.Null] else &#34;&#34; for col in self._data.columns} for _ in range(count)]
        self.beginInsertRows(QtCore.QModelIndex(), row, row + count - 1)
        self._data = pl.concat([self._data[:row], pl.DataFrame(new_rows), self._data[row:]])
        self.loaded_rows += count
        self.endInsertRows()
        command = AddRowsCommand(self, row, new_rows)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.canFetchMore"><code class="name flex">
<span>def <span class="ident">canFetchMore</span></span>(<span>self, _)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def canFetchMore(self, _):
    return self.loaded_rows &lt; self._data.shape[0]</code></pre>
</details>
<div class="desc"><p>canFetchMore(self, parent: QModelIndex) -&gt; bool</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.columnCount"><code class="name flex">
<span>def <span class="ident">columnCount</span></span>(<span>self, _)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def columnCount(self, _):
    return self._data.shape[1]</code></pre>
</details>
<div class="desc"><p>columnCount(self, parent: QModelIndex = QModelIndex()) -&gt; int</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.copy"><code class="name flex">
<span>def <span class="ident">copy</span></span>(<span>self, index)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def copy(self, index):
    if index.isValid():
        value = self.data(index, Qt.ItemDataRole.DisplayRole)
        clipboard = QtGui.QGuiApplication.clipboard()
        clipboard.setText(value)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.data"><code class="name flex">
<span>def <span class="ident">data</span></span>(<span>self, index, role)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def data(self, index, role):
    if role == Qt.ItemDataRole.DisplayRole or role == Qt.ItemDataRole.EditRole:
        value = self._data[index.row(), index.column()]
        return &#34;&#34; if value is None else str(value)</code></pre>
</details>
<div class="desc"><p>data(self, index: QModelIndex, role: int = Qt.DisplayRole) -&gt; Any</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.deleteColumns"><code class="name flex">
<span>def <span class="ident">deleteColumns</span></span>(<span>self, start_column, count)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def deleteColumns(self, start_column, count):
    &#34;&#34;&#34;
    Deletes columns starting from `start_column` and spanning `count` columns.

    Args:
        start_column (int): The starting column index to delete.
        count (int): The number of columns to delete.
    &#34;&#34;&#34;
    if start_column &gt;= 0 and count &gt; 0:
        # Store original column order
        original_order = self._data.columns

        # Store the deleted columns and their data
        old_columns = {
            self._data.columns[i]: self._data[:, i].to_list()
            for i in range(start_column, start_column + count)
        }
        self.beginResetModel()
        columns_to_keep = [
            col for i, col in enumerate(self._data.columns)
            if i &lt; start_column or i &gt;= start_column + count
        ]
        self._data = self._data.select(columns_to_keep)
        self.endResetModel()

        # Create a DeleteColumnsCommand and push it to the undo stack
        command = DeleteColumnsCommand(self, start_column, old_columns, original_order)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"><p>Deletes columns starting from <code>start_column</code> and spanning <code>count</code> columns.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>start_column</code></strong> :&ensp;<code>int</code></dt>
<dd>The starting column index to delete.</dd>
<dt><strong><code>count</code></strong> :&ensp;<code>int</code></dt>
<dd>The number of columns to delete.</dd>
</dl></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.deleteRows"><code class="name flex">
<span>def <span class="ident">deleteRows</span></span>(<span>self, start_row, count)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def deleteRows(self, start_row, count):
    if start_row &gt;= 0 and count &gt; 0:
        old_rows = self._data[start_row:start_row + count].to_dict(as_series=False)
        self.beginRemoveRows(QtCore.QModelIndex(), start_row, start_row + count - 1)
        self._data = pl.concat([self._data[:start_row], self._data[start_row + count:]])
        self.loaded_rows -= count
        self.endRemoveRows()
        command = DeleteRowsCommand(self, start_row, old_rows)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.fetchMore"><code class="name flex">
<span>def <span class="ident">fetchMore</span></span>(<span>self, _)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def fetchMore(self, _):
    if self.loaded_rows &gt;= self._data.shape[0]:
        return
    remaining_rows = self._data.shape[0] - self.loaded_rows
    rows_to_fetch = min(self.batch_size, remaining_rows)
    self.beginInsertRows(QtCore.QModelIndex(), self.loaded_rows, self.loaded_rows + rows_to_fetch - 1)
    self.loaded_rows += rows_to_fetch
    self.endInsertRows()</code></pre>
</details>
<div class="desc"><p>fetchMore(self, parent: QModelIndex)</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.flags"><code class="name flex">
<span>def <span class="ident">flags</span></span>(<span>self, _)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flags(self, _):
    return (
        Qt.ItemFlag.ItemIsSelectable
        | Qt.ItemFlag.ItemIsEnabled
        | Qt.ItemFlag.ItemIsEditable
    )</code></pre>
</details>
<div class="desc"><p>flags(self, index: QModelIndex) -&gt; Qt.ItemFlag</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.get_column_type"><code class="name flex">
<span>def <span class="ident">get_column_type</span></span>(<span>self, column_index)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_type(self, column_index):
    if isinstance(column_index, int) and 0 &lt;= column_index &lt; len(self._data.columns):
        column_name = self._data.columns[column_index]
        return self._data[column_name].dtype
    return None</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.get_data"><code class="name flex">
<span>def <span class="ident">get_data</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_data(self):
    return self._data</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.headerData"><code class="name flex">
<span>def <span class="ident">headerData</span></span>(<span>self, section, orientation, role)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def headerData(self, section, orientation, role):
    if role == Qt.ItemDataRole.DisplayRole:
        if orientation == Qt.Orientation.Horizontal:
            if section &lt; len(self._data.columns):
                column_name = self._data.columns[section]
                return f&#34;{column_name}&#34;
            return &#34;&#34;
        if orientation == Qt.Orientation.Vertical:
            return str(section + 1)
    elif role == Qt.ItemDataRole.DecorationRole or role == Qt.ItemDataRole.DisplayRole:
        if orientation == Qt.Orientation.Horizontal:
            if section &lt; len(self._data.columns):
                column_name = self._data.columns[section]
                dtype = self._data[column_name].dtype
                if dtype == pl.Utf8:
                    return QtGui.QIcon(&#34;assets/nominal.svg&#34;)
                elif dtype == pl.Null:
                    return QtGui.QIcon(&#34;assets/null.svg&#34;)
                else:
                    return QtGui.QIcon(&#34;assets/numeric.svg&#34;)
    return None</code></pre>
</details>
<div class="desc"><p>headerData(self, section: int, orientation: Qt.Orientation, role: int = Qt.DisplayRole) -&gt; Any</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.paste"><code class="name flex">
<span>def <span class="ident">paste</span></span>(<span>self, index)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def paste(self, index):
    if index.isValid():
        clipboard = QtGui.QGuiApplication.clipboard()
        value = clipboard.text()
        self.setData(index, value)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    self.undo_stack.redo()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.rename_column"><code class="name flex">
<span>def <span class="ident">rename_column</span></span>(<span>self, column_index, new_name)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rename_column(self, column_index, new_name):
    if isinstance(column_index, int) and 0 &lt;= column_index &lt; len(self._data.columns):
        old_name = self._data.columns[column_index]
        self.beginResetModel()
        self._data = self._data.rename({old_name: new_name})
        self.endResetModel()
        command = RenameColumnCommand(self, column_index, old_name, new_name)
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.rowCount"><code class="name flex">
<span>def <span class="ident">rowCount</span></span>(<span>self, _)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rowCount(self, _):
    return self.loaded_rows</code></pre>
</details>
<div class="desc"><p>rowCount(self, parent: QModelIndex = QModelIndex()) -&gt; int</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.setData"><code class="name flex">
<span>def <span class="ident">setData</span></span>(<span>self, index, value, role=2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setData(self, index, value, role=Qt.ItemDataRole.EditRole):
    if role == Qt.ItemDataRole.EditRole:
        row = index.row()
        column = index.column()

        column_name = self._data.columns[column]
        dtype = self._data[column_name].dtype

        old_value = self._data[row, column]
        
        if dtype == pl.Null:
            if isinstance(value, str):
                val_strip = value.strip()
                val_dot = val_strip.replace(&#39;,&#39;, &#39;.&#39;)
                try:
                    float_val = float(val_dot)
                    if &#39;.&#39; in val_dot:
                        new_dtype = pl.Float64
                        value = float_val
                    else:
                        new_dtype = pl.Int64
                        value = int(float_val)
                except ValueError:
                    new_dtype = pl.Utf8
            elif isinstance(value, float):
                new_dtype = pl.Float64
            elif isinstance(value, int):
                new_dtype = pl.Int64
            else:
                new_dtype = pl.Utf8
            self._data = self._data.with_columns([pl.col(column_name).cast(new_dtype)])
            dtype = new_dtype

        if dtype == pl.Float64:
            try:
                if isinstance(value, str):
                    if value.count(&#39;,&#39;) == 1 and value.replace(&#39;,&#39;, &#39;&#39;).isdigit():
                        value = value.replace(&#39;,&#39;, &#39;.&#39;)
                    value = float(value) if value is not None else None
                    
            except ValueError:
                error_dialog = QtWidgets.QMessageBox()
                error_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                error_dialog.setText(f&#34;Invalid value: {value} for column {column_name}. Expected a numeric value.&#34;)
                error_dialog.setInformativeText(&#34;Do you want to set the column as a string?&#34;)
                error_dialog.setWindowTitle(&#34;Invalid Input&#34;)
                error_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                error_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                ret = error_dialog.exec()

                if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                    dtype = pl.Utf8
                    self._data = self._data.with_columns([pl.col(column_name).cast(dtype)])
                else:
                    return False

        if dtype == pl.Int64:
            try:
                if isinstance(value, str):
                    value = int(value) if value is not None else None
            except ValueError:
                error_dialog = QtWidgets.QMessageBox()
                error_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                error_dialog.setText(f&#34;Invalid value: {value} for column {column_name}. Expected an integer value.&#34;)
                error_dialog.setInformativeText(&#34;Do you want to set column to a string?&#34;)
                error_dialog.setWindowTitle(&#34;Invalid Input&#34;)
                error_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                error_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                ret = error_dialog.exec()

                if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                    dtype = pl.Utf8
                    self._data = self._data.with_columns([pl.col(column_name).cast(dtype)])
                else:
                    return False

        self._data[row, column] = value
        self.dataChanged.emit(index, index)
        command = EditDataCommand(self, row, column, old_value, value)  # Pass row, column to command
        self.undo_stack.push(command)
        return True
    return False</code></pre>
</details>
<div class="desc"><p>setData(self, index: QModelIndex, value: Any, role: int = Qt.EditRole) -&gt; bool</p></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.set_column_type"><code class="name flex">
<span>def <span class="ident">set_column_type</span></span>(<span>self, column_index, new_type)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_column_type(self, column_index, new_type):
    if isinstance(column_index, int) and 0 &lt;= column_index &lt; len(self._data.columns):
        column_name = self._data.columns[column_index]
        old_dtype = self._data[column_name].dtype
        old_data = self._data[column_name].to_list()

        if new_type == &#34;String&#34;:
            new_dtype = pl.Utf8
        elif new_type == &#34;Integer&#34;:
            if self._data[column_name].dtype == pl.Utf8:
                try:
                    warning_dialog = QtWidgets.QMessageBox()
                    warning_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                    warning_dialog.setText(f&#34;The current data type of column {column_name} is String. Converting to Integer will result in loss of non-numeric data.&#34;)
                    warning_dialog.setInformativeText(&#34;Do you want to proceed with the conversion?&#34;)
                    warning_dialog.setWindowTitle(&#34;Data Type Conversion Warning&#34;)
                    warning_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                    warning_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                    ret = warning_dialog.exec()

                    if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                        self._data = self._data.with_columns([
                            pl.when(pl.col(column_name).str.contains(r&#39;\d&#39;))
                            .then(pl.col(column_name).str.extract(r&#39;(\d+)&#39;).cast(pl.Int64))
                            .otherwise(pl.lit(None).cast(pl.Int64))
                        ])
                    else:
                        return
                except Exception:
                    raise ValueError(f&#34;Cannot convert column {column_name} to Integer&#34;)
            new_dtype = pl.Int64
        elif new_type == &#34;Float&#34;:
            if self._data[column_name].dtype == pl.Utf8:
                try:
                    warning_dialog = QtWidgets.QMessageBox()
                    warning_dialog.setIcon(QtWidgets.QMessageBox.Icon.Warning)
                    warning_dialog.setText(f&#34;The current data type of column {column_name} is String. Converting to Float will result in loss of non-numeric data.&#34;)
                    warning_dialog.setInformativeText(&#34;Do you want to proceed with the conversion?&#34;)
                    warning_dialog.setWindowTitle(&#34;Data Type Conversion Warning&#34;)
                    warning_dialog.setStandardButtons(QtWidgets.QMessageBox.StandardButton.Yes | QtWidgets.QMessageBox.StandardButton.No)
                    warning_dialog.setDefaultButton(QtWidgets.QMessageBox.StandardButton.No)
                    ret = warning_dialog.exec()

                    if ret == QtWidgets.QMessageBox.StandardButton.Yes:
                        self._data = self._data.with_columns([
                            pl.when(pl.col(column_name).str.contains(r&#39;^\d+(\.\d+)?$&#39;) | pl.col(column_name).str.contains(r&#39;^\d+(,\d+)?$&#39;))
                            .then(pl.col(column_name).str.replace(&#34;,&#34;, &#34;.&#34;).cast(pl.Float64, strict=False))
                            .otherwise(pl.lit(None).cast(pl.Float64))
                        ])
                    else:
                        return
                except Exception:
                    raise ValueError(f&#34;Cannot convert column {column_name} to Float&#34;)
            new_dtype = pl.Float64
        else:
            raise ValueError(&#34;Unsupported data type&#34;)

        self.beginResetModel()
        self._data = self._data.with_columns([pl.col(column_name).cast(new_dtype)])
        self.endResetModel()

        command = ChangeColumnTypeCommand(self, column_index, old_dtype, new_dtype, old_data, self._data[column_name].to_list())
        self.undo_stack.push(command)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.set_data"><code class="name flex">
<span>def <span class="ident">set_data</span></span>(<span>self, new_data)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_data(self, new_data):
    if isinstance(new_data, pl.DataFrame):
        self.beginResetModel()
        self._data = new_data
        self.loaded_rows = min(self.batch_size, self._data.shape[0])
        self.endResetModel()
    else:
        raise ValueError(&#34;Data must be a Polars DataFrame&#34;)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.TableModel.TableModel.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    self.undo_stack.undo()</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.TableModel.TableModel" href="#saePisan.model.TableModel.TableModel">TableModel</a></code></h4>
<ul class="two-column">
<li><code><a title="saePisan.model.TableModel.TableModel.addColumnAfter" href="#saePisan.model.TableModel.TableModel.addColumnAfter">addColumnAfter</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.addColumnBefore" href="#saePisan.model.TableModel.TableModel.addColumnBefore">addColumnBefore</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.addRowsAfter" href="#saePisan.model.TableModel.TableModel.addRowsAfter">addRowsAfter</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.addRowsBefore" href="#saePisan.model.TableModel.TableModel.addRowsBefore">addRowsBefore</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.canFetchMore" href="#saePisan.model.TableModel.TableModel.canFetchMore">canFetchMore</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.columnCount" href="#saePisan.model.TableModel.TableModel.columnCount">columnCount</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.copy" href="#saePisan.model.TableModel.TableModel.copy">copy</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.data" href="#saePisan.model.TableModel.TableModel.data">data</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.deleteColumns" href="#saePisan.model.TableModel.TableModel.deleteColumns">deleteColumns</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.deleteRows" href="#saePisan.model.TableModel.TableModel.deleteRows">deleteRows</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.fetchMore" href="#saePisan.model.TableModel.TableModel.fetchMore">fetchMore</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.flags" href="#saePisan.model.TableModel.TableModel.flags">flags</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.get_column_type" href="#saePisan.model.TableModel.TableModel.get_column_type">get_column_type</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.get_data" href="#saePisan.model.TableModel.TableModel.get_data">get_data</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.headerData" href="#saePisan.model.TableModel.TableModel.headerData">headerData</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.paste" href="#saePisan.model.TableModel.TableModel.paste">paste</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.redo" href="#saePisan.model.TableModel.TableModel.redo">redo</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.rename_column" href="#saePisan.model.TableModel.TableModel.rename_column">rename_column</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.rowCount" href="#saePisan.model.TableModel.TableModel.rowCount">rowCount</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.setData" href="#saePisan.model.TableModel.TableModel.setData">setData</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.set_column_type" href="#saePisan.model.TableModel.TableModel.set_column_type">set_column_type</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.set_data" href="#saePisan.model.TableModel.TableModel.set_data">set_data</a></code></li>
<li><code><a title="saePisan.model.TableModel.TableModel.undo" href="#saePisan.model.TableModel.TableModel.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_2_9">
                <div class="file-header">
                    <div>ğŸ“„ VariableSelection</div>
                    <div class="file-path">model/VariableSelection.html (10.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.model.VariableSelection</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.model.VariableSelection.VariableSelection"><code class="flex name class">
<span>class <span class="ident">VariableSelection</span></span>
<span>(</span><span>model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class VariableSelection:
    &#34;&#34;&#34;
    A class used to represent the Variable Selection process.
    Attributes
    ----------
    model1 : object
        The first model used in the variable selection process.
    model2 : object
        The second model used in the variable selection process.
    view : object
        The view associated with the variable selection process.
    result : str
        The result of the variable selection process.
    error : bool
        A flag indicating if there was an error during the variable selection process.
    Methods
    -------
    run_model(r_script)
        Executes the variable selection process using the provided R script.
    activate_R()
        Activates the R environment using rpy2.
    &#34;&#34;&#34;
    
    def __init__(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.result =&#34;&#34;
        self.error = False

    def run_model(self, r_script):
        self.r_script = r_script
        run_variable_selection(self)

    def activate_R(self):
        from rpy2.robjects import pandas2ri
        pandas2ri.activate()</code></pre>
</details>
<div class="desc"><p>A class used to represent the Variable Selection process.
Attributes</p>
<hr>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>object</code></dt>
<dd>The first model used in the variable selection process.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model used in the variable selection process.</dd>
<dt><strong><code>view</code></strong> :&ensp;<code>object</code></dt>
<dd>The view associated with the variable selection process.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>str</code></dt>
<dd>The result of the variable selection process.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating if there was an error during the variable selection process.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>run_model(r_script)
Executes the variable selection process using the provided R script.
activate_R()
Activates the R environment using rpy2.</p></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.model.VariableSelection.VariableSelection.activate_R"><code class="name flex">
<span>def <span class="ident">activate_R</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def activate_R(self):
    from rpy2.robjects import pandas2ri
    pandas2ri.activate()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.model.VariableSelection.VariableSelection.run_model"><code class="name flex">
<span>def <span class="ident">run_model</span></span>(<span>self, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model(self, r_script):
    self.r_script = r_script
    run_variable_selection(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.model" href="index.html">saePisan.model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.model.VariableSelection.VariableSelection" href="#saePisan.model.VariableSelection.VariableSelection">VariableSelection</a></code></h4>
<ul class="">
<li><code><a title="saePisan.model.VariableSelection.VariableSelection.activate_R" href="#saePisan.model.VariableSelection.VariableSelection.activate_R">activate_R</a></code></li>
<li><code><a title="saePisan.model.VariableSelection.VariableSelection.run_model" href="#saePisan.model.VariableSelection.VariableSelection.run_model">run_model</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_0">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">model/index.html (11.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.model</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.model.BoxPlot" href="BoxPlot.html">saePisan.model.BoxPlot</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.CorrelationMatrix" href="CorrelationMatrix.html">saePisan.model.CorrelationMatrix</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.Histogram" href="Histogram.html">saePisan.model.Histogram</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.LinePlot" href="LinePlot.html">saePisan.model.LinePlot</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.Multicollinearity" href="Multicollinearity.html">saePisan.model.Multicollinearity</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.NormalityTest" href="NormalityTest.html">saePisan.model.NormalityTest</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.ProjectionModel" href="ProjectionModel.html">saePisan.model.ProjectionModel</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.SaeEblup" href="SaeEblup.html">saePisan.model.SaeEblup</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.SaeEblupPseudo" href="SaeEblupPseudo.html">saePisan.model.SaeEblupPseudo</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.SaeEblupUnit" href="SaeEblupUnit.html">saePisan.model.SaeEblupUnit</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.SaeHB" href="SaeHB.html">saePisan.model.SaeHB</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.SaeModelling" href="SaeModelling.html">saePisan.model.SaeModelling</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.Scatterplot" href="Scatterplot.html">saePisan.model.Scatterplot</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.SummaryData" href="SummaryData.html">saePisan.model.SummaryData</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.TableModel" href="TableModel.html">saePisan.model.TableModel</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.model.VariableSelection" href="VariableSelection.html">saePisan.model.VariableSelection</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan" href="../index.html">saePisan</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.model.BoxPlot" href="BoxPlot.html">saePisan.model.BoxPlot</a></code></li>
<li><code><a title="saePisan.model.CorrelationMatrix" href="CorrelationMatrix.html">saePisan.model.CorrelationMatrix</a></code></li>
<li><code><a title="saePisan.model.Histogram" href="Histogram.html">saePisan.model.Histogram</a></code></li>
<li><code><a title="saePisan.model.LinePlot" href="LinePlot.html">saePisan.model.LinePlot</a></code></li>
<li><code><a title="saePisan.model.Multicollinearity" href="Multicollinearity.html">saePisan.model.Multicollinearity</a></code></li>
<li><code><a title="saePisan.model.NormalityTest" href="NormalityTest.html">saePisan.model.NormalityTest</a></code></li>
<li><code><a title="saePisan.model.ProjectionModel" href="ProjectionModel.html">saePisan.model.ProjectionModel</a></code></li>
<li><code><a title="saePisan.model.SaeEblup" href="SaeEblup.html">saePisan.model.SaeEblup</a></code></li>
<li><code><a title="saePisan.model.SaeEblupPseudo" href="SaeEblupPseudo.html">saePisan.model.SaeEblupPseudo</a></code></li>
<li><code><a title="saePisan.model.SaeEblupUnit" href="SaeEblupUnit.html">saePisan.model.SaeEblupUnit</a></code></li>
<li><code><a title="saePisan.model.SaeHB" href="SaeHB.html">saePisan.model.SaeHB</a></code></li>
<li><code><a title="saePisan.model.SaeModelling" href="SaeModelling.html">saePisan.model.SaeModelling</a></code></li>
<li><code><a title="saePisan.model.Scatterplot" href="Scatterplot.html">saePisan.model.Scatterplot</a></code></li>
<li><code><a title="saePisan.model.SummaryData" href="SummaryData.html">saePisan.model.SummaryData</a></code></li>
<li><code><a title="saePisan.model.TableModel" href="TableModel.html">saePisan.model.TableModel</a></code></li>
<li><code><a title="saePisan.model.VariableSelection" href="VariableSelection.html">saePisan.model.VariableSelection</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_1">
                <div class="file-header">
                    <div>ğŸ“„ EditColumn</div>
                    <div class="file-path">service/EditColumn.html (15.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.EditColumn</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.EditColumn.EditColumnDialog"><code class="flex name class">
<span>class <span class="ident">EditColumnDialog</span></span>
<span>(</span><span>column_name, data_type, parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EditColumnDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for editing the name and data type of a column.
    Attributes:
        column_name (str): The name of the column to be edited.
        data_type (str): The data type of the column to be edited.
        column_name_label (QLabel): Label displaying the column name.
        data_type_label (QLabel): Label displaying the data type.
        edit_name_input (QLineEdit): Input field for editing the column name.
        edit_data_type_input (QLineEdit): Input field for editing the data type.
        buttons (QDialogButtonBox): Dialog buttons for accepting or rejecting changes.
    Methods:
        __init__(column_name, data_type, parent=None):
            Initializes the dialog with the given column name and data type.
        init_ui():
            Initializes the user interface of the dialog.
        display():
            Displays the dialog and sets the input fields with the current column name and data type.
        edit_name(new_name):
            Updates the column name with the given new name.
        edit_data_type(new_data_type):
            Updates the data type with the given new data type.
    &#34;&#34;&#34;
    
    def __init__(self, column_name, data_type, parent=None):
        super().__init__(parent)
        self.setWindowTitle(&#34;Edit Column Dialog&#34;)

        self.column_name = column_name
        self.data_type = data_type

        self.init_ui()

    def init_ui(self):
        layout = QVBoxLayout()

        # Column name label
        self.column_name_label = QLabel(f&#34;Column Name: {self.column_name}&#34;)
        layout.addWidget(self.column_name_label)

        # Data type label
        self.data_type_label = QLabel(f&#34;Data Type: {self.data_type}&#34;)
        layout.addWidget(self.data_type_label)

        # Edit name input
        self.edit_name_input = QLineEdit()
        layout.addWidget(self.edit_name_input)

        # Edit data type input
        self.edit_data_type_input = QLineEdit()
        layout.addWidget(self.edit_data_type_input)

        # OK/Cancel buttons
        self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
        self.buttons.accepted.connect(self.accept)
        self.buttons.rejected.connect(self.reject)
        layout.addWidget(self.buttons)

        self.setLayout(layout)

    def display(self):
        self.edit_name_input.setText(self.column_name)
        self.edit_data_type_input.setText(self.data_type)
        self.exec()

    def edit_name(self, new_name):
        self.column_name = new_name

    def edit_data_type(self, new_data_type):
        self.data_type = new_data_type</code></pre>
</details>
<div class="desc"><p>A dialog for editing the name and data type of a column.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>column_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the column to be edited.</dd>
<dt><strong><code>data_type</code></strong> :&ensp;<code>str</code></dt>
<dd>The data type of the column to be edited.</dd>
<dt><strong><code>column_name_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label displaying the column name.</dd>
<dt><strong><code>data_type_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label displaying the data type.</dd>
<dt><strong><code>edit_name_input</code></strong> :&ensp;<code>QLineEdit</code></dt>
<dd>Input field for editing the column name.</dd>
<dt><strong><code>edit_data_type_input</code></strong> :&ensp;<code>QLineEdit</code></dt>
<dd>Input field for editing the data type.</dd>
<dt><strong><code>buttons</code></strong> :&ensp;<code>QDialogButtonBox</code></dt>
<dd>Dialog buttons for accepting or rejecting changes.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(column_name, data_type, parent=None):
Initializes the dialog with the given column name and data type.
init_ui():
Initializes the user interface of the dialog.
display():
Displays the dialog and sets the input fields with the current column name and data type.
edit_name(new_name):
Updates the column name with the given new name.
edit_data_type(new_data_type):
Updates the data type with the given new data type.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.EditColumn.EditColumnDialog.display"><code class="name flex">
<span>def <span class="ident">display</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def display(self):
    self.edit_name_input.setText(self.column_name)
    self.edit_data_type_input.setText(self.data_type)
    self.exec()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.EditColumn.EditColumnDialog.edit_data_type"><code class="name flex">
<span>def <span class="ident">edit_data_type</span></span>(<span>self, new_data_type)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def edit_data_type(self, new_data_type):
    self.data_type = new_data_type</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.EditColumn.EditColumnDialog.edit_name"><code class="name flex">
<span>def <span class="ident">edit_name</span></span>(<span>self, new_name)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def edit_name(self, new_name):
    self.column_name = new_name</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.EditColumn.EditColumnDialog.init_ui"><code class="name flex">
<span>def <span class="ident">init_ui</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_ui(self):
    layout = QVBoxLayout()

    # Column name label
    self.column_name_label = QLabel(f&#34;Column Name: {self.column_name}&#34;)
    layout.addWidget(self.column_name_label)

    # Data type label
    self.data_type_label = QLabel(f&#34;Data Type: {self.data_type}&#34;)
    layout.addWidget(self.data_type_label)

    # Edit name input
    self.edit_name_input = QLineEdit()
    layout.addWidget(self.edit_name_input)

    # Edit data type input
    self.edit_data_type_input = QLineEdit()
    layout.addWidget(self.edit_data_type_input)

    # OK/Cancel buttons
    self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
    self.buttons.accepted.connect(self.accept)
    self.buttons.rejected.connect(self.reject)
    layout.addWidget(self.buttons)

    self.setLayout(layout)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.EditColumn.EditColumnDialog" href="#saePisan.service.EditColumn.EditColumnDialog">EditColumnDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.EditColumn.EditColumnDialog.display" href="#saePisan.service.EditColumn.EditColumnDialog.display">display</a></code></li>
<li><code><a title="saePisan.service.EditColumn.EditColumnDialog.edit_data_type" href="#saePisan.service.EditColumn.EditColumnDialog.edit_data_type">edit_data_type</a></code></li>
<li><code><a title="saePisan.service.EditColumn.EditColumnDialog.edit_name" href="#saePisan.service.EditColumn.EditColumnDialog.edit_name">edit_name</a></code></li>
<li><code><a title="saePisan.service.EditColumn.EditColumnDialog.init_ui" href="#saePisan.service.EditColumn.EditColumnDialog.init_ui">init_ui</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_2">
                <div class="file-header">
                    <div>ğŸ“„ AddColumnCommand</div>
                    <div class="file-path">service/command/AddColumnCommand.html (12.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.AddColumnCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.AddColumnCommand.AddColumnCommand"><code class="flex name class">
<span>class <span class="ident">AddColumnCommand</span></span>
<span>(</span><span>model, column_names, new_columns)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class AddColumnCommand(QUndoCommand):
    def __init__(self, model, column_names, new_columns):
        &#34;&#34;&#34;
        Initializes the AddColumnCommand with model, column names, and the corresponding new columns.

        :param model: The model containing the data.
        :param column_names: A list of column names to be added.
        :param new_columns: A list of lists with the new column data (one list per column).
        &#34;&#34;&#34;
        super().__init__()
        self.model = model
        self.column_names = column_names
        self.new_columns = new_columns
        self.executed = False

    def undo(self):
        &#34;&#34;&#34;
        Undo the addition of columns by removing them from the DataFrame.
        &#34;&#34;&#34;
        for column_name in self.column_names:
            if column_name in self.model._data.columns:
                col_index = self.model._data.columns.index(column_name)
                self.model.beginRemoveColumns(QtCore.QModelIndex(), col_index, 1)
                self.model._data = self.model._data.drop(column_name)
                self.model.endRemoveColumns()

    def redo(self):
        &#34;&#34;&#34;
        Redo the addition of columns by inserting them into the DataFrame.
        &#34;&#34;&#34;
        if not self.executed:
            self.executed = True
        else:
            for column_name, new_column in zip(self.column_names, self.new_columns):
                self.model.beginInsertColumns(QtCore.QModelIndex(), self.model._data.width, self.model._data.width)
                self.model._data = self.model._data.with_columns(pl.Series(column_name, new_column))
                self.model.endInsertColumns()</code></pre>
</details>
<div class="desc"><p>QUndoCommand(parent: Optional[QUndoCommand] = None)
QUndoCommand(text: Optional[str], parent: Optional[QUndoCommand] = None)</p>
<p>Initializes the AddColumnCommand with model, column names, and the corresponding new columns.</p>
<p>:param model: The model containing the data.
:param column_names: A list of column names to be added.
:param new_columns: A list of lists with the new column data (one list per column).</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.AddColumnCommand.AddColumnCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    &#34;&#34;&#34;
    Redo the addition of columns by inserting them into the DataFrame.
    &#34;&#34;&#34;
    if not self.executed:
        self.executed = True
    else:
        for column_name, new_column in zip(self.column_names, self.new_columns):
            self.model.beginInsertColumns(QtCore.QModelIndex(), self.model._data.width, self.model._data.width)
            self.model._data = self.model._data.with_columns(pl.Series(column_name, new_column))
            self.model.endInsertColumns()</code></pre>
</details>
<div class="desc"><p>Redo the addition of columns by inserting them into the DataFrame.</p></div>
</dd>
<dt id="saePisan.service.command.AddColumnCommand.AddColumnCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    &#34;&#34;&#34;
    Undo the addition of columns by removing them from the DataFrame.
    &#34;&#34;&#34;
    for column_name in self.column_names:
        if column_name in self.model._data.columns:
            col_index = self.model._data.columns.index(column_name)
            self.model.beginRemoveColumns(QtCore.QModelIndex(), col_index, 1)
            self.model._data = self.model._data.drop(column_name)
            self.model.endRemoveColumns()</code></pre>
</details>
<div class="desc"><p>Undo the addition of columns by removing them from the DataFrame.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.AddColumnCommand.AddColumnCommand" href="#saePisan.service.command.AddColumnCommand.AddColumnCommand">AddColumnCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.AddColumnCommand.AddColumnCommand.redo" href="#saePisan.service.command.AddColumnCommand.AddColumnCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.AddColumnCommand.AddColumnCommand.undo" href="#saePisan.service.command.AddColumnCommand.AddColumnCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_3">
                <div class="file-header">
                    <div>ğŸ“„ AddRowCommand</div>
                    <div class="file-path">service/command/AddRowCommand.html (12.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.AddRowCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.AddRowCommand.AddRowsCommand"><code class="flex name class">
<span>class <span class="ident">AddRowsCommand</span></span>
<span>(</span><span>model, row, new_rows)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class AddRowsCommand(QUndoCommand):
    &#34;&#34;&#34;
    A command class to add rows to a model, supporting undo and redo operations.
    Attributes:
        model (QAbstractItemModel): The model to which rows will be added.
        row (int): The position at which new rows will be inserted.
        new_rows (list): The new rows to be added to the model.
        executed (bool): A flag to prevent re-execution during the initial push.
    Methods:
        undo():
            Removes the previously added rows from the model.
        redo():
            Adds the new rows to the model. If the command has already been executed,
            it will insert the rows again.
    &#34;&#34;&#34;
    
    def __init__(self, model, row, new_rows):
        super().__init__()
        self.model = model
        self.row = row
        self.new_rows = new_rows
        self.executed = False

    def undo(self):
        self.model.beginRemoveRows(QtCore.QModelIndex(), self.row, self.row + len(self.new_rows) - 1)
        self.model._data = pl.concat([self.model._data[:self.row], self.model._data[self.row + len(self.new_rows):]])
        self.model.loaded_rows -= len(self.new_rows)
        self.model.endRemoveRows()

    def redo(self):
        if not self.executed:  # Cegah eksekusi ulang saat push
            self.executed = True
        else:
            self.model.beginInsertRows(QtCore.QModelIndex(), self.row, self.row + len(self.new_rows) - 1)
            self.model._data = pl.concat([self.model._data[:self.row], pl.DataFrame(self.new_rows), self.model._data[self.row:]])
            self.model.loaded_rows += len(self.new_rows)
            self.model.endInsertRows()</code></pre>
</details>
<div class="desc"><p>A command class to add rows to a model, supporting undo and redo operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model</code></strong> :&ensp;<code>QAbstractItemModel</code></dt>
<dd>The model to which rows will be added.</dd>
<dt><strong><code>row</code></strong> :&ensp;<code>int</code></dt>
<dd>The position at which new rows will be inserted.</dd>
<dt><strong><code>new_rows</code></strong> :&ensp;<code>list</code></dt>
<dd>The new rows to be added to the model.</dd>
<dt><strong><code>executed</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag to prevent re-execution during the initial push.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>undo():
Removes the previously added rows from the model.
redo():
Adds the new rows to the model. If the command has already been executed,
it will insert the rows again.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.AddRowCommand.AddRowsCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    if not self.executed:  # Cegah eksekusi ulang saat push
        self.executed = True
    else:
        self.model.beginInsertRows(QtCore.QModelIndex(), self.row, self.row + len(self.new_rows) - 1)
        self.model._data = pl.concat([self.model._data[:self.row], pl.DataFrame(self.new_rows), self.model._data[self.row:]])
        self.model.loaded_rows += len(self.new_rows)
        self.model.endInsertRows()</code></pre>
</details>
<div class="desc"><p>redo(self)</p></div>
</dd>
<dt id="saePisan.service.command.AddRowCommand.AddRowsCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    self.model.beginRemoveRows(QtCore.QModelIndex(), self.row, self.row + len(self.new_rows) - 1)
    self.model._data = pl.concat([self.model._data[:self.row], self.model._data[self.row + len(self.new_rows):]])
    self.model.loaded_rows -= len(self.new_rows)
    self.model.endRemoveRows()</code></pre>
</details>
<div class="desc"><p>undo(self)</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.AddRowCommand.AddRowsCommand" href="#saePisan.service.command.AddRowCommand.AddRowsCommand">AddRowsCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.AddRowCommand.AddRowsCommand.redo" href="#saePisan.service.command.AddRowCommand.AddRowsCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.AddRowCommand.AddRowsCommand.undo" href="#saePisan.service.command.AddRowCommand.AddRowsCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_4">
                <div class="file-header">
                    <div>ğŸ“„ ChangeColumnTypeCommand</div>
                    <div class="file-path">service/command/ChangeColumnTypeCommand.html (12.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.ChangeColumnTypeCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand"><code class="flex name class">
<span>class <span class="ident">ChangeColumnTypeCommand</span></span>
<span>(</span><span>model, column_index, old_dtype, new_dtype, old_data, new_data)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ChangeColumnTypeCommand(QUndoCommand):
    &#34;&#34;&#34;
    A command class to change the data type of a column in a model, supporting undo and redo operations.
    Attributes:
        model (QAbstractTableModel): The model containing the data.
        column_index (int): The index of the column to change.
        old_dtype (str): The original data type of the column.
        new_dtype (str): The new data type of the column.
        old_data (list): The original data of the column.
        new_data (list): The new data of the column.
        column_name (str): The name of the column to change.
    Methods:
        undo(): Reverts the column to its original data type and data.
        redo(): Changes the column to the new data type and data.
    &#34;&#34;&#34;
    
    def __init__(self, model, column_index, old_dtype, new_dtype, old_data, new_data):
        super().__init__()
        self.model = model
        self.column_index = column_index
        self.old_dtype = old_dtype
        self.new_dtype = new_dtype
        self.old_data = old_data
        self.new_data = new_data
        self.column_name = self.model._data.columns[self.column_index]
        self.setText(f&#34;Change column type of {self.column_name} from {self.old_dtype} to {self.new_dtype}&#34;)

    def undo(self):
        self.model.beginResetModel()
        self.model._data = self.model._data.with_columns([pl.Series(self.column_name, self.old_data).cast(self.old_dtype)])
        self.model.endResetModel()

    def redo(self):
        self.model.beginResetModel()
        self.model._data = self.model._data.with_columns([pl.Series(self.column_name, self.new_data).cast(self.new_dtype)])
        self.model.endResetModel()</code></pre>
</details>
<div class="desc"><p>A command class to change the data type of a column in a model, supporting undo and redo operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model</code></strong> :&ensp;<code>QAbstractTableModel</code></dt>
<dd>The model containing the data.</dd>
<dt><strong><code>column_index</code></strong> :&ensp;<code>int</code></dt>
<dd>The index of the column to change.</dd>
<dt><strong><code>old_dtype</code></strong> :&ensp;<code>str</code></dt>
<dd>The original data type of the column.</dd>
<dt><strong><code>new_dtype</code></strong> :&ensp;<code>str</code></dt>
<dd>The new data type of the column.</dd>
<dt><strong><code>old_data</code></strong> :&ensp;<code>list</code></dt>
<dd>The original data of the column.</dd>
<dt><strong><code>new_data</code></strong> :&ensp;<code>list</code></dt>
<dd>The new data of the column.</dd>
<dt><strong><code>column_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the column to change.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>undo(): Reverts the column to its original data type and data.
redo(): Changes the column to the new data type and data.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    self.model.beginResetModel()
    self.model._data = self.model._data.with_columns([pl.Series(self.column_name, self.new_data).cast(self.new_dtype)])
    self.model.endResetModel()</code></pre>
</details>
<div class="desc"><p>redo(self)</p></div>
</dd>
<dt id="saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    self.model.beginResetModel()
    self.model._data = self.model._data.with_columns([pl.Series(self.column_name, self.old_data).cast(self.old_dtype)])
    self.model.endResetModel()</code></pre>
</details>
<div class="desc"><p>undo(self)</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand" href="#saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand">ChangeColumnTypeCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand.redo" href="#saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand.undo" href="#saePisan.service.command.ChangeColumnTypeCommand.ChangeColumnTypeCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_5">
                <div class="file-header">
                    <div>ğŸ“„ DeleteColumnsCommand</div>
                    <div class="file-path">service/command/DeleteColumnsCommand.html (12.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.DeleteColumnsCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand"><code class="flex name class">
<span>class <span class="ident">DeleteColumnsCommand</span></span>
<span>(</span><span>model, start_column, deleted_columns, original_order)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteColumnsCommand(QUndoCommand):
    def __init__(self, model, start_column, deleted_columns, original_order):
        &#34;&#34;&#34;
        Initialize the DeleteColumnsCommand.

        Args:
            model: The model to apply the changes to.
            start_column: The index of the first column to delete.
            deleted_columns: A dictionary of deleted column names and their data.
            original_order: The original order of columns before deletion.
        &#34;&#34;&#34;
        super().__init__()
        self.model = model
        self.start_column = start_column
        self.deleted_columns = deleted_columns
        self.old_data = deleted_columns  # Store the columns that were deleted
        self.original_order = original_order  # Store the original column order
        self.executed = False

    def undo(self):
        &#34;&#34;&#34;Undo the column deletion by restoring the deleted columns.&#34;&#34;&#34;
        self.model.beginResetModel()
        for col_name, col_values in self.deleted_columns.items():
            self.model._data = self.model._data.with_columns(pl.Series(col_name, col_values))

        # Reorder columns to match the original order
        self.model._data = self.model._data.select(self.original_order)
        self.model.endResetModel()

    def redo(self):
        &#34;&#34;&#34;Redo the column deletion by removing the columns again.&#34;&#34;&#34;
        if not self.executed:
            self.executed = True
        else:
            self.model.beginResetModel()
            columns_to_remove = list(self.deleted_columns.keys())
            self.model._data = self.model._data.select(
                [col for col in self.model._data.columns if col not in columns_to_remove]
            )
            self.model.endResetModel()</code></pre>
</details>
<div class="desc"><p>QUndoCommand(parent: Optional[QUndoCommand] = None)
QUndoCommand(text: Optional[str], parent: Optional[QUndoCommand] = None)</p>
<p>Initialize the DeleteColumnsCommand.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>model</code></strong></dt>
<dd>The model to apply the changes to.</dd>
<dt><strong><code>start_column</code></strong></dt>
<dd>The index of the first column to delete.</dd>
<dt><strong><code>deleted_columns</code></strong></dt>
<dd>A dictionary of deleted column names and their data.</dd>
<dt><strong><code>original_order</code></strong></dt>
<dd>The original order of columns before deletion.</dd>
</dl></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    &#34;&#34;&#34;Redo the column deletion by removing the columns again.&#34;&#34;&#34;
    if not self.executed:
        self.executed = True
    else:
        self.model.beginResetModel()
        columns_to_remove = list(self.deleted_columns.keys())
        self.model._data = self.model._data.select(
            [col for col in self.model._data.columns if col not in columns_to_remove]
        )
        self.model.endResetModel()</code></pre>
</details>
<div class="desc"><p>Redo the column deletion by removing the columns again.</p></div>
</dd>
<dt id="saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    &#34;&#34;&#34;Undo the column deletion by restoring the deleted columns.&#34;&#34;&#34;
    self.model.beginResetModel()
    for col_name, col_values in self.deleted_columns.items():
        self.model._data = self.model._data.with_columns(pl.Series(col_name, col_values))

    # Reorder columns to match the original order
    self.model._data = self.model._data.select(self.original_order)
    self.model.endResetModel()</code></pre>
</details>
<div class="desc"><p>Undo the column deletion by restoring the deleted columns.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand" href="#saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand">DeleteColumnsCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand.redo" href="#saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand.undo" href="#saePisan.service.command.DeleteColumnsCommand.DeleteColumnsCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_6">
                <div class="file-header">
                    <div>ğŸ“„ DeleteRowsCommand</div>
                    <div class="file-path">service/command/DeleteRowsCommand.html (13.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.DeleteRowsCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand"><code class="flex name class">
<span>class <span class="ident">DeleteRowsCommand</span></span>
<span>(</span><span>model, start_row, rows_data)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteRowsCommand(QUndoCommand):
    &#34;&#34;&#34;
    A command to delete rows from a model, supporting undo and redo operations.
    Attributes:
        model (QAbstractItemModel): The model from which rows will be deleted.
        start_row (int): The starting row index for deletion.
        rows_data (pl.DataFrame): The data of the rows to be deleted.
        executed (bool): A flag to indicate if the command has been executed.
    Methods:
        undo(): Reverts the deletion of rows by inserting them back into the model.
        redo(): Executes the deletion of rows from the model.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Initializes the DeleteRowsCommand with the model, starting row, and rows data.
    Args:
        model (QAbstractItemModel): The model from which rows will be deleted.
        start_row (int): The starting row index for deletion.
        rows_data (list or pl.DataFrame): The data of the rows to be deleted.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Reverts the deletion of rows by inserting them back into the model.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Executes the deletion of rows from the model.
    &#34;&#34;&#34;
    
    def __init__(self, model, start_row, rows_data):
        super().__init__(&#34;Delete Rows&#34;)
        self.model = model
        self.start_row = start_row
        self.rows_data = pl.DataFrame(rows_data) if not isinstance(rows_data, pl.DataFrame) else rows_data
        self.executed = False

    def undo(self):
        self.model.beginInsertRows(QModelIndex(), self.start_row, self.start_row + len(self.rows_data) - 1)
        self.model._data = pl.concat([pl.DataFrame(self.model._data[:self.start_row]), self.rows_data, pl.DataFrame(self.model._data[self.start_row:])])
        self.model.loaded_rows = min(self.model.loaded_rows + len(self.rows_data), self.model._data.shape[0])
        self.model.endInsertRows()
        self.model.layoutChanged.emit()

    def redo(self):
        if not self.executed:  # Prevent re-execution when pushed
            self.executed = True
        else:
            self.model.beginRemoveRows(QModelIndex(), self.start_row, self.start_row + len(self.rows_data) - 1)
            self.model._data = pl.concat([self.model._data[:self.start_row], self.model._data[self.start_row + len(self.rows_data):]])
            self.model.loaded_rows = max(self.model.loaded_rows - len(self.rows_data), 0)
            self.model.endRemoveRows()
            self.model.layoutChanged.emit()</code></pre>
</details>
<div class="desc"><p>A command to delete rows from a model, supporting undo and redo operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model</code></strong> :&ensp;<code>QAbstractItemModel</code></dt>
<dd>The model from which rows will be deleted.</dd>
<dt><strong><code>start_row</code></strong> :&ensp;<code>int</code></dt>
<dd>The starting row index for deletion.</dd>
<dt><strong><code>rows_data</code></strong> :&ensp;<code>pl.DataFrame</code></dt>
<dd>The data of the rows to be deleted.</dd>
<dt><strong><code>executed</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag to indicate if the command has been executed.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>undo(): Reverts the deletion of rows by inserting them back into the model.
redo(): Executes the deletion of rows from the model.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    if not self.executed:  # Prevent re-execution when pushed
        self.executed = True
    else:
        self.model.beginRemoveRows(QModelIndex(), self.start_row, self.start_row + len(self.rows_data) - 1)
        self.model._data = pl.concat([self.model._data[:self.start_row], self.model._data[self.start_row + len(self.rows_data):]])
        self.model.loaded_rows = max(self.model.loaded_rows - len(self.rows_data), 0)
        self.model.endRemoveRows()
        self.model.layoutChanged.emit()</code></pre>
</details>
<div class="desc"><p>redo(self)</p></div>
</dd>
<dt id="saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    self.model.beginInsertRows(QModelIndex(), self.start_row, self.start_row + len(self.rows_data) - 1)
    self.model._data = pl.concat([pl.DataFrame(self.model._data[:self.start_row]), self.rows_data, pl.DataFrame(self.model._data[self.start_row:])])
    self.model.loaded_rows = min(self.model.loaded_rows + len(self.rows_data), self.model._data.shape[0])
    self.model.endInsertRows()
    self.model.layoutChanged.emit()</code></pre>
</details>
<div class="desc"><p>undo(self)</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand" href="#saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand">DeleteRowsCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand.redo" href="#saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand.undo" href="#saePisan.service.command.DeleteRowsCommand.DeleteRowsCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_7">
                <div class="file-header">
                    <div>ğŸ“„ EditDataCommand</div>
                    <div class="file-path">service/command/EditDataCommand.html (12.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.EditDataCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.EditDataCommand.EditDataCommand"><code class="flex name class">
<span>class <span class="ident">EditDataCommand</span></span>
<span>(</span><span>model, row, column, old_value, new_value)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EditDataCommand(QUndoCommand):
    &#34;&#34;&#34;
    Command to edit data in a cell.
    This command is used to change the value of a specific cell in a model.
    It supports undo and redo operations to revert or reapply the changes.
    Attributes:
        model: The model containing the data to be edited.
        row: The row index of the cell to be edited.
        column: The column index of the cell to be edited.
        old_value: The original value of the cell before the edit.
        new_value: The new value to be set in the cell.
    Methods:
        undo(): Reverts the cell value to the original value.
        redo(): Applies the new value to the cell.
    &#34;&#34;&#34;
    
    &#34;&#34;&#34;Command untuk mengubah data dalam sel&#34;&#34;&#34;
    def __init__(self, model, row, column, old_value, new_value):
        super().__init__()
        self.model = model  # Model passed as argument
        self.row = row
        self.column = column
        self.old_value = old_value
        self.new_value = new_value
        self.setText(f&#34;Edit cell at ({row}, {column})&#34;)  # Deskripsi untuk command

    def undo(self):
        &#34;&#34;&#34;Kembalikan ke nilai sebelumnya&#34;&#34;&#34;
        # Update model data
        self.model._data[self.row, self.column] = self.old_value
        self.model.dataChanged.emit(self.model.createIndex(self.row, self.column), self.model.createIndex(self.row, self.column))

    def redo(self):
        &#34;&#34;&#34;Terapkan perubahan baru&#34;&#34;&#34;
        # Update model data
        self.model._data[self.row, self.column] = self.new_value
        self.model.dataChanged.emit(self.model.createIndex(self.row, self.column), self.model.createIndex(self.row, self.column))</code></pre>
</details>
<div class="desc"><p>Command to edit data in a cell.
This command is used to change the value of a specific cell in a model.
It supports undo and redo operations to revert or reapply the changes.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model</code></strong></dt>
<dd>The model containing the data to be edited.</dd>
<dt><strong><code>row</code></strong></dt>
<dd>The row index of the cell to be edited.</dd>
<dt><strong><code>column</code></strong></dt>
<dd>The column index of the cell to be edited.</dd>
<dt><strong><code>old_value</code></strong></dt>
<dd>The original value of the cell before the edit.</dd>
<dt><strong><code>new_value</code></strong></dt>
<dd>The new value to be set in the cell.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>undo(): Reverts the cell value to the original value.
redo(): Applies the new value to the cell.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.EditDataCommand.EditDataCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    &#34;&#34;&#34;Terapkan perubahan baru&#34;&#34;&#34;
    # Update model data
    self.model._data[self.row, self.column] = self.new_value
    self.model.dataChanged.emit(self.model.createIndex(self.row, self.column), self.model.createIndex(self.row, self.column))</code></pre>
</details>
<div class="desc"><p>Terapkan perubahan baru</p></div>
</dd>
<dt id="saePisan.service.command.EditDataCommand.EditDataCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    &#34;&#34;&#34;Kembalikan ke nilai sebelumnya&#34;&#34;&#34;
    # Update model data
    self.model._data[self.row, self.column] = self.old_value
    self.model.dataChanged.emit(self.model.createIndex(self.row, self.column), self.model.createIndex(self.row, self.column))</code></pre>
</details>
<div class="desc"><p>Kembalikan ke nilai sebelumnya</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.EditDataCommand.EditDataCommand" href="#saePisan.service.command.EditDataCommand.EditDataCommand">EditDataCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.EditDataCommand.EditDataCommand.redo" href="#saePisan.service.command.EditDataCommand.EditDataCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.EditDataCommand.EditDataCommand.undo" href="#saePisan.service.command.EditDataCommand.EditDataCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_8">
                <div class="file-header">
                    <div>ğŸ“„ RenameColumnCommand</div>
                    <div class="file-path">service/command/RenameColumnCommand.html (12.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.command.RenameColumnCommand</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.service.command.RenameColumnCommand.RenameColumnCommand"><code class="flex name class">
<span>class <span class="ident">RenameColumnCommand</span></span>
<span>(</span><span>model, column_index, old_name, new_name)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class RenameColumnCommand(QUndoCommand):
    &#34;&#34;&#34;
    A command to rename a column in a model, supporting undo and redo operations.
    Attributes:
        model (QAbstractItemModel): The model containing the data.
        column_index (int): The index of the column to rename.
        old_name (str): The current name of the column.
        new_name (str): The new name for the column.
        executed (bool): Flag indicating whether the command has been executed.
    Methods:
        redo(): Renames the column to the new name.
        undo(): Reverts the column name to the old name.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Initializes the RenameColumnCommand with the model, column index, old name, and new name.
    Args:
        model (QAbstractItemModel): The model containing the data.
        column_index (int): The index of the column to rename.
        old_name (str): The current name of the column.
        new_name (str): The new name for the column.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Renames the column to the new name. If the command has already been executed,
    it updates the model&#39;s data and emits the layoutChanged signal.
    &#34;&#34;&#34;
    &#34;&#34;&#34;
    Reverts the column name to the old name. If the command has already been executed,
    it updates the model&#39;s data and emits the layoutChanged signal.
    &#34;&#34;&#34;
    
    def __init__(self, model, column_index, old_name, new_name):
        super().__init__()
        self._model = model
        self._column_index = column_index
        self._old_name = old_name
        self._new_name = new_name
        self.executed = False

    def redo(self):
        if not self.executed:
            self.executed = True
        else:
            self._model._data = self._model._data.rename({self._old_name: self._new_name})
            self._model.layoutChanged.emit()

    def undo(self):
        if not self.executed:
            self.executed = True
        else:
            self._model._data = self._model._data.rename({self._new_name: self._old_name})
            self._model.layoutChanged.emit()</code></pre>
</details>
<div class="desc"><p>A command to rename a column in a model, supporting undo and redo operations.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model</code></strong> :&ensp;<code>QAbstractItemModel</code></dt>
<dd>The model containing the data.</dd>
<dt><strong><code>column_index</code></strong> :&ensp;<code>int</code></dt>
<dd>The index of the column to rename.</dd>
<dt><strong><code>old_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The current name of the column.</dd>
<dt><strong><code>new_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The new name for the column.</dd>
<dt><strong><code>executed</code></strong> :&ensp;<code>bool</code></dt>
<dd>Flag indicating whether the command has been executed.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>redo(): Renames the column to the new name.
undo(): Reverts the column name to the old name.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtGui.QUndoCommand</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.service.command.RenameColumnCommand.RenameColumnCommand.redo"><code class="name flex">
<span>def <span class="ident">redo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo(self):
    if not self.executed:
        self.executed = True
    else:
        self._model._data = self._model._data.rename({self._old_name: self._new_name})
        self._model.layoutChanged.emit()</code></pre>
</details>
<div class="desc"><p>redo(self)</p></div>
</dd>
<dt id="saePisan.service.command.RenameColumnCommand.RenameColumnCommand.undo"><code class="name flex">
<span>def <span class="ident">undo</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo(self):
    if not self.executed:
        self.executed = True
    else:
        self._model._data = self._model._data.rename({self._new_name: self._old_name})
        self._model.layoutChanged.emit()</code></pre>
</details>
<div class="desc"><p>undo(self)</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.command" href="index.html">saePisan.service.command</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.service.command.RenameColumnCommand.RenameColumnCommand" href="#saePisan.service.command.RenameColumnCommand.RenameColumnCommand">RenameColumnCommand</a></code></h4>
<ul class="">
<li><code><a title="saePisan.service.command.RenameColumnCommand.RenameColumnCommand.redo" href="#saePisan.service.command.RenameColumnCommand.RenameColumnCommand.redo">redo</a></code></li>
<li><code><a title="saePisan.service.command.RenameColumnCommand.RenameColumnCommand.undo" href="#saePisan.service.command.RenameColumnCommand.RenameColumnCommand.undo">undo</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_3_9">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/command/index.html (9.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.command</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.command.AddColumnCommand" href="AddColumnCommand.html">saePisan.service.command.AddColumnCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command.AddRowCommand" href="AddRowCommand.html">saePisan.service.command.AddRowCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command.ChangeColumnTypeCommand" href="ChangeColumnTypeCommand.html">saePisan.service.command.ChangeColumnTypeCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command.DeleteColumnsCommand" href="DeleteColumnsCommand.html">saePisan.service.command.DeleteColumnsCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command.DeleteRowsCommand" href="DeleteRowsCommand.html">saePisan.service.command.DeleteRowsCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command.EditDataCommand" href="EditDataCommand.html">saePisan.service.command.EditDataCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command.RenameColumnCommand" href="RenameColumnCommand.html">saePisan.service.command.RenameColumnCommand</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.command.AddColumnCommand" href="AddColumnCommand.html">saePisan.service.command.AddColumnCommand</a></code></li>
<li><code><a title="saePisan.service.command.AddRowCommand" href="AddRowCommand.html">saePisan.service.command.AddRowCommand</a></code></li>
<li><code><a title="saePisan.service.command.ChangeColumnTypeCommand" href="ChangeColumnTypeCommand.html">saePisan.service.command.ChangeColumnTypeCommand</a></code></li>
<li><code><a title="saePisan.service.command.DeleteColumnsCommand" href="DeleteColumnsCommand.html">saePisan.service.command.DeleteColumnsCommand</a></code></li>
<li><code><a title="saePisan.service.command.DeleteRowsCommand" href="DeleteRowsCommand.html">saePisan.service.command.DeleteRowsCommand</a></code></li>
<li><code><a title="saePisan.service.command.EditDataCommand" href="EditDataCommand.html">saePisan.service.command.EditDataCommand</a></code></li>
<li><code><a title="saePisan.service.command.RenameColumnCommand" href="RenameColumnCommand.html">saePisan.service.command.RenameColumnCommand</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_0">
                <div class="file-header">
                    <div>ğŸ“„ compute</div>
                    <div class="file-path">service/compute.html (9.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.compute</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.compute.run_compute"><code class="name flex">
<span>def <span class="ident">run_compute</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_compute(parent):
    &#34;&#34;&#34;
    Executes an R script provided by the parent object and computes a new column.
    This function retrieves data from the parent object, converts it to an R dataframe,
    attaches the dataframe in the R environment, runs the R script provided by the parent,
    and extracts the newly computed column. If successful, it returns the new column as a
    Polars Series. If an error occurs, it displays an error message.
    Parameters:
    parent (object): The parent object containing the data and the R script to be executed.
                     It should have the methods `get_script()` and `column_name_input.text()`.
    Returns:
    pl.Series: A Polars Series containing the new column if computation is successful.
    None: If an error occurs during the computation.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    get_data(parent)
    try:
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)
        ro.r(&#34;attach(data)&#34;)
        ro.r(parent.get_script())
        new_column_name = parent.column_name_input.text()
        new_column = ro.conversion.rpy2py(ro.globalenv[&#39;new_column&#39;])
        ro.r(&#34;detach(data)&#34;)
        if new_column is not None:
            return pl.Series(new_column_name, list(new_column))
        QMessageBox.information(parent, &#34;Success&#34;, &#34;New variable computed successfully!&#34;)
    except Exception as e:
        error_dialog = QMessageBox()
        error_dialog.setIcon(QMessageBox.Icon.Critical)
        error_dialog.setText(&#34;Error&#34;)
        error_dialog.setInformativeText(str(e))
        error_dialog.exec()
        return None</code></pre>
</details>
<div class="desc"><p>Executes an R script provided by the parent object and computes a new column.
This function retrieves data from the parent object, converts it to an R dataframe,
attaches the dataframe in the R environment, runs the R script provided by the parent,
and extracts the newly computed column. If successful, it returns the new column as a
Polars Series. If an error occurs, it displays an error message.
Parameters:
parent (object): The parent object containing the data and the R script to be executed.
It should have the methods <code>get_script()</code> and <code>column_name_input.text()</code>.
Returns:
pl.Series: A Polars Series containing the new column if computation is successful.
None: If an error occurs during the computation.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.compute.run_compute" href="#saePisan.service.compute.run_compute">run_compute</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_1">
                <div class="file-header">
                    <div>ğŸ“„ convert_df</div>
                    <div class="file-path">service/convert_df.html (9.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.convert_df</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.convert_df.convert_df"><code class="name flex">
<span>def <span class="ident">convert_df</span></span>(<span>df, parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def convert_df(df, parent):
    &#34;&#34;&#34;
    Converts a Polars DataFrame to an R DataFrame using rpy2 and handles columns with a high percentage of null values.
    Parameters:
    df (pl.DataFrame): The Polars DataFrame to be converted.
    parent (object): An object that has a method `activate_R()` to activate the R environment.
    Returns:
    None: The function modifies the R global environment by adding the converted DataFrame as &#39;r_df&#39;.
    Notes:
    - Columns with null values exceeding 30% of the DataFrame length are dropped before conversion.
    - The function uses the rpy2_arrow.polars and rpy2.robjects libraries for conversion.
    &#34;&#34;&#34;
    
    import rpy2_arrow.polars as rpy2polars
    import rpy2.robjects as ro
    parent.activate_R()
    
    null_threshold = 0.3 * len(df)
    cols_to_drop = [col for col in df.columns if df[col].null_count() &gt;= null_threshold]
    if len(cols_to_drop)&gt;0:
        df_pandas = df.to_pandas()
        df = pl.from_pandas(df_pandas)
    
    with rpy2polars.converter.context() as cv_ctx:
        r_df = cv_ctx.py2rpy(df)
        ro.globalenv[&#39;r_df&#39;] = r_df</code></pre>
</details>
<div class="desc"><p>Converts a Polars DataFrame to an R DataFrame using rpy2 and handles columns with a high percentage of null values.
Parameters:
df (pl.DataFrame): The Polars DataFrame to be converted.
parent (object): An object that has a method <code>activate_R()</code> to activate the R environment.
Returns:
None: The function modifies the R global environment by adding the converted DataFrame as 'r_df'.
Notes:
- Columns with null values exceeding 30% of the DataFrame length are dropped before conversion.
- The function uses the rpy2_arrow.polars and rpy2.robjects libraries for conversion.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.convert_df.convert_df" href="#saePisan.service.convert_df.convert_df">convert_df</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_2">
                <div class="file-header">
                    <div>ğŸ“„ CorrelationMatrix</div>
                    <div class="file-path">service/exploration/CorrelationMatrix.html (12.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.exploration.CorrelationMatrix</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.exploration.CorrelationMatrix.run_correlation_matrix"><code class="name flex">
<span>def <span class="ident">run_correlation_matrix</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_correlation_matrix(parent):
    &#34;&#34;&#34;
    Executes a correlation matrix analysis using R and returns the results.
    Parameters:
    parent (object): An object that contains the following attributes:
        - activate_R(): Method to activate R environment.
        - model1: An object with a method get_data() that returns a Polars DataFrame.
        - model2: An object with a method get_data() that returns a Polars DataFrame.
        - r_script: A string containing the R script to be executed.
        - result: A string to store the correlation matrix result.
        - plot: A list to store the path of the generated correlation plot.
        - error: A boolean to indicate if an error occurred.
    The function performs the following steps:
    1. Activates the R environment.
    2. Retrieves data from model1 and model2, concatenates them, and removes null values.
    3. Converts the Polars DataFrame to an R DataFrame.
    4. Loads necessary R libraries and prepares the data in R.
    5. Executes the provided R script to generate the correlation matrix.
    6. Captures the correlation matrix result and stores it in the parent.result attribute.
    7. Checks if a correlation plot is generated and saves it to a file if it exists.
    8. Handles any exceptions by setting the parent.error attribute and storing the error message in parent.result.
    &#34;&#34;&#34;
    
    import rpy2_arrow.polars as rpy2polars

    # Aktivasi R
    parent.activate_R()
    pandas2ri.activate()

    # Mengambil data dari model1 dan model2
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        # Memuat library R yang diperlukan
        ro.r(&#39;suppressMessages(library(tidyr))&#39;)
        ro.r(&#39;suppressMessages(library(ggcorrplot))&#39;)
        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)

        # Menyiapkan data di R
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)
        ro.r(parent.r_script)

        result_tables = {}
        result_plots = []

        # Daftar metode yang mungkin digunakan
        methods = [&#34;pearson&#34;, &#34;spearman&#34;, &#34;kendall&#34;]

        for method in methods:
            matrix_name = f&#34;correlation_matrix_{method}&#34;
            plot_name = f&#34;correlation_plot_{method}&#34;

            if ro.r(f&#39;exists(&#34;{matrix_name}&#34;)&#39;)[0]:
                # Ambil tabel korelasi
                matrix_df = ro.r(f&#39;as.data.frame({matrix_name})&#39;)
                pandas_df = pandas2ri.rpy2py(matrix_df)
                pandas_df_rounded = pandas_df.round(5)  # Round to 10 decimal places
                correlation_df = pl.from_pandas(pandas_df_rounded)
                result_tables[f&#34;{method.title()} Correlation&#34;] = correlation_df

            if ro.r(f&#39;exists(&#34;{plot_name}&#34;)&#39;)[0]:
                # Simpan plot korelasi ke file
                plot_path = f&#34;{plot_name}.png&#34;
                grdevices.png(file=plot_path, width=800, height=600)
                ro.r(f&#39;print({plot_name})&#39;)
                grdevices.dev_off()
                result_plots.append(plot_path)

        parent.result = result_tables
        parent.plot = result_plots if result_plots else None

    except Exception as e:
        parent.error = True
        parent.result = str(e)</code></pre>
</details>
<div class="desc"><p>Executes a correlation matrix analysis using R and returns the results.
Parameters:
parent (object): An object that contains the following attributes:
- activate_R(): Method to activate R environment.
- model1: An object with a method get_data() that returns a Polars DataFrame.
- model2: An object with a method get_data() that returns a Polars DataFrame.
- r_script: A string containing the R script to be executed.
- result: A string to store the correlation matrix result.
- plot: A list to store the path of the generated correlation plot.
- error: A boolean to indicate if an error occurred.
The function performs the following steps:
1. Activates the R environment.
2. Retrieves data from model1 and model2, concatenates them, and removes null values.
3. Converts the Polars DataFrame to an R DataFrame.
4. Loads necessary R libraries and prepares the data in R.
5. Executes the provided R script to generate the correlation matrix.
6. Captures the correlation matrix result and stores it in the parent.result attribute.
7. Checks if a correlation plot is generated and saves it to a file if it exists.
8. Handles any exceptions by setting the parent.error attribute and storing the error message in parent.result.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.exploration" href="index.html">saePisan.service.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.exploration.CorrelationMatrix.run_correlation_matrix" href="#saePisan.service.exploration.CorrelationMatrix.run_correlation_matrix">run_correlation_matrix</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_3">
                <div class="file-header">
                    <div>ğŸ“„ Multicollinearity</div>
                    <div class="file-path">service/exploration/Multicollinearity.html (12.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.exploration.Multicollinearity</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.exploration.Multicollinearity.run_multicollinearity"><code class="name flex">
<span>def <span class="ident">run_multicollinearity</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_multicollinearity(parent):
    &#34;&#34;&#34;
    Run multicollinearity analysis using R from within a Python environment.
    This function performs the following steps:
    1. Activates R environment.
    2. Retrieves data from two models in the parent object.
    3. Combines the data using Polars and removes any null values.
    4. Converts the Polars DataFrame to an R DataFrame.
    5. Loads the &#39;car&#39; library in R and prepares the data for analysis.
    6. Executes a pre-generated R script stored in the parent object.
    7. Captures and stores the output of the regression model and VIF (Variance Inflation Factor) analysis.
    8. Combines the results and stores them in the parent object.
    Parameters:
    parent (object): An object that contains the models, R script, and attributes to store results and errors.
    Raises:
    ValueError: If no R script has been generated in the parent object.
    Exception: If any other error occurs during the execution, it is caught and stored in the parent object.
    &#34;&#34;&#34;
    pandas2ri.activate()
    parent.activate_R()  # Pastikan R aktif
    # Ambil data dari model
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()

    # Gabungkan data menggunakan Polars
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        ro.r(&#39;suppressMessages(library(car))&#39;)
        ro.r(&#39;suppressMessages(library(tibble))&#39;)  # untuk rownames_to_column

        # Bersihkan environment di R kecuali r_df
        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Jalankan script R dari parent
        ro.r(parent.r_script)

        result = {}

        if parent.reg_model:
            # Ambil formula regresi sebagai teks string
            regression_formula_r = ro.r(&#39;deparse(regression_model$call)&#39;)
            regression_formula = &#34; &#34;.join(regression_formula_r)
            result[&#34;Regression Formula&#34;] = regression_formula

            # Ambil intercept (koefisien), ubah rownames jadi kolom
            ro.r(&#39;intercept_df &lt;- tibble::rownames_to_column(as.data.frame(regression_model$coefficients), var = &#34;Variable&#34;)&#39;)
            intercept_df = ro.r(&#39;intercept_df&#39;)
            intercept_polars = pl.from_pandas(pandas2ri.rpy2py(intercept_df))
            intercept_polars = intercept_polars.with_columns(
                pl.col(&#34;Variable&#34;).str.replace_all(&#34;`&#34;, &#34;&#34;)
            )
            intercept_polars = intercept_polars.rename({&#34;regression_model$coefficients&#34;: &#34;Coefficient&#34;})
            result[&#34;Intercept&#34;] = intercept_polars

        # Ambil VIF dan ubah rownames jadi kolom
        ro.r(&#39;vif_df &lt;- tibble::rownames_to_column(as.data.frame(vif_values), var = &#34;Variable&#34;)&#39;)
        vif_df = ro.r(&#39;vif_df&#39;)
        vif_polars_df = pl.from_pandas(pandas2ri.rpy2py(vif_df))
        vif_polars_df = vif_polars_df.with_columns(
            pl.col(&#34;Variable&#34;).str.replace_all(&#34;`&#34;, &#34;&#34;)
        )
        vif_polars_df = vif_polars_df.rename({&#34;vif_values&#34;: &#34;VIF&#34;})
        result[&#34;VIF Table&#34;] = vif_polars_df

        # Simpan hasil ke parent
        parent.result = result

    except Exception as e:
        parent.error = True
        parent.result = str(e)
        return</code></pre>
</details>
<div class="desc"><p>Run multicollinearity analysis using R from within a Python environment.
This function performs the following steps:
1. Activates R environment.
2. Retrieves data from two models in the parent object.
3. Combines the data using Polars and removes any null values.
4. Converts the Polars DataFrame to an R DataFrame.
5. Loads the 'car' library in R and prepares the data for analysis.
6. Executes a pre-generated R script stored in the parent object.
7. Captures and stores the output of the regression model and VIF (Variance Inflation Factor) analysis.
8. Combines the results and stores them in the parent object.
Parameters:
parent (object): An object that contains the models, R script, and attributes to store results and errors.
Raises:
ValueError: If no R script has been generated in the parent object.
Exception: If any other error occurs during the execution, it is caught and stored in the parent object.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.exploration" href="index.html">saePisan.service.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.exploration.Multicollinearity.run_multicollinearity" href="#saePisan.service.exploration.Multicollinearity.run_multicollinearity">run_multicollinearity</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_4">
                <div class="file-header">
                    <div>ğŸ“„ NormalityTest</div>
                    <div class="file-path">service/exploration/NormalityTest.html (12.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.exploration.NormalityTest</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.exploration.NormalityTest.run_normality_test"><code class="name flex">
<span>def <span class="ident">run_normality_test</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_normality_test(parent):
    &#34;&#34;&#34;
    Runs a normality test on the combined data from two models in the parent object.
    This function performs the following steps:
    1. Activates the R environment.
    2. Retrieves data from two models in the parent object and concatenates them horizontally.
    3. Drops any rows with null values.
    4. Converts the concatenated data to an R dataframe.
    5. Executes an R script provided by the parent object to perform normality tests.
    6. Collects the results of the normality tests and any generated plots.
    Parameters:
    parent (object): An object that contains the following attributes:
        - activate_R(): A method to activate the R environment.
        - model1: An object with a get_data() method that returns a dataframe.
        - model2: An object with a get_data() method that returns a dataframe.
        - r_script (str): An R script to be executed.
        - selected_columns (list): A list of column names to be tested for normality.
        - result (str): A string to store the results of the normality tests.
        - plot (list): A list to store the paths of generated plots.
        - error (bool): A boolean to indicate if an error occurred.
    Raises:
    Exception: If any error occurs during the execution of the R script or data processing.
    &#34;&#34;&#34;
    
    parent.activate_R()
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)
        ro.r(&#39;suppressMessages(library(nortest))&#39;)
        ro.r(&#39;suppressMessages(library(tseries))&#39;)
        ro.r(&#39;suppressMessages(library(ggplot2))&#39;)

        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        script = parent.r_script
        ro.r(script)

        selected_vars = parent.selected_columns
        plot_paths = []  
        test_names = [&#34;shapiro&#34;, &#34;jarque&#34;, &#34;lilliefors&#34;]

        # Prepare data containers
        shapiro_data = []
        jarque_data = []
        lillie_data = []

        test_map = {
            &#34;shapiro&#34;: shapiro_data,
            &#34;jarque&#34;: jarque_data,
            &#34;lilliefors&#34;: lillie_data
        }

        for var in selected_vars:

            safe_var = var.replace(&#34; &#34;, &#34;_&#34;)

            for test in test_names:
                result_key = f&#34;normality_results_{safe_var}_{test}&#34;
                if ro.r(f&#34;exists(&#39;{result_key}&#39;)&#34;)[0]:
                    stat = ro.r(f&#34;{result_key}$statistic&#34;)[0]
                    pval = ro.r(f&#34;{result_key}$p.value&#34;)[0]
                    test_map[test].append({
                        &#34;Variable Name&#34;: var,
                        &#34;Statistic&#34;: stat,
                        &#34;P-Value&#34;: pval
                    })

            # Save plots if available
            for plot_type in [&#34;histogram&#34;, &#34;qqplot&#34;]:
                plot_name = f&#34;{plot_type}_{safe_var}&#34;
                if ro.r(f&#34;exists(&#39;{plot_name}&#39;)&#34;)[0]:
                    plot_path = f&#34;temp_{plot_name}.png&#34;
                    grdevices.png(file=plot_path, width=800, height=600)
                    ro.r(f&#34;print({plot_name})&#34;)
                    grdevices.dev_off()
                    plot_paths.append(plot_path)

        # Build parent.result only with non-empty tables
        result_dict = {}
        if shapiro_data:
            result_dict[&#34;Shapiro Test Results&#34;] = pl.DataFrame(shapiro_data)
        if jarque_data:
            result_dict[&#34;Jarque Test Results&#34;] = pl.DataFrame(jarque_data)
        if lillie_data:
            result_dict[&#34;Lilliefors Test Results&#34;] = pl.DataFrame(lillie_data)

        parent.result = result_dict
        parent.plot = plot_paths if plot_paths else None

        
    except Exception as e:
        parent.result = str(e)
        parent.error = True</code></pre>
</details>
<div class="desc"><p>Runs a normality test on the combined data from two models in the parent object.
This function performs the following steps:
1. Activates the R environment.
2. Retrieves data from two models in the parent object and concatenates them horizontally.
3. Drops any rows with null values.
4. Converts the concatenated data to an R dataframe.
5. Executes an R script provided by the parent object to perform normality tests.
6. Collects the results of the normality tests and any generated plots.
Parameters:
parent (object): An object that contains the following attributes:
- activate_R(): A method to activate the R environment.
- model1: An object with a get_data() method that returns a dataframe.
- model2: An object with a get_data() method that returns a dataframe.
- r_script (str): An R script to be executed.
- selected_columns (list): A list of column names to be tested for normality.
- result (str): A string to store the results of the normality tests.
- plot (list): A list to store the paths of generated plots.
- error (bool): A boolean to indicate if an error occurred.
Raises:
Exception: If any error occurs during the execution of the R script or data processing.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.exploration" href="index.html">saePisan.service.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.exploration.NormalityTest.run_normality_test" href="#saePisan.service.exploration.NormalityTest.run_normality_test">run_normality_test</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_5">
                <div class="file-header">
                    <div>ğŸ“„ SummaryData</div>
                    <div class="file-path">service/exploration/SummaryData.html (15.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.exploration.SummaryData</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.exploration.SummaryData.extract_formatted_multiple"><code class="name flex">
<span>def <span class="ident">extract_formatted_multiple</span></span>(<span>r_output:Â str) â€‘>Â tuple[polars.dataframe.frame.DataFrame,Â polars.dataframe.frame.DataFrame]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_formatted_multiple(r_output: str) -&gt; tuple[pl.DataFrame, pl.DataFrame]:
    # Clean r_output and split into lines
    lines = r_output.strip().strip(&#34;[]&#34;).split(&#39;\n&#39;)
    lines = [line.strip(&#34; &#39;&#34;) for line in lines if line.strip()]

    # Regex for numeric summary (Min., 1st Qu., ..., Max.)
    pattern_num = r&#39;^\d+\s+([A-Za-z0-9_.\s]+)\s+(Min\.|1st Qu\.|Median|Mean|3rd Qu\.|Max\.|NA\&#39;s)\s*:\s*(&lt;NA&gt;|[-\d.]+)&#39;

    
    # Regex for string summary (Length, Class, Mode)
    pattern_char = r&#39;^\d+\s+([A-Za-z0-9_.\s]+)\s+(Length|Class|Mode)\s*:\s*(.*)&#39;

    stat_label_map = {
        &#34;Min.&#34;: &#34;Minimum&#34;,
        &#34;1st Qu.&#34;: &#34;Quartil 1&#34;,
        &#34;Median&#34;: &#34;Median&#34;,
        &#34;Mean&#34;: &#34;Mean&#34;,
        &#34;3rd Qu.&#34;: &#34;Quartil 3&#34;,
        &#34;Max.&#34;: &#34;Maximum&#34;,
        &#34;NA&#39;s&#34;: &#34;Missing&#34;,
    }

    stat_order = [&#34;Min.&#34;, &#34;1st Qu.&#34;, &#34;Median&#34;, &#34;Mean&#34;, &#34;3rd Qu.&#34;, &#34;Max.&#34;, &#34;NA&#39;s&#34;]
    string_keys = [&#34;Length&#34;, &#34;Class&#34;, &#34;Mode&#34;]

    # Save summary results
    numeric_summary = defaultdict(dict)
    string_summary = defaultdict(dict)

    for line in lines:
        if match := re.match(pattern_num, line):
            var_name = match.group(1).strip()
            stat = match.group(2)
            value_str = match.group(3)
            value = None if value_str == &#34;&lt;NA&gt;&#34; else float(value_str)
            numeric_summary[var_name][stat] = value
        elif match := re.match(pattern_char, line):
            var_name = match.group(1).strip()
            stat = match.group(2)
            value = match.group(3).strip()
            string_summary[var_name][stat] = value


    # Create numeric DataFrame
    num_result = {
        &#34;Variable Name&#34;: [],
        &#34;Minimum&#34;: [],
        &#34;Quartil 1&#34;: [],
        &#34;Median&#34;: [],
        &#34;Mean&#34;: [],
        &#34;Quartil 3&#34;: [],
        &#34;Maximum&#34;: [],
        &#34;Missing&#34;: []

    }

    for var in numeric_summary:
        num_result[&#34;Variable Name&#34;].append(var)
        for stat in stat_order:
            num_result[stat_label_map[stat]].append(numeric_summary[var].get(stat, None))

    # Create string DataFrame
    char_result = {
        &#34;Variable Name&#34;: [],
        &#34;Length&#34;: [],
        &#34;Class&#34;: [],
        &#34;Mode&#34;: []
    }

    for var in string_summary:
        char_result[&#34;Variable Name&#34;].append(var)
        for key in string_keys:
            char_result[key].append(string_summary[var].get(key, None))

    return pl.DataFrame(num_result), pl.DataFrame(char_result)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.exploration.SummaryData.extract_formatted_single"><code class="name flex">
<span>def <span class="ident">extract_formatted_single</span></span>(<span>r_output:Â str, r_script:Â str) â€‘>Â polars.dataframe.frame.DataFrame</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_formatted_single(r_output: str, r_script: str) -&gt; pl.DataFrame:

    # Extract variable name from R script
    pattern = r&#39;(?&lt;=\(&#34;)(.*?)(?=&#34;\))&#39;
    variable_name = re.search(pattern, r_script).group(0)

    # Mapping labels
    mapping = {
        &#34;Min.&#34;: &#34;Minimum&#34;, 
        &#34;1st Qu.&#34;: &#34;Quartile 1&#34;,
        &#34;Median&#34;: &#34;Median&#34;,
        &#34;Mean&#34;: &#34;Mean&#34;,
        &#34;3rd Qu.&#34;: &#34;Quartile 3&#34;,
        &#34;Max.&#34;: &#34;Maximum&#34;,
        &#34;Length&#34;: &#34;Length&#34;,
        &#34;Class&#34;: &#34;Class&#34;,
        &#34;Mode&#34;: &#34;Mode&#34;
    }

    # Clean and split lines
    lines = r_output.strip().split(&#39;\n&#39;)
    lines = [line.strip() for line in lines if line.strip()]

    # Initialize dictionary with Variable Name column
    data = {&#34;Variable Name&#34;: [variable_name]}

    found_stats = set()

    for line in lines:
        parts = line.split()
        if len(parts) &gt;= 3:
            stat = &#34; &#34;.join(parts[1:-1])
            value = parts[-1]
        else:
            continue

        label = mapping.get(stat, stat)
        found_stats.add(label)

        try:
            value = float(value)
        except ValueError:
            value = str(value)

        data[label] = [value]
        
    if &#34;Length&#34; in data and data[&#34;Length&#34;][0] is not None:
        data[&#34;Class&#34;] = [&#34;character&#34;]
        data[&#34;Mode&#34;] = [&#34;character&#34;]

    return pl.DataFrame(data)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.exploration.SummaryData.run_summary_data"><code class="name flex">
<span>def <span class="ident">run_summary_data</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_summary_data(parent):
    &#34;&#34;&#34;
    Run data summary using Python (Polars) and R.
    &#34;&#34;&#34;
    parent.activate_R()

    # Get data from model
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()

    # Combine data using Polars
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        # Set data in R
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Execute R script from parent
        ro.r(parent.r_script)

        # Create summary_table in R
        ro.r(&#39;&#39;&#39;
            if (is.matrix(summary_results)) {
                summary_table &lt;- as.data.frame(summary_results)
            } else if (is.atomic(summary_results)) {
                summary_table &lt;- data.frame(stat = names(summary_results), value = as.numeric(summary_results))
            }
        &#39;&#39;&#39;)

        # Get the number of rows and columns from the summary_table in R
        ncol = int(ro.r(&#39;ncol(summary_table)&#39;)[0])

        # Get the output summary_table as a string
        summary_str = ro.r(&#39;capture.output(print(summary_table))&#39;)
        summary_str_joined = &#34;\n&#34;.join(summary_str)
        print(&#34;[DEBUG] Summary String:&#34;, summary_str_joined)
        parent.result = {}

        if ncol == 2 :
            summary_table = extract_formatted_single(summary_str_joined, parent.r_script)
            parent.result[&#34;Summary Table&#34;] = summary_table
        else:
            # Use extract_summary for multi-variable data
            numeric_df, string_df = extract_formatted_multiple(summary_str_joined)

            if numeric_df.shape[0] &gt; 0:
                parent.result[&#34;Summary Table (Numeric)&#34;] = numeric_df
            if string_df.shape[0] &gt; 0:
                parent.result[&#34;Summary Table (Character)&#34;] = string_df

    except Exception as e:
        parent.result = str(e)
        parent.error = True</code></pre>
</details>
<div class="desc"><p>Run data summary using Python (Polars) and R.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.exploration" href="index.html">saePisan.service.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.exploration.SummaryData.extract_formatted_multiple" href="#saePisan.service.exploration.SummaryData.extract_formatted_multiple">extract_formatted_multiple</a></code></li>
<li><code><a title="saePisan.service.exploration.SummaryData.extract_formatted_single" href="#saePisan.service.exploration.SummaryData.extract_formatted_single">extract_formatted_single</a></code></li>
<li><code><a title="saePisan.service.exploration.SummaryData.run_summary_data" href="#saePisan.service.exploration.SummaryData.run_summary_data">run_summary_data</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_6">
                <div class="file-header">
                    <div>ğŸ“„ VariableSelection</div>
                    <div class="file-path">service/exploration/VariableSelection.html (16.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.exploration.VariableSelection</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.exploration.VariableSelection.extract_formatted"><code class="name flex">
<span>def <span class="ident">extract_formatted</span></span>(<span>r_output:Â str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_formatted(r_output: str):
    lines = r_output.strip().split(&#39;\n&#39;)
    # print(&#34;Lines:&#34;, lines)
    call = &#34;&#34;
    residuals = []
    coef_lines = []
    summary_info = {}

    i = 0
    while i &lt; len(lines):
        line = lines[i].strip()

        # Call
        if line.startswith(&#34;Call:&#34;):
            call = lines[i + 1].strip()
            i += 2
            continue

        # Residuals
        elif line.startswith(&#34;Residuals:&#34;):
            i += 1
            while i &lt; len(lines) and lines[i].strip():
                residuals.append(lines[i].strip())
                i += 1
            continue

        # Coefficients
        elif line.startswith(&#34;Coefficients:&#34;):
            i += 1
            while i &lt; len(lines) and not lines[i].startswith(&#34;---&#34;) and not lines[i].startswith(&#34;Signif. codes:&#34;):
                coef_lines.append(lines[i].strip())
                i += 1
            continue

        # Residual std error
        elif &#34;Residual standard error&#34; in line:
            match = re.search(r&#34;Residual standard error:\s+([\d.]+) on (\d+) degrees of freedom&#34;, line)
            if match:
                summary_info[&#34;Residual Std Error&#34;] = float(match.group(1))
                summary_info[&#34;DF&#34;] = int(match.group(2))

        # R-squared
        elif &#34;Multiple R-squared&#34; in line:
            match = re.search(r&#34;Multiple R-squared:\s+([\d.]+),\s+Adjusted R-squared:\s+([\d.]+)&#34;, line)
            if match:
                summary_info[&#34;R-squared&#34;] = float(match.group(1))
                summary_info[&#34;Adj R-squared&#34;] = float(match.group(2))

        # F-statistic
        elif &#34;F-statistic&#34; in line:
            match = re.search(r&#34;F-statistic:\s+([\d.]+) on (\d+) and (\d+) DF,\s+p-value:\s+([^\s]+)&#34;, line)
            if match:
                summary_info[&#34;F-statistic&#34;] = float(match.group(1))
                summary_info[&#34;DF1&#34;] = int(match.group(2))
                summary_info[&#34;DF2&#34;] = int(match.group(3))
                summary_info[&#34;p-value&#34;] = match.group(4)

        i += 1

    def extract_residuals(residuals: list[str]) -&gt; pl.DataFrame:
        labels = residuals[0].split()
        # Ubah nama kolom sesuai permintaan
        labels = [label.replace(&#34;Min&#34;, &#34;Minimum&#34;).replace(&#34;1Q&#34;, &#34;Quartile 1&#34;).replace(&#34;3Q&#34;, &#34;Quartile 3&#34;).replace(&#34;Max&#34;, &#34;Maximum&#34;) for label in labels]
        values = list(map(float, residuals[1].split()))
        return pl.DataFrame([dict(zip(labels, values))])
    
    residual_df = extract_residuals(residuals)


    def extract_coefficients(coef_lines: list[str]) -&gt; pl.DataFrame:
        import re

        columns = [&#34;Variable&#34;, &#34;Estimate&#34;, &#34;Std. Error&#34;, &#34;t statistic&#34;, &#34;p-value&#34;, &#34;Significance&#34;]
        rows = []

        signif_map = {
            &#39;***&#39;: &#34;Significant at 0.1% level&#34;,
            &#39;**&#39;: &#34;Significant at 1% level&#34;,
            &#39;*&#39;: &#34;Significant at 5% level&#34;,
            &#39;.&#39;: &#34;significant at 10% level&#34;,
            &#39;&#39;: &#34;Not significant at 10% level&#34;
        }

        for line in coef_lines[1:]:
            match = re.match(
                r&#34;^(`[^`]+`|\S+)\s+&#34;  
                r&#34;([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?|\d+)\s+&#34;
                r&#34;([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?|\d+)\s+&#34;
                r&#34;([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?|\d+)\s+&#34;
                r&#34;([&lt;&gt;=]*\s*[\d.eE+-]+)\s*&#34;
                r&#34;(\*\*\*|\*\*|\*|\.|)?&#34;,
                line
            )
            if match:
                variable = match.group(1).strip(&#39;`&#39;)
                estimate = float(match.group(2))
                std_error = float(match.group(3))
                t_value = float(match.group(4))
                p_value = match.group(5).strip()
                signif_code = match.group(6).strip() if match.group(6) else &#39;&#39;
                significance = signif_map.get(signif_code, &#34;Not significant&#34;)

                rows.append({
                    &#34;Variable&#34;: variable,
                    &#34;Estimate&#34;: estimate,
                    &#34;Std. Error&#34;: std_error,
                    &#34;t statistic&#34;: t_value,
                    &#34;P-value&#34;: p_value,
                    &#34;Significance&#34;: significance
                })

        return pl.DataFrame(rows)
    coef_df = extract_coefficients(coef_lines)

    def summary_info_to_table(summary_info: dict) -&gt; pl.DataFrame:
        &#34;&#34;&#34;
        Convert summary info dictionary to a Polars DataFrame with float values.
        &#34;&#34;&#34;
        return pl.DataFrame({
            &#34;Description&#34;: list(summary_info.keys()),
            &#34;Value&#34;: [float(v) for v in summary_info.values()]
        })

    summary_table = summary_info_to_table(summary_info)
    # print(&#34;Call:&#34;, call)
    # print(&#34;Residuals DataFrame:&#34;, residual_df)
    # print(&#34;Coefficients DataFrame:&#34;, coef_df)
    # print(&#34;Summary Table:&#34;, summary_table)

    return {
        &#34;call&#34;: call,
        &#34;residuals&#34;: residual_df,
        &#34;coefficients&#34;: coef_df,
        &#34;summary&#34;: summary_table,
    }</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.exploration.VariableSelection.run_variable_selection"><code class="name flex">
<span>def <span class="ident">run_variable_selection</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_variable_selection(parent):
    parent.activate_R()

    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()

    # Gabungkan dan filter data kosong
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        ro.r(&#39;suppressMessages(library(car))&#39;)
        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Jalankan R script dari parent
        ro.r(parent.r_script)

        result_dict = {}
        existing_objects = list(ro.r(&#34;ls()&#34;))

        # Daftar metode seleksi variabel
        methods = [&#34;forward&#34;, &#34;backward&#34;, &#34;both&#34;]

        method_label_map = {
            &#34;forward&#34;: &#34;Forward&#34;,
            &#34;backward&#34;: &#34;Backward&#34;,
            &#34;both&#34;: &#34;Stepwise&#34;
        }

        for method in methods:
            model_var = f&#34;{method}_model&#34;
            result_var = f&#34;{method}_result&#34;
            prefix = method_label_map[method]  


            if model_var in existing_objects:
                # 1. ANOVA Table
                try:
                    anova_r = ro.r(f&#34;{model_var}$anova&#34;)
                    anova_pd = pandas2ri.rpy2py(anova_r)
                    if anova_pd.index.name and anova_pd.index.name not in anova_pd.columns:
                        anova_pd = anova_pd.reset_index()
                    if &#39;Step&#39; in anova_pd.columns:
                        anova_pd[&#39;Step&#39;] = anova_pd[&#39;Step&#39;].astype(str).str.replace(&#39;`&#39;, &#39;&#39;, regex=False)
                    result_dict[f&#34;Anova {method.capitalize()} Selection&#34;] = pl.from_pandas(anova_pd)
                except Exception as e:
                    result_dict[f&#34;Anova {method.capitalize()} Selection&#34;] = f&#34;[ERROR] {e}&#34;
            if result_var in existing_objects:
                try:
                    # Tangkap output summary sebagai string
                    summary_text = ro.r(f&#39;capture.output(print({result_var}))&#39;)
                    summary_text_joined = &#34;\n&#34;.join(summary_text)
                    # print(f&#34;Summary Text for {method}:&#34;, summary_text_joined)
                    parsed = extract_formatted(summary_text_joined)

                    # Masukkan ke result_dict satu per satu dengan key terpisah
                    result_dict[f&#34;Regression Model {prefix} Selection&#34;] = parsed[&#34;call&#34;]
                    result_dict[f&#34;Residual {prefix} Selection&#34;] = parsed[&#34;residuals&#34;]
                    result_dict[f&#34;Coefficients {prefix} Selection&#34;] = parsed[&#34;coefficients&#34;]
                    result_dict[f&#34;Summary {prefix} Selection&#34;] = parsed[&#34;summary&#34;]

                except Exception as e:
                    result_dict[f&#34;Regression Summary {prefix} Selection&#34;] = f&#34;[ERROR] {e}&#34;

            parent.result = result_dict

    except Exception as e:
        parent.error = True
        parent.result = str(e)
        return</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.exploration" href="index.html">saePisan.service.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.exploration.VariableSelection.extract_formatted" href="#saePisan.service.exploration.VariableSelection.extract_formatted">extract_formatted</a></code></li>
<li><code><a title="saePisan.service.exploration.VariableSelection.run_variable_selection" href="#saePisan.service.exploration.VariableSelection.run_variable_selection">run_variable_selection</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_7">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/exploration/index.html (8.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.exploration</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.exploration.CorrelationMatrix" href="CorrelationMatrix.html">saePisan.service.exploration.CorrelationMatrix</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.exploration.Multicollinearity" href="Multicollinearity.html">saePisan.service.exploration.Multicollinearity</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.exploration.NormalityTest" href="NormalityTest.html">saePisan.service.exploration.NormalityTest</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.exploration.SummaryData" href="SummaryData.html">saePisan.service.exploration.SummaryData</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.exploration.VariableSelection" href="VariableSelection.html">saePisan.service.exploration.VariableSelection</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.exploration.CorrelationMatrix" href="CorrelationMatrix.html">saePisan.service.exploration.CorrelationMatrix</a></code></li>
<li><code><a title="saePisan.service.exploration.Multicollinearity" href="Multicollinearity.html">saePisan.service.exploration.Multicollinearity</a></code></li>
<li><code><a title="saePisan.service.exploration.NormalityTest" href="NormalityTest.html">saePisan.service.exploration.NormalityTest</a></code></li>
<li><code><a title="saePisan.service.exploration.SummaryData" href="SummaryData.html">saePisan.service.exploration.SummaryData</a></code></li>
<li><code><a title="saePisan.service.exploration.VariableSelection" href="VariableSelection.html">saePisan.service.exploration.VariableSelection</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_8">
                <div class="file-header">
                    <div>ğŸ“„ BoxPlot</div>
                    <div class="file-path">service/graph/BoxPlot.html (11.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.graph.BoxPlot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.graph.BoxPlot.run_box_plot"><code class="name flex">
<span>def <span class="ident">run_box_plot</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_box_plot(parent):
    &#34;&#34;&#34;
    Executes a box plot generation process using R and Polars DataFrame.
    This function performs the following steps:
    1. Activates the R environment through the parent object.
    2. Retrieves data from two models in the parent object and concatenates them horizontally.
    3. Removes null values from the concatenated DataFrame.
    4. Converts the Polars DataFrame to an R DataFrame.
    5. Loads required R libraries (ggplot2 and tidyr).
    6. Sets up the data in the R environment.
    7. Executes an R script provided by the parent object.
    8. Retrieves the list of boxplot variables generated in the R environment.
    9. Saves each boxplot as a PNG file and stores the file paths in a list.
    10. Optionally stores the list of plot paths in the parent object.
    Args:
        parent: An object that provides the R environment activation method, data retrieval methods,
                and the R script to be executed. It also stores the resulting plot paths and error information.
    Raises:
        Exception: If any error occurs during the execution, it sets the error flag and result message in the parent object.
    &#34;&#34;&#34;
    
    import rpy2_arrow.polars as rpy2polars

    parent.activate_R()
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        # Load required R libraries
        ro.r(&#39;suppressMessages(library(ggplot2))&#39;)
        ro.r(&#39;suppressMessages(library(tidyr))&#39;)

        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)

        # Set up data in R
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Execute the script created in the dialog
        script = parent.r_script
        ro.r(script)

        # Extract list of boxplot variable names in order of appearance in the script
        boxplot_vars = re.findall(r&#39;boxplot_\w+&#39;, script)
        print(&#34;Boxplot variables (ordered):&#34;, boxplot_vars)

        plot_paths = []

        for plot_name in boxplot_vars:
            # Ensure the directory exists
            appdata_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
            os.makedirs(appdata_dir, exist_ok=True)
            plot_path = os.path.join(appdata_dir, f&#34;{plot_name}.png&#34;)
            grdevices.png(file=plot_path, width=800, height=600)
            ro.r(f&#34;print({plot_name})&#34;)
            grdevices.dev_off()
            plot_paths.append(plot_path)

        print(&#34;Saved boxplots:&#34;, plot_paths)

        # Store the results in parent (optional)
        parent.plot = plot_paths  # All plots are stored in a list

    except Exception as e:
        parent.error = True
        parent.result = str(e)
        return</code></pre>
</details>
<div class="desc"><p>Executes a box plot generation process using R and Polars DataFrame.
This function performs the following steps:
1. Activates the R environment through the parent object.
2. Retrieves data from two models in the parent object and concatenates them horizontally.
3. Removes null values from the concatenated DataFrame.
4. Converts the Polars DataFrame to an R DataFrame.
5. Loads required R libraries (ggplot2 and tidyr).
6. Sets up the data in the R environment.
7. Executes an R script provided by the parent object.
8. Retrieves the list of boxplot variables generated in the R environment.
9. Saves each boxplot as a PNG file and stores the file paths in a list.
10. Optionally stores the list of plot paths in the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that provides the R environment activation method, data retrieval methods,
and the R script to be executed. It also stores the resulting plot paths and error information.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>Exception</code></dt>
<dd>If any error occurs during the execution, it sets the error flag and result message in the parent object.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.graph" href="index.html">saePisan.service.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.graph.BoxPlot.run_box_plot" href="#saePisan.service.graph.BoxPlot.run_box_plot">run_box_plot</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_4_9">
                <div class="file-header">
                    <div>ğŸ“„ Histogram</div>
                    <div class="file-path">service/graph/Histogram.html (12.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.graph.Histogram</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.graph.Histogram.run_histogram"><code class="name flex">
<span>def <span class="ident">run_histogram</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_histogram(parent):
    &#34;&#34;&#34;
    Executes an R script to generate histograms from data in a Polars DataFrame.
    This function performs the following steps:
    1. Activates the R environment using the parent object&#39;s `activate_R` method.
    2. Retrieves data from two models in the parent object and concatenates them into a single Polars DataFrame.
    3. Drops any null values from the DataFrame.
    4. Converts the Polars DataFrame to an R DataFrame and assigns it to the R global environment.
    5. Loads required R libraries (`ggplot2` and `tidyr`).
    6. Sets up the data in R and executes a script provided by the parent object.
    7. Identifies histogram variables created by the script in the R environment.
    8. Generates PNG files for each histogram and stores their paths in the parent object&#39;s `plot` attribute.
    9. Handles any exceptions by setting the parent object&#39;s `error` attribute to True and storing the error message in the `result` attribute.
    Args:
        parent (object): An object that contains methods and attributes required for the function, including:
            - `activate_R()`: Method to activate the R environment.
            - `model1.get_data()`: Method to retrieve data from the first model.
            - `model2.get_data()`: Method to retrieve data from the second model.
            - `r_script`: A string containing the R script to be executed.
            - `plot`: Attribute to store the paths of generated histogram PNG files.
            - `error`: Attribute to indicate if an error occurred.
            - `result`: Attribute to store the error message if an exception is raised.
    &#34;&#34;&#34;
    
    import rpy2_arrow.polars as rpy2polars

    parent.activate_R()
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        # Load required R libraries
        ro.r(&#39;suppressMessages(library(ggplot2))&#39;)
        ro.r(&#39;suppressMessages(library(tidyr))&#39;)
        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)

        # Set up data in R
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Execute the script created in the dialog
        script = parent.r_script
        ro.r(script)

        # Retrieve the list of histogram variables in the R environment
        r_objects = ro.r(&#34;ls()&#34;)  # List all objects in R
        histogram_vars = [obj for obj in r_objects if obj.startswith(&#34;histogram_&#34;)]

        plot_paths = []

        for plot_name in histogram_vars:
            appdata_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
            os.makedirs(appdata_dir, exist_ok=True)
            plot_path = os.path.join(appdata_dir, f&#34;{plot_name}.png&#34;)
            grdevices.png(file=plot_path, width=800, height=600)
            ro.r(f&#34;print({plot_name})&#34;)
            grdevices.dev_off()
            plot_paths.append(plot_path)

        parent.plot = plot_paths  

    except Exception as e:
        parent.error = True
        parent.result = str(e)
        return</code></pre>
</details>
<div class="desc"><p>Executes an R script to generate histograms from data in a Polars DataFrame.
This function performs the following steps:
1. Activates the R environment using the parent object's <code>activate_R</code> method.
2. Retrieves data from two models in the parent object and concatenates them into a single Polars DataFrame.
3. Drops any null values from the DataFrame.
4. Converts the Polars DataFrame to an R DataFrame and assigns it to the R global environment.
5. Loads required R libraries (<code>ggplot2</code> and <code>tidyr</code>).
6. Sets up the data in R and executes a script provided by the parent object.
7. Identifies histogram variables created by the script in the R environment.
8. Generates PNG files for each histogram and stores their paths in the parent object's <code>plot</code> attribute.
9. Handles any exceptions by setting the parent object's <code>error</code> attribute to True and storing the error message in the <code>result</code> attribute.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>An object that contains methods and attributes required for the function, including:
- <code>activate_R()</code>: Method to activate the R environment.
- <code>model1.get_data()</code>: Method to retrieve data from the first model.
- <code>model2.get_data()</code>: Method to retrieve data from the second model.
- <code>r_script</code>: A string containing the R script to be executed.
- <code>plot</code>: Attribute to store the paths of generated histogram PNG files.
- <code>error</code>: Attribute to indicate if an error occurred.
- <code>result</code>: Attribute to store the error message if an exception is raised.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.graph" href="index.html">saePisan.service.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.graph.Histogram.run_histogram" href="#saePisan.service.graph.Histogram.run_histogram">run_histogram</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_0">
                <div class="file-header">
                    <div>ğŸ“„ Lineplot</div>
                    <div class="file-path">service/graph/Lineplot.html (12.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.graph.Lineplot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.graph.Lineplot.run_lineplot"><code class="name flex">
<span>def <span class="ident">run_lineplot</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_lineplot(parent):
    &#34;&#34;&#34;
    Executes an R script to generate line plots from data in a Polars DataFrame.
    This function performs the following steps:
    1. Activates the R environment in the parent object.
    2. Retrieves data from two models in the parent object and concatenates them horizontally.
    3. Removes null values from the concatenated DataFrame.
    4. Converts the Polars DataFrame to an R DataFrame.
    5. Loads required R libraries (ggplot2 and tidyr).
    6. Sets up the data in the R environment.
    7. Executes an R script provided by the parent object.
    8. Retrieves the list of line plot variables created in the R environment.
    9. Saves each line plot as a PNG file and stores the file paths in the parent object.
    Args:
        parent: An object that contains the following attributes and methods:
            - activate_R(): Method to activate the R environment.
            - model1: An object with a get_data() method that returns a Polars DataFrame.
            - model2: An object with a get_data() method that returns a Polars DataFrame.
            - r_script: A string containing the R script to be executed.
            - plot: An attribute to store the list of plot file paths (optional).
            - error: An attribute to indicate if an error occurred.
            - result: An attribute to store the error message if an error occurred.
    Raises:
        Exception: If any error occurs during the execution of the R script or plot generation.
    &#34;&#34;&#34;
    
    import rpy2_arrow.polars as rpy2polars

    parent.activate_R()
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:
        # Load required R libraries
        ro.r(&#39;suppressMessages(library(ggplot2))&#39;)
        ro.r(&#39;suppressMessages(library(tidyr))&#39;)

        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)

        # Set up data in R
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Execute the script created in the dialog
        script = parent.r_script
        ro.r(script)

        # Retrieve the list of lineplot variables in the R environment
        r_objects = ro.r(&#34;ls()&#34;)  # List all objects in R
        lineplot_vars = [obj for obj in r_objects if obj.startswith(&#34;lineplot_&#34;)]

        plot_paths = []

        for plot_name in lineplot_vars:
            appdata_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
            os.makedirs(appdata_dir, exist_ok=True)
            plot_path = os.path.join(appdata_dir, f&#34;{plot_name}.png&#34;)
            grdevices.png(file=plot_path, width=800, height=600)
            ro.r(f&#34;print({plot_name})&#34;)
            grdevices.dev_off()
            plot_paths.append(plot_path)

        print(&#34;Saved lineplots:&#34;, plot_paths)

        # Store the results in parent (optional)
        parent.plot = plot_paths  # All plots are stored in a list

    except Exception as e:
        parent.error = True
        parent.result = str(e)
        return</code></pre>
</details>
<div class="desc"><p>Executes an R script to generate line plots from data in a Polars DataFrame.
This function performs the following steps:
1. Activates the R environment in the parent object.
2. Retrieves data from two models in the parent object and concatenates them horizontally.
3. Removes null values from the concatenated DataFrame.
4. Converts the Polars DataFrame to an R DataFrame.
5. Loads required R libraries (ggplot2 and tidyr).
6. Sets up the data in the R environment.
7. Executes an R script provided by the parent object.
8. Retrieves the list of line plot variables created in the R environment.
9. Saves each line plot as a PNG file and stores the file paths in the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes and methods:
- activate_R(): Method to activate the R environment.
- model1: An object with a get_data() method that returns a Polars DataFrame.
- model2: An object with a get_data() method that returns a Polars DataFrame.
- r_script: A string containing the R script to be executed.
- plot: An attribute to store the list of plot file paths (optional).
- error: An attribute to indicate if an error occurred.
- result: An attribute to store the error message if an error occurred.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>Exception</code></dt>
<dd>If any error occurs during the execution of the R script or plot generation.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.graph" href="index.html">saePisan.service.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.graph.Lineplot.run_lineplot" href="#saePisan.service.graph.Lineplot.run_lineplot">run_lineplot</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_1">
                <div class="file-header">
                    <div>ğŸ“„ Scatterplot</div>
                    <div class="file-path">service/graph/Scatterplot.html (11.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.graph.Scatterplot</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.graph.Scatterplot.run_scatterplot"><code class="name flex">
<span>def <span class="ident">run_scatterplot</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_scatterplot(parent):
    &#34;&#34;&#34;
    Generates scatterplots using data from two models and saves them as images.
    This function activates the R environment, retrieves data from two models,
    merges the data, converts it to an R DataFrame, and executes an R script
    to generate scatterplots. The scatterplots are then saved as PNG images.
    Args:
        parent: An object that contains the following attributes:
            - activate_R(): A method to activate the R environment.
            - model1: An object with a get_data() method that returns a Polars DataFrame.
            - model2: An object with a get_data() method that returns a Polars DataFrame.
            - r_script: A string containing the R script to be executed.
            - plot: An attribute to store the list of generated plot image paths.
            - error: An attribute to indicate if an error occurred.
            - result: An attribute to store the error message if an error occurred.
    Raises:
        Exception: If any error occurs during the execution, it sets the parent&#39;s
                   error attribute to True and stores the error message in the
                   parent&#39;s result attribute.
    &#34;&#34;&#34;
    
    # Activate R
    parent.activate_R()

    # Get data from model1 and model2
    df1 = parent.model1.get_data()
    df2 = parent.model2.get_data()

    # Merge the data into one dataframe
    df = pl.concat([df1, df2], how=&#34;horizontal&#34;)
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    get_data(parent,df)

    try:

        # Load required R libraries
        ro.r(&#39;suppressMessages(library(GGally))&#39;)
        ro.r(&#39;rm(list=ls()[ls() != &#34;r_df&#34;])&#39;)

        # Set data in R
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)

        # Get the R script created from the dialog
        script = parent.r_script

        # Run the R script
        ro.r(script)

        # Get the list of objects in R
        r_objects = ro.r(&#34;ls()&#34;)  

        # Find scatterplot objects
        scatterplot_vars = [obj for obj in r_objects if obj.startswith(&#34;scatterplot&#34;)]

        plot_paths = []

        # Save scatterplots as images
        for plot_name in scatterplot_vars:
            appdata_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
            os.makedirs(appdata_dir, exist_ok=True)
            plot_path = os.path.join(appdata_dir, f&#34;{plot_name}.png&#34;)
            
            # Specify the output file for the image
            grdevices.png(file=plot_path, width=800, height=600)

            # Print the plot
            ro.r(f&#34;print({plot_name})&#34;)
            
            # Close the image device
            grdevices.dev_off()

            # Save the image path to the list
            plot_paths.append(plot_path)

        # Save the plot results in the parent (optional)
        parent.plot = plot_paths  # All plots are stored in a list

    except Exception as e:
        parent.error = True
        parent.result = str(e)
        print(str(e))
        return</code></pre>
</details>
<div class="desc"><p>Generates scatterplots using data from two models and saves them as images.
This function activates the R environment, retrieves data from two models,
merges the data, converts it to an R DataFrame, and executes an R script
to generate scatterplots. The scatterplots are then saved as PNG images.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes:
- activate_R(): A method to activate the R environment.
- model1: An object with a get_data() method that returns a Polars DataFrame.
- model2: An object with a get_data() method that returns a Polars DataFrame.
- r_script: A string containing the R script to be executed.
- plot: An attribute to store the list of generated plot image paths.
- error: An attribute to indicate if an error occurred.
- result: An attribute to store the error message if an error occurred.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>Exception</code></dt>
<dd>If any error occurs during the execution, it sets the parent's
error attribute to True and stores the error message in the
parent's result attribute.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.graph" href="index.html">saePisan.service.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.graph.Scatterplot.run_scatterplot" href="#saePisan.service.graph.Scatterplot.run_scatterplot">run_scatterplot</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_2">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/graph/index.html (8.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.graph</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.graph.BoxPlot" href="BoxPlot.html">saePisan.service.graph.BoxPlot</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.graph.Histogram" href="Histogram.html">saePisan.service.graph.Histogram</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.graph.Lineplot" href="Lineplot.html">saePisan.service.graph.Lineplot</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.graph.Scatterplot" href="Scatterplot.html">saePisan.service.graph.Scatterplot</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.graph.BoxPlot" href="BoxPlot.html">saePisan.service.graph.BoxPlot</a></code></li>
<li><code><a title="saePisan.service.graph.Histogram" href="Histogram.html">saePisan.service.graph.Histogram</a></code></li>
<li><code><a title="saePisan.service.graph.Lineplot" href="Lineplot.html">saePisan.service.graph.Lineplot</a></code></li>
<li><code><a title="saePisan.service.graph.Scatterplot" href="Scatterplot.html">saePisan.service.graph.Scatterplot</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_3">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/index.html (9.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.EditColumn" href="EditColumn.html">saePisan.service.EditColumn</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.command" href="command/index.html">saePisan.service.command</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.compute" href="compute.html">saePisan.service.compute</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.convert_df" href="convert_df.html">saePisan.service.convert_df</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.exploration" href="exploration/index.html">saePisan.service.exploration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.graph" href="graph/index.html">saePisan.service.graph</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.main" href="main/index.html">saePisan.service.main</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling" href="modelling/index.html">saePisan.service.modelling</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.table" href="table/index.html">saePisan.service.table</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.utils" href="utils/index.html">saePisan.service.utils</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan" href="../index.html">saePisan</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.EditColumn" href="EditColumn.html">saePisan.service.EditColumn</a></code></li>
<li><code><a title="saePisan.service.command" href="command/index.html">saePisan.service.command</a></code></li>
<li><code><a title="saePisan.service.compute" href="compute.html">saePisan.service.compute</a></code></li>
<li><code><a title="saePisan.service.convert_df" href="convert_df.html">saePisan.service.convert_df</a></code></li>
<li><code><a title="saePisan.service.exploration" href="exploration/index.html">saePisan.service.exploration</a></code></li>
<li><code><a title="saePisan.service.graph" href="graph/index.html">saePisan.service.graph</a></code></li>
<li><code><a title="saePisan.service.main" href="main/index.html">saePisan.service.main</a></code></li>
<li><code><a title="saePisan.service.modelling" href="modelling/index.html">saePisan.service.modelling</a></code></li>
<li><code><a title="saePisan.service.table" href="table/index.html">saePisan.service.table</a></code></li>
<li><code><a title="saePisan.service.utils" href="utils/index.html">saePisan.service.utils</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_4">
                <div class="file-header">
                    <div>ğŸ“„ CheckEnviroment</div>
                    <div class="file-path">service/main/CheckEnviroment.html (11.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.main.CheckEnviroment</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.main.CheckEnviroment.check_environment"><code class="name flex">
<span>def <span class="ident">check_environment</span></span>(<span>path, original_path)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def check_environment(path, original_path):
    &#34;&#34;&#34;
    Checks if R version 4.4.2 is installed in the specified environment. If not, it downloads and installs R version 4.4.2.
    Args:
        path (str): The path where R should be installed.
        original_path (str): The original working directory to return to after checking/installing R.
    Raises:
        RuntimeError: If R is not installed or not found in the PATH.
        subprocess.CalledProcessError: If there is an error during the installation process.
    Notes:
        - For Windows, it downloads the R installer and installs it silently.
        - For POSIX systems, it downloads the R source tarball, extracts it, and installs it using `configure`, `make`, and `make install`.
        - Sets the `R_HOME` environment variable to the specified path.
    &#34;&#34;&#34;
    
    r_path = os.path.join(path, &#34;bin&#34;)
    try:
        os.chdir(r_path)
        output = subprocess.check_output([&#39;r&#39;, &#39;--version&#39;], stderr=subprocess.STDOUT)
    except subprocess.CalledProcessError as e:
        raise RuntimeError(&#34;R is not installed or not found in PATH.&#34;)
    finally:
        os.chdir(original_path)
    
    if b&#34;R version&#34; in output:
        version_line = output.decode().split(&#39;\n&#39;)[0]
        version = version_line.split()[2]
    
    if (b&#34;R version&#34; not in output) or (version != &#34;4.4.2&#34;):
        if os.name == &#39;nt&#39;:
            url = &#34;https://cran.r-project.org/bin/windows/base/R-4.4.2-win.exe&#34;
            installer_path = os.path.join(os.path.expanduser(&#34;~&#34;), &#34;R-latest.exe&#34;)

            subprocess.check_call([&#39;curl&#39;, &#39;-o&#39;, installer_path, url])

            # Define the relative path for the R installation directory
            relative_path = os.path.join(os.path.dirname(__file__), &#39;R&#39;, &#39;R-4.4.2&#39;)

            # Run the installer silently with the correct directory
            for _ in range(20):  # Retry up to 5 times
                try:
                    subprocess.check_call([installer_path, &#39;/SILENT&#39;, f&#39;/DIR={relative_path}&#39;])
                    break
                except subprocess.CalledProcessError as e:
                    if e.errno == errno.EACCES:  # Access error
                        time.sleep(1)  # Wait for 1 second before retrying
                    else:
                        raise
        elif os.name == &#39;posix&#39;:
            url = &#34;https://cran.r-project.org/src/base/R-4/R-4.4.2.tar.gz&#34;
            installer_path = os.path.join(os.path.expanduser(&#34;~&#34;), &#34;R-latest.tar.gz&#34;)
            extract_path = os.path.join(os.path.expanduser(&#34;~&#34;), &#34;R-4.4.2&#34;)

            subprocess.check_call([&#39;curl&#39;, &#39;-o&#39;, installer_path, url])
            subprocess.check_call([&#39;tar&#39;, &#39;-xzf&#39;, installer_path, &#39;-C&#39;, os.path.expanduser(&#34;~&#34;)])

            # Configure and install R
            os.chdir(extract_path)
            subprocess.check_call([&#39;./configure&#39;, &#39;--prefix=&#39; + path])
            subprocess.check_call([&#39;make&#39;])
            subprocess.check_call([&#39;make&#39;, &#39;install&#39;])
    os.environ[&#39;R_HOME&#39;] = path</code></pre>
</details>
<div class="desc"><p>Checks if R version 4.4.2 is installed in the specified environment. If not, it downloads and installs R version 4.4.2.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path where R should be installed.</dd>
<dt><strong><code>original_path</code></strong> :&ensp;<code>str</code></dt>
<dd>The original working directory to return to after checking/installing R.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>RuntimeError</code></dt>
<dd>If R is not installed or not found in the PATH.</dd>
<dt><code>subprocess.CalledProcessError</code></dt>
<dd>If there is an error during the installation process.</dd>
</dl>
<h2 id="notes">Notes</h2>
<ul>
<li>For Windows, it downloads the R installer and installs it silently.</li>
<li>For POSIX systems, it downloads the R source tarball, extracts it, and installs it using <code>configure</code>, <code>make</code>, and <code>make install</code>.</li>
<li>Sets the <code>R_HOME</code> environment variable to the specified path.</li>
</ul></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.main" href="index.html">saePisan.service.main</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.main.CheckEnviroment.check_environment" href="#saePisan.service.main.CheckEnviroment.check_environment">check_environment</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_5">
                <div class="file-header">
                    <div>ğŸ“„ LoadingR</div>
                    <div class="file-path">service/main/LoadingR.html (10.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.main.LoadingR</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.main.LoadingR.loadR"><code class="name flex">
<span>def <span class="ident">loadR</span></span>(<span>splash)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def loadR(splash):
    &#34;&#34;&#34;Loads and installs necessary R packages for the application.
    This function updates the splash screen message, activates the pandas2ri interface,
    and runs an R script to install required R packages if they are not already installed.
    The R packages include &#39;sae&#39;, &#39;arrow&#39;, &#39;sae.projection&#39;, &#39;emdi&#39;, &#39;xgboost&#39;, &#39;LiblineaR&#39;,
    &#39;kernlab&#39;, &#39;GGally&#39;, &#39;ggplot2&#39;, &#39;ggcorrplot&#39;, &#39;car&#39;, and &#39;polars&#39;.
    Args:
        splash: An object that handles the splash screen updates.
    Returns:
        None&#34;&#34;&#34;
    
    splash.update_message()
    pandas2ri.activate()
    from rpy2.robjects.packages import importr, isinstalled
    utils = importr(&#39;utils&#39;)
    r_home = str(ro.r(&#39;Sys.getenv(&#34;R_HOME&#34;)&#39;)[0])
    os.environ[&#39;R_LIBS_USER&#39;] = r_home
    # Initialize rpy2 with the new library location
    ro.r(f&#39;.libPaths(&#34;{r_home}&#34;)&#39;)
    lib_path = str(ro.r(&#39;.libPaths()[1]&#39;)[0])
    os.environ[&#39;R_LIBS_USER&#39;] = lib_path
    ro.r(f&#39;.libPaths(&#34;{lib_path}&#34;)&#39;)
    packages = [
        &#34;sae&#34;, &#34;arrow&#34;, &#34;sae.projection&#34;, &#34;emdi&#34;, &#34;xgboost&#34;, &#34;LiblineaR&#34;,
        &#34;kernlab&#34;, &#34;GGally&#34;, &#34;ggplot2&#34;, &#34;ggcorrplot&#34;, &#34;car&#34;, &#34;nortest&#34;,
        &#34;tidyr&#34;, &#34;carData&#34;, &#34;dplyr&#34;, &#34;tseries&#34;, &#34;FSelector&#34;, &#34;glmnet&#34;, &#34;Rcpp&#34;, &#34;lme4&#34;
    ]
    # Install CRAN packages if not installed
    for pkg in packages:
        if not isinstalled(pkg):
            utils.install_packages(pkg, lib=lib_path)
    # Install &#39;polars&#39; from R-multiverse if not installed
    if not isinstalled(&#34;polars&#34;):
        utils.install_packages(&#34;polars&#34;, repos=&#34;https://community.r-multiverse.org&#34;, lib=lib_path)
    splash.update_message()
    importr(&#39;sae&#39;, lib_loc=lib_path)
    importr(&#39;saeHB&#39;, lib_loc=lib_path)
    importr(&#39;emdi&#39;, lib_loc=lib_path)
    importr(&#39;sae.projection&#39;, lib_loc=lib_path)
    splash.update_message()</code></pre>
</details>
<div class="desc"><p>Loads and installs necessary R packages for the application.
This function updates the splash screen message, activates the pandas2ri interface,
and runs an R script to install required R packages if they are not already installed.
The R packages include 'sae', 'arrow', 'sae.projection', 'emdi', 'xgboost', 'LiblineaR',
'kernlab', 'GGally', 'ggplot2', 'ggcorrplot', 'car', and 'polars'.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>splash</code></strong></dt>
<dd>An object that handles the splash screen updates.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.main" href="index.html">saePisan.service.main</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.main.LoadingR.loadR" href="#saePisan.service.main.LoadingR.loadR">loadR</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_6">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/main/index.html (7.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.main</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.main.CheckEnviroment" href="CheckEnviroment.html">saePisan.service.main.CheckEnviroment</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.main.LoadingR" href="LoadingR.html">saePisan.service.main.LoadingR</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.main.CheckEnviroment" href="CheckEnviroment.html">saePisan.service.main.CheckEnviroment</a></code></li>
<li><code><a title="saePisan.service.main.LoadingR" href="LoadingR.html">saePisan.service.main.LoadingR</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_7">
                <div class="file-header">
                    <div>ğŸ“„ ProjectionService</div>
                    <div class="file-path">service/modelling/ProjectionService.html (65.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.ProjectionService</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.ProjectionService.assign_as_factor"><code class="name flex">
<span>def <span class="ident">assign_as_factor</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_as_factor(parent):
    &#34;&#34;&#34;
    Assigns selected variables as factors and updates the parent object&#39;s factor list and model.
    Args:
        parent: The parent object containing the variables list and factor list.
    The function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. Extracts the data from the selected indexes and adds them to a new list of variables.
    3. Updates the parent&#39;s factor variable list by adding new variables if they are not already present.
    4. Updates the parent&#39;s factor model with the new factor variable list.
    5. Removes the selected variables from the parent&#39;s variables list.
    6. Calls the `show_r_script` function to update the R script display.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        old_var = parent.as_factor_var[0] if parent.as_factor_var else None
        last_index = selected_indexes[-1]  # Get the last selected index
        new_var = last_index.data()  # Get the data of the last selected variable
        parent.as_factor_var = [new_var]  # Assign only the last variable
        parent.as_factor_model.setStringList(parent.as_factor_var)
        parent.variables_list.model().removeRow(last_index.row())  # Remove the last selected variable from the list
        if old_var:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns selected variables as factors and updates the parent object's factor list and model.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list and factor list.</dd>
</dl>
<p>The function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. Extracts the data from the selected indexes and adds them to a new list of variables.
3. Updates the parent's factor variable list by adding new variables if they are not already present.
4. Updates the parent's factor model with the new factor variable list.
5. Removes the selected variables from the parent's variables list.
6. Calls the <code><a title="saePisan.service.modelling.ProjectionService.show_r_script" href="#saePisan.service.modelling.ProjectionService.show_r_script">show_r_script()</a></code> function to update the R script display.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.assign_auxilary"><code class="name flex">
<span>def <span class="ident">assign_auxilary</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_auxilary(parent):
    &#34;&#34;&#34;
    Assigns selected auxiliary variables from the parent object&#39;s variables list to its auxiliary variables list.
    Parameters:
    parent (object): The parent object containing the variables list and auxiliary variables list.
    Functionality:
    - Retrieves the selected indexes from the parent&#39;s variables list.
    - Filters out non-numeric variables from the selected indexes.
    - If no valid numeric variables are selected, displays a warning message.
    - Adds the new numeric variables to the parent&#39;s auxiliary variables list, ensuring no duplicates.
    - Updates the parent&#39;s auxiliary model with the new list of auxiliary variables.
    - Removes the selected variables from the parent&#39;s variables list.
    - Calls the show_r_script function with the parent object.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                new_vars.append(index.data())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid numeric variables selected. Please select at least one numeric variable.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.auxilary_vars = list(set(parent.auxilary_vars + new_vars))  # Add new variables if they are different
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns selected auxiliary variables from the parent object's variables list to its auxiliary variables list.
Parameters:
parent (object): The parent object containing the variables list and auxiliary variables list.
Functionality:
- Retrieves the selected indexes from the parent's variables list.
- Filters out non-numeric variables from the selected indexes.
- If no valid numeric variables are selected, displays a warning message.
- Adds the new numeric variables to the parent's auxiliary variables list, ensuring no duplicates.
- Updates the parent's auxiliary model with the new list of auxiliary variables.
- Removes the selected variables from the parent's variables list.
- Calls the show_r_script function with the parent object.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.assign_domains"><code class="name flex">
<span>def <span class="ident">assign_domains</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_domains(parent):
    &#34;&#34;&#34;
    Assigns one or more selected domain variables from the variables list to the domain model.
    Parameters:
    parent (object): The parent object containing the variables list and domain model.
    The function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. If there are selected indexes, assigns all selected variables to the parent&#39;s domain variable list.
    3. Updates the parent&#39;s domain model with the selected domain variables.
    4. Removes the selected variables from the parent&#39;s variables list.
    5. Calls the show_r_script function with the parent object.
    &#34;&#34;&#34;
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = [index.data() for index in selected_indexes]
        parent.domain_var = list(set(parent.domain_var + new_vars))
        parent.domain_model.setStringList(parent.domain_var)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns one or more selected domain variables from the variables list to the domain model.
Parameters:
parent (object): The parent object containing the variables list and domain model.
The function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. If there are selected indexes, assigns all selected variables to the parent's domain variable list.
3. Updates the parent's domain model with the selected domain variables.
4. Removes the selected variables from the parent's variables list.
5. Calls the show_r_script function with the parent object.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.assign_index"><code class="name flex">
<span>def <span class="ident">assign_index</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_index(parent):
    &#34;&#34;&#34;
    Assigns the selected index from the variables list to the index variable of the parent object,
    updates the index model with the new index, removes the selected index from the variables list,
    and calls the show_r_script function.
    Args:
        parent: An object that contains the following attributes:
            - variables_list: A QListView or similar widget that holds the list of variables.
            - index_var: A list to store the selected index data.
            - index_model: A QStringListModel or similar model to update with the new index.
    Returns:
        None
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        for index in selected_indexes:
            old_var = parent.index_var[0] if parent.index_var else None
            parent.index_var = [index.data()]
            parent.index_model.setStringList(parent.index_var)
            parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
            if old_var:
                parent.variables_list.model().insertRow(0)
                parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
            show_r_script(parent)
            break</code></pre>
</details>
<div class="desc"><p>Assigns the selected index from the variables list to the index variable of the parent object,
updates the index model with the new index, removes the selected index from the variables list,
and calls the show_r_script function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes:
- variables_list: A QListView or similar widget that holds the list of variables.
- index_var: A list to store the selected index data.
- index_model: A QStringListModel or similar model to update with the new index.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.assign_of_interest"><code class="name flex">
<span>def <span class="ident">assign_of_interest</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_of_interest(parent):
    &#34;&#34;&#34;
    Assigns the variable of interest from the selected indexes in the variables list.
    This function checks the selected variables in the `variables_list` of the `parent` object.
    If the selected variable is of type &#34;String&#34; and the projection method is &#34;Linear&#34;, it shows a warning message.
    Otherwise, it assigns the selected variable as the variable of interest, updates the `of_interest_model`,
    removes the variable from the `variables_list`, and calls the `show_r_script` function.
    Args:
        parent: The parent object containing the variables list, projection method, and other related attributes.
    Raises:
        QMessageBox: Displays a warning message if all selected variables are of type &#34;String&#34; and the projection method is &#34;Linear&#34;.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = False
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var == &#34;String&#34; and parent.projection_method == &#34;Linear&#34;:
                all_string = True
                break
            else:
                all_string = False
                old_var = parent.of_interest_var[0] if parent.of_interest_var else None
                parent.of_interest_var = [index.data()]
                parent.of_interest_model.setStringList(parent.of_interest_var)
                parent.variables_list.model().removeRow(index.row())
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Variable of interest must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns the variable of interest from the selected indexes in the variables list.
This function checks the selected variables in the <code>variables_list</code> of the <code>parent</code> object.
If the selected variable is of type "String" and the projection method is "Linear", it shows a warning message.
Otherwise, it assigns the selected variable as the variable of interest, updates the <code>of_interest_model</code>,
removes the variable from the <code>variables_list</code>, and calls the <code><a title="saePisan.service.modelling.ProjectionService.show_r_script" href="#saePisan.service.modelling.ProjectionService.show_r_script">show_r_script()</a></code> function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list, projection method, and other related attributes.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>QMessageBox</code></dt>
<dd>Displays a warning message if all selected variables are of type "String" and the projection method is "Linear".</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.assign_strata"><code class="name flex">
<span>def <span class="ident">assign_strata</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_strata(parent):
    &#34;&#34;&#34;
    Assigns a selected variable to the strata list and updates the UI components accordingly.
    Args:
        parent: The parent object that contains the UI components and variables list.
    The function performs the following steps:
    1. Retrieves the selected indexes from the variables list.
    2. If there are selected indexes, it assigns the first selected variable to the strata list.
    3. Updates the strata model with the new strata variable.
    4. Removes the selected variable from the variables list.
    5. Calls the show_r_script function to update the R script display.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        old_var = parent.strata_var[0] if parent.strata_var else None
        parent.strata_var = [selected_indexes[0].data()]  # Only one variable
        parent.strata_model.setStringList(parent.strata_var)
        parent.variables_list.model().removeRow(selected_indexes[0].row())  # Remove from variables list
        if old_var:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns a selected variable to the strata list and updates the UI components accordingly.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the UI components and variables list.</dd>
</dl>
<p>The function performs the following steps:
1. Retrieves the selected indexes from the variables list.
2. If there are selected indexes, it assigns the first selected variable to the strata list.
3. Updates the strata model with the new strata variable.
4. Removes the selected variable from the variables list.
5. Calls the show_r_script function to update the R script display.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.assign_weight"><code class="name flex">
<span>def <span class="ident">assign_weight</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_weight(parent):
    &#34;&#34;&#34;
    Assigns a weight variable from the selected indexes in the variables list.
    Parameters:
    parent (object): The parent object containing the variables list and weight model.
    Behavior:
    - Checks the selected indexes in the variables list.
    - If any selected variable is not of type &#34;String&#34;, assigns it as the weight variable.
    - Updates the weight model with the selected weight variable.
    - Removes the selected weight variable from the variables list.
    - Calls the show_r_script function with the parent object.
    - If all selected variables are of type &#34;String&#34;, displays a warning message indicating that the weight variable must be of type Numeric.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.weight_var[0] if parent.weight_var else None
                parent.weight_var = [index.data()]  # Only one variable
                parent.weight_model.setStringList(parent.weight_var)
                parent.variables_list.model().removeRow(index.row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Weight variable must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns a weight variable from the selected indexes in the variables list.
Parameters:
parent (object): The parent object containing the variables list and weight model.
Behavior:
- Checks the selected indexes in the variables list.
- If any selected variable is not of type "String", assigns it as the weight variable.
- Updates the weight model with the selected weight variable.
- Removes the selected weight variable from the variables list.
- Calls the show_r_script function with the parent object.
- If all selected variables are of type "String", displays a warning message indicating that the weight variable must be of type Numeric.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script based on the provided parent object.
    Args:
        parent: An object containing the following attributes:
            - of_interest_var: List of variables of interest.
            - auxilary_vars: List of auxiliary variables.
            - as_factor_var: List of variables to be treated as factors.
            - index_var: List of index variables.
            - domain_var: List of domain variables.
            - weight_var: List of weight variables.
            - strata_var: List of strata variables.
            - projection_method: String specifying the projection method (e.g., &#34;Linear&#34;, &#34;Logistic&#34;, &#34;SVM Linear&#34;, &#34;SVM RBF&#34;, &#34;Neural Network&#34;, &#34;Gradient Boost&#34;).
            - epoch: Integer specifying the number of epochs (used for Neural Network).
            - learning_rate: Float specifying the learning rate (used for Neural Network).
            - var_position: String specifying the position of variables (&#34;After&#34; or &#34;Before&#34;).
            - model_name: String specifying the model name.
            - separator: String specifying the separator to be used.
            - projection_name: String specifying the projection name.
            - selection_method: String specifying the selection method (e.g., &#34;Stepwise&#34;, &#34;None&#34;).
            - metric: String specifying the model metric.
            - k_fold: Integer specifying the number of folds for cross-validation.
            - grid: Grid specification for tuning parameters.
    Returns:
        str: The generated R script as a string.
    &#34;&#34;&#34;
    
    def format_var(var_list, as_factor=False):
        if not var_list:
            return &#39;&#39;
        if as_factor:
            return &#34; + &#34;.join([f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; for var in var_list])
        return &#34; + &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in var_list])

    def format_single_var(var):
        return f&#39;{var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if var else &#39;&#39;

    def format_edit_var(var, prefix):
        return f&#39;{prefix}{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39;
    
    def format_edit_var_before(var, prefix):
        return f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}{prefix}&#39;

    def format_domain_var(domain_var_list):
        if not domain_var_list:
            return &#39;NULL&#39;
        if len(domain_var_list) == 1:
            return f&#39;&#34;{domain_var_list[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#34;&#39;
        else:
            names = [f&#39;&#34;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#34;&#39; for var in domain_var_list]
            return f&#39;c({&#34;, &#34;.join(names)})&#39;
    
    of_interest_var = format_single_var(parent.of_interest_var)
    auxilary_vars = format_var(parent.auxilary_vars)
    as_factor_var = format_var(parent.as_factor_var, as_factor=True)
    index_var = format_single_var(parent.index_var)
    domain_var = format_domain_var(parent.domain_var)
    weight = format_single_var(parent.weight_var)
    strata = format_single_var(parent.strata_var) if parent.strata_var else &#39;NULL&#39;

    model_var = {
        &#34;Linear&#34;: &#34;linear_reg()&#34;,
        &#34;Logistic&#34;: &#34;logistic_reg()&#34;,
        &#34;SVM Linear&#34;: &#34;svm_linear(mode=&#39;classification&#39;)&#34;,
        &#34;SVM RBF&#34;: &#34;svm_rbf(mode=&#39;classification&#39;)&#34;,
        &#34;Neural Network&#34;: f&#34;mlp(mode=&#39;classification&#39;, engine=&#39;nnet&#39;, epochs={parent.epoch}, learn_rate={parent.learning_rate})&#34;
    }.get(parent.projection_method, &#39;gb_model&#39;)

    if auxilary_vars or as_factor_var:
        formula_parts = [of_interest_var]
        if auxilary_vars:
            formula_parts.append(auxilary_vars)
        if as_factor_var:
            formula_parts.append(as_factor_var)
        formula = f&#34;{of_interest_var} ~ {&#39; + &#39;.join(filter(None, formula_parts[1:]))}&#34;
    else:
        formula = f&#34;{of_interest_var} ~ 1&#34;
    
    r_script = f&#39;formula &lt;- {formula}\n&#39;
    if parent.projection_method==&#34;Gradient Boost&#34;:
        r_script += f&#39;show_engines(&#34;boost_tree&#34;)\n&#39;
        r_script += f&#39;gb_model &lt;- boost_tree( mtry = tune(), trees = tune(), min_n = tune(), tree_depth = tune(), learn_rate = tune(), engine = &#34;xgboost&#34;)\n&#39;

    if parent.var_position == &#34;After&#34;:
        if parent.of_interest_var:
            var = parent.of_interest_var[0]
            var_name_edit = format_edit_var(var, parent.model_name + parent.separator)
            if parent.projection_method != &#34;Linear&#34;:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
            else:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.auxilary_vars:
            var_name_edit = format_edit_var(var, parent.model_name + parent.separator)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.as_factor_var:
            var_name_edit = format_edit_var(var, parent.model_name + parent.separator)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
        
        for var in parent.domain_var:
            var_name_edit = format_edit_var(var, parent.model_name + parent.separator)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var, prefix in [(weight, parent.model_name), (strata, parent.model_name), (index_var, parent.model_name)]:
            if var and var != &#39;NULL&#39;:
                var_edit = format_edit_var(var, prefix + parent.separator)
                r_script += f&#39;{var} &lt;- data_pe[[&#34;{var_edit}&#34;]];\n&#39;
                
        all_vars = parent.auxilary_vars + parent.as_factor_var + parent.of_interest_var + parent.domain_var + parent.index_var + parent.strata_var+parent.weight_var
        r_script += f&#39;data_model &lt;- data.frame({&#34;, &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in all_vars])});\n&#39;
        r_script += f&#39;colnames(data_model) &lt;- sub(&#34;^{prefix}\\\\{parent.separator}&#34;, &#34;&#34;, colnames(data_model))\n&#39;
        
        if parent.of_interest_var:
            var = parent.of_interest_var[0]
            var_name_edit = format_edit_var(var, parent.projection_name + parent.separator)
            if parent.projection_method != &#34;Linear&#34;:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
            else:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.auxilary_vars:
            var_name_edit = format_edit_var(var, parent.projection_name + parent.separator)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.as_factor_var:
            var_name_edit = format_edit_var(var, parent.projection_name + parent.separator)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;

        for var in parent.domain_var:
            var_name_edit = format_edit_var(var, parent.projection_name + parent.separator)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var, prefix in [(weight, parent.projection_name), (strata, parent.projection_name), (index_var, parent.projection_name)]:
            if var and var != &#39;NULL&#39;:
                var_edit = format_edit_var(var, prefix + parent.separator)
                r_script += f&#39;{var} &lt;- data_pe[[&#34;{var_edit}&#34;]];\n&#39;

        all_vars = parent.auxilary_vars + parent.as_factor_var + parent.of_interest_var + parent.domain_var + parent.index_var + parent.strata_var+parent.weight_var
        r_script += f&#39;data_proj &lt;- data.frame({&#34;, &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in all_vars])});\n&#39;
        if(parent.projection_method != &#34;Linear&#34;):
            r_script += f&#39;data_model${of_interest_var} &lt;- as.factor(data_model${of_interest_var})\n&#39;
            r_script += f&#39;data_proj${of_interest_var} &lt;- as.factor(data_proj${of_interest_var})\n&#39;
        r_script += f&#39;colnames(data_proj) &lt;- colnames(data_model)\n&#39;
    
    if parent.var_position == &#34;Before&#34;:
        if parent.of_interest_var:
            var = parent.of_interest_var[0]
            var_name_edit = format_edit_var_before(var, parent.separator + parent.model_name)
            if parent.projection_method != &#34;Linear&#34;:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
            else:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.auxilary_vars:
            var_name_edit = format_edit_var_before(var, parent.separator + parent.model_name)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.as_factor_var:
            var_name_edit = format_edit_var_before(var, parent.separator + parent.model_name)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
        
        for var in parent.domain_var:
            var_name_edit = format_edit_var_before(var, parent.separator + parent.model_name)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var, prefix in [(weight, parent.model_name), (strata, parent.model_name), (index_var, parent.model_name)]:
            if var and var != &#39;NULL&#39;:
                var_edit = format_edit_var_before(var, parent.separator + prefix)
                r_script += f&#39;{var} &lt;- data_pe[[&#34;{var_edit}&#34;]];\n&#39;
                
        all_vars = parent.auxilary_vars + parent.as_factor_var + parent.of_interest_var + parent.domain_var + parent.index_var + parent.strata_var+parent.weight_var
        r_script += f&#39;data_model &lt;- data.frame({&#34;, &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in all_vars])});\n&#39;
        r_script += f&#39;colnames(data_model) &lt;- sub(&#34;\\\\{parent.separator}{prefix}$&#34;, &#34;&#34;, colnames(data_model))\n&#39;
        
        if parent.of_interest_var:
            var = parent.of_interest_var[0]
            var_name_edit = format_edit_var_before(var, parent.separator + parent.projection_name)
            if parent.projection_method != &#34;Linear&#34;:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
            else:
                r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.auxilary_vars:
            var_name_edit = format_edit_var_before(var, parent.separator + parent.projection_name)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;
        
        for var in parent.as_factor_var:
            var_name_edit = format_edit_var_before(var, parent.separator + parent.projection_name)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- as.factor(data_pe[[&#34;{var_name_edit}&#34;]]);\n&#39;
        
        for var in parent.domain_var:
            var_name_edit = format_edit_var_before(var, parent.separator + parent.projection_name)
            r_script += f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)} &lt;- data_pe[[&#34;{var_name_edit}&#34;]];\n&#39;    
        
        for var, prefix in [(weight, parent.projection_name), (strata, parent.projection_name), (index_var, parent.projection_name)]:
            if var and var != &#39;NULL&#39;:
                var_edit = format_edit_var_before(var, parent.separator + prefix)
                r_script += f&#39;{var} &lt;- data_pe[[&#34;{var_edit}&#34;]];\n&#39;
        
        all_vars = parent.auxilary_vars + parent.as_factor_var + parent.of_interest_var + parent.domain_var + parent.index_var + parent.strata_var+parent.weight_var
        r_script += f&#39;data_proj &lt;- data.frame({&#34;, &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in all_vars])});\n&#39;
        if(parent.projection_method != &#34;Linear&#34;):
            r_script += f&#39;data_model${of_interest_var} &lt;- as.factor(data_model${of_interest_var})\n&#39;
            r_script += f&#39;data_proj${of_interest_var} &lt;- as.factor(data_proj${of_interest_var})\n&#39;
        r_script += f&#39;colnames(data_proj) &lt;- colnames(data_model)\n&#39;
    
    r_script += f&#39;data_model &lt;- data_model %&gt;% filter(!is.na({of_interest_var}))\n&#39;
    r_script += f&#39;data_proj &lt;- data_proj %&gt;% filter(!is.na({of_interest_var}))\n&#39;
    r_script += f&#39;data_model &lt;- data_model %&gt;% filter(!is.null({of_interest_var}))\n&#39;
    r_script += f&#39;data_proj &lt;- data_proj %&gt;% filter(!is.null({of_interest_var}))\n&#39;
    
    
    if parent.selection_method == &#34;Stepwise&#34;:
        parent.selection_method = &#34;both&#34;
    if parent.selection_method and parent.selection_method != &#34;None&#34; and auxilary_vars:
        r_script += f&#39;stepwise_model &lt;- step(formula, direction=&#34;{parent.selection_method.lower()}&#34;)\n&#39;
        r_script += f&#39;final_formula &lt;- formula(stepwise_model)\n&#39;
        r_script += f&#39;model_pe &lt;- projection(final_formula, id=&#34;{index_var}&#34;, weight=&#34;{weight}&#34;, strata=&#34;{strata}&#34;, domain={domain_var}, model={model_var}, data_model=data_model, data_proj=data_proj, model_metric={parent.metric}, kfold={parent.k_fold}, grid={parent.grid})\n&#39;
    else:
        if strata == &#39;NULL&#39;:
            r_script += f&#39;model_pe &lt;- projection(formula, id=&#34;{index_var}&#34;, weight=&#34;{weight}&#34;, strata={strata}, domain={domain_var}, model={model_var}, data_model=data_model, data_proj=data_proj, model_metric={parent.metric}, kfold={parent.k_fold}, grid={parent.grid})\n&#39;
        else:
            r_script += f&#39;model_pe &lt;- projection(formula, id=&#34;{index_var}&#34;, weight=&#34;{weight}&#34;, strata=&#34;{strata}&#34;, domain={domain_var}, model={model_var}, data_model=data_model, data_proj=data_proj, model_metric={parent.metric}, kfold={parent.k_fold}, grid={parent.grid})\n&#39;
        return r_script</code></pre>
</details>
<div class="desc"><p>Generates an R script based on the provided parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object containing the following attributes:
- of_interest_var: List of variables of interest.
- auxilary_vars: List of auxiliary variables.
- as_factor_var: List of variables to be treated as factors.
- index_var: List of index variables.
- domain_var: List of domain variables.
- weight_var: List of weight variables.
- strata_var: List of strata variables.
- projection_method: String specifying the projection method (e.g., "Linear", "Logistic", "SVM Linear", "SVM RBF", "Neural Network", "Gradient Boost").
- epoch: Integer specifying the number of epochs (used for Neural Network).
- learning_rate: Float specifying the learning rate (used for Neural Network).
- var_position: String specifying the position of variables ("After" or "Before").
- model_name: String specifying the model name.
- separator: String specifying the separator to be used.
- projection_name: String specifying the projection name.
- selection_method: String specifying the selection method (e.g., "Stepwise", "None").
- metric: String specifying the model metric.
- k_fold: Integer specifying the number of folds for cross-validation.
- grid: Grid specification for tuning parameters.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The generated R script as a string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.get_script"><code class="name flex">
<span>def <span class="ident">get_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_script(parent):
    &#34;&#34;&#34;
    Retrieves the text content from the &#39;r_script_edit&#39; attribute of the given parent object.
    Args:
        parent: An object that contains an attribute &#39;r_script_edit&#39; which is expected to be a QTextEdit or similar widget.
    Returns:
        str: The text content of the &#39;r_script_edit&#39; widget as a string.
    &#34;&#34;&#34;
    
    return parent.r_script_edit.toPlainText()  </code></pre>
</details>
<div class="desc"><p>Retrieves the text content from the 'r_script_edit' attribute of the given parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains an attribute 'r_script_edit' which is expected to be a QTextEdit or similar widget.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The text content of the 'r_script_edit' widget as a string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.get_selected_variables"><code class="name flex">
<span>def <span class="ident">get_selected_variables</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_variables(parent):
    &#34;&#34;&#34;
    Retrieve selected variables from the given parent object.
    Args:
        parent (object): An object containing the variables of interest.
    Returns:
        tuple: A tuple containing the following variables from the parent object:
            - of_interest_var: The primary variable of interest.
            - auxilary_vars: Auxiliary variables related to the primary variable.
            - vardir_var: Directional variable.
            - as_factor_var: Factor variable.
    &#34;&#34;&#34;
    
    return parent.of_interest_var, parent.auxilary_vars, parent.vardir_var, parent.as_factor_var</code></pre>
</details>
<div class="desc"><p>Retrieve selected variables from the given parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>An object containing the variables of interest.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>A tuple containing the following variables from the parent object:
- of_interest_var: The primary variable of interest.
- auxilary_vars: Auxiliary variables related to the primary variable.
- vardir_var: Directional variable.
- as_factor_var: Factor variable.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.process_vars"><code class="name flex">
<span>def <span class="ident">process_vars</span></span>(<span>vars_list, prefix, suffix)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def process_vars(vars_list, prefix, suffix):
    &#34;&#34;&#34;
    Processes a list of variable names by modifying them with a given prefix and suffix,
    and generates R script lines to assign these modified variable names to data columns.
    Args:
        vars_list (list of str): List of variable names to be processed.
        prefix (str): Prefix to be added to each variable name.
        suffix (str): Suffix to be added to each variable name.
    Returns:
        None
    &#34;&#34;&#34;
    
    for var in vars_list:
        var_name = var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)
        var_name_edit = f&#34;{prefix}{var_name}{suffix}&#34;
        r_script += f&#39;{var_name} &lt;- data[&#34;{var_name_edit}&#34;];\n&#39;</code></pre>
</details>
<div class="desc"><p>Processes a list of variable names by modifying them with a given prefix and suffix,
and generates R script lines to assign these modified variable names to data columns.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vars_list</code></strong> :&ensp;<code>list</code> of <code>str</code></dt>
<dd>List of variable names to be processed.</dd>
<dt><strong><code>prefix</code></strong> :&ensp;<code>str</code></dt>
<dd>Prefix to be added to each variable name.</dd>
<dt><strong><code>suffix</code></strong> :&ensp;<code>str</code></dt>
<dd>Suffix to be added to each variable name.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.set_selection_method"><code class="name flex">
<span>def <span class="ident">set_selection_method</span></span>(<span>parent, dialog)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_selection_method(parent, dialog):
    &#34;&#34;&#34;
    Sets various selection parameters for the parent object based on the current state of the UI elements,
    and then accepts the dialog and shows the R script.
    Parameters:
    parent (object): The parent object that contains the UI elements and attributes to be set.
    dialog (QDialog): The dialog that will be accepted after setting the parameters.
    Attributes Set on Parent:
    - metric (str): The selected model metric from the model_metric_combo UI element.
    - k_fold (str): The k-fold value from the kfold_edit UI element.
    - grid (str): The grid value from the grid_edit UI element.
    - epoch (str): The epoch value from the epoch_edit UI element.
    - learning_rate (str): The learning rate value from the learning_edit UI element.
    Actions:
    - Accepts the dialog.
    - Calls the show_r_script function with the parent object.
    &#34;&#34;&#34;
    
    # parent.selection_method = parent.method_combo.currentText()
    parent.metric = parent.model_metric_combo.currentText()
    parent.k_fold = parent.kfold_edit.text()
    parent.grid = parent.grid_edit.text()
    parent.epoch = parent.epoch_edit.text()
    parent.learning_rate = parent.learning_edit.text()
    dialog.accept()
    show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Sets various selection parameters for the parent object based on the current state of the UI elements,
and then accepts the dialog and shows the R script.
Parameters:
parent (object): The parent object that contains the UI elements and attributes to be set.
dialog (QDialog): The dialog that will be accepted after setting the parameters.
Attributes Set on Parent:
- metric (str): The selected model metric from the model_metric_combo UI element.
- k_fold (str): The k-fold value from the kfold_edit UI element.
- grid (str): The grid value from the grid_edit UI element.
- epoch (str): The epoch value from the epoch_edit UI element.
- learning_rate (str): The learning rate value from the learning_edit UI element.
Actions:
- Accepts the dialog.
- Calls the show_r_script function with the parent object.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.show_options"><code class="name flex">
<span>def <span class="ident">show_options</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_options(parent):
    &#34;&#34;&#34;
    Displays a dialog window with various options for configuring the projection method.
    Parameters:
    parent (QWidget): The parent widget to which this dialog belongs.
    The dialog includes the following options:
    - Model Metric: A combo box to select the model metric.
    - The number of partitions: A line edit to input the number of partitions (k-fold).
    - Grid: A line edit to input the grid size.
    - Epoch (conditionally visible): A line edit to input the number of epochs, visible only if the projection method is &#34;Neural Network&#34;.
    - Learning Rate (conditionally visible): A line edit to input the learning rate, visible only if the projection method is &#34;Neural Network&#34;.
    The dialog also includes OK and Cancel buttons to confirm or reject the selections.
    The OK button triggers the `set_selection_method` function with the parent and dialog as arguments.
    The Cancel button closes the dialog without saving changes.
    &#34;&#34;&#34;
    
    options_dialog = QDialog(parent)
    options_dialog.setWindowTitle(&#34;Options&#34;)

    layout = QVBoxLayout()

    # method_label = QLabel(&#34;Stepwise Selection Method:&#34;)
    # layout.addWidget(method_label)

    # parent.method_combo = QComboBox()
    # parent.method_combo.addItems([&#34;None&#34;, &#34;Stepwise&#34;, &#34;Forward&#34;, &#34;Backward&#34;])
    # layout.addWidget(parent.method_combo)

    model_metric_label = QLabel(&#34;Model Metric:&#34;)
    layout.addWidget(model_metric_label)

    parent.model_metric_combo = QComboBox()
    parent.model_metric_combo.addItems([&#34;yardstick::metric_set()&#34;, &#34;NULL&#34;])
    parent.model_metric_combo.setCurrentText(&#34;NULL&#34;)
    layout.addWidget(parent.model_metric_combo)

    kfold_label = QLabel(&#34;The number of partitions :&#34;)
    layout.addWidget(kfold_label)

    parent.kfold_edit = QLineEdit()
    parent.kfold_edit.setValidator(QIntValidator())
    parent.kfold_edit.setText(&#34;3&#34;)
    layout.addWidget(parent.kfold_edit)

    grid_label = QLabel(&#34;Grid:&#34;)
    layout.addWidget(grid_label)

    parent.grid_edit = QLineEdit()
    parent.grid_edit.setValidator(QIntValidator())
    parent.grid_edit.setText(&#34;10&#34;)
    layout.addWidget(parent.grid_edit)
    
    epoch_label = QLabel(&#34;Epoch&#34;)
    epoch_label.setVisible(False)
    layout.addWidget(epoch_label)
    
    parent.epoch_edit = QLineEdit()
    parent.epoch_edit.setValidator(QIntValidator())
    parent.epoch_edit.setText(&#34;10&#34;)
    parent.epoch_edit.setVisible(False)
    layout.addWidget(parent.epoch_edit)
    
    learning_label = QLabel(&#34;Learning Rate&#34;)
    learning_label.setVisible(False)
    layout.addWidget(learning_label)
    
    parent.learning_edit = QLineEdit()
    parent.learning_edit.setVisible(False)
    parent.learning_edit.setValidator(QDoubleValidator())
    parent.learning_edit.setText(&#34;0.01&#34;)
    layout.addWidget(parent.learning_edit)
    
    if(parent.projection_method==&#34;Neural Network&#34;):
        epoch_label.setVisible(True)
        parent.epoch_edit.setVisible(True)
        parent.hidden_unit_label.setVisible(True)
        parent.hidden_edit.setVisible(True)
        learning_label.setVisible(True)
        parent.learning_edit.setVisible(True)
    

    button_layout = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    button_layout.addWidget(ok_button)
    button_layout.addWidget(cancel_button)

    layout.addLayout(button_layout)

    options_dialog.setLayout(layout)

    ok_button.clicked.connect(lambda: set_selection_method(parent, options_dialog))
    cancel_button.clicked.connect(options_dialog.reject)

    options_dialog.exec()</code></pre>
</details>
<div class="desc"><p>Displays a dialog window with various options for configuring the projection method.
Parameters:
parent (QWidget): The parent widget to which this dialog belongs.
The dialog includes the following options:
- Model Metric: A combo box to select the model metric.
- The number of partitions: A line edit to input the number of partitions (k-fold).
- Grid: A line edit to input the grid size.
- Epoch (conditionally visible): A line edit to input the number of epochs, visible only if the projection method is "Neural Network".
- Learning Rate (conditionally visible): A line edit to input the learning rate, visible only if the projection method is "Neural Network".
The dialog also includes OK and Cancel buttons to confirm or reject the selections.
The OK button triggers the <code><a title="saePisan.service.modelling.ProjectionService.set_selection_method" href="#saePisan.service.modelling.ProjectionService.set_selection_method">set_selection_method()</a></code> function with the parent and dialog as arguments.
The Cancel button closes the dialog without saving changes.</p></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.show_r_script"><code class="name flex">
<span>def <span class="ident">show_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script based on the given parent object and sets the text of the parent&#39;s R script editor.
    Args:
        parent: The parent object that contains the method to generate the R script and the R script editor.
    &#34;&#34;&#34;
    
    r_script = generate_r_script(parent)
    parent.r_script_edit.setText(r_script)</code></pre>
</details>
<div class="desc"><p>Generates an R script based on the given parent object and sets the text of the parent's R script editor.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the method to generate the R script and the R script editor.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.ProjectionService.unassign_variable"><code class="name flex">
<span>def <span class="ident">unassign_variable</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unassign_variable(parent):
    &#34;&#34;&#34;
    Unassigns selected variables from various lists in the parent object and adds them back to the variables list.
    This function checks for selected indexes in the following lists in order:
    - of_interest_list
    - auxilary_list
    - index_list
    - as_factor_list
    - domain_list
    - strata_list
    - weight_list
    For each list, if there are selected items, it removes the selected items from the corresponding variable list in the parent object,
    updates the model for that list, and adds the items back to the variables list. Finally, it calls the show_r_script function.
    Args:
        parent: The parent object containing the lists and models to be updated.
    &#34;&#34;&#34;
    
    selected_indexes = parent.of_interest_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.of_interest_var = [var for var in parent.of_interest_var if var not in selected_items]
        parent.of_interest_model.setStringList(parent.of_interest_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.auxilary_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.auxilary_vars = [var for var in parent.auxilary_vars if var not in selected_items]
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.index_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.index_var = [var for var in parent.index_var if var not in selected_items]
        parent.index_model.setStringList(parent.index_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.as_factor_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.as_factor_var = [var for var in parent.as_factor_var if var not in selected_items]
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.domain_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.domain_var = [var for var in parent.domain_var if var not in selected_items]
        parent.domain_model.setStringList(parent.domain_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return
    
    selected_indexes = parent.strata_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.strata_var = [var for var in parent.strata_var if var not in selected_items]
        parent.strata_model.setStringList(parent.strata_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.weight_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.weight_var = [var for var in parent.weight_var if var not in selected_items]
        parent.weight_model.setStringList(parent.weight_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return</code></pre>
</details>
<div class="desc"><p>Unassigns selected variables from various lists in the parent object and adds them back to the variables list.
This function checks for selected indexes in the following lists in order:
- of_interest_list
- auxilary_list
- index_list
- as_factor_list
- domain_list
- strata_list
- weight_list
For each list, if there are selected items, it removes the selected items from the corresponding variable list in the parent object,
updates the model for that list, and adds the items back to the variables list. Finally, it calls the show_r_script function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the lists and models to be updated.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling" href="index.html">saePisan.service.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_as_factor" href="#saePisan.service.modelling.ProjectionService.assign_as_factor">assign_as_factor</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_auxilary" href="#saePisan.service.modelling.ProjectionService.assign_auxilary">assign_auxilary</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_domains" href="#saePisan.service.modelling.ProjectionService.assign_domains">assign_domains</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_index" href="#saePisan.service.modelling.ProjectionService.assign_index">assign_index</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_of_interest" href="#saePisan.service.modelling.ProjectionService.assign_of_interest">assign_of_interest</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_strata" href="#saePisan.service.modelling.ProjectionService.assign_strata">assign_strata</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.assign_weight" href="#saePisan.service.modelling.ProjectionService.assign_weight">assign_weight</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.generate_r_script" href="#saePisan.service.modelling.ProjectionService.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.get_script" href="#saePisan.service.modelling.ProjectionService.get_script">get_script</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.get_selected_variables" href="#saePisan.service.modelling.ProjectionService.get_selected_variables">get_selected_variables</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.process_vars" href="#saePisan.service.modelling.ProjectionService.process_vars">process_vars</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.set_selection_method" href="#saePisan.service.modelling.ProjectionService.set_selection_method">set_selection_method</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.show_options" href="#saePisan.service.modelling.ProjectionService.show_options">show_options</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.show_r_script" href="#saePisan.service.modelling.ProjectionService.show_r_script">show_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.ProjectionService.unassign_variable" href="#saePisan.service.modelling.ProjectionService.unassign_variable">unassign_variable</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_8">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupArea</div>
                    <div class="file-path">service/modelling/SaeEblupArea.html (39.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.SaeEblupArea</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.SaeEblupArea.assign_as_factor"><code class="name flex">
<span>def <span class="ident">assign_as_factor</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_as_factor(parent):
    &#34;&#34;&#34;
    Assigns selected variables as factors and updates the parent object&#39;s factor list and model.
    Args:
        parent: An object that contains the following attributes:
            - variables_list: A QListView or similar object with a method selectedIndexes() 
              that returns a list of selected indexes.
            - as_factor_var: A list of variables that are currently assigned as factors.
            - as_factor_model: A QStringListModel or similar object with a method setStringList() 
              that updates the model with a new list of factor variables.
    The function performs the following steps:
        1. Retrieves the selected indexes from the variables_list.
        2. Extracts the data from each selected index and appends it to a new list of variables.
        3. Updates the as_factor_var list with the new variables, ensuring no duplicates.
        4. Updates the as_factor_model with the new list of factor variables.
        5. Removes the selected variables from the variables_list.
        6. Calls the show_r_script function with the parent object as an argument.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            new_vars.append(index.data())
        parent.as_factor_var = list(set(parent.as_factor_var + new_vars))  # Add new variables if they are different
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns selected variables as factors and updates the parent object's factor list and model.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes:
- variables_list: A QListView or similar object with a method selectedIndexes()
that returns a list of selected indexes.
- as_factor_var: A list of variables that are currently assigned as factors.
- as_factor_model: A QStringListModel or similar object with a method setStringList()
that updates the model with a new list of factor variables.</dd>
</dl>
<p>The function performs the following steps:
1. Retrieves the selected indexes from the variables_list.
2. Extracts the data from each selected index and appends it to a new list of variables.
3. Updates the as_factor_var list with the new variables, ensuring no duplicates.
4. Updates the as_factor_model with the new list of factor variables.
5. Removes the selected variables from the variables_list.
6. Calls the show_r_script function with the parent object as an argument.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.assign_auxilary"><code class="name flex">
<span>def <span class="ident">assign_auxilary</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_auxilary(parent):
    &#34;&#34;&#34;
    Assigns auxiliary variables from the selected indexes in the parent&#39;s variables list to the parent&#39;s auxiliary variables list.
    Parameters:
    parent (object): The parent object containing the variables list and auxiliary variables list.
    The function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. Filters out non-numeric variables from the selected indexes.
    3. If no valid numeric variables are selected, displays a warning message and exits the function.
    4. Adds the new numeric variables to the parent&#39;s auxiliary variables list, ensuring no duplicates.
    5. Updates the parent&#39;s auxiliary model with the new list of auxiliary variables.
    6. Removes the selected variables from the parent&#39;s variables list.
    7. Calls the `show_r_script` function to update the R script display.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                new_vars.append(index.data())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid numeric variables selected. Please select at least one numeric variable.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.auxilary_vars = list(set(parent.auxilary_vars + new_vars))  # Add new variables if they are different
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns auxiliary variables from the selected indexes in the parent's variables list to the parent's auxiliary variables list.
Parameters:
parent (object): The parent object containing the variables list and auxiliary variables list.
The function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. Filters out non-numeric variables from the selected indexes.
3. If no valid numeric variables are selected, displays a warning message and exits the function.
4. Adds the new numeric variables to the parent's auxiliary variables list, ensuring no duplicates.
5. Updates the parent's auxiliary model with the new list of auxiliary variables.
6. Removes the selected variables from the parent's variables list.
7. Calls the <code><a title="saePisan.service.modelling.SaeEblupArea.show_r_script" href="#saePisan.service.modelling.SaeEblupArea.show_r_script">show_r_script()</a></code> function to update the R script display.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.assign_of_interest"><code class="name flex">
<span>def <span class="ident">assign_of_interest</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_of_interest(parent):
    &#34;&#34;&#34;
    Assigns the variable of interest from the selected indexes in the variables list.
    This function checks the selected indexes in the `variables_list` of the `parent` object.
    If any of the selected variables is not of type &#34;String&#34;, it assigns that variable as the 
    variable of interest (`of_interest_var`) and updates the `of_interest_model` with this variable.
    It also removes the selected variable from the `variables_list` and calls the `show_r_script` function.
    If all selected variables are of type &#34;String&#34;, it shows a warning message indicating that 
    the variable of interest must be of type Numeric.
    Args:
        parent (object): The parent object containing the `variables_list`, `of_interest_var`, 
                         `of_interest_model`, and other related attributes.
    Raises:
        None
    Returns:
        None
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.of_interest_var[0] if parent.of_interest_var else None
                parent.of_interest_var = [index.data()]
                parent.of_interest_model.setStringList(parent.of_interest_var)
                parent.variables_list.model().removeRow(index.row())
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Variable of interest must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns the variable of interest from the selected indexes in the variables list.
This function checks the selected indexes in the <code>variables_list</code> of the <code>parent</code> object.
If any of the selected variables is not of type "String", it assigns that variable as the
variable of interest (<code>of_interest_var</code>) and updates the <code>of_interest_model</code> with this variable.
It also removes the selected variable from the <code>variables_list</code> and calls the <code><a title="saePisan.service.modelling.SaeEblupArea.show_r_script" href="#saePisan.service.modelling.SaeEblupArea.show_r_script">show_r_script()</a></code> function.
If all selected variables are of type "String", it shows a warning message indicating that
the variable of interest must be of type Numeric.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>The parent object containing the <code>variables_list</code>, <code>of_interest_var</code>,
<code>of_interest_model</code>, and other related attributes.</dd>
</dl>
<h2 id="raises">Raises</h2>
<p>None</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.assign_vardir"><code class="name flex">
<span>def <span class="ident">assign_vardir</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_vardir(parent):
    &#34;&#34;&#34;
    Assigns a variable directory (vardir) from the selected variables in the parent object&#39;s variables list.
    Parameters:
    parent (object): The parent object containing the variables list and vardir attributes.
    Functionality:
    - Checks the selected indexes in the parent&#39;s variables list.
    - If there are selected indexes, it iterates through them to determine the type of each variable.
    - If a variable is not of type &#34;String&#34;, it assigns it to the parent&#39;s vardir_var attribute and updates the vardir_model.
    - Removes the selected variable from the variables list.
    - Calls the show_r_script function with the parent object.
    - If all selected variables are of type &#34;String&#34;, displays a warning message indicating that the vardir variable must be of type Numeric.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.vardir_var[0] if parent.vardir_var else None
                parent.vardir_var = [index.data()]
                parent.vardir_model.setStringList(parent.vardir_var)
                parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Vardir variable must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns a variable directory (vardir) from the selected variables in the parent object's variables list.
Parameters:
parent (object): The parent object containing the variables list and vardir attributes.
Functionality:
- Checks the selected indexes in the parent's variables list.
- If there are selected indexes, it iterates through them to determine the type of each variable.
- If a variable is not of type "String", it assigns it to the parent's vardir_var attribute and updates the vardir_model.
- Removes the selected variable from the variables list.
- Calls the show_r_script function with the parent object.
- If all selected variables are of type "String", displays a warning message indicating that the vardir variable must be of type Numeric.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script for model fitting based on the provided parent object.
    Args:
        parent (object): An object containing the following attributes:
            - of_interest_var (list): A list containing the variable of interest.
            - auxilary_vars (list): A list of auxiliary variables.
            - vardir_var (list): A list containing the variance directory variable.
            - as_factor_var (list): A list of variables to be treated as factors.
            - selection_method (str): The method for variable selection (&#34;Stepwise&#34;, &#34;None&#34;, or other).
            - method (str): The method to be used in the mseFH function.
    Returns:
        str: The generated R script as a string.
    &#34;&#34;&#34;
    
    of_interest_var = f&#39;{parent.of_interest_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.of_interest_var else &#39;&#34;&#34;&#39;
    auxilary_vars = &#34; + &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in parent.auxilary_vars]) if parent.auxilary_vars else &#39;&#34;&#34;&#39;
    vardir_var = f&#39;{parent.vardir_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.vardir_var else &#39;&#34;&#34;&#39;
    as_factor_var = &#34; + &#34;.join([f&#39;as.factor({var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)})&#39; for var in parent.as_factor_var]) if parent.as_factor_var else &#39;&#34;&#34;&#39;
    
    if (auxilary_vars==&#39;&#34;&#34;&#39; or auxilary_vars is None) and as_factor_var==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ 1&#39;
    elif as_factor_var==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ {auxilary_vars}&#39;
    elif auxilary_vars==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ {as_factor_var}&#39;
    else:
        formula = f&#39;{of_interest_var} ~ {auxilary_vars} + {as_factor_var}&#39;

    r_script = f&#39;names(data) &lt;- gsub(&#34; &#34;, &#34;_&#34;, names(data)); #Replace space with underscore\n&#39;
    r_script += f&#39;formula &lt;- {formula}\n&#39;
    r_script += f&#39;vardir_var &lt;- data[&#34;{vardir_var}&#34;]\n&#39;
    if parent.selection_method==&#34;Stepwise&#34;:
        parent.selection_method = &#34;both&#34;
    if parent.selection_method and parent.selection_method != &#34;None&#34; and auxilary_vars:
        r_script += f&#39;stepwise_model &lt;- step(formula, direction=&#34;{parent.selection_method.lower()}&#34;)\n&#39;
        r_script += f&#39;final_formula &lt;- formula(stepwise_model)\n&#39;
        r_script += f&#39;model&lt;-mseFH(final_formula, {vardir_var}, method = &#34;{parent.method}&#34;, data=data)&#39;
    else:
        r_script += f&#39;model&lt;-mseFH(formula, {vardir_var}, method = &#34;{parent.method}&#34;, data=data)&#39;
    return r_script</code></pre>
</details>
<div class="desc"><p>Generates an R script for model fitting based on the provided parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>An object containing the following attributes:
- of_interest_var (list): A list containing the variable of interest.
- auxilary_vars (list): A list of auxiliary variables.
- vardir_var (list): A list containing the variance directory variable.
- as_factor_var (list): A list of variables to be treated as factors.
- selection_method (str): The method for variable selection ("Stepwise", "None", or other).
- method (str): The method to be used in the mseFH function.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The generated R script as a string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.get_script"><code class="name flex">
<span>def <span class="ident">get_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_script(parent):
    &#34;&#34;&#34;
    Retrieves the text content from the &#39;r_script_edit&#39; attribute of the given parent object.
    Args:
        parent: An object that contains an attribute &#39;r_script_edit&#39; which is expected to be a QTextEdit or similar widget.
    Returns:
        str: The text content of the &#39;r_script_edit&#39; widget as a plain string.
    &#34;&#34;&#34;
    
    return parent.r_script_edit.toPlainText()  </code></pre>
</details>
<div class="desc"><p>Retrieves the text content from the 'r_script_edit' attribute of the given parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains an attribute 'r_script_edit' which is expected to be a QTextEdit or similar widget.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The text content of the 'r_script_edit' widget as a plain string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.get_selected_variables"><code class="name flex">
<span>def <span class="ident">get_selected_variables</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_variables(parent):
    &#34;&#34;&#34;
    Retrieve selected variables from the parent object.
    Parameters:
    parent (object): An object that contains the variables of interest.
    Returns:
    tuple: A tuple containing the following variables from the parent object:
        - of_interest_var: The variable of interest.
        - auxilary_vars: Auxiliary variables.
        - vardir_var: Variance direction variable.
        - as_factor_var: Factor variable.
    &#34;&#34;&#34;
    
    return parent.of_interest_var, parent.auxilary_vars, parent.vardir_var, parent.as_factor_var</code></pre>
</details>
<div class="desc"><p>Retrieve selected variables from the parent object.
Parameters:
parent (object): An object that contains the variables of interest.
Returns:
tuple: A tuple containing the following variables from the parent object:
- of_interest_var: The variable of interest.
- auxilary_vars: Auxiliary variables.
- vardir_var: Variance direction variable.
- as_factor_var: Factor variable.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.set_selection_method"><code class="name flex">
<span>def <span class="ident">set_selection_method</span></span>(<span>parent, dialog)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_selection_method(parent, dialog):
    &#34;&#34;&#34;
    Sets the selection method for the parent object and accepts the dialog.
    This function retrieves the current text from the method selection combo box
    of the parent object and assigns it to the parent&#39;s method attribute. It then
    accepts the dialog and calls the show_r_script function with the parent object
    as an argument.
    Args:
        parent: The parent object that contains the method selection combo box.
        dialog: The dialog object that will be accepted.
    Returns:
        None
    &#34;&#34;&#34;
    
    # parent.selection_method = parent.method_combo.currentText()
    parent.method = parent.method_selection.currentText()
    dialog.accept()
    show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Sets the selection method for the parent object and accepts the dialog.
This function retrieves the current text from the method selection combo box
of the parent object and assigns it to the parent's method attribute. It then
accepts the dialog and calls the show_r_script function with the parent object
as an argument.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the method selection combo box.</dd>
<dt><strong><code>dialog</code></strong></dt>
<dd>The dialog object that will be accepted.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.show_options"><code class="name flex">
<span>def <span class="ident">show_options</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_options(parent):
    &#34;&#34;&#34;
    Displays a dialog window with options for selecting a method.
    Parameters:
    parent (QWidget): The parent widget to which this dialog belongs.
    The dialog contains a combo box for selecting a method from the options 
    &#34;ML&#34;, &#34;REML&#34;, and &#34;FH&#34;, with &#34;REML&#34; set as the default selection. 
    It also includes &#34;OK&#34; and &#34;Cancel&#34; buttons. The &#34;OK&#34; button triggers 
    the set_selection_method function, while the &#34;Cancel&#34; button closes the dialog.
    &#34;&#34;&#34;
    
    options_dialog = QDialog(parent)
    options_dialog.setWindowTitle(&#34;Options&#34;)

    layout = QVBoxLayout()

    # method_label = QLabel(&#34;Stepwise Selection Method:&#34;)
    # layout.addWidget(method_label)

    # parent.method_combo = QComboBox()
    # parent.method_combo.addItems([&#34;None&#34;, &#34;Stepwise&#34;, &#34;Forward&#34;, &#34;Backward&#34;])
    # layout.addWidget(parent.method_combo)

    method_label = QLabel(&#34;Method:&#34;)
    layout.addWidget(method_label)

    parent.method_selection = QComboBox()
    parent.method_selection.addItems([&#34;ML&#34;, &#34;REML&#34;, &#34;FH&#34;])
    parent.method_selection.setCurrentText(&#34;REML&#34;)
    layout.addWidget(parent.method_selection)

    button_layout = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    button_layout.addWidget(ok_button)
    button_layout.addWidget(cancel_button)

    layout.addLayout(button_layout)

    options_dialog.setLayout(layout)

    ok_button.clicked.connect(lambda: set_selection_method(parent, options_dialog))
    cancel_button.clicked.connect(options_dialog.reject)

    options_dialog.exec()</code></pre>
</details>
<div class="desc"><p>Displays a dialog window with options for selecting a method.
Parameters:
parent (QWidget): The parent widget to which this dialog belongs.
The dialog contains a combo box for selecting a method from the options
"ML", "REML", and "FH", with "REML" set as the default selection.
It also includes "OK" and "Cancel" buttons. The "OK" button triggers
the set_selection_method function, while the "Cancel" button closes the dialog.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.show_r_script"><code class="name flex">
<span>def <span class="ident">show_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script using the provided parent object and sets the text of the parent&#39;s R script editor.
    Args:
        parent: An object that contains the method `generate_r_script` and the attribute `r_script_edit`.
                The `generate_r_script` method is used to generate the R script, and the `r_script_edit` attribute
                is expected to have a `setText` method to update the editor&#39;s text.
    Returns:
        None
    &#34;&#34;&#34;
    
    r_script = generate_r_script(parent)
    parent.r_script_edit.setText(r_script)</code></pre>
</details>
<div class="desc"><p>Generates an R script using the provided parent object and sets the text of the parent's R script editor.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the method <code><a title="saePisan.service.modelling.SaeEblupArea.generate_r_script" href="#saePisan.service.modelling.SaeEblupArea.generate_r_script">generate_r_script()</a></code> and the attribute <code>r_script_edit</code>.
The <code><a title="saePisan.service.modelling.SaeEblupArea.generate_r_script" href="#saePisan.service.modelling.SaeEblupArea.generate_r_script">generate_r_script()</a></code> method is used to generate the R script, and the <code>r_script_edit</code> attribute
is expected to have a <code>setText</code> method to update the editor's text.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupArea.unassign_variable"><code class="name flex">
<span>def <span class="ident">unassign_variable</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unassign_variable(parent):
    &#34;&#34;&#34;
    Unassigns selected variables from various lists in the parent object and adds them back to the variables list.
    This function checks for selected items in the following lists of the parent object:
    - of_interest_list
    - auxilary_list
    - vardir_list
    - as_factor_list
    For each list, if there are selected items, it removes these items from the corresponding variable list in the parent object,
    updates the model for that list, and adds the items back to the variables list. Finally, it calls the `show_r_script` function
    to update the R script display.
    Args:
        parent: The parent object containing the lists and models to be updated.
    &#34;&#34;&#34;
    
    selected_indexes = parent.of_interest_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.of_interest_var = [var for var in parent.of_interest_var if var not in selected_items]
        parent.of_interest_model.setStringList(parent.of_interest_var)
        parent.variables_list.model().insertRow(0)  # Add back to variables list
        parent.variables_list.model().setData(parent.variables_list.model().index(0), selected_items[0])
        show_r_script(parent)
        return

    selected_indexes = parent.auxilary_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.auxilary_vars = [var for var in parent.auxilary_vars if var not in selected_items]
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.vardir_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.vardir_var = [var for var in parent.vardir_var if var not in selected_items]
        parent.vardir_model.setStringList(parent.vardir_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.as_factor_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.as_factor_var = [var for var in parent.as_factor_var if var not in selected_items]
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Unassigns selected variables from various lists in the parent object and adds them back to the variables list.
This function checks for selected items in the following lists of the parent object:
- of_interest_list
- auxilary_list
- vardir_list
- as_factor_list
For each list, if there are selected items, it removes these items from the corresponding variable list in the parent object,
updates the model for that list, and adds the items back to the variables list. Finally, it calls the <code><a title="saePisan.service.modelling.SaeEblupArea.show_r_script" href="#saePisan.service.modelling.SaeEblupArea.show_r_script">show_r_script()</a></code> function
to update the R script display.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the lists and models to be updated.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling" href="index.html">saePisan.service.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.SaeEblupArea.assign_as_factor" href="#saePisan.service.modelling.SaeEblupArea.assign_as_factor">assign_as_factor</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.assign_auxilary" href="#saePisan.service.modelling.SaeEblupArea.assign_auxilary">assign_auxilary</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.assign_of_interest" href="#saePisan.service.modelling.SaeEblupArea.assign_of_interest">assign_of_interest</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.assign_vardir" href="#saePisan.service.modelling.SaeEblupArea.assign_vardir">assign_vardir</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.generate_r_script" href="#saePisan.service.modelling.SaeEblupArea.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.get_script" href="#saePisan.service.modelling.SaeEblupArea.get_script">get_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.get_selected_variables" href="#saePisan.service.modelling.SaeEblupArea.get_selected_variables">get_selected_variables</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.set_selection_method" href="#saePisan.service.modelling.SaeEblupArea.set_selection_method">set_selection_method</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.show_options" href="#saePisan.service.modelling.SaeEblupArea.show_options">show_options</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.show_r_script" href="#saePisan.service.modelling.SaeEblupArea.show_r_script">show_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea.unassign_variable" href="#saePisan.service.modelling.SaeEblupArea.unassign_variable">unassign_variable</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_5_9">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupPseudo</div>
                    <div class="file-path">service/modelling/SaeEblupPseudo.html (41.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.SaeEblupPseudo</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.SaeEblupPseudo.assign_as_factor"><code class="name flex">
<span>def <span class="ident">assign_as_factor</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_as_factor(parent):
    &#34;&#34;&#34;
    Assigns selected variables as factors and updates the parent object&#39;s factor variables list and model.
    Args:
        parent: An object that contains the following attributes:
            - variables_list: A QListView or similar object with a method selectedIndexes() that returns a list of selected indexes.
            - as_factor_var: A list of variables that are currently assigned as factors.
            - as_factor_model: A QStringListModel or similar object with a method setStringList() to update the list of factor variables.
    The function performs the following steps:
        1. Retrieves the selected indexes from the variables_list.
        2. Extracts the data from each selected index and appends it to a new list of variables.
        3. Updates the as_factor_var list by adding new variables, ensuring no duplicates.
        4. Updates the as_factor_model with the new list of factor variables.
        5. Removes the selected variables from the variables_list.
        6. Calls the show_r_script function with the parent object to update the R script.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        last_index = selected_indexes[-1]  # Get the last selected index
        new_var = last_index.data()  # Get the data of the last selected variable
        parent.as_factor_var = [new_var]  # Assign only the last variable
        parent.as_factor_model.setStringList(parent.as_factor_var)
        parent.variables_list.model().removeRow(last_index.row())  # Remove the last selected variable from the list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns selected variables as factors and updates the parent object's factor variables list and model.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes:
- variables_list: A QListView or similar object with a method selectedIndexes() that returns a list of selected indexes.
- as_factor_var: A list of variables that are currently assigned as factors.
- as_factor_model: A QStringListModel or similar object with a method setStringList() to update the list of factor variables.</dd>
</dl>
<p>The function performs the following steps:
1. Retrieves the selected indexes from the variables_list.
2. Extracts the data from each selected index and appends it to a new list of variables.
3. Updates the as_factor_var list by adding new variables, ensuring no duplicates.
4. Updates the as_factor_model with the new list of factor variables.
5. Removes the selected variables from the variables_list.
6. Calls the show_r_script function with the parent object to update the R script.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.assign_auxilary"><code class="name flex">
<span>def <span class="ident">assign_auxilary</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_auxilary(parent):
    &#34;&#34;&#34;
    Assigns auxiliary variables from the selected indexes in the parent&#39;s variables list to the parent&#39;s auxiliary variables list.
    Parameters:
    parent (object): The parent object containing the variables list and auxiliary variables list.
    Functionality:
    - Retrieves the selected indexes from the parent&#39;s variables list.
    - Filters out non-numeric variables from the selected indexes.
    - If no valid numeric variables are selected, displays a warning message.
    - Adds the new numeric variables to the parent&#39;s auxiliary variables list, ensuring no duplicates.
    - Updates the parent&#39;s auxiliary model with the new list of auxiliary variables.
    - Removes the selected variables from the parent&#39;s variables list.
    - Calls the `show_r_script` function with the parent object to update the R script display.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                new_vars.append(index.data())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid numeric variables selected. Please select at least one numeric variable.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.auxilary_vars = list(set(parent.auxilary_vars + new_vars))  # Add new variables if they are different
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns auxiliary variables from the selected indexes in the parent's variables list to the parent's auxiliary variables list.
Parameters:
parent (object): The parent object containing the variables list and auxiliary variables list.
Functionality:
- Retrieves the selected indexes from the parent's variables list.
- Filters out non-numeric variables from the selected indexes.
- If no valid numeric variables are selected, displays a warning message.
- Adds the new numeric variables to the parent's auxiliary variables list, ensuring no duplicates.
- Updates the parent's auxiliary model with the new list of auxiliary variables.
- Removes the selected variables from the parent's variables list.
- Calls the <code><a title="saePisan.service.modelling.SaeEblupPseudo.show_r_script" href="#saePisan.service.modelling.SaeEblupPseudo.show_r_script">show_r_script()</a></code> function with the parent object to update the R script display.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.assign_domain"><code class="name flex">
<span>def <span class="ident">assign_domain</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_domain(parent):
    &#34;&#34;&#34;
    Assigns a selected domain variable from the variables list to the domain variable of the parent object.
    Parameters:
    parent (object): The parent object that contains the variables list and domain variable.
    The function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. If there are selected indexes, it assigns the first selected index&#39;s data to the parent&#39;s domain variable.
    3. Updates the parent&#39;s domain model with the new domain variable.
    4. Removes the selected index from the variables list.
    5. Calls the show_r_script function with the parent object.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        old_var = parent.domain_var[0] if parent.domain_var else None
        parent.domain_var = [selected_indexes[0].data()]
        parent.domain_model.setStringList(parent.domain_var)
        parent.variables_list.model().removeRow(selected_indexes[0].row())  # Remove from variables list
        if old_var:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns a selected domain variable from the variables list to the domain variable of the parent object.
Parameters:
parent (object): The parent object that contains the variables list and domain variable.
The function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. If there are selected indexes, it assigns the first selected index's data to the parent's domain variable.
3. Updates the parent's domain model with the new domain variable.
4. Removes the selected index from the variables list.
5. Calls the show_r_script function with the parent object.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.assign_of_interest"><code class="name flex">
<span>def <span class="ident">assign_of_interest</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_of_interest(parent):
    &#34;&#34;&#34;
    Assigns the variable of interest from the selected indexes in the variables list.
    This function checks the selected variables in the `variables_list` of the `parent` object.
    If any of the selected variables is not of type &#34;String&#34;, it assigns that variable as the 
    variable of interest, updates the `of_interest_model` with the selected variable, and removes 
    the variable from the `variables_list`. If all selected variables are of type &#34;String&#34;, it 
    displays a warning message indicating that the variable of interest must be of type Numeric.
    Args:
        parent: The parent object containing the `variables_list`, `of_interest_var`, and `of_interest_model`.
    Raises:
        QMessageBox: Displays a warning message if all selected variables are of type String.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.of_interest_var[0] if parent.of_interest_var else None
                parent.of_interest_var = [index.data()]
                parent.of_interest_model.setStringList(parent.of_interest_var)
                parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Variable of interest must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns the variable of interest from the selected indexes in the variables list.
This function checks the selected variables in the <code>variables_list</code> of the <code>parent</code> object.
If any of the selected variables is not of type "String", it assigns that variable as the
variable of interest, updates the <code>of_interest_model</code> with the selected variable, and removes
the variable from the <code>variables_list</code>. If all selected variables are of type "String", it
displays a warning message indicating that the variable of interest must be of type Numeric.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the <code>variables_list</code>, <code>of_interest_var</code>, and <code>of_interest_model</code>.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>QMessageBox</code></dt>
<dd>Displays a warning message if all selected variables are of type String.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.assign_vardir"><code class="name flex">
<span>def <span class="ident">assign_vardir</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_vardir(parent):
    &#34;&#34;&#34;
    Assigns a variable directory (vardir) from the selected variables in the parent object&#39;s variables list.
    This function checks the types of the selected variables. If any of the selected variables are not of type &#34;String&#34;,
    it assigns the first non-string variable to the vardir_var attribute of the parent object, updates the vardir_model
    with this variable, removes the variable from the variables list, and calls the show_r_script function. If all selected
    variables are of type &#34;String&#34;, it displays a warning message.
    Args:
        parent: The parent object containing the variables list, vardir_var, and vardir_model attributes.
    Raises:
        None
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.vardir_var[0] if parent.vardir_var else None
                parent.vardir_var = [index.data()]
                parent.vardir_model.setStringList(parent.vardir_var)
                parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Vardir variable must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns a variable directory (vardir) from the selected variables in the parent object's variables list.
This function checks the types of the selected variables. If any of the selected variables are not of type "String",
it assigns the first non-string variable to the vardir_var attribute of the parent object, updates the vardir_model
with this variable, removes the variable from the variables list, and calls the show_r_script function. If all selected
variables are of type "String", it displays a warning message.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list, vardir_var, and vardir_model attributes.</dd>
</dl>
<h2 id="raises">Raises</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script for fitting a Fay-Herriot model with optional stepwise selection.
    Args:
        parent: An object containing the following attributes:
            - of_interest_var (list): A list containing the variable of interest.
            - auxilary_vars (list): A list of auxiliary variables.
            - vardir_var (list): A list containing the variance directory variable.
            - as_factor_var (list): A list of variables to be treated as factors.
            - domain_var (list): A list containing the domain variable.
            - selection_method (str): The method for variable selection (e.g., &#34;Stepwise&#34;, &#34;None&#34;).
    Returns:
        str: The generated R script as a string.
    &#34;&#34;&#34;
    
    of_interest_var = f&#39;{parent.of_interest_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.of_interest_var else &#39;&#34;&#34;&#39;
    auxilary_vars = &#34; + &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in parent.auxilary_vars]) if parent.auxilary_vars else &#39;&#34;&#34;&#39;
    vardir_var = f&#39;{parent.vardir_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.vardir_var else &#39;&#34;&#34;&#39;
    as_factor_var = &#34; + &#34;.join([f&#39;as.factor({var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)})&#39; for var in parent.as_factor_var]) if parent.as_factor_var else &#39;&#34;&#34;&#39;
    domain_var = f&#39;&#34;{parent.domain_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#34;&#39; if parent.domain_var else &#39;NULL&#39;
    
    if (auxilary_vars==&#39;&#34;&#34;&#39; or auxilary_vars is None) and as_factor_var==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ 1&#39;
    elif as_factor_var==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ {auxilary_vars}&#39;
    elif auxilary_vars==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ {as_factor_var}&#39;
    else:
        formula = f&#39;{of_interest_var} ~ {auxilary_vars} + {as_factor_var}&#39;

    r_script = f&#39;names(data_pseudo) &lt;- gsub(&#34; &#34;, &#34;_&#34;, names(data_pseudo)); #Replace space with underscore\n&#39;
    r_script += f&#39;formula &lt;- {formula}\n&#39;
    r_script += f&#39;vardir_var_pseudo &lt;- data_pseudo[&#34;{vardir_var}&#34;]\n&#39;
    if parent.selection_method==&#34;Stepwise&#34;:
        parent.selection_method = &#34;both&#34;
    if parent.selection_method and parent.selection_method != &#34;None&#34; and auxilary_vars:
        r_script += f&#39;stepwise_model &lt;- step(formula, direction=&#34;{parent.selection_method.lower()}&#34;)\n&#39;
        r_script += f&#39;final_formula &lt;- formula(stepwise_model)\n&#39;
        r_script += f&#39;model_pseudo&lt;-fh(final_formula, vardir=&#34;{vardir_var}&#34;, combined_data =data_pseudo, domains={domain_var}, method = &#34;reblupbc&#34;, MSE=TRUE, mse_type = &#34;pseudo&#34;)&#39;
    else:
        r_script += f&#39;model_pseudo&lt;-fh(formula, vardir=&#34;{vardir_var}&#34;, combined_data =data_pseudo, domains={domain_var}, method = &#34;reblupbc&#34;, MSE=TRUE, mse_type = &#34;pseudo&#34;)&#39;
    return r_script</code></pre>
</details>
<div class="desc"><p>Generates an R script for fitting a Fay-Herriot model with optional stepwise selection.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object containing the following attributes:
- of_interest_var (list): A list containing the variable of interest.
- auxilary_vars (list): A list of auxiliary variables.
- vardir_var (list): A list containing the variance directory variable.
- as_factor_var (list): A list of variables to be treated as factors.
- domain_var (list): A list containing the domain variable.
- selection_method (str): The method for variable selection (e.g., "Stepwise", "None").</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The generated R script as a string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.get_script"><code class="name flex">
<span>def <span class="ident">get_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_script(parent):
    &#34;&#34;&#34;
    Retrieves the text content from the r_script_edit attribute of the parent object.
    Args:
        parent: An object that contains an attribute `r_script_edit` which is expected to be a QTextEdit or similar widget.
    Returns:
        str: The text content of the `r_script_edit` widget as a plain string.
    &#34;&#34;&#34;
    
    return parent.r_script_edit.toPlainText()  </code></pre>
</details>
<div class="desc"><p>Retrieves the text content from the r_script_edit attribute of the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains an attribute <code>r_script_edit</code> which is expected to be a QTextEdit or similar widget.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The text content of the <code>r_script_edit</code> widget as a plain string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.get_selected_variables"><code class="name flex">
<span>def <span class="ident">get_selected_variables</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_variables(parent):
    &#34;&#34;&#34;
    Retrieve selected variables from the parent object.
    Args:
        parent (object): An object containing the variables of interest.
    Returns:
        tuple: A tuple containing the following elements:
            - of_interest_var: The variable of interest.
            - auxilary_vars: The auxiliary variables.
            - vardir_var: The variance directory variable.
            - as_factor_var: The factor variable.
    &#34;&#34;&#34;
    
    return parent.of_interest_var, parent.auxilary_vars, parent.vardir_var, parent.as_factor_var</code></pre>
</details>
<div class="desc"><p>Retrieve selected variables from the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>An object containing the variables of interest.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>A tuple containing the following elements:
- of_interest_var: The variable of interest.
- auxilary_vars: The auxiliary variables.
- vardir_var: The variance directory variable.
- as_factor_var: The factor variable.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.set_selection_method"><code class="name flex">
<span>def <span class="ident">set_selection_method</span></span>(<span>parent, dialog)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_selection_method(parent, dialog):
    &#34;&#34;&#34;
    Sets the selection method for the parent object and accepts the dialog.
    This function sets the selection method for the parent object by retrieving
    the current text from the method_combo widget. It then accepts the dialog
    and calls the show_r_script function with the parent object as an argument.
    Args:
        parent: The parent object that contains the method_combo widget.
        dialog: The dialog object that will be accepted.
    Returns:
        None
    &#34;&#34;&#34;
    
    # parent.selection_method = parent.method_combo.currentText()
    dialog.accept()
    show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Sets the selection method for the parent object and accepts the dialog.
This function sets the selection method for the parent object by retrieving
the current text from the method_combo widget. It then accepts the dialog
and calls the show_r_script function with the parent object as an argument.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the method_combo widget.</dd>
<dt><strong><code>dialog</code></strong></dt>
<dd>The dialog object that will be accepted.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.show_options"><code class="name flex">
<span>def <span class="ident">show_options</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_options(parent):
    &#34;&#34;&#34;
    Displays an options dialog with OK and Cancel buttons.
    Parameters:
    parent (QWidget): The parent widget for the dialog.
    The dialog allows the user to confirm or cancel their selection.
    When the OK button is clicked, the `set_selection_method` function is called.
    When the Cancel button is clicked, the dialog is rejected.
    &#34;&#34;&#34;
    
    options_dialog = QDialog(parent)
    options_dialog.setWindowTitle(&#34;Options&#34;)

    layout = QVBoxLayout()

    # method_label = QLabel(&#34;Stepwise Selection Method:&#34;)
    # layout.addWidget(method_label)

    # parent.method_combo = QComboBox()
    # parent.method_combo.addItems([&#34;None&#34;, &#34;Stepwise&#34;, &#34;Forward&#34;, &#34;Backward&#34;])
    # layout.addWidget(parent.method_combo)

    button_layout = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    button_layout.addWidget(ok_button)
    button_layout.addWidget(cancel_button)

    layout.addLayout(button_layout)

    options_dialog.setLayout(layout)

    ok_button.clicked.connect(lambda: set_selection_method(parent, options_dialog))
    cancel_button.clicked.connect(options_dialog.reject)

    options_dialog.exec()</code></pre>
</details>
<div class="desc"><p>Displays an options dialog with OK and Cancel buttons.
Parameters:
parent (QWidget): The parent widget for the dialog.
The dialog allows the user to confirm or cancel their selection.
When the OK button is clicked, the <code><a title="saePisan.service.modelling.SaeEblupPseudo.set_selection_method" href="#saePisan.service.modelling.SaeEblupPseudo.set_selection_method">set_selection_method()</a></code> function is called.
When the Cancel button is clicked, the dialog is rejected.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.show_r_script"><code class="name flex">
<span>def <span class="ident">show_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script using the provided parent object and sets the text of the parent&#39;s R script editor.
    Args:
        parent: An object that contains the method `generate_r_script` and the attribute `r_script_edit`.
                `generate_r_script(parent)` is expected to return a string representing the R script.
                `parent.r_script_edit` is expected to have a method `setText` to set the generated R script.
    &#34;&#34;&#34;
    
    r_script = generate_r_script(parent)
    parent.r_script_edit.setText(r_script)</code></pre>
</details>
<div class="desc"><p>Generates an R script using the provided parent object and sets the text of the parent's R script editor.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the method <code><a title="saePisan.service.modelling.SaeEblupPseudo.generate_r_script" href="#saePisan.service.modelling.SaeEblupPseudo.generate_r_script">generate_r_script()</a></code> and the attribute <code>r_script_edit</code>.
<code><a title="saePisan.service.modelling.SaeEblupPseudo.generate_r_script" href="#saePisan.service.modelling.SaeEblupPseudo.generate_r_script">generate_r_script()</a>(parent)</code> is expected to return a string representing the R script.
<code>parent.r_script_edit</code> is expected to have a method <code>setText</code> to set the generated R script.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupPseudo.unassign_variable"><code class="name flex">
<span>def <span class="ident">unassign_variable</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unassign_variable(parent):
    &#34;&#34;&#34;
    Unassigns selected variables from various lists in the parent object and adds them back to the variables list.
    This function checks for selected items in the following lists of the parent object:
    - of_interest_list
    - auxilary_list
    - vardir_list
    - as_factor_list
    - domain_list
    For each list, if there are selected items, it removes these items from the corresponding variable list in the parent object,
    updates the associated model, and adds the items back to the variables list model. Finally, it calls the `show_r_script` function
    to update the R script display.
    Args:
        parent: The parent object containing the lists and models to be updated.
    &#34;&#34;&#34;
    
    selected_indexes = parent.of_interest_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.of_interest_var = [var for var in parent.of_interest_var if var not in selected_items]
        parent.of_interest_model.setStringList(parent.of_interest_var)
        parent.variables_list.model().insertRow(0)  # Add back to variables list
        parent.variables_list.model().setData(parent.variables_list.model().index(0), selected_items[0])
        show_r_script(parent)
        return

    selected_indexes = parent.auxilary_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.auxilary_vars = [var for var in parent.auxilary_vars if var not in selected_items]
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.vardir_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.vardir_var = [var for var in parent.vardir_var if var not in selected_items]
        parent.vardir_model.setStringList(parent.vardir_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.as_factor_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.as_factor_var = [var for var in parent.as_factor_var if var not in selected_items]
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        
    selected_indexes = parent.domain_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.domain_var = [var for var in parent.domain_var if var not in selected_items]
        parent.domain_model.setStringList(parent.domain_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script()</code></pre>
</details>
<div class="desc"><p>Unassigns selected variables from various lists in the parent object and adds them back to the variables list.
This function checks for selected items in the following lists of the parent object:
- of_interest_list
- auxilary_list
- vardir_list
- as_factor_list
- domain_list
For each list, if there are selected items, it removes these items from the corresponding variable list in the parent object,
updates the associated model, and adds the items back to the variables list model. Finally, it calls the <code><a title="saePisan.service.modelling.SaeEblupPseudo.show_r_script" href="#saePisan.service.modelling.SaeEblupPseudo.show_r_script">show_r_script()</a></code> function
to update the R script display.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the lists and models to be updated.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling" href="index.html">saePisan.service.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.assign_as_factor" href="#saePisan.service.modelling.SaeEblupPseudo.assign_as_factor">assign_as_factor</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.assign_auxilary" href="#saePisan.service.modelling.SaeEblupPseudo.assign_auxilary">assign_auxilary</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.assign_domain" href="#saePisan.service.modelling.SaeEblupPseudo.assign_domain">assign_domain</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.assign_of_interest" href="#saePisan.service.modelling.SaeEblupPseudo.assign_of_interest">assign_of_interest</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.assign_vardir" href="#saePisan.service.modelling.SaeEblupPseudo.assign_vardir">assign_vardir</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.generate_r_script" href="#saePisan.service.modelling.SaeEblupPseudo.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.get_script" href="#saePisan.service.modelling.SaeEblupPseudo.get_script">get_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.get_selected_variables" href="#saePisan.service.modelling.SaeEblupPseudo.get_selected_variables">get_selected_variables</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.set_selection_method" href="#saePisan.service.modelling.SaeEblupPseudo.set_selection_method">set_selection_method</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.show_options" href="#saePisan.service.modelling.SaeEblupPseudo.show_options">show_options</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.show_r_script" href="#saePisan.service.modelling.SaeEblupPseudo.show_r_script">show_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo.unassign_variable" href="#saePisan.service.modelling.SaeEblupPseudo.unassign_variable">unassign_variable</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_0">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupUnit</div>
                    <div class="file-path">service/modelling/SaeEblupUnit.html (51.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.SaeEblupUnit</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_as_factor"><code class="name flex">
<span>def <span class="ident">assign_as_factor</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_as_factor(parent):
    &#34;&#34;&#34;
    Assigns selected variables as factors and updates the parent object&#39;s factor list and model.
    Args:
        parent: An object that contains the following attributes:
            - variables_list: A QListView or similar object with a method selectedIndexes() that returns a list of selected indexes.
            - as_factor_var: A list of variables that are currently assigned as factors.
            - as_factor_model: A QStringListModel or similar object with a method setStringList() to update the list of factor variables.
    The function performs the following steps:
        1. Retrieves the selected indexes from the variables_list.
        2. Extracts the data from each selected index and appends it to a new list of variables.
        3. Updates the as_factor_var list by adding new variables, ensuring no duplicates.
        4. Updates the as_factor_model with the new list of factor variables.
        5. Removes the selected variables from the variables_list.
        6. Calls the show_r_script function to update the R script display.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        old_var = parent.as_factor_var[0] if parent.as_factor_var else None
        last_index = selected_indexes[-1]  # Get the last selected index
        new_var = last_index.data()  # Get the data of the last selected variable
        parent.as_factor_var = [new_var]  # Assign only the last variable
        parent.as_factor_model.setStringList(parent.as_factor_var)
        parent.variables_list.model().removeRow(last_index.row())  # Remove the last selected variable from the list
        if old_var:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns selected variables as factors and updates the parent object's factor list and model.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes:
- variables_list: A QListView or similar object with a method selectedIndexes() that returns a list of selected indexes.
- as_factor_var: A list of variables that are currently assigned as factors.
- as_factor_model: A QStringListModel or similar object with a method setStringList() to update the list of factor variables.</dd>
</dl>
<p>The function performs the following steps:
1. Retrieves the selected indexes from the variables_list.
2. Extracts the data from each selected index and appends it to a new list of variables.
3. Updates the as_factor_var list by adding new variables, ensuring no duplicates.
4. Updates the as_factor_model with the new list of factor variables.
5. Removes the selected variables from the variables_list.
6. Calls the show_r_script function to update the R script display.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_aux_mean"><code class="name flex">
<span>def <span class="ident">assign_aux_mean</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_aux_mean(parent):
    &#34;&#34;&#34;
    Assigns auxiliary mean variables from the selected indexes in the parent object&#39;s variables list.
    This function performs the following steps:
    1. Retrieves the selected indexes from the parent object&#39;s variables list.
    2. Filters out non-numeric variables from the selected indexes.
    3. If no valid numeric variables are selected, displays a warning message.
    4. Adds the new numeric variables to the parent object&#39;s auxiliary mean variables list.
    5. Updates the auxiliary mean model with the new list of variables.
    6. Removes the selected variables from the parent object&#39;s variables list.
    7. Calls the show_r_script function to update the R script display.
    Args:
        parent: The parent object containing the variables list, auxiliary mean variables list, 
                and auxiliary mean model.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                new_vars.append(index.data())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid numeric variables selected. Please select at least one numeric variable.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.aux_mean_vars = list(set(parent.aux_mean_vars + new_vars))  # Add new variables if they are different
        parent.aux_mean_model.setStringList(parent.aux_mean_vars)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns auxiliary mean variables from the selected indexes in the parent object's variables list.
This function performs the following steps:
1. Retrieves the selected indexes from the parent object's variables list.
2. Filters out non-numeric variables from the selected indexes.
3. If no valid numeric variables are selected, displays a warning message.
4. Adds the new numeric variables to the parent object's auxiliary mean variables list.
5. Updates the auxiliary mean model with the new list of variables.
6. Removes the selected variables from the parent object's variables list.
7. Calls the show_r_script function to update the R script display.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list, auxiliary mean variables list,
and auxiliary mean model.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_auxilary"><code class="name flex">
<span>def <span class="ident">assign_auxilary</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_auxilary(parent):
    &#34;&#34;&#34;
    Assigns auxiliary variables from the selected indexes in the parent object&#39;s variables list.
    This function performs the following steps:
    1. Retrieves the selected indexes from the parent object&#39;s variables list.
    2. Filters out non-numeric variables from the selected indexes.
    3. If no valid numeric variables are selected, displays a warning message and exits.
    4. Adds the new numeric variables to the parent object&#39;s auxiliary variables list.
    5. Updates the auxiliary model with the new list of auxiliary variables.
    6. Removes the selected variables from the parent object&#39;s variables list.
    7. Calls the show_r_script function with the parent object.
    Args:
        parent (object): The parent object containing the variables list, auxiliary variables list, and auxiliary model.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                new_vars.append(index.data())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid numeric variables selected. Please select at least one numeric variable.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.auxilary_vars = list(set(parent.auxilary_vars + new_vars))  # Add new variables if they are different
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns auxiliary variables from the selected indexes in the parent object's variables list.
This function performs the following steps:
1. Retrieves the selected indexes from the parent object's variables list.
2. Filters out non-numeric variables from the selected indexes.
3. If no valid numeric variables are selected, displays a warning message and exits.
4. Adds the new numeric variables to the parent object's auxiliary variables list.
5. Updates the auxiliary model with the new list of auxiliary variables.
6. Removes the selected variables from the parent object's variables list.
7. Calls the show_r_script function with the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>The parent object containing the variables list, auxiliary variables list, and auxiliary model.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_domains"><code class="name flex">
<span>def <span class="ident">assign_domains</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_domains(parent):
    &#34;&#34;&#34;
    Assigns the selected domain variable from the variables list to the domain model of the parent object.
    Parameters:
    parent (object): The parent object that contains the variables list and domain model.
    The function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. If there are selected indexes, it assigns the first selected variable to the parent&#39;s domain variable.
    3. Updates the parent&#39;s domain model with the selected domain variable.
    4. Removes the selected variable from the parent&#39;s variables list.
    5. Calls the show_r_script function with the parent object as an argument.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        old_var = parent.domain_var[0] if parent.domain_var else None
        parent.domain_var = [selected_indexes[0].data()]  # Only one variable
        parent.domain_model.setStringList(parent.domain_var)
        parent.variables_list.model().removeRow(selected_indexes[0].row())  # Remove from variables list
        if old_var:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns the selected domain variable from the variables list to the domain model of the parent object.
Parameters:
parent (object): The parent object that contains the variables list and domain model.
The function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. If there are selected indexes, it assigns the first selected variable to the parent's domain variable.
3. Updates the parent's domain model with the selected domain variable.
4. Removes the selected variable from the parent's variables list.
5. Calls the show_r_script function with the parent object as an argument.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_index"><code class="name flex">
<span>def <span class="ident">assign_index</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_index(parent):
    &#34;&#34;&#34;
    Assigns the selected index from the variables list to the parent&#39;s index variable and updates the index model.
    Parameters:
    parent (object): The parent object that contains the variables list, index variable, and index model.
    The function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. If there are selected indexes, it iterates through them.
    3. Assigns the data of the first selected index to the parent&#39;s index variable.
    4. Updates the parent&#39;s index model with the new index variable.
    5. Removes the selected index from the variables list.
    6. Calls the show_r_script function with the parent object.
    7. Breaks the loop after processing the first selected index.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        for index in selected_indexes:
            old_var = parent.index_var[0] if parent.index_var else None
            parent.index_var = [index.data()]
            parent.index_model.setStringList(parent.index_var)
            parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
            if old_var:
                parent.variables_list.model().insertRow(0)
                parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
            show_r_script(parent)
            break</code></pre>
</details>
<div class="desc"><p>Assigns the selected index from the variables list to the parent's index variable and updates the index model.
Parameters:
parent (object): The parent object that contains the variables list, index variable, and index model.
The function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. If there are selected indexes, it iterates through them.
3. Assigns the data of the first selected index to the parent's index variable.
4. Updates the parent's index model with the new index variable.
5. Removes the selected index from the variables list.
6. Calls the show_r_script function with the parent object.
7. Breaks the loop after processing the first selected index.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_of_interest"><code class="name flex">
<span>def <span class="ident">assign_of_interest</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_of_interest(parent):
    &#34;&#34;&#34;
    Assigns a variable of interest from the selected indexes in the variables list.
    This function checks the selected indexes in the `variables_list` of the `parent` object.
    If any of the selected variables is not of type &#34;String&#34;, it assigns that variable as the
    variable of interest, updates the `of_interest_model` with this variable, removes the variable
    from the `variables_list`, and calls the `show_r_script` function. If all selected variables
    are of type &#34;String&#34;, it shows a warning message indicating that the variable of interest must
    be of type Numeric.
    Args:
        parent: The parent object containing the `variables_list`, `of_interest_var`, `of_interest_model`,
                and the `show_r_script` function.
    Raises:
        None
    Displays:
        QMessageBox: A warning message if all selected variables are of type &#34;String&#34;.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.of_interest_var[0] if parent.of_interest_var else None
                parent.of_interest_var = [index.data()]
                parent.of_interest_model.setStringList(parent.of_interest_var)
                parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Variable of interest must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns a variable of interest from the selected indexes in the variables list.
This function checks the selected indexes in the <code>variables_list</code> of the <code>parent</code> object.
If any of the selected variables is not of type "String", it assigns that variable as the
variable of interest, updates the <code>of_interest_model</code> with this variable, removes the variable
from the <code>variables_list</code>, and calls the <code><a title="saePisan.service.modelling.SaeEblupUnit.show_r_script" href="#saePisan.service.modelling.SaeEblupUnit.show_r_script">show_r_script()</a></code> function. If all selected variables
are of type "String", it shows a warning message indicating that the variable of interest must
be of type Numeric.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the <code>variables_list</code>, <code>of_interest_var</code>, <code>of_interest_model</code>,
and the <code><a title="saePisan.service.modelling.SaeEblupUnit.show_r_script" href="#saePisan.service.modelling.SaeEblupUnit.show_r_script">show_r_script()</a></code> function.</dd>
</dl>
<h2 id="raises">Raises</h2>
<p>None</p>
<h2 id="displays">Displays</h2>
<p>QMessageBox: A warning message if all selected variables are of type "String".</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.assign_population_sample_size"><code class="name flex">
<span>def <span class="ident">assign_population_sample_size</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_population_sample_size(parent):
    &#34;&#34;&#34;
    Assigns the population sample size based on the selected index from the variables list.
    Args:
        parent: The parent object that contains the variables list and other related attributes.
    This function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. If there are selected indexes, it assigns the first selected index&#39;s data to the parent&#39;s population_sample_size_var.
    3. Updates the parent&#39;s population_sample_size_model with the new population sample size.
    4. Removes the selected index from the variables list.
    5. Calls the show_r_script function with the parent object.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        old_var = parent.population_sample_size_var[0] if parent.population_sample_size_var else None
        parent.population_sample_size_var = [selected_indexes[0].data()]  # Only one variable
        parent.population_sample_size_model.setStringList(parent.population_sample_size_var)
        parent.variables_list.model().removeRow(selected_indexes[0].row())  # Remove from variables list
        if old_var:
            parent.variables_list.model().insertRow(0)
            parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns the population sample size based on the selected index from the variables list.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the variables list and other related attributes.</dd>
</dl>
<p>This function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. If there are selected indexes, it assigns the first selected index's data to the parent's population_sample_size_var.
3. Updates the parent's population_sample_size_model with the new population sample size.
4. Removes the selected index from the variables list.
5. Calls the show_r_script function with the parent object.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script for statistical modeling based on the provided parent object.
    Args:
        parent (object): An object containing the following attributes:
            - of_interest_var (list): A list containing the variable of interest.
            - auxilary_vars (list): A list of auxiliary variables.
            - as_factor_var (list): A list of variables to be treated as factors.
            - index_var (list): A list containing the index variable.
            - aux_mean_vars (list): A list of auxiliary mean variables.
            - population_sample_size_var (list): A list containing the population sample size variable.
            - domain_var (list): A list containing the domain variable.
            - selection_method (str): The method for variable selection (e.g., &#34;Stepwise&#34;, &#34;None&#34;).
            - bootstrap (int): The number of bootstrap samples.
            - method (str): The method to be used in the pbmseBHF function.
    Returns:
        str: The generated R script as a string.
    &#34;&#34;&#34;
    
    of_interest_var = f&#39;{parent.of_interest_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.of_interest_var else &#39;&#34;&#34;&#39;
    auxilary_vars = &#34; + &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in parent.auxilary_vars]) if parent.auxilary_vars else &#39;&#34;&#34;&#39;
    as_factor_var = &#34; + &#34;.join([f&#39;as.factor({var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)})&#39; for var in parent.as_factor_var]) if parent.as_factor_var else &#39;&#34;&#34;&#39;
    index_var = f&#39;{parent.index_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.index_var else &#39;&#34;&#34;&#39;
    aux_mean_vars = &#34;,&#34;.join([f&#39;{var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; for var in parent.aux_mean_vars]) if parent.aux_mean_vars else &#39;&#34;&#34;&#39;
    population_sample_size_var = f&#39;{parent.population_sample_size_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.population_sample_size_var else &#39;&#34;&#34;&#39;
    domain_var = f&#39;{parent.domain_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.domain_var else &#39;&#34;&#34;&#39;
    
    if (auxilary_vars==&#39;&#34;&#34;&#39; or auxilary_vars is None) and as_factor_var==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ 1&#39;
    elif as_factor_var==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ {auxilary_vars}&#39;
    elif auxilary_vars==&#39;&#34;&#34;&#39;:
        formula = f&#39;{of_interest_var} ~ {as_factor_var}&#39;
    else:
        formula = f&#39;{of_interest_var} ~ {auxilary_vars} + {as_factor_var}&#39;

    r_script = f&#39;names(data_unit) &lt;- gsub(&#34; &#34;, &#34;_&#34;, names(data_unit)); #Replace space with underscore\n&#39;
    r_script += f&#39;formula &lt;- {formula}\n&#39;
    r_script += f&#39;Xmeans &lt;- with(data_unit, data.frame({index_var},{aux_mean_vars}))\n&#39;
    r_script += f&#39;Popn &lt;- with(data_unit, data.frame({index_var},{population_sample_size_var}))\n&#39;
    r_script += f&#39;Xmeans &lt;- na.omit(Xmeans)\n&#39;
    r_script += f&#39;Popn &lt;- na.omit(Popn)\n&#39;
    r_script += f&#39;Popn &lt;- Popn[complete.cases(Popn), ]\n&#39;
    r_script += f&#39;Xmeans &lt;- Xmeans[complete.cases(Xmeans), ]\n&#39;
    r_script += f&#39;domains=Xmeans[,1]\n&#39;
    
    if parent.selection_method==&#34;Stepwise&#34;:
        parent.selection_method = &#34;both&#34;
    if parent.selection_method and parent.selection_method != &#34;None&#34; and auxilary_vars:
        r_script += f&#39;stepwise_model &lt;- step(formula, direction=&#34;{parent.selection_method.lower()}&#34;)\n&#39;
        r_script += f&#39;final_formula &lt;- formula(stepwise_model)\n&#39;
        r_script += f&#39;model_unit&lt;-pbmseBHF(final_formula, dom={domain_var}, selectdom=domains, meanxpop=Xmeans, popnsize=Popn, B={parent.bootstrap}, method = &#34;{parent.method}&#34;, data=data_unit)&#39;
    else:
        r_script += f&#39;model_unit&lt;-pbmseBHF(formula,dom={domain_var}, selectdom=domains, meanxpop=Xmeans, popnsize=Popn, B={parent.bootstrap}, method = &#34;{parent.method}&#34;, data=data_unit)&#39;
    return r_script</code></pre>
</details>
<div class="desc"><p>Generates an R script for statistical modeling based on the provided parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>An object containing the following attributes:
- of_interest_var (list): A list containing the variable of interest.
- auxilary_vars (list): A list of auxiliary variables.
- as_factor_var (list): A list of variables to be treated as factors.
- index_var (list): A list containing the index variable.
- aux_mean_vars (list): A list of auxiliary mean variables.
- population_sample_size_var (list): A list containing the population sample size variable.
- domain_var (list): A list containing the domain variable.
- selection_method (str): The method for variable selection (e.g., "Stepwise", "None").
- bootstrap (int): The number of bootstrap samples.
- method (str): The method to be used in the pbmseBHF function.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The generated R script as a string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.get_script"><code class="name flex">
<span>def <span class="ident">get_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_script(parent):
    &#34;&#34;&#34;
    Retrieves the text content from the r_script_edit attribute of the parent object.
    Args:
        parent: An object that contains an attribute r_script_edit, which is expected to have a method toPlainText().
    Returns:
        str: The text content of the r_script_edit attribute.
    &#34;&#34;&#34;
    
    return parent.r_script_edit.toPlainText()  </code></pre>
</details>
<div class="desc"><p>Retrieves the text content from the r_script_edit attribute of the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains an attribute r_script_edit, which is expected to have a method toPlainText().</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The text content of the r_script_edit attribute.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.get_selected_variables"><code class="name flex">
<span>def <span class="ident">get_selected_variables</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_variables(parent):
    &#34;&#34;&#34;
    Retrieve selected variables from the parent object.
    Args:
        parent (object): The parent object containing the variables of interest.
    Returns:
        tuple: A tuple containing the following elements:
            - of_interest_var: The variable of interest.
            - auxilary_vars: The auxiliary variables.
            - vardir_var: The variable directory.
            - as_factor_var: The factor variable.
    &#34;&#34;&#34;
    
    return parent.of_interest_var, parent.auxilary_vars, parent.vardir_var, parent.as_factor_var</code></pre>
</details>
<div class="desc"><p>Retrieve selected variables from the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>The parent object containing the variables of interest.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>A tuple containing the following elements:
- of_interest_var: The variable of interest.
- auxilary_vars: The auxiliary variables.
- vardir_var: The variable directory.
- as_factor_var: The factor variable.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.set_selection_method"><code class="name flex">
<span>def <span class="ident">set_selection_method</span></span>(<span>parent, dialog)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_selection_method(parent, dialog):
    &#34;&#34;&#34;
    Sets the selection method and bootstrap value for the parent object and accepts the dialog.
    Args:
        parent: The parent object that contains the method_selection and bootstrap_edit widgets.
        dialog: The dialog object that will be accepted after setting the selection method and bootstrap value.
    Returns:
        None
    &#34;&#34;&#34;
    
    # parent.selection_method = parent.method_combo.currentText()
    parent.method = parent.method_selection.currentText()
    parent.bootstrap = parent.bootstrap_edit.text()
    dialog.accept()
    show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Sets the selection method and bootstrap value for the parent object and accepts the dialog.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the method_selection and bootstrap_edit widgets.</dd>
<dt><strong><code>dialog</code></strong></dt>
<dd>The dialog object that will be accepted after setting the selection method and bootstrap value.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.show_options"><code class="name flex">
<span>def <span class="ident">show_options</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_options(parent):
    &#34;&#34;&#34;
    Displays a dialog window with options for method selection and bootstrap settings.
    Parameters:
    parent (QWidget): The parent widget to which the dialog belongs.
    The dialog allows the user to select a method from a combo box and set the number of bootstrap iterations.
    The available methods are &#34;ML&#34;, &#34;REML&#34;, and &#34;FH&#34;, with &#34;REML&#34; set as the default.
    The bootstrap iterations input is validated to accept only integer values, with a default value of 50.
    The dialog contains &#34;OK&#34; and &#34;Cancel&#34; buttons. Clicking &#34;OK&#34; will apply the selected options by calling
    the set_selection_method function, while clicking &#34;Cancel&#34; will close the dialog without applying changes.
    &#34;&#34;&#34;
    
    options_dialog = QDialog(parent)
    options_dialog.setWindowTitle(&#34;Options&#34;)

    layout = QVBoxLayout()

    # method_label = QLabel(&#34;Stepwise Selection Method:&#34;)
    # layout.addWidget(method_label)

    # parent.method_combo = QComboBox()
    # parent.method_combo.addItems([&#34;None&#34;, &#34;Stepwise&#34;, &#34;Forward&#34;, &#34;Backward&#34;])
    # layout.addWidget(parent.method_combo)

    method_label = QLabel(&#34;Method:&#34;)
    layout.addWidget(method_label)

    parent.method_selection = QComboBox()
    parent.method_selection.addItems([&#34;ML&#34;, &#34;REML&#34;, &#34;FH&#34;])
    parent.method_selection.setCurrentText(&#34;REML&#34;)
    layout.addWidget(parent.method_selection)
    
    bootstrap_label = QLabel(&#34;Bootstrap:&#34;)
    layout.addWidget(bootstrap_label)
    
    parent.bootstrap_edit = QLineEdit()
    parent.bootstrap_edit.setValidator(QIntValidator())
    parent.bootstrap_edit.setText(&#34;50&#34;)
    layout.addWidget(parent.bootstrap_edit)
    

    button_layout = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    button_layout.addWidget(ok_button)
    button_layout.addWidget(cancel_button)

    layout.addLayout(button_layout)

    options_dialog.setLayout(layout)

    ok_button.clicked.connect(lambda: set_selection_method(parent, options_dialog))
    cancel_button.clicked.connect(options_dialog.reject)

    options_dialog.exec()</code></pre>
</details>
<div class="desc"><p>Displays a dialog window with options for method selection and bootstrap settings.
Parameters:
parent (QWidget): The parent widget to which the dialog belongs.
The dialog allows the user to select a method from a combo box and set the number of bootstrap iterations.
The available methods are "ML", "REML", and "FH", with "REML" set as the default.
The bootstrap iterations input is validated to accept only integer values, with a default value of 50.
The dialog contains "OK" and "Cancel" buttons. Clicking "OK" will apply the selected options by calling
the set_selection_method function, while clicking "Cancel" will close the dialog without applying changes.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.show_r_script"><code class="name flex">
<span>def <span class="ident">show_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script using the given parent object and sets the text of the parent&#39;s r_script_edit widget to the generated script.
    Args:
        parent: The parent object that contains the r_script_edit widget and is used to generate the R script.
    &#34;&#34;&#34;
    
    r_script = generate_r_script(parent)
    parent.r_script_edit.setText(r_script)</code></pre>
</details>
<div class="desc"><p>Generates an R script using the given parent object and sets the text of the parent's r_script_edit widget to the generated script.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object that contains the r_script_edit widget and is used to generate the R script.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeEblupUnit.unassign_variable"><code class="name flex">
<span>def <span class="ident">unassign_variable</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unassign_variable(parent):
    &#34;&#34;&#34;
    Unassigns selected variables from various lists in the parent object and adds them back to the main variables list.
    This function checks for selected items in several lists within the parent object, removes the selected items from
    their respective lists, and then adds them back to the main variables list. It also updates the corresponding models
    and triggers the `show_r_script` function to reflect the changes.
    Args:
        parent: The parent object containing the lists and models. It is expected to have the following attributes:
            - of_interest_list
            - of_interest_var
            - of_interest_model
            - auxilary_list
            - auxilary_vars
            - auxilary_model
            - index_list
            - index_var
            - index_model
            - as_factor_list
            - as_factor_var
            - as_factor_model
            - domain_list
            - domain_var
            - domain_model
            - auxilary_vars_mean_list
            - aux_mean_vars
            - aux_mean_model
            - population_sample_size_list
            - population_sample_size_var
            - population_sample_size_model
            - variables_list
    Returns:
        None
    &#34;&#34;&#34;
    
    selected_indexes = parent.of_interest_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.of_interest_var = [var for var in parent.of_interest_var if var not in selected_items]
        parent.of_interest_model.setStringList(parent.of_interest_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.auxilary_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.auxilary_vars = [var for var in parent.auxilary_vars if var not in selected_items]
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.index_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.index_var = [var for var in parent.index_var if var not in selected_items]
        parent.index_model.setStringList(parent.index_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.as_factor_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.as_factor_var = [var for var in parent.as_factor_var if var not in selected_items]
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.domain_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.domain_var = [var for var in parent.domain_var if var not in selected_items]
        parent.domain_model.setStringList(parent.domain_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.auxilary_vars_mean_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.aux_mean_vars = [var for var in parent.aux_mean_vars if var not in selected_items]
        parent.aux_mean_model.setStringList(parent.aux_mean_vars)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.population_sample_size_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.population_sample_size_var = [var for var in parent.population_sample_size_var if var not in selected_items]
        parent.population_sample_size_model.setStringList(parent.population_sample_size_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Unassigns selected variables from various lists in the parent object and adds them back to the main variables list.
This function checks for selected items in several lists within the parent object, removes the selected items from
their respective lists, and then adds them back to the main variables list. It also updates the corresponding models
and triggers the <code><a title="saePisan.service.modelling.SaeEblupUnit.show_r_script" href="#saePisan.service.modelling.SaeEblupUnit.show_r_script">show_r_script()</a></code> function to reflect the changes.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the lists and models. It is expected to have the following attributes:
- of_interest_list
- of_interest_var
- of_interest_model
- auxilary_list
- auxilary_vars
- auxilary_model
- index_list
- index_var
- index_model
- as_factor_list
- as_factor_var
- as_factor_model
- domain_list
- domain_var
- domain_model
- auxilary_vars_mean_list
- aux_mean_vars
- aux_mean_model
- population_sample_size_list
- population_sample_size_var
- population_sample_size_model
- variables_list</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling" href="index.html">saePisan.service.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_as_factor" href="#saePisan.service.modelling.SaeEblupUnit.assign_as_factor">assign_as_factor</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_aux_mean" href="#saePisan.service.modelling.SaeEblupUnit.assign_aux_mean">assign_aux_mean</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_auxilary" href="#saePisan.service.modelling.SaeEblupUnit.assign_auxilary">assign_auxilary</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_domains" href="#saePisan.service.modelling.SaeEblupUnit.assign_domains">assign_domains</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_index" href="#saePisan.service.modelling.SaeEblupUnit.assign_index">assign_index</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_of_interest" href="#saePisan.service.modelling.SaeEblupUnit.assign_of_interest">assign_of_interest</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.assign_population_sample_size" href="#saePisan.service.modelling.SaeEblupUnit.assign_population_sample_size">assign_population_sample_size</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.generate_r_script" href="#saePisan.service.modelling.SaeEblupUnit.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.get_script" href="#saePisan.service.modelling.SaeEblupUnit.get_script">get_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.get_selected_variables" href="#saePisan.service.modelling.SaeEblupUnit.get_selected_variables">get_selected_variables</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.set_selection_method" href="#saePisan.service.modelling.SaeEblupUnit.set_selection_method">set_selection_method</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.show_options" href="#saePisan.service.modelling.SaeEblupUnit.show_options">show_options</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.show_r_script" href="#saePisan.service.modelling.SaeEblupUnit.show_r_script">show_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit.unassign_variable" href="#saePisan.service.modelling.SaeEblupUnit.unassign_variable">unassign_variable</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_1">
                <div class="file-header">
                    <div>ğŸ“„ SaeHBArea</div>
                    <div class="file-path">service/modelling/SaeHBArea.html (42.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.SaeHBArea</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.SaeHBArea.assign_as_factor"><code class="name flex">
<span>def <span class="ident">assign_as_factor</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_as_factor(parent):
    &#34;&#34;&#34;
    Assigns selected variables as factors (only variables of type String) and updates the parent object&#39;s factor variable list and model.
    Args:
        parent: An object that contains the following attributes:
            - variables_list: A QListView or similar widget that holds the list of variables.
            - as_factor_var: A list that stores the variables to be treated as factors.
            - as_factor_model: A QStringListModel or similar model that represents the factor variables.
    The function performs the following steps:
        1. Retrieves the selected indexes from the variables_list.
        2. Filters only variables of type &#34;String&#34;.
        3. Adds them to the as_factor_var list, ensuring no duplicates.
        4. Updates the as_factor_model with the new list of factor variables.
        5. Removes the selected variables from the variables_list.
        6. Calls the show_r_script function to update the R script display.
    &#34;&#34;&#34;

    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        rows_to_remove = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var == &#34;String&#34;:
                new_vars.append(index.data())
                rows_to_remove.append(index.row())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid string variables selected. Please select at least one variable of type String.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.as_factor_var = list(set(parent.as_factor_var + new_vars))
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for row in sorted(rows_to_remove, reverse=True):
            parent.variables_list.model().removeRow(row)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns selected variables as factors (only variables of type String) and updates the parent object's factor variable list and model.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the following attributes:
- variables_list: A QListView or similar widget that holds the list of variables.
- as_factor_var: A list that stores the variables to be treated as factors.
- as_factor_model: A QStringListModel or similar model that represents the factor variables.</dd>
</dl>
<p>The function performs the following steps:
1. Retrieves the selected indexes from the variables_list.
2. Filters only variables of type "String".
3. Adds them to the as_factor_var list, ensuring no duplicates.
4. Updates the as_factor_model with the new list of factor variables.
5. Removes the selected variables from the variables_list.
6. Calls the show_r_script function to update the R script display.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.assign_auxilary"><code class="name flex">
<span>def <span class="ident">assign_auxilary</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_auxilary(parent):
    &#34;&#34;&#34;
    Assigns auxiliary variables from the selected indexes in the parent&#39;s variables list.
    This function performs the following steps:
    1. Retrieves the selected indexes from the parent&#39;s variables list.
    2. Filters out non-numeric variables from the selected indexes.
    3. If no valid numeric variables are selected, displays a warning message.
    4. Adds the new numeric variables to the parent&#39;s auxiliary variables list.
    5. Updates the parent&#39;s auxiliary model with the new list of auxiliary variables.
    6. Removes the selected variables from the parent&#39;s variables list.
    7. Calls the show_r_script function to update the R script.
    Args:
        parent: The parent object containing the variables list, auxiliary variables list, and auxiliary model.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        new_vars = []
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                new_vars.append(index.data())
        if not new_vars:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;No valid numeric variables selected. Please select at least one numeric variable.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()
            return
        parent.auxilary_vars = list(set(parent.auxilary_vars + new_vars))  # Add new variables if they are different
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for index in sorted(selected_indexes, reverse=True):
            parent.variables_list.model().removeRow(index.row())  # Remove from variables list
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Assigns auxiliary variables from the selected indexes in the parent's variables list.
This function performs the following steps:
1. Retrieves the selected indexes from the parent's variables list.
2. Filters out non-numeric variables from the selected indexes.
3. If no valid numeric variables are selected, displays a warning message.
4. Adds the new numeric variables to the parent's auxiliary variables list.
5. Updates the parent's auxiliary model with the new list of auxiliary variables.
6. Removes the selected variables from the parent's variables list.
7. Calls the show_r_script function to update the R script.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list, auxiliary variables list, and auxiliary model.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.assign_of_interest"><code class="name flex">
<span>def <span class="ident">assign_of_interest</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_of_interest(parent):
    &#34;&#34;&#34;
    Assigns a variable of interest from the selected variables in the parent object&#39;s variables list.
    This function checks the selected variables in the parent object&#39;s variables list. If any of the selected
    variables are not of type &#34;String&#34;, it assigns the first non-string variable as the variable of interest,
    updates the parent object&#39;s of_interest_model with this variable, and removes the variable from the variables list.
    If all selected variables are of type &#34;String&#34;, it displays a warning message.
    Args:
        parent: The parent object containing the variables list and other related attributes.
    Attributes:
        parent.variables_list: The list of variables from which the variable of interest is selected.
        parent.of_interest_var: The variable of interest to be assigned.
        parent.of_interest_model: The model to be updated with the variable of interest.
    Raises:
        QMessageBox: Displays a warning message if all selected variables are of type &#34;String&#34;.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.of_interest_var[0] if parent.of_interest_var else None
                parent.of_interest_var = [index.data()]
                parent.of_interest_model.setStringList(parent.of_interest_var)
                parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Variable of interest must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns a variable of interest from the selected variables in the parent object's variables list.
This function checks the selected variables in the parent object's variables list. If any of the selected
variables are not of type "String", it assigns the first non-string variable as the variable of interest,
updates the parent object's of_interest_model with this variable, and removes the variable from the variables list.
If all selected variables are of type "String", it displays a warning message.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list and other related attributes.</dd>
</dl>
<h2 id="attributes">Attributes</h2>
<p>parent.variables_list: The list of variables from which the variable of interest is selected.
parent.of_interest_var: The variable of interest to be assigned.
parent.of_interest_model: The model to be updated with the variable of interest.</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>QMessageBox</code></dt>
<dd>Displays a warning message if all selected variables are of type "String".</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.assign_vardir"><code class="name flex">
<span>def <span class="ident">assign_vardir</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def assign_vardir(parent):
    &#34;&#34;&#34;
    Assigns a variable directory (vardir) from the selected variables in the parent object&#39;s variables list.
    This function checks the selected variables in the parent object&#39;s variables list. If any of the selected 
    variables are not of type &#34;String&#34;, it assigns the first non-string variable to the vardir_var attribute 
    of the parent object, updates the vardir_model with this variable, removes the variable from the variables 
    list, and calls the show_r_script function. If all selected variables are of type &#34;String&#34;, it displays a 
    warning message indicating that the vardir variable must be of type Numeric.
    Args:
        parent: The parent object containing the variables list, vardir_var, and vardir_model attributes.
    Raises:
        None
    Displays:
        QMessageBox: A warning message if all selected variables are of type &#34;String&#34;.
    &#34;&#34;&#34;
    
    selected_indexes = parent.variables_list.selectedIndexes()
    if selected_indexes:
        all_string = True
        for index in selected_indexes:
            type_of_var = index.data().split(&#34; [&#34;)[1].replace(&#34;]&#34;, &#34;&#34;)
            if type_of_var != &#34;String&#34;:
                all_string = False
                old_var = parent.vardir_var[0] if parent.vardir_var else None
                parent.vardir_var = [index.data()]
                parent.vardir_model.setStringList(parent.vardir_var)
                parent.variables_list.model().removeRow(selected_indexes[-1].row())  # Remove from variables list
                if old_var:
                    parent.variables_list.model().insertRow(0)
                    parent.variables_list.model().setData(parent.variables_list.model().index(0), old_var)
                show_r_script(parent)
                break
        if all_string:
            msg = QMessageBox()
            msg.setIcon(QMessageBox.Icon.Warning)
            msg.setText(&#34;All selected variables are of type String. Vardir variable must be of type Numeric.&#34;)
            msg.setWindowTitle(&#34;Warning&#34;)
            msg.exec()</code></pre>
</details>
<div class="desc"><p>Assigns a variable directory (vardir) from the selected variables in the parent object's variables list.
This function checks the selected variables in the parent object's variables list. If any of the selected
variables are not of type "String", it assigns the first non-string variable to the vardir_var attribute
of the parent object, updates the vardir_model with this variable, removes the variable from the variables
list, and calls the show_r_script function. If all selected variables are of type "String", it displays a
warning message indicating that the vardir variable must be of type Numeric.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the variables list, vardir_var, and vardir_model attributes.</dd>
</dl>
<h2 id="raises">Raises</h2>
<p>None</p>
<h2 id="displays">Displays</h2>
<p>QMessageBox: A warning message if all selected variables are of type "String".</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script based on the provided parent object&#39;s attributes.
    Args:
        parent (object): An object containing the following attributes:
            - of_interest_var (list): A list containing the variable of interest.
            - auxilary_vars (list): A list of auxiliary variables.
            - vardir_var (list): A list containing the variance directory variable.
            - as_factor_var (list): A list of variables to be treated as factors.
            - selection_method (str): The method for variable selection (e.g., &#34;Stepwise&#34;, &#34;None&#34;).
            - model_method (str): The method for modeling (e.g., &#34;lm&#34;, &#34;glm&#34;).
            - iter_update (int): The number of iterations for updating the model.
            - iter_mcmc (int): The number of MCMC iterations.
            - burn_in (int): The number of burn-in iterations.
    Returns:
        str: The generated R script as a string.
    &#34;&#34;&#34;
    
    of_interest_var = f&#39;{parent.of_interest_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.of_interest_var else &#39;&#34;&#34;&#39;
    auxilary_vars = &#34; + &#34;.join([var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;) for var in parent.auxilary_vars]) if parent.auxilary_vars else &#39;&#34;&#34;&#39;
    vardir_var = f&#39;{parent.vardir_var[0].split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)}&#39; if parent.vardir_var else &#39;&#34;&#34;&#39;
    
    dummy_vars = []
    dummy_creation_script = &#34;&#34;
    if parent.as_factor_var:
        for var in parent.as_factor_var:
            var_name = var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)
            dummy_creation_script += f&#39;dummies_{var_name} &lt;- model.matrix(~{var_name} - 1, datahb)\n&#39;
            dummy_creation_script += f&#39;datahb &lt;- cbind(datahb, dummies_{var_name})\n&#39;
            dummy_vars.append(f&#39;colnames(dummies_{var_name})&#39;)

    # Gabungkan semua dummy variable ke formula
    dummy_vars_str = &#34;&#34;
    if dummy_vars:
        dummy_names = []
        for var in parent.as_factor_var:
            var_name = var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)
            # You don&#39;t know the levels in Python, so use a placeholder for R to expand
            dummy_names.append(f&#39;colnames(dummies_{var_name})&#39;)
        # Instead of using paste() in formula, expand in R before formula creation
        dummy_vars_str = &#34; + &#34;.join([f&#39;`{name}`&#39; for name in dummy_names])
    
    
    r_script = f&#39;names(datahb) &lt;- gsub(&#34; &#34;, &#34;_&#34;, names(datahb)); #Replace space with underscore\n&#39;
    r_script += dummy_creation_script

    # Build the formula in R after dummies are created
    r_script += &#34;all_vars &lt;- names(datahb)\n&#34;
    if parent.as_factor_var:
        for var in parent.as_factor_var:
            var_name = var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)
            r_script += f&#39;all_vars &lt;- c(all_vars, colnames(dummies_{var_name}))\n&#39;

    # Build the formula string in R
    r_script += &#34;rhs_vars &lt;- c()&#34;
    if auxilary_vars != &#39;&#34;&#34;&#39;:
        r_script += f&#39;\nrhs_vars &lt;- c(rhs_vars, &#34;{auxilary_vars}&#34;)&#39;
    if parent.as_factor_var:
        for var in parent.as_factor_var:
            var_name = var.split(&#34; [&#34;)[0].replace(&#34; &#34;, &#34;_&#34;)
            r_script += f&#39;\nrhs_vars &lt;- c(rhs_vars, colnames(dummies_{var_name}))&#39;
    r_script += &#39;\nformula_str &lt;- paste(&#39;
    if of_interest_var != &#39;&#34;&#34;&#39;:
        r_script += f&#39;&#34;{of_interest_var}&#34;, &#34;~&#34;, paste(rhs_vars, collapse = &#34; + &#34;))\n&#39;
    else:
        r_script += &#39;&#34;&#34;, &#34;~&#34;, paste(rhs_vars, collapse = &#34; + &#34;))\n&#39;
    r_script += &#34;formula &lt;- as.formula(formula_str)\n&#34;
    
    if parent.selection_method==&#34;Stepwise&#34;:
        parent.selection_method = &#34;both&#34;
    if parent.selection_method and parent.selection_method != &#34;None&#34; and auxilary_vars:
        r_script += f&#39;stepwise_model &lt;- step(formula, direction=&#34;{parent.selection_method.lower()}&#34;)\n&#39;
        r_script += f&#39;final_formula &lt;- formula(stepwise_model)\n&#39;
        r_script += f&#39;modelhb&lt;-{parent.model_method} (final_formula, iter.update={parent.iter_update}, iter.mcmc = {parent.iter_mcmc}, burn.in ={parent.burn_in} , data=datahb)&#39;
    else:
        r_script += f&#39;modelhb&lt;-{parent.model_method} (formula, iter.update={parent.iter_update}, iter.mcmc = {parent.iter_mcmc}, burn.in ={parent.burn_in}, data=datahb)&#39;
    return r_script</code></pre>
</details>
<div class="desc"><p>Generates an R script based on the provided parent object's attributes.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>An object containing the following attributes:
- of_interest_var (list): A list containing the variable of interest.
- auxilary_vars (list): A list of auxiliary variables.
- vardir_var (list): A list containing the variance directory variable.
- as_factor_var (list): A list of variables to be treated as factors.
- selection_method (str): The method for variable selection (e.g., "Stepwise", "None").
- model_method (str): The method for modeling (e.g., "lm", "glm").
- iter_update (int): The number of iterations for updating the model.
- iter_mcmc (int): The number of MCMC iterations.
- burn_in (int): The number of burn-in iterations.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The generated R script as a string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.get_script"><code class="name flex">
<span>def <span class="ident">get_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_script(parent):
    &#34;&#34;&#34;
    Retrieves the text content from the &#39;r_script_edit&#39; attribute of the given parent object.
    Args:
        parent: An object that contains an attribute &#39;r_script_edit&#39; which is expected to be a QTextEdit or similar widget.
    Returns:
        str: The text content of the &#39;r_script_edit&#39; widget as a plain string.
    &#34;&#34;&#34;
    
    return parent.r_script_edit.toPlainText()  </code></pre>
</details>
<div class="desc"><p>Retrieves the text content from the 'r_script_edit' attribute of the given parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains an attribute 'r_script_edit' which is expected to be a QTextEdit or similar widget.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The text content of the 'r_script_edit' widget as a plain string.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.get_selected_variables"><code class="name flex">
<span>def <span class="ident">get_selected_variables</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_variables(parent):
    &#34;&#34;&#34;
    Retrieve selected variables from the parent object.
    Args:
        parent (object): The parent object containing the variables of interest.
    Returns:
        tuple: A tuple containing the following variables from the parent object:
            - of_interest_var: The variable of interest.
            - auxilary_vars: Auxiliary variables.
            - vardir_var: The variable direction.
            - as_factor_var: The factor variable.
    &#34;&#34;&#34;
    
    return parent.of_interest_var, parent.auxilary_vars, parent.vardir_var, parent.as_factor_var</code></pre>
</details>
<div class="desc"><p>Retrieve selected variables from the parent object.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>object</code></dt>
<dd>The parent object containing the variables of interest.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>A tuple containing the following variables from the parent object:
- of_interest_var: The variable of interest.
- auxilary_vars: Auxiliary variables.
- vardir_var: The variable direction.
- as_factor_var: The factor variable.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.set_selection_method"><code class="name flex">
<span>def <span class="ident">set_selection_method</span></span>(<span>parent, dialog)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_selection_method(parent, dialog):
    &#34;&#34;&#34;
    Sets the selection method and updates iteration parameters for the parent object,
    then accepts the dialog and shows the R script.
    Args:
        parent: The parent object containing the selection method and iteration parameters.
        dialog: The dialog object to be accepted.
    Side Effects:
        Updates the following attributes of the parent object:
        - iter_update: The updated iteration value.
        - iter_mcmc: The updated MCMC iteration value.
        - burn_in: The updated burn-in value.
        Accepts the dialog and calls the show_r_script function with the parent object.
    &#34;&#34;&#34;
    
    # parent.selection_method = parent.method_combo.currentText()
    parent.iter_update = parent.iter_update.text()
    parent.iter_mcmc = parent.iter_mcmc.text()
    parent.burn_in = parent.burn_in.text()
    dialog.accept()
    show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Sets the selection method and updates iteration parameters for the parent object,
then accepts the dialog and shows the R script.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the selection method and iteration parameters.</dd>
<dt><strong><code>dialog</code></strong></dt>
<dd>The dialog object to be accepted.</dd>
</dl>
<p>Side Effects:
Updates the following attributes of the parent object:
- iter_update: The updated iteration value.
- iter_mcmc: The updated MCMC iteration value.
- burn_in: The updated burn-in value.
Accepts the dialog and calls the show_r_script function with the parent object.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.show_options"><code class="name flex">
<span>def <span class="ident">show_options</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_options(parent):
    &#34;&#34;&#34;
    Displays a dialog window with options for configuring the stepwise selection method and iteration parameters.
    Parameters:
    parent (QWidget): The parent widget for the dialog.
    The dialog includes the following options:
    - Number of Iteration Update (minimum 2): A QLineEdit for specifying the number of iteration updates, with a default value of 3.
    - Number of Total Iterations per Chain: A QLineEdit for specifying the total number of iterations per chain, with a default value of 2000.
    - Number of iterations to discard at the beginning: A QLineEdit for specifying the number of iterations to discard at the beginning, with a default value of 1000.
    The dialog also includes &#34;OK&#34; and &#34;Cancel&#34; buttons. Clicking &#34;OK&#34; will apply the settings and close the dialog, while clicking &#34;Cancel&#34; will close the dialog without applying any changes.
    &#34;&#34;&#34;
    
    options_dialog = QDialog(parent)
    options_dialog.setWindowTitle(&#34;Options&#34;)

    layout = QVBoxLayout()

    method_label = QLabel(&#34;Stepwise Selection Method:&#34;)
    # layout.addWidget(method_label)

    # parent.method_combo = QComboBox()
    # parent.method_combo.addItems([&#34;None&#34;, &#34;Stepwise&#34;, &#34;Forward&#34;, &#34;Backward&#34;])
    # layout.addWidget(parent.method_combo)

    iter_update_label = QLabel(&#34;Number of Iteration Update (minimum 2):&#34;)
    layout.addWidget(iter_update_label)
    
    parent.iter_update = QLineEdit()
    parent.iter_update.setValidator(QIntValidator())
    parent.iter_update.setText(&#34;3&#34;)  # Set default value to 3
    layout.addWidget(parent.iter_update)
    
    iter_mcmc_label = QLabel(&#34;Number of Total Iterations per Chain:&#34;)
    layout.addWidget(iter_mcmc_label)
    
    parent.iter_mcmc = QLineEdit()
    parent.iter_mcmc.setValidator(QIntValidator())
    parent.iter_mcmc.setText(&#34;2000&#34;)  # Set default value to 2000
    layout.addWidget(parent.iter_mcmc)
    
    burn_in_label = QLabel(&#34;Number of iterations to discard at the beginning:&#34;)
    layout.addWidget(burn_in_label)
    
    parent.burn_in = QLineEdit()
    parent.burn_in.setValidator(QIntValidator())
    parent.burn_in.setText(&#34;1000&#34;)  # Set default value to 1000
    layout.addWidget(parent.burn_in)
    

    button_layout = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    button_layout.addWidget(ok_button)
    button_layout.addWidget(cancel_button)

    layout.addLayout(button_layout)

    options_dialog.setLayout(layout)

    ok_button.clicked.connect(lambda: set_selection_method(parent, options_dialog))
    cancel_button.clicked.connect(options_dialog.reject)

    options_dialog.exec()</code></pre>
</details>
<div class="desc"><p>Displays a dialog window with options for configuring the stepwise selection method and iteration parameters.
Parameters:
parent (QWidget): The parent widget for the dialog.
The dialog includes the following options:
- Number of Iteration Update (minimum 2): A QLineEdit for specifying the number of iteration updates, with a default value of 3.
- Number of Total Iterations per Chain: A QLineEdit for specifying the total number of iterations per chain, with a default value of 2000.
- Number of iterations to discard at the beginning: A QLineEdit for specifying the number of iterations to discard at the beginning, with a default value of 1000.
The dialog also includes "OK" and "Cancel" buttons. Clicking "OK" will apply the settings and close the dialog, while clicking "Cancel" will close the dialog without applying any changes.</p></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.show_r_script"><code class="name flex">
<span>def <span class="ident">show_r_script</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_r_script(parent):
    &#34;&#34;&#34;
    Generates an R script using the given parent object and sets the text of the parent&#39;s R script editor.
    Args:
        parent: An object that contains the method `generate_r_script` and the attribute `r_script_edit`.
                The `generate_r_script` method is used to generate the R script, and `r_script_edit` is
                an editor widget where the generated R script will be displayed.
    &#34;&#34;&#34;
    
    r_script = generate_r_script(parent)
    parent.r_script_edit.setText(r_script)</code></pre>
</details>
<div class="desc"><p>Generates an R script using the given parent object and sets the text of the parent's R script editor.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains the method <code><a title="saePisan.service.modelling.SaeHBArea.generate_r_script" href="#saePisan.service.modelling.SaeHBArea.generate_r_script">generate_r_script()</a></code> and the attribute <code>r_script_edit</code>.
The <code><a title="saePisan.service.modelling.SaeHBArea.generate_r_script" href="#saePisan.service.modelling.SaeHBArea.generate_r_script">generate_r_script()</a></code> method is used to generate the R script, and <code>r_script_edit</code> is
an editor widget where the generated R script will be displayed.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.modelling.SaeHBArea.unassign_variable"><code class="name flex">
<span>def <span class="ident">unassign_variable</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unassign_variable(parent):
    &#34;&#34;&#34;
    Unassigns selected variables from the specified lists in the parent object and adds them back to the variables list.
    This function checks for selected items in the following lists in order:
    1. of_interest_list
    2. auxilary_list
    3. vardir_list
    4. as_factor_list
    For each list, if there are selected items, it removes these items from the corresponding variable list in the parent object,
    updates the model for that list, and adds the items back to the variables list. It then calls the show_r_script function.
    Args:
        parent: The parent object containing the lists and models to be updated.
    &#34;&#34;&#34;
    
    selected_indexes = parent.of_interest_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.of_interest_var = [var for var in parent.of_interest_var if var not in selected_items]
        parent.of_interest_model.setStringList(parent.of_interest_var)
        parent.variables_list.model().insertRow(0)  # Add back to variables list
        parent.variables_list.model().setData(parent.variables_list.model().index(0), selected_items[0])
        show_r_script(parent)
        return

    selected_indexes = parent.auxilary_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.auxilary_vars = [var for var in parent.auxilary_vars if var not in selected_items]
        parent.auxilary_model.setStringList(parent.auxilary_vars)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.vardir_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.vardir_var = [var for var in parent.vardir_var if var not in selected_items]
        parent.vardir_model.setStringList(parent.vardir_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)
        return

    selected_indexes = parent.as_factor_list.selectedIndexes()
    if selected_indexes:
        selected_items = [index.data() for index in selected_indexes]
        parent.as_factor_var = [var for var in parent.as_factor_var if var not in selected_items]
        parent.as_factor_model.setStringList(parent.as_factor_var)
        for item in selected_items:
            parent.variables_list.model().insertRow(0)  # Add back to variables list
            parent.variables_list.model().setData(parent.variables_list.model().index(0), item)
        show_r_script(parent)</code></pre>
</details>
<div class="desc"><p>Unassigns selected variables from the specified lists in the parent object and adds them back to the variables list.
This function checks for selected items in the following lists in order:
1. of_interest_list
2. auxilary_list
3. vardir_list
4. as_factor_list
For each list, if there are selected items, it removes these items from the corresponding variable list in the parent object,
updates the model for that list, and adds the items back to the variables list. It then calls the show_r_script function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the lists and models to be updated.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling" href="index.html">saePisan.service.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.SaeHBArea.assign_as_factor" href="#saePisan.service.modelling.SaeHBArea.assign_as_factor">assign_as_factor</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.assign_auxilary" href="#saePisan.service.modelling.SaeHBArea.assign_auxilary">assign_auxilary</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.assign_of_interest" href="#saePisan.service.modelling.SaeHBArea.assign_of_interest">assign_of_interest</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.assign_vardir" href="#saePisan.service.modelling.SaeHBArea.assign_vardir">assign_vardir</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.generate_r_script" href="#saePisan.service.modelling.SaeHBArea.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.get_script" href="#saePisan.service.modelling.SaeHBArea.get_script">get_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.get_selected_variables" href="#saePisan.service.modelling.SaeHBArea.get_selected_variables">get_selected_variables</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.set_selection_method" href="#saePisan.service.modelling.SaeHBArea.set_selection_method">set_selection_method</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.show_options" href="#saePisan.service.modelling.SaeHBArea.show_options">show_options</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.show_r_script" href="#saePisan.service.modelling.SaeHBArea.show_r_script">show_r_script</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea.unassign_variable" href="#saePisan.service.modelling.SaeHBArea.unassign_variable">unassign_variable</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_2">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/modelling/index.html (8.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.modelling</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.modelling.ProjectionService" href="ProjectionService.html">saePisan.service.modelling.ProjectionService</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.SaeEblupArea" href="SaeEblupArea.html">saePisan.service.modelling.SaeEblupArea</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.SaeEblupPseudo" href="SaeEblupPseudo.html">saePisan.service.modelling.SaeEblupPseudo</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.SaeEblupUnit" href="SaeEblupUnit.html">saePisan.service.modelling.SaeEblupUnit</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.SaeHBArea" href="SaeHBArea.html">saePisan.service.modelling.SaeHBArea</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.running_model" href="running_model/index.html">saePisan.service.modelling.running_model</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.modelling.ProjectionService" href="ProjectionService.html">saePisan.service.modelling.ProjectionService</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupArea" href="SaeEblupArea.html">saePisan.service.modelling.SaeEblupArea</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupPseudo" href="SaeEblupPseudo.html">saePisan.service.modelling.SaeEblupPseudo</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeEblupUnit" href="SaeEblupUnit.html">saePisan.service.modelling.SaeEblupUnit</a></code></li>
<li><code><a title="saePisan.service.modelling.SaeHBArea" href="SaeHBArea.html">saePisan.service.modelling.SaeHBArea</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model" href="running_model/index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_3">
                <div class="file-header">
                    <div>ğŸ“„ Projection</div>
                    <div class="file-path">service/modelling/running_model/Projection.html (12.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.running_model.Projection</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.running_model.Projection.extract_output2_results"><code class="name flex">
<span>def <span class="ident">extract_output2_results</span></span>(<span>output)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_output2_results(output):
    &#34;&#34;&#34;
    Extracts results from the given output2 string and returns it as a dictionary.
    &#34;&#34;&#34;
    import re

    # Extract formula
    formula_match = re.search(r&#34;formula\s*=\s*(.+)&#34;, output)
    if formula_match:
        formula = formula_match.group(1).strip()
    else:
        formula = &#34;No formula found&#34;

    # Extract coefficients
    coefficients_match = re.search(r&#39;Coefficients:\s+((?:.+\n)+)&#39;, output, re.S)
    if coefficients_match:
        coefficients = coefficients_match.group(1).strip()
        rows = coefficients.split(&#39;\n&#39;)
        
        # Process header and data rows
        header = rows[0].split()
        data = [row.split() for row in rows[1:] if row.strip()]
        
        # Ensure all rows have the same number of columns as the header
        max_columns = len(header)
        data = [row + [None] * (max_columns - len(row)) for row in data]
        
        # Convert to Polars DataFrame
        coeff = pl.DataFrame(data, schema=header, orient=&#34;row&#34;)
    else:
        coeff = pl.DataFrame()

    return formula, coeff</code></pre>
</details>
<div class="desc"><p>Extracts results from the given output2 string and returns it as a dictionary.</p></div>
</dd>
<dt id="saePisan.service.modelling.running_model.Projection.run_model_projection"><code class="name flex">
<span>def <span class="ident">run_model_projection</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model_projection(parent):
    &#34;&#34;&#34;
    Runs the model projection using R scripts and returns the results.
    Parameters:
    parent (object): The parent object that contains the necessary methods and attributes for running the model projection.
    Returns:
    tuple: A tuple containing:
        - result (str): The result of the model projection or error message.
        - error (bool): A boolean indicating whether an error occurred.
        - df (polars.DataFrame or None): The projected data as a Polars DataFrame if successful, otherwise None.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    parent.activate_R()
    df = parent.model1.get_data()
    # df = df.drop_nulls()
    convert_df(df, parent)
    result = &#34;&#34;
    error = False
    try:
        ro.r(&#39;data_pe &lt;- as.data.frame(r_df)&#39;)
        try:
            ro.r(parent.r_script)  # Menjalankan skrip R
        except RRuntimeError as e:
            result = str(e)
            error = True
            return result, error, None
        ro.r(&#39;summary_pe &lt;- model_pe$model \n pred_pe &lt;-model_pe$prediction&#39;)
        summary = ro.globalenv[&#39;summary_pe&#39;]
        formula, coeff = extract_output2_results(str(summary))
        pred = ro.conversion.rpy2py(ro.globalenv[&#39;pred_pe&#39;])
        pred = [float(value) for value in pred]
        pred_df = pl.DataFrame({
            &#34;Index&#34;: range(1, len(pred) + 1),
            &#34;Value&#34;: pred
        })
        results = {
            &#39;Model&#39;: &#34;Projection Estimation&#34;,
            &#39;Formula of Modelling&#39;: formula,
            &#39;Coefficients of Modelling&#39;: coeff,
            &#39;Prediction&#39;: pred_df
        }
        ro.r(&#39;projection_pe &lt;- model_pe$projection&#39;)
        proj = ro.conversion.rpy2py(ro.globalenv[&#39;projection_pe&#39;])
        df = pl.from_pandas(proj)
        error = False
        return results, error, df
        
    except Exception as e:
        error = True
        return str(e), error, None</code></pre>
</details>
<div class="desc"><p>Runs the model projection using R scripts and returns the results.
Parameters:
parent (object): The parent object that contains the necessary methods and attributes for running the model projection.
Returns:
tuple: A tuple containing:
- result (str): The result of the model projection or error message.
- error (bool): A boolean indicating whether an error occurred.
- df (polars.DataFrame or None): The projected data as a Polars DataFrame if successful, otherwise None.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model" href="index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.running_model.Projection.extract_output2_results" href="#saePisan.service.modelling.running_model.Projection.extract_output2_results">extract_output2_results</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.Projection.run_model_projection" href="#saePisan.service.modelling.running_model.Projection.run_model_projection">run_model_projection</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_4">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupArea</div>
                    <div class="file-path">service/modelling/running_model/SaeEblupArea.html (12.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.running_model.SaeEblupArea</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.running_model.SaeEblupArea.run_model_eblup_area"><code class="name flex">
<span>def <span class="ident">run_model_eblup_area</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model_eblup_area(parent):
    &#34;&#34;&#34;
    Runs the EBLUP (Empirical Best Linear Unbiased Prediction) area model using the provided parent object.
    Parameters:
    parent (object): The parent object that contains necessary methods and attributes for running the model.
                     It should have the following methods and attributes:
                     - activate_R(): Method to activate R environment.
                     - model1.get_data(): Method to get the data for the model.
                     - r_script: An R script to be executed.
    Returns:
    tuple: A tuple containing:
           - result (str): The result of the model execution or error message.
           - error (bool): A flag indicating whether an error occurred.
           - df (polars.DataFrame or None): A DataFrame containing the estimated values, MSE, and RSE if the model runs successfully, otherwise None.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    parent.activate_R()
    df = parent.model1.get_data()
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    result = &#34;&#34;
    error = False
    convert_df(df, parent)
    try:
        ro.r(&#39;data &lt;- as.data.frame(r_df)&#39;)
        try:
            ro.r(parent.r_script)  # Menjalankan skrip R
        except RRuntimeError as e:
            result = str(e)
            error = True
            return result, error, None
        ro.r(&#39;estimated_value &lt;- model$est$eblup\n mse &lt;- model$mse \n method &lt;- model$est$fit$method \n convergence&lt;-model$est$fit$convergence \n iterations &lt;- model$est$fit$iterations \n refvar &lt;- model$est$fit$refvar \n goodness &lt;-model$est$fit$goodness&#39;)
        method = ro.globalenv[&#39;method&#39;]
        convergence = ro.globalenv[&#39;convergence&#39;]
        if isinstance(convergence, ro.vectors.BoolVector):
            convergence = &#34;Yes&#34; if bool(convergence[0]) else &#34;NO&#34;
        else:
            convergence = &#34;Not Converged&#34;
        itteration = ro.globalenv[&#39;iterations&#39;]
        itteration = int(float(itteration[0]))
        refvar = ro.globalenv[&#39;refvar&#39;]
        refvar = int(float(refvar[0]))
        goodness_r = ro.conversion.rpy2py(ro.globalenv[&#39;goodness&#39;])
        goodness = pl.DataFrame({
            &#39;Logarithmic Likelihood&#39;: [goodness_r[0]],
            &#39;Akaike Information Criterion ( AIC )&#39;: [goodness_r[1]],
            &#39;Bayesian Information Criterion (BIC)&#39;: [goodness_r[2]],
            &#39;Kullback Information Criterion (KIC)&#39;: [goodness_r[3]],
        })
        
        results = {
            &#34;Model&#34;: &#34;EBLUP Area Level&#34;,
            &#34;Method&#34;: method,
            &#34;Convergence&#34;: convergence,
            &#34;Number of Iterations Performed by The Fisher-scoring Algorithm&#34;: itteration,
            &#34;Random Effect Variance&#34;: refvar,
            &#34;Goodness of Fit Models&#34;: goodness
        }
        
        estimated_value = ro.conversion.rpy2py(ro.globalenv[&#39;estimated_value&#39;])
        mse = ro.conversion.rpy2py(ro.globalenv[&#39;mse&#39;])
        vardir_var = ro.conversion.rpy2py(ro.globalenv[&#39;vardir_var&#39;])
        estimated_value = estimated_value.flatten()
        vardir_var = vardir_var.to_numpy()[:, 0]
        rse = abs(mse**0.5/estimated_value*100)
        df = pl.DataFrame({
            &#39;Eblup&#39;: estimated_value,
            &#39;MSE&#39;: mse,
            &#39;RSE (%)&#39;: rse})
        error = False
        return results, error, df
        
    except Exception as e:
        error = True
        return str(e), error, None</code></pre>
</details>
<div class="desc"><p>Runs the EBLUP (Empirical Best Linear Unbiased Prediction) area model using the provided parent object.
Parameters:
parent (object): The parent object that contains necessary methods and attributes for running the model.
It should have the following methods and attributes:
- activate_R(): Method to activate R environment.
- model1.get_data(): Method to get the data for the model.
- r_script: An R script to be executed.
Returns:
tuple: A tuple containing:
- result (str): The result of the model execution or error message.
- error (bool): A flag indicating whether an error occurred.
- df (polars.DataFrame or None): A DataFrame containing the estimated values, MSE, and RSE if the model runs successfully, otherwise None.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model" href="index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupArea.run_model_eblup_area" href="#saePisan.service.modelling.running_model.SaeEblupArea.run_model_eblup_area">run_model_eblup_area</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_5">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupPseudo</div>
                    <div class="file-path">service/modelling/running_model/SaeEblupPseudo.html (13.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.running_model.SaeEblupPseudo</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.running_model.SaeEblupPseudo.extract_output_results"><code class="name flex">
<span>def <span class="ident">extract_output_results</span></span>(<span>output)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_output_results(output):
    &#34;&#34;&#34;
    Extracts results from the given output string and returns it as a dictionary.
    &#34;&#34;&#34;
    import re
    results = {}
    
    results[&#39;Model&#39;] = &#39;Pseudo Empirical Best Linear Unbiased Prediction (Fay-Herriot)&#39;

    # Extract out-of-sample and in-sample domains
    results[&#39;Out of sample domains&#39;] = int(re.search(r&#34;Out-of-sample domains:\s+(\d+)&#34;, output).group(1))
    results[&#39;In Sample domains&#39;] = int(re.search(r&#34;In-sample domains:\s+(\d+)&#34;, output).group(1))

    # Extract variance estimation method
    results[&#39;Variance Estimation Method&#39;] = re.search(r&#34;Variance estimation method:\s+([\w\s,]+)&#34;, output).group(1).strip().split(&#39;\n&#39;)[0]
    
    # Extract k and mult_constant
    results[&#39;k&#39;] = float(re.search(r&#34;k\s+=\s+([\d.]+)&#34;, output).group(1))
    results[&#39;Mult constant&#39;] = float(re.search(r&#34;mult_constant\s+=\s+([\d.]+)&#34;, output).group(1))

    # Extract variance of random effects
    results[&#39;Variance of Random Effect&#39;] = float(re.search(r&#34;Variance of random effects:\s+([\d.]+)&#34;, output).group(1))

    # Extract MSE method
    results[&#39;MSE Method&#39;] = re.search(r&#34;MSE method:\s+([\w\s]+)&#34;, output).group(1).strip().split(&#39;\n&#39;)[0]
    
    # Extract transformation
    results[&#39;Transformation&#39;] = re.search(r&#34;Transformation:\s+([\w\s]+)&#34;, output).group(1).strip()

    return results</code></pre>
</details>
<div class="desc"><p>Extracts results from the given output string and returns it as a dictionary.</p></div>
</dd>
<dt id="saePisan.service.modelling.running_model.SaeEblupPseudo.run_model_eblup_pseudo"><code class="name flex">
<span>def <span class="ident">run_model_eblup_pseudo</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model_eblup_pseudo(parent):
    &#34;&#34;&#34;
    Runs the EBLUP (Empirical Best Linear Unbiased Prediction) pseudo model using R scripts.
    Parameters:
    parent (object): The parent object that contains necessary methods and attributes for running the model.
    Returns:
    tuple: A tuple containing:
        - result (str): The result of the R script execution or error message.
        - error (bool): A boolean indicating if an error occurred.
        - df (polars.DataFrame or None): A DataFrame containing the domain, EBLUP estimates, MSE, and RSE (%) if successful, otherwise None.
    The function performs the following steps:
    1. Activates the R environment.
    2. Retrieves and preprocesses the data.
    3. Executes the R script provided by the parent object.
    4. Extracts the estimated values, MSE, and domain from the R environment.
    5. Calculates the Relative Standard Error (RSE).
    6. Constructs a DataFrame with the results.
    7. Returns the results, error status, and DataFrame.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    parent.activate_R()
    df = parent.model1.get_data()
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    convert_df(df, parent)
    result = &#34;&#34;
    error = False
    try:
        ro.r(&#39;data_pseudo &lt;- as.data.frame(r_df)&#39;)
        try:
            ro.r(parent.r_script)  # Menjalankan skrip R
        except RRuntimeError as e:
            result = str(e)
            error = True
            return result, error, None
        ro.r(&#39;estimated_value_pseudo &lt;- getResponse(model_pseudo)\n mse_pseudo &lt;- model_pseudo$MSE$FH \n domain_pseudo &lt;-model_pseudo$MSE$Domain \n refvar_pseudo &lt;-model_pseudo$refVar&#39;)
        domain = ro.conversion.rpy2py(ro.globalenv[&#39;domain_pseudo&#39;])
        result_str = ro.r(&#39;capture.output(print(model_pseudo))&#39;)
        result = &#34;\n&#34;.join(result_str)
        results = extract_output_results(result)
        estimated_value = ro.conversion.rpy2py(ro.globalenv[&#39;estimated_value_pseudo&#39;])
        mse = ro.conversion.rpy2py(ro.globalenv[&#39;mse_pseudo&#39;])
        vardir_var = ro.conversion.rpy2py(ro.globalenv[&#39;vardir_var_pseudo&#39;])
        estimated_value = estimated_value.flatten()
        vardir_var = vardir_var.to_numpy()[:, 0]
        rse = abs(mse**0.5/estimated_value*100)
        df = pl.DataFrame({
            &#39;Domain&#39;: domain,
            &#39;Eblup&#39;: estimated_value,
            &#39;MSE&#39;: mse,
            &#39;RSE (%)&#39;: rse})
        error = False
        return results, error, df
        
    except Exception as e:
        error = True
        return str(e), error, None</code></pre>
</details>
<div class="desc"><p>Runs the EBLUP (Empirical Best Linear Unbiased Prediction) pseudo model using R scripts.
Parameters:
parent (object): The parent object that contains necessary methods and attributes for running the model.
Returns:
tuple: A tuple containing:
- result (str): The result of the R script execution or error message.
- error (bool): A boolean indicating if an error occurred.
- df (polars.DataFrame or None): A DataFrame containing the domain, EBLUP estimates, MSE, and RSE (%) if successful, otherwise None.
The function performs the following steps:
1. Activates the R environment.
2. Retrieves and preprocesses the data.
3. Executes the R script provided by the parent object.
4. Extracts the estimated values, MSE, and domain from the R environment.
5. Calculates the Relative Standard Error (RSE).
6. Constructs a DataFrame with the results.
7. Returns the results, error status, and DataFrame.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model" href="index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupPseudo.extract_output_results" href="#saePisan.service.modelling.running_model.SaeEblupPseudo.extract_output_results">extract_output_results</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupPseudo.run_model_eblup_pseudo" href="#saePisan.service.modelling.running_model.SaeEblupPseudo.run_model_eblup_pseudo">run_model_eblup_pseudo</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_6">
                <div class="file-header">
                    <div>ğŸ“„ SaeEblupUnit</div>
                    <div class="file-path">service/modelling/running_model/SaeEblupUnit.html (16.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.running_model.SaeEblupUnit</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.running_model.SaeEblupUnit.extract_formatted"><code class="name flex">
<span>def <span class="ident">extract_formatted</span></span>(<span>output)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_formatted(output):
    import re
    # Fungsi untuk mengekstrak metode
    def extract_method(output):
        match = re.search(r&#39;Linear mixed model fit by (.*?)\s+(\[.*?\])&#39;, output)
        return f&#34;Linear mixed model fit by {match.group(1).strip()} {match.group(2).strip()}&#34; if match else None

    # Fungsi untuk mengekstrak formula
    def extract_formula(output):
        match = re.search(r&#39;Formula:\s+(.*?)\s+REML criterion&#39;, output)
        return match.group(1).strip() if match else None

    # Fungsi untuk mengekstrak metode dan kriterianya
    def extract_criterion(output):
        match = re.search(r&#39;criterion at convergence:\s+([\d.-]+)&#39;, output)
        return float(match.group(1)) if match else None

    # Fungsi untuk mengekstrak jumlah observasi
    def number_of_obs(output):
        match = re.search(r&#39;Number of obs:\s+(\d+)&#39;, output)
        return int(match.group(1)) if match else None

    # Fungsi untuk mengekstrak kelompok
    def extract_groups(output):
        match = re.search(r&#39;Number of obs:\s+(\d+),\s+groups:\s+(.*?),\s+(\d+)&#39;, output)
        return f&#34;Number of obs: {match.group(1)}, groups: {match.group(2)}, {match.group(3)}&#34; if match else None

    # Fungsi untuk mengekstrak dataframe antara Scaled residuals dan Random effects
    def extract_summary(output):
        match = re.search(r&#39;Scaled residuals:\s+(.*?)\s+Random effects:&#39;, output, re.S)
        if match:
            dataframe = match.group(1).strip()
            rows = dataframe.split(&#39;\n&#39;)
            data = [row.split(maxsplit=5) for row in rows if row.strip()]
            max_columns = 4
            data = [row + [None] * (max_columns - len(row)) for row in data]
            df = pl.DataFrame(data, schema=[&#34;Statistic&#34;, &#34;Value&#34;])
            df = df.with_columns([
                    pl.col(&#34;Statistic&#34;).replace(
                        [&#34;Min&#34;, &#34;1Q&#34;, &#34;Median&#34;, &#34;3Q&#34;, &#34;Max&#34;],
                        [&#34;Minimum&#34;, &#34;Quartil 1&#34;, &#34;Median&#34;, &#34;Quartil 3&#34;, &#34;Maximum&#34;]
                    ).alias(&#34;Statistic&#34;),
                    pl.col(&#34;Value&#34;).cast(pl.Float64).alias(&#34;Value&#34;)
                ])
            return df
        return None

    # Fungsi untuk mengekstrak bagian Fixed effects
    def extract_fixed_effects(output):
        match = re.search(r&#39;Fixed effects:\s+(.*?)\s+Correlation of Fixed Effects:&#39;, output, re.S)
        if match:
            dataframe = match.group(1).strip()
            rows = dataframe.split(&#39;\n&#39;)
            data = [row.split(maxsplit=4) for row in rows[1:] if row.strip()]
            df = pl.DataFrame(data, schema=[&#34;Effect&#34;, &#34;Estimate&#34;, &#34;Standard Error&#34;, &#34;t-value&#34;], orient=&#34;row&#34;)
            return df.with_columns([
                pl.col(&#34;Estimate&#34;).cast(pl.Float64).alias(&#34;Estimate&#34;),
                pl.col(&#34;Standard Error&#34;).cast(pl.Float64).alias(&#34;Standard Error&#34;),
                pl.col(&#34;t-value&#34;).cast(pl.Float64).alias(&#34;t-value&#34;)
            ])
        return None

    # Fungsi untuk mengekstrak bagian Random effects
    def extract_random_effects(output):
        match = re.search(r&#39;Random effects:\s+(.*?)\s+Number of obs:&#39;, output, re.S)
        if match:
            dataframe = match.group(1).strip()
            rows = dataframe.split(&#39;\n&#39;)
            data = []
            for row in rows[1:]:
                if row.strip():
                    parts = row.split()
                    if len(parts) &gt;= 4:
                        group, name, variance, std_dev = parts[0], parts[1], parts[-2], parts[-1]
                    else:
                        group, name, variance, std_dev = parts[0], None, parts[-2], parts[-1]
                    data.append([group, name, float(variance), float(std_dev)])
            return pl.DataFrame(data, schema=[&#34;Group&#34;, &#34;Name&#34;, &#34;Variance&#34;, &#34;Standard Deviation&#34;], orient=&#34;row&#34;)
        return None

    # Fungsi untuk mengekstrak bagian Correlation of Fixed Effects
    def correlation_fixed_effects(output):
        match = re.search(r&#39;Correlation of Fixed Effects:\s+(.*?)\s+boundary&#39;, output, re.S)
        if match:
            dataframe = match.group(1).strip()
            rows = dataframe.split(&#39;\n&#39;)
            data = [row.split() for row in rows if row.strip()]
            data[0].insert(0, &#39;&#39;)
            header = data[0]
            data = data[1:]
            max_columns = len(header)
            data = [row + [None] * (max_columns - len(row)) for row in data]
            return pl.DataFrame(data, schema=header, orient=&#34;row&#34;)
        return None

    # Menggabungkan hasil ekstraksi menjadi string yang user-friendly
    results = {
        &#34;Model&#34;: &#34;EBLUP Unit Level&#34;,
        &#34;Method&#34;: extract_method(output),
        &#34;Formula&#34;: extract_formula(output),
        &#34;Criterion of Convergence&#34;: extract_criterion(output),
        &#34;Number of Observation&#34;: number_of_obs(output),
        &#34;Groups&#34;: extract_groups(output),
        &#34;Summary of Modelling&#34;: extract_summary(output),
        &#34;Fixed Effects&#34;: extract_fixed_effects(output),
        &#34;Random Effects&#34;: extract_random_effects(output),
        &#34;Correlation of Fixed Effect&#34;: correlation_fixed_effects(output)
    }
    return results</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.service.modelling.running_model.SaeEblupUnit.run_model_eblup_unit"><code class="name flex">
<span>def <span class="ident">run_model_eblup_unit</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model_eblup_unit(parent):
    &#34;&#34;&#34;
    Runs the EBLUP (Empirical Best Linear Unbiased Prediction) model using R through rpy2.
    Parameters:
    parent (object): An object that contains the necessary methods and attributes to run the model.
                     It should have the following methods and attributes:
                     - activate_R(): Method to activate the R environment.
                     - model1.get_data(): Method to get the data for the model.
                     - r_script: An R script to be executed.
    Returns:
    tuple: A tuple containing:
           - result (str): The result of the model execution or error message.
           - error (bool): A flag indicating whether an error occurred.
           - df (polars.DataFrame or None): A DataFrame containing the model results with columns &#39;Domain&#39;, &#39;Eblup&#39;, &#39;Sample size&#39;, and &#39;MSE&#39;.
                                            None if an error occurred.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    parent.activate_R()
    df = parent.model1.get_data()
    df = df.filter(~pl.all_horizontal(pl.all().is_null()))
    convert_df(df, parent)
    result = &#34;&#34;
    error = False
    try:
        ro.r(&#39;data_unit &lt;- as.data.frame(r_df)&#39;)
        try:
            ro.r(parent.r_script)  # Menjalankan skrip R
        except RRuntimeError as e:
            result = str(e)
            error = True
            return result, error, None
        ro.r(&#39;domain_unit &lt;- model_unit$est$eblup$domain\n estimated_value_unit &lt;- model_unit$est$eblup$eblup\n n_size_unit &lt;- model_unit$est$eblup$sampsize \n mse_unit &lt;- model_unit$mse$mse&#39;)
        result_str = ro.r(&#39;model_unit$est$fit$summary&#39;)
        result = str(result_str)
        results = extract_formatted(result)
        domain = ro.r(&#39;domain_unit&#39;)
        estimated_value = ro.r(&#39;estimated_value_unit&#39;)
        n_size = ro.r(&#39;n_size_unit&#39;)
        mse = ro.r(&#39;mse_unit&#39;)
        df = pl.DataFrame({
            &#39;Domain&#39;: domain,
            &#39;Eblup&#39;: estimated_value,
            &#39;Sample size&#39;: n_size,
            &#39;MSE&#39;: mse})
        error = False
        return results, error, df
        
    except Exception as e:
        error = True
        return str(e), error, None</code></pre>
</details>
<div class="desc"><p>Runs the EBLUP (Empirical Best Linear Unbiased Prediction) model using R through rpy2.
Parameters:
parent (object): An object that contains the necessary methods and attributes to run the model.
It should have the following methods and attributes:
- activate_R(): Method to activate the R environment.
- model1.get_data(): Method to get the data for the model.
- r_script: An R script to be executed.
Returns:
tuple: A tuple containing:
- result (str): The result of the model execution or error message.
- error (bool): A flag indicating whether an error occurred.
- df (polars.DataFrame or None): A DataFrame containing the model results with columns 'Domain', 'Eblup', 'Sample size', and 'MSE'.
None if an error occurred.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model" href="index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupUnit.extract_formatted" href="#saePisan.service.modelling.running_model.SaeEblupUnit.extract_formatted">extract_formatted</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupUnit.run_model_eblup_unit" href="#saePisan.service.modelling.running_model.SaeEblupUnit.run_model_eblup_unit">run_model_eblup_unit</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_7">
                <div class="file-header">
                    <div>ğŸ“„ SaeHBArea</div>
                    <div class="file-path">service/modelling/running_model/SaeHBArea.html (13.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.running_model.SaeHBArea</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.running_model.SaeHBArea.run_model_hb_area"><code class="name flex">
<span>def <span class="ident">run_model_hb_area</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run_model_hb_area(parent):
    &#34;&#34;&#34;
    Runs the hierarchical Bayesian area model using the provided parent object.
    This function activates the R environment, processes the data, and runs the specified R script
    to perform hierarchical Bayesian modeling. It captures the results and returns them along with
    any errors encountered during execution.
    Parameters:
    parent (object): An object that contains the necessary methods and attributes for running the model.
                     It should have the following methods and attributes:
                     - activate_R(): Method to activate the R environment.
                     - model1.get_data(): Method to get the data for modeling.
                     - r_script: A string containing the R script to be executed.
    Returns:
    tuple: A tuple containing:
           - result_str (str): A string with the formatted results of the model.
           - error (bool): A boolean indicating whether an error occurred.
           - df (polars.DataFrame or None): A DataFrame containing the estimated values and standard deviations,
                                            or None if an error occurred.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    parent.activate_R()
    df = parent.model1.get_data()
    df = df.drop_nulls()
    convert_df(df, parent)
    result = &#34;&#34;
    error = False
    try:
        ro.r(&#39;datahb &lt;- as.data.frame(r_df)&#39;)
        ro.r(&#39;attach(datahb)&#39;)
        try:
            ro.r(parent.r_script)  # Menjalankan skrip R
        except RRuntimeError as e:
            result = str(e)
            error = True
            return result, error, None
        
        from contextlib import contextmanager
        @contextmanager
        def png_device(filename, width=800, height=600, res=100):
            grdevices.png(file=filename, width=width, height=height, res=res)
            try:
                yield
            finally:
                grdevices.dev_off()
        
        script_png = &#34;&#34;&#34;
        sae_autocorr &lt;- function() {
            coda::autocorr.plot(modelhb$plot[[length(modelhb$plot)-1]], col=&#39;brown2&#39;, lwd=2)
        }

        sae_plot &lt;- function() {
            plot(modelhb$plot[[length(modelhb$plot)-1]], col=&#39;brown2&#39;, lwd=2)
        }
        &#34;&#34;&#34;
        
        ro.r(script_png)
        
        r_objects = ro.r(&#34;ls()&#34;)
        
        import rpy2.robjects.lib.grdevices as grdevices
        
        plots = [obj for obj in r_objects if obj.startswith(&#34;sae_&#34;)]

        temp_dir = os.path.join(os.getcwd(), &#34;temp&#34;)
        if not os.path.exists(temp_dir):
            os.makedirs(temp_dir)
        plot_paths = []

        for plot_name in plots:
            plot_path = os.path.join(temp_dir, f&#34;{plot_name}.png&#34;)
            with png_device(plot_path):
                ro.r(f&#34;{plot_name}()&#34;)
            plot_paths.append(plot_path)
        
            
        ro.r(&#39;estimated_value_hb &lt;- modelhb$Est&#39;)
        ro.r(&#39;sd_hb &lt;- modelhb$sd&#39;)
        ro.r(&#39;refVar_hb &lt;- modelhb$refVar&#39;)
        ro.r(&#39;coefficient_hb &lt;- modelhb$coefficient&#39;)
        
        refvar = ro.globalenv[&#39;refVar_hb&#39;]
        refvar = int(float(refvar[0]))
        coefficient = ro.conversion.rpy2py(ro.globalenv[&#39;coefficient_hb&#39;])
        coefficient.reset_index(inplace=True)
        coefficient.columns = [&#39;Parameter&#39;] + list(coefficient.columns[1:])
        coefficient = pl.DataFrame(coefficient)
        
        results ={
            &#34;Model&#34;: &#34;Hierarchical Bayesian&#34;,
            &#34;Estimated Random Effect Variances&#34;: refvar,
            &#34;Estimated Model Coefficient&#34;: coefficient,
        }
        estimated_value = ro.conversion.rpy2py(ro.globalenv[&#39;estimated_value_hb&#39;])
        hb_mean = estimated_value[&#34;MEAN&#34;]
        hb_25 = estimated_value[&#34;25%&#34;]
        hb_50 = estimated_value[&#34;50%&#34;]
        hb_75 = estimated_value[&#34;75%&#34;]
        hb_97_5 = estimated_value[&#34;97.5%&#34;]
        hb_sd = estimated_value[&#34;SD&#34;]
        df = pl.DataFrame({
            &#39;HB Mean&#39;: hb_mean,
            &#39;HB 25%&#39;: hb_25,
            &#39;HB 50%&#39;: hb_50,
            &#39;HB 75%&#39;: hb_75,
            &#39;HB 97.5%&#39;: hb_97_5,
            &#39;Standard Deviation&#39;: hb_sd,})
        ro.r(&#34;detach(datahb)&#34;)
        
        error = False
        return results, error, df, plot_paths
        
    except Exception as e:
        error = True
        return str(e), error, None</code></pre>
</details>
<div class="desc"><p>Runs the hierarchical Bayesian area model using the provided parent object.
This function activates the R environment, processes the data, and runs the specified R script
to perform hierarchical Bayesian modeling. It captures the results and returns them along with
any errors encountered during execution.
Parameters:
parent (object): An object that contains the necessary methods and attributes for running the model.
It should have the following methods and attributes:
- activate_R(): Method to activate the R environment.
- model1.get_data(): Method to get the data for modeling.
- r_script: A string containing the R script to be executed.
Returns:
tuple: A tuple containing:
- result_str (str): A string with the formatted results of the model.
- error (bool): A boolean indicating whether an error occurred.
- df (polars.DataFrame or None): A DataFrame containing the estimated values and standard deviations,
or None if an error occurred.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model" href="index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.running_model.SaeHBArea.run_model_hb_area" href="#saePisan.service.modelling.running_model.SaeHBArea.run_model_hb_area">run_model_hb_area</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_8">
                <div class="file-header">
                    <div>ğŸ“„ convert_df</div>
                    <div class="file-path">service/modelling/running_model/convert_df.html (9.3 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.modelling.running_model.convert_df</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.modelling.running_model.convert_df.convert_df"><code class="name flex">
<span>def <span class="ident">convert_df</span></span>(<span>df, parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def convert_df(df, parent):
    &#34;&#34;&#34;
    Converts a Polars DataFrame to an R DataFrame using rpy2 and handles columns with a high percentage of null values.
    Parameters:
    df (pl.DataFrame): The Polars DataFrame to be converted.
    parent (object): An object that has a method `activate_R()` to activate the R environment.
    Returns:
    None: The function modifies the R global environment by adding the converted DataFrame as &#39;r_df&#39;.
    Notes:
    - Columns with null values exceeding 30% of the DataFrame length are dropped before conversion.
    - The function uses the rpy2_arrow.polars and rpy2.robjects libraries for conversion.
    &#34;&#34;&#34;
    
    import rpy2_arrow.polars as rpy2polars
    import rpy2.robjects as ro
    parent.activate_R()
    
    null_threshold = 0.3 * len(df)
    cols_to_drop = [col for col in df.columns if df[col].null_count() &gt;= null_threshold]
    if len(cols_to_drop)&gt;0:
        df_pandas = df.to_pandas()
        df = pl.from_pandas(df_pandas)
    
    with rpy2polars.converter.context() as cv_ctx:
        r_df = cv_ctx.py2rpy(df)
        ro.globalenv[&#39;r_df&#39;] = r_df</code></pre>
</details>
<div class="desc"><p>Converts a Polars DataFrame to an R DataFrame using rpy2 and handles columns with a high percentage of null values.
Parameters:
df (pl.DataFrame): The Polars DataFrame to be converted.
parent (object): An object that has a method <code>activate_R()</code> to activate the R environment.
Returns:
None: The function modifies the R global environment by adding the converted DataFrame as 'r_df'.
Notes:
- Columns with null values exceeding 30% of the DataFrame length are dropped before conversion.
- The function uses the rpy2_arrow.polars and rpy2.robjects libraries for conversion.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model" href="index.html">saePisan.service.modelling.running_model</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.modelling.running_model.convert_df.convert_df" href="#saePisan.service.modelling.running_model.convert_df.convert_df">convert_df</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_6_9">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/modelling/running_model/index.html (9.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.modelling.running_model</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.modelling.running_model.Projection" href="Projection.html">saePisan.service.modelling.running_model.Projection</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.running_model.SaeEblupArea" href="SaeEblupArea.html">saePisan.service.modelling.running_model.SaeEblupArea</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.running_model.SaeEblupPseudo" href="SaeEblupPseudo.html">saePisan.service.modelling.running_model.SaeEblupPseudo</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.running_model.SaeEblupUnit" href="SaeEblupUnit.html">saePisan.service.modelling.running_model.SaeEblupUnit</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.running_model.SaeHBArea" href="SaeHBArea.html">saePisan.service.modelling.running_model.SaeHBArea</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.modelling.running_model.convert_df" href="convert_df.html">saePisan.service.modelling.running_model.convert_df</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.modelling" href="../index.html">saePisan.service.modelling</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.modelling.running_model.Projection" href="Projection.html">saePisan.service.modelling.running_model.Projection</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupArea" href="SaeEblupArea.html">saePisan.service.modelling.running_model.SaeEblupArea</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupPseudo" href="SaeEblupPseudo.html">saePisan.service.modelling.running_model.SaeEblupPseudo</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.SaeEblupUnit" href="SaeEblupUnit.html">saePisan.service.modelling.running_model.SaeEblupUnit</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.SaeHBArea" href="SaeHBArea.html">saePisan.service.modelling.running_model.SaeHBArea</a></code></li>
<li><code><a title="saePisan.service.modelling.running_model.convert_df" href="convert_df.html">saePisan.service.modelling.running_model.convert_df</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_0">
                <div class="file-header">
                    <div>ğŸ“„ AddColumn</div>
                    <div class="file-path">service/table/AddColumn.html (10.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.table.AddColumn</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.table.AddColumn.add_column_after"><code class="name flex">
<span>def <span class="ident">add_column_after</span></span>(<span>parent, num_columns)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_column_after(parent, num_columns):
    &#34;&#34;&#34;Add columns after the selected column in the specified sheet.&#34;&#34;&#34;
    selection = parent.spreadsheet.selectionModel().selectedIndexes()
    if selection:
        selected_column = selection[0].column()
        parent.model1.addColumnAfter(parent.model1.index(0, selected_column), num_columns)
        parent.update_table(1, parent.model1)</code></pre>
</details>
<div class="desc"><p>Add columns after the selected column in the specified sheet.</p></div>
</dd>
<dt id="saePisan.service.table.AddColumn.add_column_before"><code class="name flex">
<span>def <span class="ident">add_column_before</span></span>(<span>parent, num_columns)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_column_before(parent, num_columns):
    &#34;&#34;&#34;Add columns before the selected column in the specified sheet.&#34;&#34;&#34;
    selection = parent.spreadsheet.selectionModel().selectedIndexes()
    if selection:
        selected_column = selection[0].column()
        parent.model1.addColumnBefore(parent.model1.index(0, selected_column), num_columns)
        parent.update_table(1, parent.model1)</code></pre>
</details>
<div class="desc"><p>Add columns before the selected column in the specified sheet.</p></div>
</dd>
<dt id="saePisan.service.table.AddColumn.show_add_column_after_dialog"><code class="name flex">
<span>def <span class="ident">show_add_column_after_dialog</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_add_column_after_dialog(parent):
    &#34;&#34;&#34;Show a dialog to select which sheet to add a row to.&#34;&#34;&#34;
    num_rows, ok = QInputDialog.getInt(parent, &#34;Add Row&#34;, &#34;Enter number of rows to add:&#34;, 1, 1)
    if ok:
        for _ in range(num_rows):
            add_column_after(parent, num_rows)</code></pre>
</details>
<div class="desc"><p>Show a dialog to select which sheet to add a row to.</p></div>
</dd>
<dt id="saePisan.service.table.AddColumn.show_add_column_before_dialog"><code class="name flex">
<span>def <span class="ident">show_add_column_before_dialog</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_add_column_before_dialog(parent):
    &#34;&#34;&#34;Show a dialog to select which sheet to add a row to.&#34;&#34;&#34;
    num_rows, ok = QInputDialog.getInt(parent, &#34;Add Row&#34;, &#34;Enter number of rows to add:&#34;, 1, 1)
    if ok:
        for _ in range(num_rows):
            add_column_before(parent, num_rows)</code></pre>
</details>
<div class="desc"><p>Show a dialog to select which sheet to add a row to.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.table" href="index.html">saePisan.service.table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.table.AddColumn.add_column_after" href="#saePisan.service.table.AddColumn.add_column_after">add_column_after</a></code></li>
<li><code><a title="saePisan.service.table.AddColumn.add_column_before" href="#saePisan.service.table.AddColumn.add_column_before">add_column_before</a></code></li>
<li><code><a title="saePisan.service.table.AddColumn.show_add_column_after_dialog" href="#saePisan.service.table.AddColumn.show_add_column_after_dialog">show_add_column_after_dialog</a></code></li>
<li><code><a title="saePisan.service.table.AddColumn.show_add_column_before_dialog" href="#saePisan.service.table.AddColumn.show_add_column_before_dialog">show_add_column_before_dialog</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_1">
                <div class="file-header">
                    <div>ğŸ“„ AddRow</div>
                    <div class="file-path">service/table/AddRow.html (10.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.table.AddRow</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.table.AddRow.add_row_after"><code class="name flex">
<span>def <span class="ident">add_row_after</span></span>(<span>parent, num_rows)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_row_after(parent, num_rows):
    &#34;&#34;&#34;Add rows after the selected row in the specified sheet.&#34;&#34;&#34;
    selection = parent.spreadsheet.selectionModel().selectedIndexes()
    if selection:
        selected_row = selection[0].row()
        parent.model1.addRowsAfter(parent.model1.index(selected_row, 0), num_rows)
        parent.update_table(1, parent.model1)</code></pre>
</details>
<div class="desc"><p>Add rows after the selected row in the specified sheet.</p></div>
</dd>
<dt id="saePisan.service.table.AddRow.add_row_before"><code class="name flex">
<span>def <span class="ident">add_row_before</span></span>(<span>parent, num_rows)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_row_before(parent, num_rows):
        &#34;&#34;&#34;Add rows before the selected row in the specified sheet.&#34;&#34;&#34;
        selection = parent.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            selected_row = selection[0].row()
            parent.model1.addRowsBefore(parent.model1.index(selected_row, 0), num_rows)
            parent.update_table(1, parent.model1)</code></pre>
</details>
<div class="desc"><p>Add rows before the selected row in the specified sheet.</p></div>
</dd>
<dt id="saePisan.service.table.AddRow.show_add_row_after_dialog"><code class="name flex">
<span>def <span class="ident">show_add_row_after_dialog</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_add_row_after_dialog(parent):
    &#34;&#34;&#34;Show a dialog to select which sheet to add a row to.&#34;&#34;&#34;
    num_rows, ok = QInputDialog.getInt(parent, &#34;Add Row&#34;, &#34;Enter number of rows to add:&#34;, 1, 1)
    if ok:
        add_row_after(parent, num_rows)</code></pre>
</details>
<div class="desc"><p>Show a dialog to select which sheet to add a row to.</p></div>
</dd>
<dt id="saePisan.service.table.AddRow.show_add_row_before_dialog"><code class="name flex">
<span>def <span class="ident">show_add_row_before_dialog</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_add_row_before_dialog(parent):
        &#34;&#34;&#34;Show a dialog to select which sheet to add a row to.&#34;&#34;&#34;
        num_rows, ok = QInputDialog.getInt(parent, &#34;Add Row&#34;, &#34;Enter number of rows to add:&#34;, 1, 1)
        if ok:
            add_row_before(parent, num_rows)</code></pre>
</details>
<div class="desc"><p>Show a dialog to select which sheet to add a row to.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.table" href="index.html">saePisan.service.table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.table.AddRow.add_row_after" href="#saePisan.service.table.AddRow.add_row_after">add_row_after</a></code></li>
<li><code><a title="saePisan.service.table.AddRow.add_row_before" href="#saePisan.service.table.AddRow.add_row_before">add_row_before</a></code></li>
<li><code><a title="saePisan.service.table.AddRow.show_add_row_after_dialog" href="#saePisan.service.table.AddRow.show_add_row_after_dialog">show_add_row_after_dialog</a></code></li>
<li><code><a title="saePisan.service.table.AddRow.show_add_row_before_dialog" href="#saePisan.service.table.AddRow.show_add_row_before_dialog">show_add_row_before_dialog</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_2">
                <div class="file-header">
                    <div>ğŸ“„ DeleteColumn</div>
                    <div class="file-path">service/table/DeleteColumn.html (9.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.table.DeleteColumn</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.table.DeleteColumn.confirm_delete_selected_columns"><code class="name flex">
<span>def <span class="ident">confirm_delete_selected_columns</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def confirm_delete_selected_columns(parent):
    &#34;&#34;&#34;Show a confirmation dialog before deleting selected columns.&#34;&#34;&#34;
    reply = QMessageBox.question(parent, &#39;Confirm Delete&#39;, &#39;Are you sure you want to delete the selected columns?&#39;,
                                    QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No, QMessageBox.StandardButton.No)
    if reply == QMessageBox.StandardButton.Yes:
        delete_selected_columns(parent)</code></pre>
</details>
<div class="desc"><p>Show a confirmation dialog before deleting selected columns.</p></div>
</dd>
<dt id="saePisan.service.table.DeleteColumn.delete_selected_columns"><code class="name flex">
<span>def <span class="ident">delete_selected_columns</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_selected_columns(parent):
        &#34;&#34;&#34;Delete selected columns in the spreadsheet.&#34;&#34;&#34;
        selection = parent.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            columns = sorted(set(index.column() for index in selection), reverse=False)
            parent.model1.deleteColumns(columns[0], len(columns))
            parent.update_table(1, parent.model1)</code></pre>
</details>
<div class="desc"><p>Delete selected columns in the spreadsheet.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.table" href="index.html">saePisan.service.table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.table.DeleteColumn.confirm_delete_selected_columns" href="#saePisan.service.table.DeleteColumn.confirm_delete_selected_columns">confirm_delete_selected_columns</a></code></li>
<li><code><a title="saePisan.service.table.DeleteColumn.delete_selected_columns" href="#saePisan.service.table.DeleteColumn.delete_selected_columns">delete_selected_columns</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_3">
                <div class="file-header">
                    <div>ğŸ“„ DeleteRow</div>
                    <div class="file-path">service/table/DeleteRow.html (8.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.table.DeleteRow</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.table.DeleteRow.confirm_delete_selected_rows"><code class="name flex">
<span>def <span class="ident">confirm_delete_selected_rows</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def confirm_delete_selected_rows(parent):
        &#34;&#34;&#34;Show a confirmation dialog before deleting selected rows.&#34;&#34;&#34;
        reply = QMessageBox.question(parent, &#39;Confirm Delete&#39;, &#39;Are you sure you want to delete the selected rows?&#39;,
                                     QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No, QMessageBox.StandardButton.No)
        if reply == QMessageBox.StandardButton.Yes:
            delete_selected_rows(parent)</code></pre>
</details>
<div class="desc"><p>Show a confirmation dialog before deleting selected rows.</p></div>
</dd>
<dt id="saePisan.service.table.DeleteRow.delete_selected_rows"><code class="name flex">
<span>def <span class="ident">delete_selected_rows</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_selected_rows(parent):
    &#34;&#34;&#34;Delete selected rows in the spreadsheet.&#34;&#34;&#34;
    selection = parent.spreadsheet.selectionModel().selectedIndexes()
    if selection:
        parent.model1.deleteRows(selection[0].row(), len(selection))
        parent.update_table(1, parent.model1)</code></pre>
</details>
<div class="desc"><p>Delete selected rows in the spreadsheet.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.table" href="index.html">saePisan.service.table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.table.DeleteRow.confirm_delete_selected_rows" href="#saePisan.service.table.DeleteRow.confirm_delete_selected_rows">confirm_delete_selected_rows</a></code></li>
<li><code><a title="saePisan.service.table.DeleteRow.delete_selected_rows" href="#saePisan.service.table.DeleteRow.delete_selected_rows">delete_selected_rows</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_4">
                <div class="file-header">
                    <div>ğŸ“„ GoToColumn</div>
                    <div class="file-path">service/table/GoToColumn.html (10.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.table.GoToColumn</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.table.GoToColumn.go_to_end_column"><code class="name flex">
<span>def <span class="ident">go_to_end_column</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def go_to_end_column(parent):
    &#34;&#34;&#34;Move the selection to the end column while keeping the row the same.&#34;&#34;&#34;
    if parent.tab_widget.currentIndex() == 0:
        selection = parent.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            start_row = selection[0].row()
            end_col = parent.model1.columnCount(parent.model1.index(0, 0)) - 1
            parent.spreadsheet.setCurrentIndex(parent.model1.index(start_row, end_col))
            parent.spreadsheet.selectionModel().select(parent.model1.index(start_row, end_col), QItemSelectionModel.SelectionFlag.ClearAndSelect)
    elif parent.tab_widget.currentIndex() == 1:
        selection = parent.table_view2.selectionModel().selectedIndexes()
        if selection:
            start_row = selection[0].row()
            end_col = parent.model2.columnCount(parent.model2.index(0, 0)) - 1
            parent.table_view2.setCurrentIndex(parent.model2.index(start_row, end_col))
            parent.table_view2.selectionModel().select(parent.model2.index(start_row, end_col), QItemSelectionModel.SelectionFlag.ClearAndSelect)</code></pre>
</details>
<div class="desc"><p>Move the selection to the end column while keeping the row the same.</p></div>
</dd>
<dt id="saePisan.service.table.GoToColumn.go_to_start_column"><code class="name flex">
<span>def <span class="ident">go_to_start_column</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def go_to_start_column(parent):
        &#34;&#34;&#34;Move the selection to the start column while keeping the row the same.&#34;&#34;&#34;
        if parent.tab_widget.currentIndex() == 0:
            selection = parent.spreadsheet.selectionModel().selectedIndexes()
            if selection:
                start_row = selection[0].row()
                parent.spreadsheet.setCurrentIndex(parent.model1.index(start_row, 0))
                parent.spreadsheet.selectionModel().select(parent.model1.index(start_row, 0), QItemSelectionModel.SelectionFlag.ClearAndSelect)
        elif parent.tab_widget.currentIndex() == 1:
            selection = parent.table_view2.selectionModel().selectedIndexes()
            if selection:
                start_row = selection[0].row()
                parent.table_view2.setCurrentIndex(parent.model2.index(start_row, 0))
                parent.table_view2.selectionModel().select(parent.model2.index(start_row, 0), QItemSelectionModel.SelectionFlag.ClearAndSelect)</code></pre>
</details>
<div class="desc"><p>Move the selection to the start column while keeping the row the same.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.table" href="index.html">saePisan.service.table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.table.GoToColumn.go_to_end_column" href="#saePisan.service.table.GoToColumn.go_to_end_column">go_to_end_column</a></code></li>
<li><code><a title="saePisan.service.table.GoToColumn.go_to_start_column" href="#saePisan.service.table.GoToColumn.go_to_start_column">go_to_start_column</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_5">
                <div class="file-header">
                    <div>ğŸ“„ GoToRow</div>
                    <div class="file-path">service/table/GoToRow.html (9.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.table.GoToRow</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.table.GoToRow.go_to_end_row"><code class="name flex">
<span>def <span class="ident">go_to_end_row</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def go_to_end_row(parent):
    &#34;&#34;&#34;Move the selection to the end row while keeping the column the same.&#34;&#34;&#34;
    if parent.tab_widget.currentIndex() == 0:
        selection = parent.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            start_col = selection[0].column()
            end_row = parent.model1.rowCount(QModelIndex()) - 1
            parent.spreadsheet.setCurrentIndex(parent.model1.index(end_row, start_col))
            parent.spreadsheet.selectionModel().select(parent.model1.index(end_row, start_col), QItemSelectionModel.SelectionFlag.ClearAndSelect)
    elif parent.tab_widget.currentIndex() == 1:
        selection = parent.table_view2.selectionModel().selectedIndexes()
        if selection:
            start_col = selection[0].column()
            end_row = parent.model2.rowCount(QModelIndex()) - 1
            parent.table_view2.setCurrentIndex(parent.model2.index(end_row, start_col))
            parent.table_view2.selectionModel().select(parent.model2.index(end_row, start_col), QItemSelectionModel.SelectionFlag.ClearAndSelect)</code></pre>
</details>
<div class="desc"><p>Move the selection to the end row while keeping the column the same.</p></div>
</dd>
<dt id="saePisan.service.table.GoToRow.go_to_start_row"><code class="name flex">
<span>def <span class="ident">go_to_start_row</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def go_to_start_row(parent):
        &#34;&#34;&#34;Move the selection to the start row while keeping the column the same.&#34;&#34;&#34;
        selection = parent.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            start_col = selection[0].column()
            parent.spreadsheet.setCurrentIndex(parent.model1.index(0, start_col))
            parent.spreadsheet.selectionModel().select(parent.model1.index(0, start_col), QItemSelectionModel.SelectionFlag.ClearAndSelect)</code></pre>
</details>
<div class="desc"><p>Move the selection to the start row while keeping the column the same.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.table" href="index.html">saePisan.service.table</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.table.GoToRow.go_to_end_row" href="#saePisan.service.table.GoToRow.go_to_end_row">go_to_end_row</a></code></li>
<li><code><a title="saePisan.service.table.GoToRow.go_to_start_row" href="#saePisan.service.table.GoToRow.go_to_start_row">go_to_start_row</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_6">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/table/index.html (8.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.table</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.table.AddColumn" href="AddColumn.html">saePisan.service.table.AddColumn</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.table.AddRow" href="AddRow.html">saePisan.service.table.AddRow</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.table.DeleteColumn" href="DeleteColumn.html">saePisan.service.table.DeleteColumn</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.table.DeleteRow" href="DeleteRow.html">saePisan.service.table.DeleteRow</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.table.GoToColumn" href="GoToColumn.html">saePisan.service.table.GoToColumn</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.table.GoToRow" href="GoToRow.html">saePisan.service.table.GoToRow</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.table.AddColumn" href="AddColumn.html">saePisan.service.table.AddColumn</a></code></li>
<li><code><a title="saePisan.service.table.AddRow" href="AddRow.html">saePisan.service.table.AddRow</a></code></li>
<li><code><a title="saePisan.service.table.DeleteColumn" href="DeleteColumn.html">saePisan.service.table.DeleteColumn</a></code></li>
<li><code><a title="saePisan.service.table.DeleteRow" href="DeleteRow.html">saePisan.service.table.DeleteRow</a></code></li>
<li><code><a title="saePisan.service.table.GoToColumn" href="GoToColumn.html">saePisan.service.table.GoToColumn</a></code></li>
<li><code><a title="saePisan.service.table.GoToRow" href="GoToRow.html">saePisan.service.table.GoToRow</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_7">
                <div class="file-header">
                    <div>ğŸ“„ convert</div>
                    <div class="file-path">service/utils/convert.html (10.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.utils.convert</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.utils.convert.get_data"><code class="name flex">
<span>def <span class="ident">get_data</span></span>(<span>parent, df=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_data(parent, df=None):
    &#34;&#34;&#34;
    Retrieves data from the parent model or uses the provided dataframe, processes it, and converts it to an R dataframe.
    Args:
        parent: An object that contains a model with a `get_data` method.
        df: A pandas dataframe to be used instead of retrieving data from the parent model. Default is None.
    Returns:
        None. The resulting R dataframe is stored in the R global environment as &#39;r_df&#39;.
    Process:
        1. Imports necessary modules from `rpy2` and `rpy2_arrow.polars`.
        2. Retrieves data from the parent model or uses the provided dataframe.
        3. Replaces spaces in column names with underscores.
        4. Drops columns with a high percentage of null values (threshold: 30%).
        5. Converts the dataframe to a pandas dataframe if columns are dropped.
        6. Converts the pandas dataframe to a polars dataframe.
        7. Converts the polars dataframe to an R dataframe and assigns it to the R global environment.
    &#34;&#34;&#34;
    
    import rpy2.robjects as ro
    import rpy2_arrow.polars as rpy2polars
    
    if df is None:
        df = parent.model.get_data()
    
    null_threshold = 0.3 * len(df)
    cols_to_drop = [col for col in df.columns if df[col].null_count() &gt;= null_threshold]
    if len(cols_to_drop) &gt; 0:
        df_pandas = df.to_pandas()
        df = pl.from_pandas(df_pandas)
    with rpy2polars.converter.context() as cv_ctx:
        r_df = cv_ctx.py2rpy(df)
        ro.globalenv[&#39;r_df&#39;] = r_df</code></pre>
</details>
<div class="desc"><p>Retrieves data from the parent model or uses the provided dataframe, processes it, and converts it to an R dataframe.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>An object that contains a model with a <code><a title="saePisan.service.utils.convert.get_data" href="#saePisan.service.utils.convert.get_data">get_data()</a></code> method.</dd>
<dt><strong><code>df</code></strong></dt>
<dd>A pandas dataframe to be used instead of retrieving data from the parent model. Default is None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None. The resulting R dataframe is stored in the R global environment as 'r_df'.</p>
<h2 id="process">Process</h2>
<ol>
<li>Imports necessary modules from <code>rpy2</code> and <code>rpy2_arrow.polars</code>.</li>
<li>Retrieves data from the parent model or uses the provided dataframe.</li>
<li>Replaces spaces in column names with underscores.</li>
<li>Drops columns with a high percentage of null values (threshold: 30%).</li>
<li>Converts the dataframe to a pandas dataframe if columns are dropped.</li>
<li>Converts the pandas dataframe to a polars dataframe.</li>
<li>Converts the polars dataframe to an R dataframe and assigns it to the R global environment.</li>
</ol></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.utils" href="index.html">saePisan.service.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.utils.convert.get_data" href="#saePisan.service.utils.convert.get_data">get_data</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_8">
                <div class="file-header">
                    <div>ğŸ“„ enable_disable</div>
                    <div class="file-path">service/utils/enable_disable.html (11.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.utils.enable_disable</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.utils.enable_disable.disable_service"><code class="name flex">
<span>def <span class="ident">disable_service</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def disable_service(parent):
    &#34;&#34;&#34;
    Disables various UI components of the given parent object.
    This function sets the following properties of the parent object:
    - Sets the r_script_edit component to read-only.
    - Makes the icon_label component visible.
    - Changes the text of the ok_button to &#34;Running model...&#34;.
    - Disables the ok_button.
    - Disables the option_button.
    Args:
        parent: The parent object containing the UI components to be modified.
    &#34;&#34;&#34;
    
    parent.r_script_edit.setReadOnly(True)
    parent.icon_label.setVisible(True)
    parent.ok_button.setText(&#34;Running model...&#34;)
    parent.ok_button.setEnabled(False)
    parent.option_button.setEnabled(False)</code></pre>
</details>
<div class="desc"><p>Disables various UI components of the given parent object.
This function sets the following properties of the parent object:
- Sets the r_script_edit component to read-only.
- Makes the icon_label component visible.
- Changes the text of the ok_button to "Running model&hellip;".
- Disables the ok_button.
- Disables the option_button.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong></dt>
<dd>The parent object containing the UI components to be modified.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.utils.enable_disable.enable_service"><code class="name flex">
<span>def <span class="ident">enable_service</span></span>(<span>parent, error, results)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def enable_service(parent, error, results):
    &#34;&#34;&#34;
    Enables and updates the UI elements of the parent widget based on the result of a modelling process.
    Args:
        parent (QWidget): The parent widget containing the UI elements to be updated.
        error (bool): A flag indicating whether an error occurred during the modelling process.
        result (str): The result message to be displayed in case of an error.
    Updates:
        - Enables the &#39;ok_button&#39; and &#39;option_button&#39; of the parent widget.
        - Hides the &#39;icon_label&#39; of the parent widget.
        - Clears and makes the &#39;r_script_edit&#39; editable.
        - Displays a success message if no error occurred, otherwise displays an error message.
        - Sets the text of the &#39;ok_button&#39; to &#34;Run Model&#34;.
    &#34;&#34;&#34;
    
    parent.ok_button.setEnabled(True)
    parent.option_button.setEnabled(True)
    parent.icon_label.setVisible(False)
    parent.r_script_edit.clear()
    parent.r_script_edit.setReadOnly(False)
    if not error:
        QMessageBox.information(parent, &#34;Success&#34;, &#34;Modelling finished!&#34;)
    else:
        QMessageBox.critical(parent, &#34;Error&#34;, str(results))
    parent.ok_button.setText(&#34;Run Model&#34;)</code></pre>
</details>
<div class="desc"><p>Enables and updates the UI elements of the parent widget based on the result of a modelling process.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget containing the UI elements to be updated.</dd>
<dt><strong><code>error</code></strong> :&ensp;<code>bool</code></dt>
<dd>A flag indicating whether an error occurred during the modelling process.</dd>
<dt><strong><code>result</code></strong> :&ensp;<code>str</code></dt>
<dd>The result message to be displayed in case of an error.</dd>
</dl>
<h2 id="updates">Updates</h2>
<ul>
<li>Enables the 'ok_button' and 'option_button' of the parent widget.</li>
<li>Hides the 'icon_label' of the parent widget.</li>
<li>Clears and makes the 'r_script_edit' editable.</li>
<li>Displays a success message if no error occurred, otherwise displays an error message.</li>
<li>Sets the text of the 'ok_button' to "Run Model".</li>
</ul></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.utils" href="index.html">saePisan.service.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.utils.enable_disable.disable_service" href="#saePisan.service.utils.enable_disable.disable_service">disable_service</a></code></li>
<li><code><a title="saePisan.service.utils.enable_disable.enable_service" href="#saePisan.service.utils.enable_disable.enable_service">enable_service</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_7_9">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">service/utils/index.html (7.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.service.utils</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.service.utils.convert" href="convert.html">saePisan.service.utils.convert</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.utils.enable_disable" href="enable_disable.html">saePisan.service.utils.enable_disable</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.service.utils.utils" href="utils.html">saePisan.service.utils.utils</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service" href="../index.html">saePisan.service</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.service.utils.convert" href="convert.html">saePisan.service.utils.convert</a></code></li>
<li><code><a title="saePisan.service.utils.enable_disable" href="enable_disable.html">saePisan.service.utils.enable_disable</a></code></li>
<li><code><a title="saePisan.service.utils.utils" href="utils.html">saePisan.service.utils.utils</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_0">
                <div class="file-header">
                    <div>ğŸ“„ utils</div>
                    <div class="file-path">service/utils/utils.html (28.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.service.utils.utils</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.service.utils.utils.add_copy_context_menu_to_table"><code class="name flex">
<span>def <span class="ident">add_copy_context_menu_to_table</span></span>(<span>table_view)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_copy_context_menu_to_table(table_view):
    &#34;&#34;&#34;
    Adds a context menu to the QTableView for copying data (including headers and content).
    Args:
        table_view (QTableView): The table view to which the context menu will be added.
    &#34;&#34;&#34;
    def copy_table_data():
        &#34;&#34;&#34;
        Copies the table data (headers and content) to the clipboard.
        &#34;&#34;&#34;
        model = table_view.model()
        if model is None:
            return

        # Get headers
        headers = [model.headerData(i, Qt.Orientation.Horizontal) for i in range(model.columnCount())]
        data = &#39;\t&#39;.join(headers) + &#39;\n&#39;

        # Get table content
        for row in range(model.rowCount()):
            row_data = [model.index(row, col).data() for col in range(model.columnCount())]
            data += &#39;\t&#39;.join(map(str, row_data)) + &#39;\n&#39;

        # Copy to clipboard
        clipboard = QApplication.clipboard()
        clipboard.setText(data)

    # Add context menu
    table_view.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    table_view.customContextMenuRequested.connect(lambda pos: show_table_context_menu(pos, table_view, copy_table_data))
    
    header = table_view.horizontalHeader()
    header.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    header.customContextMenuRequested.connect(lambda pos: show_table_context_menu(pos, table_view, copy_table_data))</code></pre>
</details>
<div class="desc"><p>Adds a context menu to the QTableView for copying data (including headers and content).</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>table_view</code></strong> :&ensp;<code>QTableView</code></dt>
<dd>The table view to which the context menu will be added.</dd>
</dl></div>
</dd>
<dt id="saePisan.service.utils.utils.check_script"><code class="name flex">
<span>def <span class="ident">check_script</span></span>(<span>r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def check_script(r_script):
    &#34;&#34;&#34;
    Checks if the provided R script string is not empty.
    Parameters:
    r_script (str): The R script string to check.
    Returns:
    bool: True if the R script string is not empty, False otherwise.
    &#34;&#34;&#34;
    
    if r_script == &#34;&#34;:
        QMessageBox.warning(None, &#34;Warning&#34;, &#34;R sript cannot empty&#34;)
        return False
    return True</code></pre>
</details>
<div class="desc"><p>Checks if the provided R script string is not empty.
Parameters:
r_script (str): The R script string to check.
Returns:
bool: True if the R script string is not empty, False otherwise.</p></div>
</dd>
<dt id="saePisan.service.utils.utils.copy_output_image"><code class="name flex">
<span>def <span class="ident">copy_output_image</span></span>(<span>parent, image_label)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def copy_output_image(parent, image_label):
    &#34;&#34;&#34;Menyalin gambar dari QLabel ke clipboard dengan simpan file sementara (tanpa loop).&#34;&#34;&#34;
    pixmap = image_label.pixmap()
    
    if pixmap and not pixmap.isNull():
        temp_folder = os.path.join(parent.path, &#39;temp&#39;)
        temp_path = os.path.join(temp_folder, &#39;temp_image.png&#39;)

        os.makedirs(temp_folder, exist_ok=True)

        if pixmap.save(temp_path):
            print(f&#34;Gambar disimpan di: {temp_path}&#34;)
            
            clipboard = QApplication.clipboard()
            clipboard.setPixmap(QPixmap(temp_path))

            if os.path.exists(temp_path):  
                os.remove(temp_path)
        else:
            print(&#34;Gagal menyimpan gambar sementara.&#34;)
    else:
        print(&#34;Tidak ada gambar untuk disalin.&#34;)</code></pre>
</details>
<div class="desc"><p>Menyalin gambar dari QLabel ke clipboard dengan simpan file sementara (tanpa loop).</p></div>
</dd>
<dt id="saePisan.service.utils.utils.delete_all_outputs"><code class="name flex">
<span>def <span class="ident">delete_all_outputs</span></span>(<span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_all_outputs(parent):
    &#34;&#34;&#34;Removes all output cards from the output layout&#34;&#34;&#34;
    while parent.output_layout.count() &gt; 0:
        item = parent.output_layout.takeAt(0)
        widget = item.widget()
        if widget is not None:
            widget.deleteLater()
    parent.data = []  # Clear stored data</code></pre>
</details>
<div class="desc"><p>Removes all output cards from the output layout</p></div>
</dd>
<dt id="saePisan.service.utils.utils.delete_output_card"><code class="name flex">
<span>def <span class="ident">delete_output_card</span></span>(<span>parent, card_frame)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_output_card(parent, card_frame):
    &#34;&#34;&#34;Delete the selected output card&#34;&#34;&#34;
    parent.output_layout.removeWidget(card_frame)
    card_frame.deleteLater()

    # Optional: remove from parent.data list
    if hasattr(parent, &#34;data&#34;) and isinstance(parent.data, list):
        index = parent.output_layout.indexOf(card_frame)
        if 0 &lt;= index &lt; len(parent.data):
            del parent.data[index]</code></pre>
</details>
<div class="desc"><p>Delete the selected output card</p></div>
</dd>
<dt id="saePisan.service.utils.utils.display_script_and_output"><code class="name flex">
<span>def <span class="ident">display_script_and_output</span></span>(<span>parent, r_script, results, plot_paths=None, timestamps=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def display_script_and_output(parent, r_script, results, plot_paths=None, timestamps=None):
    &#34;&#34;&#34;
    Adds a new output card to the layout displaying the provided R script and its result.
    Parameters:
    parent (object): The parent widget containing the layout to which the card will be added.
    r_script (str): The R script to be displayed in the card.
    results (dict or str): The output result of the R script to be displayed in the card. If empty or None, only the script will be displayed.
    plot_paths (list): List of paths to plot images to be displayed.
    Returns:
    None
    &#34;&#34;&#34;
    # Membuat frame sebagai card
    card_frame = QFrame()
    card_frame.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    card_frame.customContextMenuRequested.connect(lambda pos: show_context_menu(parent, pos, card_frame))
    card_frame.setStyleSheet(&#34;&#34;&#34;
        QFrame {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
        }
        QFrame:hover {
            background-color: #f0f0f0;
            border: 1px solid #c35112;
        }
    &#34;&#34;&#34;)

    card_frame.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Maximum)

    # Layout vertikal untuk card
    card_layout = QVBoxLayout(card_frame)
    card_layout.setSpacing(8)

    # Bagian Script
    label_script = QLabel(&#34;&lt;b&gt;R Script:&lt;/b&gt;&#34;)
    label_script.setStyleSheet(&#34;color: #333; margin-bottom: 5px;&#34;)
    out = {}
    out[&#34;r_script&#34;] = r_script  # Simpan r_script ke dalam data parent untuk referensi
    result = {}
    # Bersihkan baris kosong di akhir script
    lines = r_script.splitlines()
    while lines and lines[-1].strip() == &#34;&#34;:
        lines.pop()
    cleaned_script = &#34;\n&#34;.join(lines)

    script_box = QTextEdit()
    script_box.setPlainText(cleaned_script)
    script_box.setReadOnly(True)
    script_box.setStyleSheet(&#34;&#34;&#34;
        QTextEdit {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px;
            font-family: &#34;Courier New&#34;, Courier, monospace;
            font-size: 9pt;
        }
    &#34;&#34;&#34;)
    max_height = 400
    calculated_height = script_box.fontMetrics().lineSpacing() * (cleaned_script.count(&#39;\n&#39;) + 2)
    script_box.setFixedHeight(min(calculated_height, max_height))
    script_box.setVerticalScrollBarPolicy(Qt.ScrollBarPolicy.ScrollBarAlwaysOn if calculated_height &gt; max_height else Qt.ScrollBarPolicy.ScrollBarAlwaysOff)

    card_layout.addWidget(label_script)
    card_layout.addWidget(script_box)
    # Bagian Output (jika ada)
    if isinstance(results, dict):
        label_output = QLabel(&#34;&lt;b&gt;Output:&lt;/b&gt;&#34;)
        label_output.setTextInteractionFlags(Qt.TextInteractionFlag.TextSelectableByMouse)
        label_output.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
        card_layout.addWidget(label_output)
        
        if &#34;Model&#34; in results:
            model_value = results[&#34;Model&#34;]
            model_label = QLabel(f&#34;&lt;b&gt;Summary of {model_value}&lt;/b&gt;&#34;)
            model_label.setTextInteractionFlags(Qt.TextInteractionFlag.TextSelectableByMouse)
            model_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
            model_label.setStyleSheet(&#34;font-size: 20px; color: #333; margin-top: 5px;&#34;)
            card_layout.addWidget(model_label)
            result[&#34;Model&#34;] = results[&#34;Model&#34;]

        # Add timestamp for generation
        timestamp = datetime.now().strftime(&#34;%H:%M:%S %d-%m-%Y&#34;) if timestamps is None else timestamps
        out[&#34;timestamp&#34;] = timestamp
        timestamp_label = QLabel(f&#34;&lt;i&gt;Generated at: {timestamp}&lt;/i&gt;&#34;)
        timestamp_label.setAlignment(Qt.AlignmentFlag.AlignRight)
        timestamp_label.setStyleSheet(&#34;font-size: 12px; color: #666; margin-top: 10px;&#34;)
        card_layout.addWidget(timestamp_label)

        for key, value in results.items():
            # Skip displaying if the key is &#34;Model&#34;
            if key == &#34;Model&#34;:
                continue
            elif key==&#34;Plot&#34;:
                continue

            # Tambahkan header untuk setiap key
            key_label = QLabel(f&#34;&lt;b&gt;{key}:&lt;/b&gt;&#34;)
            key_label.setTextInteractionFlags(Qt.TextInteractionFlag.TextSelectableByMouse)
            key_label.setStyleSheet(&#34;color: #333; margin-top: 5px;&#34;)
            card_layout.addWidget(key_label)

            if isinstance(value, pl.DataFrame):
                table_view = QTableView()
                model = QStandardItemModel()
                model.setHorizontalHeaderLabels(value.columns)

                for row in value.iter_rows(named=True):
                    items = [QStandardItem(str(row[col])) for col in value.columns]
                    model.appendRow(items)
                
                result[key] = value.to_dict(as_series=False)
                
                table_view.setModel(model)
                table_view.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
                table_view.horizontalHeader().setSectionResizeMode(QHeaderView.ResizeMode.Stretch)
                table_view.horizontalHeader().setFixedHeight(50)

                # Hitung tinggi tabel berdasarkan jumlah baris
                row_height = table_view.verticalHeader().defaultSectionSize()
                header_height = table_view.horizontalHeader().height()
                total_height = row_height * model.rowCount() + header_height + 20  # Tambahkan margin
                table_view.setFixedHeight(total_height)

                table_view.setStyleSheet(&#34;&#34;&#34;
                    QTableView {
                        background-color: #fff;
                        border: 1px solid #ccc;
                        border-radius: 4px;
                        padding: 5px;
                        font-family: Consolas, Courier New, monospace;
                    }
                &#34;&#34;&#34;)
                add_copy_context_menu_to_table(table_view)
                card_layout.addWidget(table_view)
                
            else:
                # Tampilkan nilai biasa sebagai teks
                value_label = QLabel(str(value))
                value_label.setTextInteractionFlags(Qt.TextInteractionFlag.TextSelectableByMouse)
                value_label.setStyleSheet(&#34;color: #333; margin-left: 10px;&#34;)
                card_layout.addWidget(value_label)
                result[key] = value
        out[&#34;result&#34;] = result  # Simpan hasil ke dalam data parent untuk referensi

    elif results:
        label_output = QLabel(&#34;&lt;b&gt;Output:&lt;/b&gt;&#34;)
        label_output.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
        result_box = QTextEdit()
        result_box.setPlainText(results)
        result_box.setReadOnly(True)
        result_box.setStyleSheet(&#34;&#34;&#34;
            QTextEdit {
                background-color: #fff;
                border: 1px solid #ccc;
                border-radius: 4px;
                padding: 5px;
                font-family: Consolas, Courier New, monospace;
            }
        &#34;&#34;&#34;)
        
        card_layout.addWidget(label_output)
        card_layout.addWidget(result_box)

    if plot_paths is not None:
        label_plot = QLabel(&#34;&lt;b&gt;Plot:&lt;/b&gt;&#34;)
        label_plot.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
        card_layout.addWidget(label_plot)

        for plot_path in plot_paths:
            if os.path.exists(plot_path):
                pixmap = QPixmap(plot_path)
                label = QLabel()
                label.setPixmap(pixmap)
                label.setFixedSize(800, 600)
                label.setScaledContents(True)
                label.setStyleSheet(&#34;border: 1px solid #ccc; border-radius: 4px;&#34;)

                # Enable right-click menu on image
                label.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
                label.customContextMenuRequested.connect(
                    lambda pos, l=label, p=plot_path: show_image_context_menu(parent, pos, l, p)
                )

                card_layout.addWidget(label)

                # Simpan image ke path baru
                dest_folder = os.path.join(parent.path, &#39;file-data&#39;, &#39;temp&#39;)
                os.makedirs(dest_folder, exist_ok=True)
                unique_id = uuid.uuid4().hex
                filename, ext = os.path.splitext(os.path.basename(plot_path))
                dest_path = os.path.join(dest_folder, f&#34;{filename}_{unique_id}{ext}&#34;)
                pixmap.save(dest_path)
                if &#34;Plot&#34; not in result:
                    result[&#34;Plot&#34;] = []
                result[&#34;Plot&#34;].append(dest_path)
                os.remove(plot_path)
                
    # Tambahkan card ke layout utama
    parent.output_layout.addWidget(card_frame)
    # parent.output_layout.addStretch()
    parent.tab_widget.setCurrentWidget(parent.tab3)
    if not hasattr(parent, &#34;data&#34;) or not isinstance(parent.data, list):
        parent.data = []
    parent.data.append(out)
    parent.autosave_data()</code></pre>
</details>
<div class="desc"><p>Adds a new output card to the layout displaying the provided R script and its result.
Parameters:
parent (object): The parent widget containing the layout to which the card will be added.
r_script (str): The R script to be displayed in the card.
results (dict or str): The output result of the R script to be displayed in the card. If empty or None, only the script will be displayed.
plot_paths (list): List of paths to plot images to be displayed.
Returns:
None</p></div>
</dd>
<dt id="saePisan.service.utils.utils.show_context_menu"><code class="name flex">
<span>def <span class="ident">show_context_menu</span></span>(<span>parent, pos, card_frame)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_context_menu(parent, pos, card_frame):
    &#34;&#34;&#34;Display right-click menu on each output card&#34;&#34;&#34;
    menu = QMenu(parent)

    copy_image_action = menu.addAction(&#34;Copy Output Image&#34;)
    delete_action = menu.addAction(&#34;Delete Output&#34;)
    delete_all_action = menu.addAction(&#34;Delete All Outputs&#34;)

    action = menu.exec(card_frame.mapToGlobal(pos))

    if action == copy_image_action:
        parent.copy_output_image(card_frame)
    elif action == delete_action:
        delete_output_card(parent, card_frame)
    elif action == delete_all_action:
        delete_all_outputs(parent)</code></pre>
</details>
<div class="desc"><p>Display right-click menu on each output card</p></div>
</dd>
<dt id="saePisan.service.utils.utils.show_image_context_menu"><code class="name flex">
<span>def <span class="ident">show_image_context_menu</span></span>(<span>parent, pos, image_label, image_path)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_image_context_menu(parent, pos, image_label, image_path):
    &#34;&#34;&#34;Display right-click menu on image labels.&#34;&#34;&#34;
    menu = QMenu(parent)

    copy_image_action = menu.addAction(&#34;Copy Image&#34;)
    save_as_action = menu.addAction(&#34;Save Image As...&#34;)

    action = menu.exec(image_label.mapToGlobal(pos))

    if action == copy_image_action:
        copy_output_image(parent, image_label)
    elif action == save_as_action:
        file_dialog = QFileDialog()
        save_path, _ = file_dialog.getSaveFileName(parent, &#34;Save Image&#34;, os.path.basename(image_path), &#34;Images (*.png *.jpg *.bmp)&#34;)
        if save_path:
            image_label.pixmap().save(save_path)</code></pre>
</details>
<div class="desc"><p>Display right-click menu on image labels.</p></div>
</dd>
<dt id="saePisan.service.utils.utils.show_table_context_menu"><code class="name flex">
<span>def <span class="ident">show_table_context_menu</span></span>(<span>pos, table_view, copy_action)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_table_context_menu(pos, table_view, copy_action):
    &#34;&#34;&#34;
    Displays the context menu for the QTableView.
    Args:
        pos (QPoint): The position where the context menu is requested.
        table_view (QTableView): The table view for which the context menu is displayed.
        copy_action (function): The function to execute when &#34;Copy&#34; is selected.
    &#34;&#34;&#34;
    menu = QMenu(table_view)
    copy_action_item = QAction(&#34;Copy&#34;, table_view)
    copy_action_item.triggered.connect(copy_action)
    menu.addAction(copy_action_item)
    menu.exec(table_view.mapToGlobal(pos))</code></pre>
</details>
<div class="desc"><p>Displays the context menu for the QTableView.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pos</code></strong> :&ensp;<code>QPoint</code></dt>
<dd>The position where the context menu is requested.</dd>
<dt><strong><code>table_view</code></strong> :&ensp;<code>QTableView</code></dt>
<dd>The table view for which the context menu is displayed.</dd>
<dt><strong><code>copy_action</code></strong> :&ensp;<code>function</code></dt>
<dd>The function to execute when "Copy" is selected.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.service.utils" href="index.html">saePisan.service.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.service.utils.utils.add_copy_context_menu_to_table" href="#saePisan.service.utils.utils.add_copy_context_menu_to_table">add_copy_context_menu_to_table</a></code></li>
<li><code><a title="saePisan.service.utils.utils.check_script" href="#saePisan.service.utils.utils.check_script">check_script</a></code></li>
<li><code><a title="saePisan.service.utils.utils.copy_output_image" href="#saePisan.service.utils.utils.copy_output_image">copy_output_image</a></code></li>
<li><code><a title="saePisan.service.utils.utils.delete_all_outputs" href="#saePisan.service.utils.utils.delete_all_outputs">delete_all_outputs</a></code></li>
<li><code><a title="saePisan.service.utils.utils.delete_output_card" href="#saePisan.service.utils.utils.delete_output_card">delete_output_card</a></code></li>
<li><code><a title="saePisan.service.utils.utils.display_script_and_output" href="#saePisan.service.utils.utils.display_script_and_output">display_script_and_output</a></code></li>
<li><code><a title="saePisan.service.utils.utils.show_context_menu" href="#saePisan.service.utils.utils.show_context_menu">show_context_menu</a></code></li>
<li><code><a title="saePisan.service.utils.utils.show_image_context_menu" href="#saePisan.service.utils.utils.show_image_context_menu">show_image_context_menu</a></code></li>
<li><code><a title="saePisan.service.utils.utils.show_table_context_menu" href="#saePisan.service.utils.utils.show_table_context_menu">show_table_context_menu</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_1">
                <div class="file-header">
                    <div>ğŸ“„ EditColumnDialog</div>
                    <div class="file-path">view/EditColumnDialog.html (15.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.EditColumnDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.EditColumnDialog.EditColumnDialog"><code class="flex name class">
<span>class <span class="ident">EditColumnDialog</span></span>
<span>(</span><span>column_name, data_type, parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class EditColumnDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for editing column details such as column name and data type.
    Attributes:
        column_name (str): The name of the column to be edited.
        data_type (str): The data type of the column to be edited.
        column_name_label (QLabel): Label displaying the current column name.
        data_type_label (QLabel): Label displaying the current data type.
        edit_name_input (QLineEdit): Input field for editing the column name.
        edit_data_type_input (QLineEdit): Input field for editing the data type.
        buttons (QDialogButtonBox): Dialog buttons for accepting or rejecting changes.
    Methods:
        __init__(column_name, data_type, parent=None):
            Initializes the dialog with the given column name and data type.
        init_ui():
            Initializes the user interface components of the dialog.
        display():
            Displays the dialog and pre-fills the input fields with the current column details.
        edit_name(new_name):
            Updates the column name with the given new name.
        edit_data_type(new_data_type):
            Updates the data type with the given new data type.
    &#34;&#34;&#34;
    
    def __init__(self, column_name, data_type, parent=None):
        super().__init__(parent)
        self.setWindowTitle(&#34;Edit Column Dialog&#34;)

        self.column_name = column_name
        self.data_type = data_type

        self.init_ui()

    def init_ui(self):
        layout = QVBoxLayout()

        # Column name label
        self.column_name_label = QLabel(f&#34;Column Name: {self.column_name}&#34;)
        layout.addWidget(self.column_name_label)

        # Data type label
        self.data_type_label = QLabel(f&#34;Data Type: {self.data_type}&#34;)
        layout.addWidget(self.data_type_label)

        # Edit name input
        self.edit_name_input = QLineEdit()
        layout.addWidget(self.edit_name_input)

        # Edit data type input
        self.edit_data_type_input = QLineEdit()
        layout.addWidget(self.edit_data_type_input)

        # OK/Cancel buttons
        self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
        self.buttons.accepted.connect(self.accept)
        self.buttons.rejected.connect(self.reject)
        layout.addWidget(self.buttons)

        self.setLayout(layout)

    def display(self):
        self.edit_name_input.setText(self.column_name)
        self.edit_data_type_input.setText(self.data_type)
        self.exec()

    def edit_name(self, new_name):
        self.column_name = new_name

    def edit_data_type(self, new_data_type):
        self.data_type = new_data_type</code></pre>
</details>
<div class="desc"><p>A dialog for editing column details such as column name and data type.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>column_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the column to be edited.</dd>
<dt><strong><code>data_type</code></strong> :&ensp;<code>str</code></dt>
<dd>The data type of the column to be edited.</dd>
<dt><strong><code>column_name_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label displaying the current column name.</dd>
<dt><strong><code>data_type_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label displaying the current data type.</dd>
<dt><strong><code>edit_name_input</code></strong> :&ensp;<code>QLineEdit</code></dt>
<dd>Input field for editing the column name.</dd>
<dt><strong><code>edit_data_type_input</code></strong> :&ensp;<code>QLineEdit</code></dt>
<dd>Input field for editing the data type.</dd>
<dt><strong><code>buttons</code></strong> :&ensp;<code>QDialogButtonBox</code></dt>
<dd>Dialog buttons for accepting or rejecting changes.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(column_name, data_type, parent=None):
Initializes the dialog with the given column name and data type.
init_ui():
Initializes the user interface components of the dialog.
display():
Displays the dialog and pre-fills the input fields with the current column details.
edit_name(new_name):
Updates the column name with the given new name.
edit_data_type(new_data_type):
Updates the data type with the given new data type.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.EditColumnDialog.EditColumnDialog.display"><code class="name flex">
<span>def <span class="ident">display</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def display(self):
    self.edit_name_input.setText(self.column_name)
    self.edit_data_type_input.setText(self.data_type)
    self.exec()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.EditColumnDialog.EditColumnDialog.edit_data_type"><code class="name flex">
<span>def <span class="ident">edit_data_type</span></span>(<span>self, new_data_type)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def edit_data_type(self, new_data_type):
    self.data_type = new_data_type</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.EditColumnDialog.EditColumnDialog.edit_name"><code class="name flex">
<span>def <span class="ident">edit_name</span></span>(<span>self, new_name)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def edit_name(self, new_name):
    self.column_name = new_name</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.EditColumnDialog.EditColumnDialog.init_ui"><code class="name flex">
<span>def <span class="ident">init_ui</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_ui(self):
    layout = QVBoxLayout()

    # Column name label
    self.column_name_label = QLabel(f&#34;Column Name: {self.column_name}&#34;)
    layout.addWidget(self.column_name_label)

    # Data type label
    self.data_type_label = QLabel(f&#34;Data Type: {self.data_type}&#34;)
    layout.addWidget(self.data_type_label)

    # Edit name input
    self.edit_name_input = QLineEdit()
    layout.addWidget(self.edit_name_input)

    # Edit data type input
    self.edit_data_type_input = QLineEdit()
    layout.addWidget(self.edit_data_type_input)

    # OK/Cancel buttons
    self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
    self.buttons.accepted.connect(self.accept)
    self.buttons.rejected.connect(self.reject)
    layout.addWidget(self.buttons)

    self.setLayout(layout)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view" href="index.html">saePisan.view</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.EditColumnDialog.EditColumnDialog" href="#saePisan.view.EditColumnDialog.EditColumnDialog">EditColumnDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.EditColumnDialog.EditColumnDialog.display" href="#saePisan.view.EditColumnDialog.EditColumnDialog.display">display</a></code></li>
<li><code><a title="saePisan.view.EditColumnDialog.EditColumnDialog.edit_data_type" href="#saePisan.view.EditColumnDialog.EditColumnDialog.edit_data_type">edit_data_type</a></code></li>
<li><code><a title="saePisan.view.EditColumnDialog.EditColumnDialog.edit_name" href="#saePisan.view.EditColumnDialog.EditColumnDialog.edit_name">edit_name</a></code></li>
<li><code><a title="saePisan.view.EditColumnDialog.EditColumnDialog.init_ui" href="#saePisan.view.EditColumnDialog.EditColumnDialog.init_ui">init_ui</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_2">
                <div class="file-header">
                    <div>ğŸ“„ MainWindow</div>
                    <div class="file-path">view/MainWindow.html (197.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.MainWindow</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.MainWindow.MainWindow"><code class="flex name class">
<span>class <span class="ident">MainWindow</span></span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MainWindow(QMainWindow):
    &#34;&#34;&#34;Main application window for SAE Pisan: Small Area Estimation Programming for Statistical Analysis.
    Attributes:
        data1 (pl.DataFrame): DataFrame for the first sheet (Data Editor).
        data2 (pl.DataFrame): DataFrame for the second sheet (Data Output).
        model1 (TableModel): Table model for the first sheet.
        model2 (TableModel): Table model for the second sheet.
        path (str): Path to the application directory.
        font_size (int): Default font size for the application.
        show_modeling_sae_dialog (ModelingSaeDialog): Dialog for SAE modeling.
        show_modeling_saeHB_dialog (ModelingSaeHBDialog): Dialog for SAE HB modeling.
        show_modeling_sae_unit_dialog (ModelingSaeUnitDialog): Dialog for SAE unit modeling.
        show_modeling_saeHB_normal_dialog (ModelingSaeHBNormalDialog): Dialog for SAE HB normal modeling.
        show_modellig_sae_pseudo_dialog (ModelingSaePseudoDialog): Dialog for SAE pseudo modeling.
        show_compute_variable_dialog (ComputeVariableDialog): Dialog for computing new variables.
        show_projection_variabel_dialog (ProjectionDialog): Dialog for variable projection.
        menu_bar (QMenuBar): Menu bar for the application.
        toolBar (QToolBar): Tool bar for the application.
        tab_widget (QTabWidget): Tab widget containing the different sheets.
        spreadsheet (QTableView): Table view for the first sheet.
        table_view2 (QTableView): Table view for the second sheet.
        scroll_area (QScrollArea): Scroll area for the output tab.
        output_layout (QVBoxLayout): Layout for displaying output in the output tab.
    Methods:
        init_ui(): Initializes the user interface.
        change_font_size(): Opens a dialog to change the font size.
        set_font_size(size): Sets the font size for the application.
        load_stylesheet_with_font_size(size): Loads the stylesheet with the specified font size.
        open_summary_data_dialog_lazy(): Lazily opens the summary data dialog.
        open_normality_test_dialog_lazy(): Lazily opens the normality test dialog.
        open_multicollinearity_dialog_lazy(): Lazily opens the multicollinearity dialog.
        open_variable_selection_dialog_lazy(): Lazily opens the variable selection dialog.
        open_scatter_plot_dialog_lazy(): Lazily opens the scatter plot dialog.
        open_correlation_matrix_dialog_lazy(): Lazily opens the correlation matrix dialog.
        open_box_plot_dialog_lazy(): Lazily opens the box plot dialog.
        open_line_plot_dialog_lazy(): Lazily opens the line plot dialog.
        open_histogram_dialog_lazy(): Lazily opens the histogram dialog.
        open_summary_data_dialog(): Opens the summary data dialog.
        open_normality_test_dialog(): Opens the normality test dialog.
        open_scatter_plot_dialog(): Opens the scatter plot dialog.
        open_line_plot_dialog(): Opens the line plot dialog.
        open_box_plot_dialog(): Opens the box plot dialog.
        open_correlation_matrix_dialog(): Opens the correlation matrix dialog.
        open_multicollinearity_dialog(): Opens the multicollinearity dialog.
        open_histogram_dialog(): Opens the histogram dialog.
        open_variable_selection_dialog(): Opens the variable selection dialog.
        show_modeling_sae_dialog_lazy(): Lazily shows the SAE modeling dialog.
        show_modeling_saeHB_dialog_lazy(): Lazily shows the SAE HB modeling dialog.
        show_modeling_sae_unit_dialog_lazy(): Lazily shows the SAE unit modeling dialog.
        show_modeling_saeHB_normal_dialog_lazy(): Lazily shows the SAE HB normal modeling dialog.
        show_modellig_sae_pseudo_dialog_lazy(): Lazily shows the SAE pseudo modeling dialog.
        show_compute_variable_dialog_lazy(): Lazily shows the compute variable dialog.
        show_projection_variabel_dialog_lazy(): Lazily shows the projection variable dialog.
        open_about_dialog(): Opens the about dialog.
        add_row(sheet_number): Adds a new row to the specified sheet.
        add_column(sheet_number): Adds a new column to the specified sheet.
        update_table(sheet_number, model): Updates the table for the specified sheet with a new model.
        keyPressEvent(event): Handles keyboard shortcuts for copy, paste, undo, and redo.
        copy_selection(): Copies the selected cells to the clipboard.
        paste_selection(): Pastes the clipboard content to the selected cells.
        undo_action(): Undoes the last action.
        redo_action(): Redoes the last undone action.
        group_by_row(selection): Groups selected indexes by row.
        show_output(title, content): Displays output in the Output tab.
        show_header_context_menu(pos): Shows the context menu for the header.
        rename_column(column_index): Renames the column at the given index.
        edit_data_type(column_index): Edits the data type of the column at the given index.
        set_path(path): Sets the path for the application.
        add_output(script_text, result_text=None, plot_paths=None, error_text=None): Adds output to the layout in the form of a card.
        remove_output(card_frame): Removes output from the layout.
        copy_output_image(card_frame): Copies the output image to the clipboard.
        show_context_menu(pos, card_frame): Shows the context menu for each output.&#34;&#34;&#34;
    
    def __init__(self):
        &#34;&#34;&#34;
        Initializes the MainWindow class.
        This constructor sets up the main window for the SAE Pisan application, 
        including setting the window title, initializing data frames, models, 
        and UI components.
        Attributes:
            data1 (pl.DataFrame): A DataFrame with 100 columns and 100 empty rows.
            data2 (pl.DataFrame): A DataFrame with columns &#34;Estimated Value&#34;, 
                                  &#34;Standar Error&#34;, and &#34;CV&#34;, each with 100 empty rows.
            model1 (TableModel): The table model for the first data frame.
            model2 (TableModel): The table model for the second data frame.
            path (str): The path to the parent directory of the current file.
            font_size (int): The font size used in the UI.
        &#34;&#34;&#34;
        
        super().__init__()

        self.setWindowTitle(&#34;saePisan: Small Area Estimation Programming for Statistical Analysis v1.4.0&#34;)
        columns = [f&#34;Column {i+1}&#34; for i in range(100)]
        self.data1 = pl.DataFrame({col: [None] * 100 for col in columns})
        self.data2 = pl.DataFrame({
            &#34;Estimated Value&#34;: [None] * 100,
            &#34;Standar Error&#34;: [None] * 100,
            &#34;RSE (%)&#34;: [None] * 100
        })

        # Model untuk Sheet 2
        self.model1 = TableModel(self.data1)
        self.model2 = TableModel(self.data2)
        self.path = os.path.join(os.path.dirname(__file__), &#39;..&#39;)
        self.font_size = 12
        self.set_font_size(self.font_size)
        self.data = []

        # Inisialisasi UI
        self.init_ui()

        # Set up autosave timer
        self.autosave_interval = 60000  # 60 seconds
        self.autosave_timer = QTimer(self)
        self.autosave_timer.timeout.connect(self.autosave_data)
        self.autosave_timer.start(self.autosave_interval)
        self.showMaximized()

    def init_ui(self):
        &#34;&#34;&#34;
        Initialize the user interface of the main window.
        This method sets up the main layout, including a splitter, tab widgets, 
        and various tabs for data editing, data output, and other functionalities. 
        It also configures the menu bar with different menus and actions, 
        and sets up the toolbar with various actions and icons.
        Tabs:
            - Data Editor: Allows editing of data in a spreadsheet format.
            - Data Output: Displays output data in a table view.
            - Output: Displays output in a scrollable area.
        Menus:
            - File: Contains actions to load and save files.
            - Exploration: Contains actions for data exploration such as summary data, normality test, correlation, etc.
            - Graph: Contains actions to generate different types of plots.
            - Model: Contains actions related to different modeling techniques.
            - Compute: Contains actions to compute new variables.
            - About: Contains information about the application.
            - Settings: Contains actions to change application settings.
        Toolbar:
            - Load File: Action to load a file.
            - Save Data: Action to save data.
            - Undo: Action to undo the last operation.
            - Redo: Action to redo the last undone operation.
            - Compute New Variable: Action to compute a new variable.
            - Setting: Action to open settings.
        Shortcuts:
            - Go to Start Row: Ctrl + Up
            - Go to End Row: Ctrl + Down
            - Go to Start Column: Ctrl + Left
            - Go to End Column: Ctrl + Right
        Layout:
            - The main layout is a vertical box layout containing the tab widget.
            - The central widget is set with this layout.
            - The main window is resized to a default size of 800x600.
        &#34;&#34;&#34;
        
        # Membuat splitter utama untuk membagi halaman menjadi dua bagian (kiri dan kanan)
        self.splitter_main = QSplitter(Qt.Orientation.Horizontal, self)

        # Bagian kiri: QTabWidget untuk dua sheet
        self.tab_widget = QTabWidget(self.splitter_main)  # Ditambahkan ke splitter utama
        self.tab_widget.setTabPosition(QTabWidget.TabPosition.South)
        
        self.show_modeling_sae_dialog = None
        self.show_modeling_saeHB_dialog = None
        self.show_modeling_sae_unit_dialog = None
        self.show_modeling_saeHB_normal_dialog = None
        self.show_modellig_sae_pseudo_dialog = None
        self.show_compute_variable_dialog = None
        self.show_projection_variabel_dialog = None
        

        # Tab pertama (Data Editor)
        self.tab1 = QWidget()
        self.spreadsheet = QTableView(self.tab1)
        self.spreadsheet.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
        self.spreadsheet.customContextMenuRequested.connect(lambda pos: show_context_menu(self, pos))
        self.spreadsheet.setModel(self.model1)
        self.spreadsheet.horizontalHeader().setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
        self.spreadsheet.horizontalHeader().customContextMenuRequested.connect(self.show_header_context_menu)
        self.spreadsheet.horizontalHeader().sectionDoubleClicked.connect(self.rename_column)
        self.spreadsheet.verticalHeader().setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
        self.spreadsheet.verticalHeader().customContextMenuRequested.connect(lambda pos: show_context_menu(self, pos))

        tab1_layout = QVBoxLayout(self.tab1)
        tab1_layout.addWidget(self.spreadsheet)
        self.spreadsheet.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)

        # Tab kedua (Data Output)
        self.tab2 = QWidget()
        self.table_view2 = QTableView(self.tab2)
        self.table_view2.setModel(self.model2)
        self.table_view2.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)

        tab2_layout = QVBoxLayout(self.tab2)
        tab2_layout.addWidget(self.table_view2)

        # Tab ketiga (Output)
        self.tab3 = QWidget()
        self.scroll_area = QScrollArea(self.tab3)
        
        # Tab output
        self.output_tab = QWidget()
        self.scroll_area = QScrollArea(self.output_tab)
        self.scroll_area.setWidgetResizable(True)
        self.output_container = QWidget()
        self.output_layout = QVBoxLayout(self.output_container)
        self.scroll_area.verticalScrollBar().rangeChanged.connect(lambda: self.scroll_area.verticalScrollBar().setValue(self.scroll_area.verticalScrollBar().maximum()))
        self.output_container.setLayout(self.output_layout)
        self.scroll_area.setWidget(self.output_container)
        
        # Atur layout output
        self.output_layout.setAlignment(Qt.AlignmentFlag.AlignTop)
        self.output_layout.setSpacing(0)

        tab3_layout = QVBoxLayout(self.tab3)
        tab3_layout.addWidget(self.scroll_area)

        # Menambahkan tab ke QTabWidget
        self.tab_widget.addTab(self.tab1, &#34;Data Editor&#34;)
        self.tab_widget.addTab(self.tab2, &#34;Data Output&#34;)
        self.tab_widget.addTab(self.tab3, &#34;Output&#34;)  # Tab baru untuk output

        # Membuat layout utama
        layout = QVBoxLayout()
        layout.addWidget(self.tab_widget)
        

        # Widget utama dan layout
        central_widget = QWidget(self)
        central_widget.setLayout(layout)
        self.setCentralWidget(central_widget)

        # Membuat menu bar
        self.menu_bar = self.menuBar()

        # Membuat menu File -&gt; Load dan Save
        self.file_menu = self.menu_bar.addMenu(&#34;File&#34;)
        
        self.recent_data = QAction(&#34;Open Recent data&#34;, self)
        self.recent_data.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_D))
        self.recent_data.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;recentdata.svg&#39;)))
        self.recent_data.setStatusTip(&#34;Ctrl+D&#34;)
        
        self.load_action = QAction(&#34;Load File&#34;, self)
        self.load_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_O))
        self.load_action.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;open.svg&#39;)))
        self.load_action.setStatusTip(&#34;Ctrl+O&#34;)
        
        self.load_secondary_data = QAction(&#34;Load File for Secondary Data&#34;, self)
        self.load_secondary_data.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_2))
        self.load_secondary_data.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;secondary.svg&#39;)))
        self.load_secondary_data.setStatusTip(&#34;Ctrl+2&#34;)
        
        self.save_action = QAction(&#34;Save Data&#34;, self)
        self.save_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_S))
        self.save_action.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;savedata.svg&#39;)))
        self.save_action.setStatusTip(&#34;Ctrl+S&#34;)
        
        self.save_data_output_action = QAction(&#34;Save Data Output&#34;, self)
        self.save_data_output_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Modifier.SHIFT | Qt.Key.Key_S))
        self.save_data_output_action.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;savedataoutput.svg&#39;)))
        self.save_action.setStatusTip(&#34;Ctrl+Shift+S&#34;)
        
        self.save_output_pdf = QAction(&#34;Save Output to PDF&#34;, self)
        self.save_output_pdf.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_P))
        self.save_output_pdf.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;savepdf.svg&#39;)))
        self.save_output_pdf.setStatusTip(&#34;Ctrl+P&#34;)

        self.file_menu.addAction(self.recent_data)
        self.file_menu.addAction(self.load_action)
        self.file_menu.addAction(self.load_secondary_data)
        self.file_menu.addAction(self.save_action)
        self.file_menu.addAction(self.save_data_output_action)
        self.file_menu.addAction(self.save_output_pdf)

        # Menu &#34;Exploration&#34;
        self.menu_exploration = self.menu_bar.addMenu(&#34;Pre-Modeling&#34;)

        self.action_summary_data = QAction(&#34;Data Summary&#34;, self)
        self.action_summary_data.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;summary.svg&#39;)))
        self.action_summary_data.triggered.connect(self.open_summary_data_dialog_lazy)

        self.action_normality_test = QAction(&#34;Normality Test&#34;, self)
        self.action_normality_test.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;normality.svg&#39;)))
        self.action_normality_test.triggered.connect(self.open_normality_test_dialog_lazy)

        self.action_correlation = QAction(&#34;Correlation&#34;, self)
        self.action_correlation.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;correlation.svg&#39;)))
        self.action_correlation.triggered.connect(self.open_correlation_matrix_dialog_lazy)

        self.action_multicollinearity = QAction(&#34;Multicollinearity&#34;, self)
        self.action_multicollinearity.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;multicolinierity.svg&#39;)))
        self.action_multicollinearity.triggered.connect(self.open_multicollinearity_dialog_lazy)

        self.action_variable_selection = QAction(&#34;Variable Selection&#34;, self)
        self.action_variable_selection.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;varselection.svg&#39;)))
        self.action_variable_selection.triggered.connect(self.open_variable_selection_dialog_lazy)

        self.menu_exploration.addAction(self.action_summary_data)
        self.menu_exploration.addAction(self.action_normality_test)
        self.menu_exploration.addAction(self.action_correlation)
        self.menu_exploration.addAction(self.action_multicollinearity)
        self.menu_exploration.addAction(self.action_variable_selection)

        # Menu &#34;Graph&#34;
        self.menu_graph = self.menu_bar.addMenu(&#34;Graph&#34;)

        self.action_scatter_plot = QAction(&#34;Scatter Plot&#34;, self)
        self.action_scatter_plot.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;scatterplot.svg&#39;)))
        self.action_scatter_plot.triggered.connect(self.open_scatter_plot_dialog_lazy)

        self.action_box_plot = QAction(&#34;Box Plot&#34;, self)
        self.action_box_plot.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;boxplot.svg&#39;)))
        self.action_box_plot.triggered.connect(self.open_box_plot_dialog_lazy)

        self.action_line_plot = QAction(&#34;Line Plot&#34;, self)
        self.action_line_plot.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;lineplot.svg&#39;)))
        self.action_line_plot.triggered.connect(self.open_line_plot_dialog_lazy)

        self.action_histogram = QAction(&#34;Histogram&#34;, self)
        self.action_histogram.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;histogram.svg&#39;)))
        self.action_histogram.triggered.connect(self.open_histogram_dialog_lazy)

        # Menambahkan plot-plot ke menu Graph
        self.menu_graph.addAction(self.action_scatter_plot)
        self.menu_graph.addAction(self.action_box_plot)
        self.menu_graph.addAction(self.action_line_plot)
        self.menu_graph.addAction(self.action_histogram)
        # Menu &#34;Model&#34;
        menu_model = self.menu_bar.addMenu(&#34;Model&#34;)

        # Submenu &#34;Area Level&#34;
        menu_area_level = QMenu(&#34;Area Level&#34;, self)
        menu_area_level.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;arealevel.svg&#39;)))
        action_eblup_area = QAction(&#34;EBLUP&#34;, self)
        action_eblup_area.triggered.connect(self.show_modeling_sae_dialog_lazy)
        action_hb_beta = QAction(&#34;HB Beta&#34;, self)
        action_hb_beta.triggered.connect(self.show_modeling_saeHB_dialog_lazy)
        menu_area_level.addAction(action_eblup_area)
        menu_area_level.addAction(action_hb_beta)

        # Submenu &#34;Unit Level&#34;
        menu_unit_level = QMenu(&#34;Unit Level&#34;, self)
        menu_unit_level.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;unitlevel.svg&#39;)))
        action_eblup_unit = QAction(&#34;EBLUP&#34;, self)
        action_eblup_unit.triggered.connect(self.show_modeling_sae_unit_dialog_lazy)
        action_hb_normal = QAction(&#34;HB Normal&#34;, self)
        action_hb_normal.triggered.connect(self.show_modeling_saeHB_normal_dialog_lazy)
        menu_unit_level.addAction(action_eblup_unit)
        menu_unit_level.addAction(action_hb_normal)

        # Submenu &#34;Pseudo&#34;
        menu_pseudo = QMenu(&#34;Pseudo&#34;, self)
        menu_pseudo.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;pseudo.svg&#39;)))
        action_eblup_pseudo = QAction(&#34;EBLUP&#34;, self)
        action_eblup_pseudo.triggered.connect(self.show_modellig_sae_pseudo_dialog_lazy)
        menu_pseudo.addAction(action_eblup_pseudo)

        # Submenu &#34;Projection&#34;
        menu_projection = QMenu(&#34;Projection&#34;, self)
        menu_projection.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;projection.svg&#39;)))
        action_projection = QAction(&#34;Projection&#34;, self)
        action_projection.triggered.connect(self.show_projection_variabel_dialog_lazy)
        menu_projection.addAction(action_projection)


        # Menambahkan submenu ke menu &#34;Model&#34;
        menu_model.addMenu(menu_area_level)
        menu_model.addMenu(menu_unit_level)
        menu_model.addMenu(menu_pseudo)
        menu_model.addMenu(menu_projection)



         # Menu &#39;Compute&#39;
        menu_compute = self.menu_bar.addMenu(&#34;Compute&#34;)
        compute_new_var = QAction(&#34;Compute New Variable&#34;, self)
        compute_new_var.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;compute.svg&#39;)))
        compute_new_var.triggered.connect(self.show_compute_variable_dialog_lazy)
        menu_compute.addAction(compute_new_var)
        
        # Menu &#34;About&#34;
        menu_about = self.menu_bar.addMenu(&#34;About&#34;)
        action_about_info = QAction(&#34;About This App&#34;, self)
        action_about_info.triggered.connect(self.open_about_dialog)
        action_about_info.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;about.svg&#39;)))
        menu_about.addAction(action_about_info)
        
        action_header_icon_info = QAction(&#34;Header Icon Info&#34;, self)
        action_header_icon_info.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;information.svg&#39;)))
        action_header_icon_info.triggered.connect(self.show_header_icon_info)
        menu_about.addAction(action_header_icon_info)
        
        # Add R Packages Used menu
        action_r_packages_info = QAction(&#34;R Packages Used&#34;, self)
        action_r_packages_info.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;Rinfo.svg&#39;)))
        action_r_packages_info.triggered.connect(self.show_r_packages_info)
        menu_about.addAction(action_r_packages_info)
        

        # Tool Bar
        self.toolBar = QToolBar(self)
        self.toolBar.setIconSize(QSize(45, 35))
        self.toolBar.setObjectName(&#34;toolBar&#34;)
        self.addToolBar(Qt.ToolBarArea.TopToolBarArea, self.toolBar)  # Perbaikan dilakukan di sini
        # Actions for Toolbar
        self.actionLoad_file = QAction(self)  # Menggunakan self untuk referensi instance
        icon_load = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;open.svg&#39;))
        self.actionLoad_file.setIcon(icon_load)
        self.actionLoad_file.setText(&#34;Load File&#34;)
        self.toolBar.addAction(self.actionLoad_file)

        self.actionSave_Data = QAction(self)  # Menggunakan self untuk referensi instance
        icon_save = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;save.svg&#39;))
        self.actionSave_Data.setIcon(icon_save)
        self.actionSave_Data.setText(&#34;Save Data&#34;)
        self.toolBar.addAction(self.actionSave_Data)

        self.actionUndo = QAction(self)
        icon_undo = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;undo.svg&#39;))
        self.actionUndo.setIcon(icon_undo)
        self.actionUndo.setText(&#34;Undo&#34;)
        self.actionUndo.triggered.connect(self.undo_action)
        self.toolBar.addAction(self.actionUndo)

        self.actionRedo = QAction(self)
        icon_redo = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;redo.svg&#39;))
        self.actionRedo.setIcon(icon_redo)
        self.actionRedo.setText(&#34;Redo&#34;)
        self.actionRedo.triggered.connect(self.redo_action)
        self.toolBar.addAction(self.actionRedo)
        
        self.actionCompute = QAction(self)
        icon_compute = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;compute.svg&#39;))
        self.actionCompute.setIcon(icon_compute)
        self.actionCompute.setText(&#34;Compute New Variable&#34;)
        self.actionCompute.triggered.connect(self.show_compute_variable_dialog_lazy)
        self.toolBar.addAction(self.actionCompute)
        
        # Shortcuts for &#34;Go to Start/End Row/Column&#34;
        self.go_to_start_row_action = QAction(self)
        self.go_to_start_row_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Up))
        self.go_to_start_row_action.triggered.connect(lambda : go_to_start_row(self))
        self.addAction(self.go_to_start_row_action)

        self.go_to_end_row_action = QAction(self)
        self.go_to_end_row_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Down))
        self.go_to_end_row_action.triggered.connect(lambda : go_to_end_row(self))
        self.addAction(self.go_to_end_row_action)

        self.go_to_start_column_action = QAction(self)
        self.go_to_start_column_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Left))
        self.go_to_start_column_action.triggered.connect(lambda : go_to_start_column(self))
        self.addAction(self.go_to_start_column_action)

        self.go_to_end_column_action = QAction(self)
        self.go_to_end_column_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Right))
        self.go_to_end_column_action.triggered.connect(lambda : go_to_end_column(self))
        self.addAction(self.go_to_end_column_action)

        # Add spacer to push following items to the right
        spacer = QWidget(self)
        spacer.setSizePolicy(QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Preferred)
        self.toolBar.addWidget(spacer)

        # Add &#34;Setting&#34; button to the right
        self.actionSetting = QAction(self)
        icon_setting = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;setting.svg&#39;))
        self.actionSetting.setIcon(icon_setting)
        self.actionSetting.setText(&#34;Setting&#34;)
        self.actionSetting.triggered.connect(self.change_font_size)
        self.toolBar.addAction(self.actionSetting)
        

        # Menu &#34;Settings&#34;
        menu_settings = self.menu_bar.addMenu(&#34;Settings&#34;)
        action_change_font_size = QAction(&#34;Change Font Size&#34;, self)
        action_change_font_size.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;setting.svg&#39;)))
        action_change_font_size.triggered.connect(self.change_font_size)
        menu_settings.addAction(action_change_font_size)

        # Menetapkan ukuran default
        self.resize(800, 600)

    
    def change_font_size(self):
        &#34;&#34;&#34;
        Opens a dialog to change the font size of the application.
        The dialog presents three font size options: &#34;Small&#34;, &#34;Medium&#34;, and &#34;Big&#34;.
        The user can select a font size from a combo box, and the selected size
        will be applied to the application if the user confirms the selection.
        The dialog also displays a sample text (&#34;AaBbCc&#34;) that updates in real-time
        to reflect the selected font size.
        Attributes:
            sizes (dict): A dictionary mapping font size names to their corresponding pixel values.
            items (list): A list of font size names.
            dialog (QDialog): The dialog window for selecting the font size.
            layout (QVBoxLayout): The main layout of the dialog.
            combo_box (QComboBox): The combo box for selecting the font size.
            display (QLabel): The label displaying the sample text with the selected font size.
            button_box (QHBoxLayout): The layout containing the OK and Cancel buttons.
            ok_button (QPushButton): The button to confirm the font size selection.
            cancel_button (QPushButton): The button to cancel the font size selection.
        Methods:
            update_display_font_size: Updates the sample text&#39;s font size based on the selected size in the combo box.
        &#34;&#34;&#34;
        
        sizes = {&#34;Small&#34;: 10, &#34;Medium&#34;: 12, &#34;Big&#34;: 16}
        items = list(sizes.keys())

        dialog = QDialog(self)
        dialog.setWindowTitle(&#34;Select Font Size&#34;)
        dialog.setMinimumWidth(200)

        layout = QVBoxLayout(dialog)

        combo_box = QComboBox()
        combo_box.addItems(items)
        default_size = next(key for key, value in sizes.items() if value == self.font_size)
        combo_box.setCurrentText(default_size)
        layout.addWidget(combo_box)
        
        display = QLabel(&#34;AaBbCc&#34;)
        display.setAlignment(Qt.AlignmentFlag.AlignCenter)
        display.setStyleSheet(f&#34;font-size: {self.font_size}px;&#34;)
        layout.addWidget(display)
    
        def update_display_font_size():
            size = combo_box.currentText()
            display.setStyleSheet(f&#34;font-size: {sizes[size]}px;&#34;)

        combo_box.currentTextChanged.connect(update_display_font_size)

        button_box = QHBoxLayout()
        ok_button = QPushButton(&#34;OK&#34;)
        cancel_button = QPushButton(&#34;Cancel&#34;)
        button_box.addWidget(ok_button)
        button_box.addWidget(cancel_button)
        layout.addLayout(button_box)

        ok_button.clicked.connect(dialog.accept)
        cancel_button.clicked.connect(dialog.reject)

        dialog.setLayout(layout)

        if dialog.exec() == QDialog.DialogCode.Accepted:
            selected_size = combo_box.currentText()
            self.set_font_size(sizes[selected_size])
            self.font_size = sizes[selected_size]

    def set_font_size(self, size):
        &#34;&#34;&#34;
        Sets the font size for the main window.
        Args:
            size (int): The desired font size to be set.
        This method updates the stylesheet of the main window with the specified font size.
        &#34;&#34;&#34;
        
        stylesheet = self.load_stylesheet_with_font_size(size)
        self.setStyleSheet(stylesheet)

    def load_stylesheet_with_font_size(self, size):
        &#34;&#34;&#34;
        Memuat stylesheet dan mengganti ukuran font global.
        &#34;&#34;&#34;
        stylesheet_path = os.path.join(self.path, &#39;assets&#39;, &#39;style&#39;, &#39;style.qss&#39;)
        if os.path.exists(stylesheet_path):
            with open(stylesheet_path, &#39;r&#39;) as file:
                stylesheet = file.read()
                # stylesheet = stylesheet.replace(&#34;font-size: 12px;&#34;, f&#34;font-size: {size}px;&#34;)
                stylesheet = stylesheet.replace(&#34;__FONT_SIZE__&#34;, f&#34;{size}px&#34;)
                return stylesheet
        else:
            print(f&#34;Stylesheet tidak ditemukan di {stylesheet_path}&#34;)
            return &#34;&#34;
    
    def open_summary_data_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the summary data dialog.
        This method checks if the &#39;show_summary_data_dialog&#39; attribute exists.
        If it does not exist, it initializes it with an instance of SummaryDataDialog.
        Then, it calls the &#39;open_summary_data_dialog&#39; method to open the dialog.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_summary_data_dialog&#39;):
            self.show_summary_data_dialog = SummaryDataDialog(self)
        self.open_summary_data_dialog()

    def open_normality_test_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the normality test dialog.
        This method checks if the normality test dialog has already been created.
        If not, it initializes the dialog and then opens it. If the dialog has 
        already been created, it simply opens the existing instance.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_normality_test_dialog&#39;):
            self.show_normality_test_dialog = NormalityTestDialog(self)
        self.open_normality_test_dialog()

    def open_multicollinearity_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the multicollinearity dialog.
        This method checks if the &#39;show_multicollinearity_dialog&#39; attribute exists.
        If it does not, it initializes it with an instance of MulticollinearityDialog.
        Then, it opens the multicollinearity dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_multicollinearity_dialog&#39;):
            self.show_multicollinearity_dialog = MulticollinearityDialog(self)
        self.open_multicollinearity_dialog()

    def open_variable_selection_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the variable selection dialog.
        This method checks if the &#39;show_variable_selection_dialog&#39; attribute
        exists. If it does not, it initializes it with an instance of 
        VariableSelectionDialog. Then, it calls the method to open the 
        variable selection dialog.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_variable_selection_dialog&#39;):
            self.show_variable_selection_dialog = VariableSelectionDialog(self)
        self.open_variable_selection_dialog()
    
    def open_scatter_plot_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the scatter plot dialog.
        This method checks if the scatter plot dialog has already been created.
        If not, it initializes the dialog and then opens it. This ensures that
        the dialog is only created when needed, potentially saving resources.
        Attributes:
            show_scatter_plot_dialog (ScatterPlotDialog): The scatter plot dialog instance.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_scatter_plot_dialog&#39;):
            self.show_scatter_plot_dialog = ScatterPlotDialog(self)
        self.open_scatter_plot_dialog()

    def open_correlation_matrix_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the correlation matrix dialog.
        This method checks if the correlation matrix dialog has already been created.
        If not, it initializes the dialog. Then, it opens the dialog.
        Attributes:
            show_correlation_matrix_dialog (CorrelationMatrixDialog): The correlation matrix dialog instance.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_correlation_matrix_dialog&#39;):
            self.show_correlation_matrix_dialog = CorrelationMatrixDialog(self)
        self.open_correlation_matrix_dialog()

    def open_box_plot_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the box plot dialog.
        This method checks if the &#39;show_box_plot_dialog&#39; attribute exists.
        If it does not, it initializes &#39;show_box_plot_dialog&#39; with an instance
        of BoxPlotDialog. Then, it calls the method to open the box plot dialog.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_box_plot_dialog&#39;):
            self.show_box_plot_dialog = BoxPlotDialog(self)
        self.open_box_plot_dialog()

    def open_line_plot_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and opens the line plot dialog.
        This method checks if the &#39;show_line_plot_dialog&#39; attribute exists.
        If it does not, it initializes &#39;show_line_plot_dialog&#39; with an instance
        of LinePlotDialog. Then, it calls the method to open the line plot dialog.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_line_plot_dialog&#39;):
            self.show_line_plot_dialog = LinePlotDialog(self)
        self.open_line_plot_dialog()

    def open_histogram_dialog_lazy(self):
        &#34;&#34;&#34;
        Opens the histogram dialog lazily.
        This method checks if the histogram dialog has already been created.
        If not, it initializes the HistogramDialog and assigns it to the 
        &#39;show_histogram_dialog&#39; attribute. Then, it opens the histogram dialog.
        &#34;&#34;&#34;
        
        if not hasattr(self, &#39;show_histogram_dialog&#39;):
            self.show_histogram_dialog = HistogramDialog(self)
        self.open_histogram_dialog()
    
    def open_summary_data_dialog(self):
        &#34;&#34;&#34;
        Opens the summary data dialog.
        This method sets the models for the summary data dialog and then displays the dialog.
        It uses `self.model1` and `self.model2` as the models to be set in the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        self.show_summary_data_dialog.set_model(self.model1, self.model2)
        self.show_summary_data_dialog.show()
        
    def open_normality_test_dialog(self):
        &#34;&#34;&#34;
        Opens the normality test dialog.
        This method sets the models for the normality test dialog and then displays the dialog.
        It uses `self.model1` and `self.model2` as the models to be set in the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        self.show_normality_test_dialog.set_model( self.model1, self.model2)
        self.show_normality_test_dialog.show()

    def open_scatter_plot_dialog(self):
        &#34;&#34;&#34;
        Opens the scatter plot dialog and sets the models for the dialog.
        This method sets the models for the scatter plot dialog using 
        `self.model1` and `self.model2`, and then displays the dialog.
        &#34;&#34;&#34;
        
        self.show_scatter_plot_dialog.set_model(self.model1, self.model2)
        self.show_scatter_plot_dialog.show()

    def open_line_plot_dialog(self):
        &#34;&#34;&#34;
        Opens the line plot dialog and sets the models for the dialog.
        This method sets the models for the line plot dialog using `self.model1` 
        and `self.model2`, and then displays the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        self.show_line_plot_dialog.set_model(self.model1, self.model2)
        self.show_line_plot_dialog.show()
    
    def open_box_plot_dialog(self):
        &#34;&#34;&#34;
        Opens the box plot dialog and sets the models for the dialog.
        This method sets the models for the box plot dialog using `self.model1` and `self.model2`,
        and then displays the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        self.show_box_plot_dialog.set_model(self.model1, self.model2)
        self.show_box_plot_dialog.show()

    def open_correlation_matrix_dialog(self):
        &#34;&#34;&#34;
        Opens the correlation matrix dialog.
        This method sets the model data for the correlation matrix dialog
        and then displays the dialog to the user.
        The models used are `self.model1` and `self.model2`.
        &#34;&#34;&#34;
        
        self.show_correlation_matrix_dialog.set_model(self.model1, self.model2)
        self.show_correlation_matrix_dialog.show()
    
    def open_multicollinearity_dialog(self):
        &#34;&#34;&#34;
        Opens the multicollinearity dialog and sets the models for it.
        This method sets the models for the multicollinearity dialog using
        `self.model1` and `self.model2`, and then displays the dialog.
        &#34;&#34;&#34;
        
        self.show_multicollinearity_dialog.set_model(self.model1, self.model2)
        self.show_multicollinearity_dialog.show()
    
    def open_histogram_dialog(self):
        &#34;&#34;&#34;
        Opens the histogram dialog and sets the models for it.
        This method sets the models for the histogram dialog using `self.model1` and `self.model2`,
        and then displays the histogram dialog.
        &#34;&#34;&#34;
        
        self.show_histogram_dialog.set_model(self.model1, self.model2)
        self.show_histogram_dialog.show()

    def open_variable_selection_dialog(self):
        &#34;&#34;&#34;
        Opens the variable selection dialog.
        This method sets the model for the variable selection dialog using 
        `self.model1` and `self.model2`, and then displays the dialog.
        &#34;&#34;&#34;
        
        self.show_variable_selection_dialog.set_model(self.model1, self.model2)
        self.show_variable_selection_dialog.show()

    def show_modeling_sae_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and displays the ModelingSaeDialog.
        If the ModelingSaeDialog has not been created yet, this method will
        instantiate it and set its model to `self.model1`. Then, it will
        display the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        if self.show_modeling_sae_dialog is None:
            self.show_modeling_sae_dialog = ModelingSaeDialog(self)
        self.show_modeling_sae_dialog.set_model(self.model1)
        self.show_modeling_sae_dialog.show()

    def show_modeling_saeHB_dialog_lazy(self):
        &#34;&#34;&#34;
        Displays the ModelingSaeHBDialog lazily.
        This method initializes the ModelingSaeHBDialog if it has not been created yet,
        sets its model to `self.model1`, and then shows the dialog.
        Attributes:
            show_modeling_saeHB_dialog (ModelingSaeHBDialog): The dialog instance to be shown.
            model1: The model to be set in the dialog.
        &#34;&#34;&#34;
        
        if self.show_modeling_saeHB_dialog is None:
            self.show_modeling_saeHB_dialog = ModelingSaeHBDialog(self)
        self.show_modeling_saeHB_dialog.set_model(self.model1)
        self.show_modeling_saeHB_dialog.show()

    def show_modeling_sae_unit_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and displays the ModelingSaeUnitDialog.
        If the dialog has not been created yet, it initializes it with the current instance.
        Then, it sets the model for the dialog and shows it.
        Attributes:
            show_modeling_sae_unit_dialog (ModelingSaeUnitDialog): The dialog for modeling SAE units.
            model1: The model to be set in the dialog.
        &#34;&#34;&#34;
        
        if self.show_modeling_sae_unit_dialog is None:
            self.show_modeling_sae_unit_dialog = ModelingSaeUnitDialog(self)
        self.show_modeling_sae_unit_dialog.set_model(self.model1)
        self.show_modeling_sae_unit_dialog.show()

    def show_modeling_saeHB_normal_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and displays the ModelingSaeHBNormalDialog.
        If the dialog has not been created yet, it initializes a new instance
        of ModelingSaeHBNormalDialog and sets its model to self.model1. 
        Then, it shows the dialog.
        Attributes:
            show_modeling_saeHB_normal_dialog (ModelingSaeHBNormalDialog): 
            The dialog instance to be displayed.
            model1: The model to be set in the dialog.
        &#34;&#34;&#34;
        
        if self.show_modeling_saeHB_normal_dialog is None:
            self.show_modeling_saeHB_normal_dialog = ModelingSaeHBNormalDialog(self)
        self.show_modeling_saeHB_normal_dialog.set_model(self.model1)
        self.show_modeling_saeHB_normal_dialog.show()

    def show_modellig_sae_pseudo_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and displays the Modeling SAE Pseudo dialog.
        This method checks if the `show_modellig_sae_pseudo_dialog` attribute is None.
        If it is, it initializes a new instance of `ModelingSaePseudoDialog` with the current
        instance (`self`) as the parent. It then sets the model for the dialog using `self.model1`
        and displays the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        if self.show_modellig_sae_pseudo_dialog is None:
            self.show_modellig_sae_pseudo_dialog = ModelingSaePseudoDialog(self)
        self.show_modellig_sae_pseudo_dialog.set_model(self.model1)
        self.show_modellig_sae_pseudo_dialog.show()

    def show_compute_variable_dialog_lazy(self):
        &#34;&#34;&#34;
        Displays the Compute Variable dialog lazily.
        This method initializes the Compute Variable dialog if it hasn&#39;t been created yet,
        sets its model to `self.model1`, and then shows the dialog.
        If `self.show_compute_variable_dialog` is already initialized, it simply updates
        the model and shows the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        if self.show_compute_variable_dialog is None:
            self.show_compute_variable_dialog = ComputeVariableDialog(self)
        self.show_compute_variable_dialog.set_model(self.model1)
        self.show_compute_variable_dialog.show()

    def show_projection_variabel_dialog_lazy(self):
        &#34;&#34;&#34;
        Lazily initializes and displays the ProjectionDialog.
        This method checks if the `show_projection_variabel_dialog` attribute is None.
        If it is, it initializes it with a new instance of `ProjectionDialog`.
        It then sets the model for the dialog and checks if the prerequisites for
        showing the dialog are met. If they are, it displays the dialog.
        Attributes:
            show_projection_variabel_dialog (ProjectionDialog): The dialog to be shown.
            model1: The model to be set in the dialog.
        Returns:
            None
        &#34;&#34;&#34;
        
        if self.show_projection_variabel_dialog is None:
            self.show_projection_variabel_dialog = ProjectionDialog(self)
        self.show_projection_variabel_dialog.set_model(self.model1)
        if self.show_projection_variabel_dialog.show_prerequisites():
            self.show_projection_variabel_dialog.show()

    def open_about_dialog(self):
        &#34;&#34;&#34;
        Opens the About dialog window.
        This method creates an instance of the AboutDialog class, passing the
        current instance as the parent, and then executes the dialog.
        &#34;&#34;&#34;
        
        about_dialog = AboutDialog(self)
        about_dialog.exec()

    def add_row(self, sheet_number):
        &#34;&#34;&#34;Sinkronisasi data ketika baris baru ditambahkan di SpreadsheetWidget.&#34;&#34;&#34;
        if sheet_number == 1:
            # Tambahkan baris baru di DataFrame data1
            new_row = pl.DataFrame({col: [&#34;&#34;] for col in self.data1.columns})
            self.data1 = pl.concat([self.data1, new_row])
        elif sheet_number == 2:
            pass  # Tidak digunakan untuk Sheet 2
    
    def add_column(self, sheet_number):
        &#34;&#34;&#34;Sinkronisasi data ketika kolom baru ditambahkan di SpreadsheetWidget.&#34;&#34;&#34;
        if sheet_number == 1:
            # Tambahkan kolom baru di DataFrame data1
            new_column_name = f&#34;Column {self.data1.shape[1] + 1}&#34;
            new_column = pl.DataFrame({new_column_name: [&#34;&#34;] * self.data1.shape[0]})
            self.data1 = pl.concat([self.data1, new_column], how=&#34;horizontal&#34;)
        elif sheet_number == 2:
            pass  # Tidak digunakan untuk Sheet 2
    
    def update_table(self, sheet_number, model):
        &#34;&#34;&#34;Memperbarui tabel pada sheet tertentu dengan model baru&#34;&#34;&#34;
        if sheet_number == 1:
            self.spreadsheet.setModel(model)
            self.model1 = model
            self.spreadsheet.resizeColumnsToContents()
            self.tab_widget.setCurrentWidget(self.tab1)
            if self.show_modeling_sae_dialog:
                self.show_modeling_sae_dialog.set_model(model)
            if self.show_modeling_saeHB_dialog:
                self.show_modeling_saeHB_dialog.set_model(model)
            if self.show_modeling_sae_unit_dialog:
                self.show_modeling_sae_unit_dialog.set_model(model)
            if self.show_modeling_saeHB_normal_dialog:
                self.show_modeling_saeHB_normal_dialog.set_model(model)
            if self.show_modellig_sae_pseudo_dialog:
                self.show_modellig_sae_pseudo_dialog.set_model(model)
            if self.show_compute_variable_dialog:
                self.show_compute_variable_dialog.set_model(model)
            if self.show_projection_variabel_dialog:
                self.show_projection_variabel_dialog.set_model(model)
        elif sheet_number == 2:
            self.table_view2.setModel(model)
            self.model2 = model
            self.table_view2.resizeColumnsToContents()

    def keyPressEvent(self, event):
        &#34;&#34;&#34;Handle keyboard shortcuts for copy, paste, undo, and redo.&#34;&#34;&#34;
        if event.matches(QKeySequence.StandardKey.Copy):
            self.copy_selection()
        elif event.matches(QKeySequence.StandardKey.Paste):
            self.paste_selection()
        elif event.matches(QKeySequence.StandardKey.Undo):
            self.undo_action()
        elif event.matches(QKeySequence.StandardKey.Redo):
            self.redo_action()
        else:
            super().keyPressEvent(event)

    def copy_selection(self):
        &#34;&#34;&#34;Copy selected cells to clipboard.&#34;&#34;&#34;
        selection = self.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            data = &#39;\n&#39;.join([&#39;\t&#39;.join([self.model1.data(index, Qt.ItemDataRole.DisplayRole) for index in row]) for row in self.group_by_row(selection)])
            clipboard = QApplication.clipboard()
            clipboard.setText(data)

    def paste_selection(self):
        &#34;&#34;&#34;Paste clipboard content to selected cells.&#34;&#34;&#34;
        clipboard = QApplication.clipboard()
        data = clipboard.text().split(&#39;\n&#39;)
        selection = self.spreadsheet.selectionModel().selectedIndexes()
        if selection:
            start_row = selection[0].row()
            start_col = selection[0].column()
            for i, row in enumerate(data):
                for j, value in enumerate(row.split(&#39;\t&#39;)):
                    index = self.model1.index(start_row + i, start_col + j)
                    self.model1.setData(index, value, Qt.ItemDataRole.EditRole)

    def undo_action(self):
        &#34;&#34;&#34;Undo the last action.&#34;&#34;&#34;
        self.model1.undo()

    def redo_action(self):
        &#34;&#34;&#34;Redo the last undone action.&#34;&#34;&#34;
        self.model1.redo()

    def group_by_row(self, selection):
        &#34;&#34;&#34;Group selected indexes by row.&#34;&#34;&#34;
        rows = {}
        for index in selection:
            if index.row() not in rows:
                rows[index.row()] = []
            rows[index.row()].append(index)
        return [rows[row] for row in sorted(rows)]
    
    def show_output(self, title, content):
        &#34;&#34;&#34;Display output in the Output tab&#34;&#34;&#34;
        label = QLabel(content)
        self.output_layout.addWidget(label)
        self.output_tab_widget.setCurrentIndex(0)

    def show_header_context_menu(self, pos):
        &#34;&#34;&#34;Show context menu for header.&#34;&#34;&#34;
        header = self.spreadsheet.horizontalHeader()
        logical_index = header.logicalIndexAt(pos)
        menu = QMenu(self)
        rename_action = QAction(&#34;Rename Column&#34;, self)
        rename_action.triggered.connect(lambda: self.rename_column(logical_index))
        menu.addAction(rename_action)
        
        edit_type_action = QAction(&#34;Edit Data Type&#34;, self)
        edit_type_action.triggered.connect(lambda: self.edit_data_type(logical_index))
        menu.addAction(edit_type_action)
        
        selection = self.spreadsheet.selectionModel().selectedIndexes()
        has_selection = bool(selection)
        
        delete_column_action = QAction(&#34;Delete Column&#34;, self)
        delete_column_action.triggered.connect(lambda : confirm_delete_selected_columns(self))
        delete_column_action.setEnabled(has_selection)
        menu.addAction(delete_column_action)
        
        add_column_before_action = QAction(&#34;Add Column Before&#34;, self)
        add_column_before_action.triggered.connect(lambda: show_add_column_before_dialog(self))
        add_column_before_action.setEnabled(has_selection)
        menu.addAction(add_column_before_action)
        
        add_column_after_action = QAction(&#34;Add Column After&#34;, self)
        add_column_after_action.triggered.connect(lambda: show_add_column_after_dialog(self))
        add_column_after_action.setEnabled(has_selection)
        menu.addAction(add_column_after_action)
        
        menu.exec(header.mapToGlobal(pos))

    def rename_column(self, column_index):
        &#34;&#34;&#34;Rename the column at the given index.&#34;&#34;&#34;
        current_name = self.model1.headerData(column_index, Qt.Orientation.Horizontal, Qt.ItemDataRole.DisplayRole)
        new_name, ok = QInputDialog.getText(self, &#34;Rename Column&#34;, &#34;New column name:&#34;, text=current_name)
        if ok and new_name:
            self.model1.rename_column(column_index, new_name)
            self.update_table(1, self.model1)

    def edit_data_type(self, column_index):
        &#34;&#34;&#34;Edit the data type of the column at the given index.&#34;&#34;&#34;
        current_type = self.model1.get_column_type(column_index)
        if current_type==pl.Utf8:
            current_type = &#34;String&#34;
        elif current_type==pl.Int64:
            current_type = &#34;Integer&#34;
        elif current_type==pl.Float64:
            current_type = &#34;Float&#34;
        type_list = [&#34;String&#34;, &#34;Integer&#34;, &#34;Float&#34;]
        current_index = type_list.index(current_type)
        new_type, ok = QInputDialog.getItem(self, &#34;Edit Data Type&#34;, &#34;Select new data type:&#34;, type_list, current=current_index)
        if ok and new_type:
            self.model1.set_column_type(column_index, new_type)
            self.update_table(1, self.model1)
    
    def set_path(self, path):
        &#34;&#34;&#34;
        Sets the path attribute for the MainWindow instance.
        Args:
            path (str): The path to be set.
        &#34;&#34;&#34;
        
        self.path=path
    
    def add_output(self, script_text, result_text=None, plot_paths=None):
        &#34;&#34;&#34;Menambahkan output ke layout dalam bentuk card&#34;&#34;&#34;

        card_frame = QFrame()
        card_frame.setStyleSheet(&#34;&#34;&#34;
            QFrame {
                background-color: #f9f9f9;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 10px;
            }
        &#34;&#34;&#34;)

        card_layout = QVBoxLayout(card_frame)
        card_layout.setSpacing(8)

        label_script = QLabel(&#34;&lt;b&gt;Script R:&lt;/b&gt;&#34;)
        label_script.setStyleSheet(&#34;color: #333; margin-bottom: 5px;&#34;)
        script_box = QTextEdit()
        script_box.setPlainText(script_text)
        script_box.setReadOnly(True)
        script_box.setStyleSheet(&#34;&#34;&#34;
            QTextEdit {
                background-color: #fff;
                border: 1px solid #ccc;
                border-radius: 4px;
                padding: 5px;
                font-family: Consolas, Courier New, monospace;
            }
        &#34;&#34;&#34;)
        script_box.setFixedHeight(script_box.fontMetrics().lineSpacing() * (script_text.count(&#39;\n&#39;) + 3))

        card_layout.addWidget(label_script)
        card_layout.addWidget(script_box)

        if result_text:
            label_output = QLabel(&#34;&lt;b&gt;Output:&lt;/b&gt;&#34;)
            label_output.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
            result_box = QTextEdit()
            result_box.setPlainText(result_text)
            result_box.setReadOnly(True)
            result_box.setStyleSheet(&#34;&#34;&#34;
                QTextEdit {
                    background-color: #fff;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    padding: 5px;
                    font-family: Consolas, Courier New, monospace;
                }
            &#34;&#34;&#34;)
            max_height = 400
            calculated_height = result_box.fontMetrics().lineSpacing() * (result_text.count(&#39;\n&#39;) + 3)
            result_box.setFixedHeight(min(calculated_height, max_height))
            result_box.setVerticalScrollBarPolicy(Qt.ScrollBarPolicy.ScrollBarAlwaysOn if calculated_height &gt; max_height else Qt.ScrollBarPolicy.ScrollBarAlwaysOff)

            card_layout.addWidget(label_output)
            card_layout.addWidget(result_box)

        if plot_paths:
            label_plot = QLabel(&#34;&lt;b&gt;Plot:&lt;/b&gt;&#34;)
            label_plot.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
            card_layout.addWidget(label_plot)

            for plot_path in plot_paths:
                if os.path.exists(plot_path):
                    pixmap = QPixmap(plot_path)
                    label = QLabel()
                    label.setPixmap(pixmap)
                    label.setFixedSize(500, 350) 
                    label.setScaledContents(True)
                    label.setStyleSheet(&#34;border: 1px solid #ccc; border-radius: 4px;&#34;)
                    card_layout.addWidget(label)
        card_frame.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
        card_frame.customContextMenuRequested.connect(lambda pos: self.show_context_menu(pos, card_frame))

        if self.output_layout.count() &gt; 0:
            last_item = self.output_layout.itemAt(self.output_layout.count() - 1)
            if isinstance(last_item.spacerItem(), QSpacerItem):
                self.output_layout.removeItem(last_item)

        self.output_layout.addWidget(card_frame)

        if self.output_layout.count() == 1:
            self.output_layout.addStretch()

        self.tab_widget.setCurrentWidget(self.tab3)

        if plot_paths:
            for plot_path in plot_paths:
                if os.path.exists(plot_path):
                    os.remove(plot_path)


    def add_output(self, script_text, result_text=None, plot_paths=None, error_text=None):
        &#34;&#34;&#34;Add output to the layout in the form of a card&#34;&#34;&#34;

        # Create a frame as a card
        card_frame = QFrame()
        card_frame.setStyleSheet(&#34;&#34;&#34;
            QFrame {
                background-color: #f9f9f9;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 10px;
            }
        &#34;&#34;&#34;)


        card_layout = QVBoxLayout(card_frame)
        card_layout.setSpacing(8)

        label_script = QLabel(&#34;&lt;b&gt;R Script:&lt;/b&gt;&#34;)
        label_script.setStyleSheet(&#34;color: #333; margin-bottom: 5px;&#34;)
        script_box = QTextEdit()
        script_box.setPlainText(script_text)
        script_box.setReadOnly(True)
        script_box.setStyleSheet(&#34;&#34;&#34;
            QTextEdit {
                background-color: #fff;
                border: 1px solid #ccc;
                border-radius: 4px;
                padding: 5px;
                font-family: Consolas, Courier New, monospace;
            }
        &#34;&#34;&#34;)
        script_box.setFixedHeight(script_box.fontMetrics().lineSpacing() * (script_text.count(&#39;\n&#39;) + 3))

        card_layout.addWidget(label_script)
        card_layout.addWidget(script_box)

        if result_text:
            label_output = QLabel(&#34;&lt;b&gt;Output:&lt;/b&gt;&#34;)
            label_output.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
            result_box = QTextEdit()
            result_box.setPlainText(result_text)
            result_box.setReadOnly(True)
            result_box.setStyleSheet(&#34;&#34;&#34;
                QTextEdit {
                    background-color: #fff;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    padding: 5px;
                    font-family: Consolas, Courier New, monospace;
                }
            &#34;&#34;&#34;)
            max_height = 400
            calculated_height = result_box.fontMetrics().lineSpacing() * (result_text.count(&#39;\n&#39;) + 3)
            result_box.setFixedHeight(min(calculated_height, max_height))
            result_box.setVerticalScrollBarPolicy(Qt.ScrollBarPolicy.ScrollBarAlwaysOn if calculated_height &gt; max_height else Qt.ScrollBarPolicy.ScrollBarAlwaysOff)

            card_layout.addWidget(label_output)
            card_layout.addWidget(result_box)

        if plot_paths:
            label_plot = QLabel(&#34;&lt;b&gt;Plot:&lt;/b&gt;&#34;)
            label_plot.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
            card_layout.addWidget(label_plot)

            for plot_path in plot_paths:
                if os.path.exists(plot_path):
                    pixmap = QPixmap(plot_path)
                    label = QLabel()
                    label.setPixmap(pixmap)
                    label.setFixedSize(500, 350)
                    label.setScaledContents(True)
                    label.setStyleSheet(&#34;border: 1px solid #ccc; border-radius: 4px;&#34;)
                    card_layout.addWidget(label)

        if error_text:
            label_error = QLabel(&#34;&lt;b&gt;Error:&lt;/b&gt;&#34;)
            label_error.setStyleSheet(&#34;color: #a94442; margin-top: 10px; margin-bottom: 5px;&#34;)
            error_box = QTextEdit()
            error_box.setPlainText(error_text)
            error_box.setReadOnly(True)
            error_box.setStyleSheet(&#34;&#34;&#34;
                QTextEdit {
                    background-color: #f8d7da;
                    border: 1px solid #f5c6cb;
                    border-radius: 4px;
                    padding: 5px;
                    font-family: Consolas, Courier New, monospace;
                    color: #721c24;
                }
            &#34;&#34;&#34;)
            error_box.setFixedHeight(error_box.fontMetrics().lineSpacing() * (error_text.count(&#39;\n&#39;) + 3))

            card_layout.addWidget(label_error)
            card_layout.addWidget(error_box)

        card_frame.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
        card_frame.customContextMenuRequested.connect(lambda pos: self.show_context_menu(pos, card_frame))

        if self.output_layout.count() &gt; 0:
            last_item = self.output_layout.itemAt(self.output_layout.count() - 1)
            if isinstance(last_item.spacerItem(), QSpacerItem):
                self.output_layout.removeItem(last_item)

        self.output_layout.addWidget(card_frame)
        if self.output_layout.count() == 1:
            self.output_layout.addStretch()

        self.tab_widget.setCurrentWidget(self.tab3)

        if plot_paths:
            for plot_path in plot_paths:
                if os.path.exists(plot_path):
                    os.remove(plot_path)

    def remove_output(self, card_frame):
        &#34;&#34;&#34;Menghapus output dari layout&#34;&#34;&#34;
        self.output_layout.removeWidget(card_frame)
        card_frame.deleteLater()

        # Hapus spacer jika masih ada widget lain
        if self.output_layout.count() &gt; 0:
            last_item = self.output_layout.itemAt(self.output_layout.count() - 1)
            if isinstance(last_item.spacerItem(), QSpacerItem):
                self.output_layout.removeItem(last_item)

        # Tambahkan stretch hanya jika tidak ada output tersisa
        if self.output_layout.count() == 0:
            self.output_layout.addStretch()

    def copy_output_image(self, card_frame):
        &#34;&#34;&#34;Menyalin gambar output ke clipboard&#34;&#34;&#34;
        for child in card_frame.findChildren(QLabel):
            pixmap = child.pixmap()
            
            if pixmap and not pixmap.isNull():
                temp_folder = os.path.join(self.path, &#39;temp&#39;)
                temp_path = os.path.join(temp_folder, &#39;temp_image.png&#39;)

                os.makedirs(temp_folder, exist_ok=True)

                if pixmap.save(temp_path):
                    print(f&#34;Gambar disimpan di: {temp_path}&#34;)
                    
                    clipboard = QApplication.clipboard()
                    clipboard.setPixmap(QPixmap(temp_path))

                    if os.path.exists(temp_path):  
                        os.remove(temp_path)
                break

    def show_context_menu(self, pos, card_frame):
        &#34;&#34;&#34;Menampilkan menu klik kanan di setiap output&#34;&#34;&#34;
        menu = QMenu(self)
        delete_action = menu.addAction(&#34;Hapus Output&#34;)
        copy_image_action = menu.addAction(&#34;Copy Output Image&#34;)
        action = menu.exec(card_frame.mapToGlobal(pos))

        if action == delete_action:
            self.remove_output(card_frame)
        elif action == copy_image_action:
            self.copy_output_image(card_frame)

    def autosave_data(self):
        &#34;&#34;&#34;
        Save the current state of data1, data2 (as parquet), and output (as JSON) to temporary files.
        &#34;&#34;&#34;
        app_data_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
        os.makedirs(app_data_dir, exist_ok=True)
        temp_dir = os.path.join(app_data_dir, &#39;file-data&#39;)
        os.makedirs(temp_dir, exist_ok=True)
        # Save data1 and data2 as parquet
        data1_path = os.path.join(temp_dir, &#39;sae_pisan_data1.parquet&#39;)
        data2_path = os.path.join(temp_dir, &#39;sae_pisan_data2.parquet&#39;)
        self.model1.get_data().write_parquet(data1_path)
        self.model2.get_data().write_parquet(data2_path)
        # Save output as JSON
        output_path = os.path.join(temp_dir, &#39;sae_pisan_output.json&#39;)
        import numpy as np

        def make_json_serializable(obj):
            if isinstance(obj, dict):
                return {k: make_json_serializable(v) for k, v in obj.items()}
            elif isinstance(obj, list):
                return [make_json_serializable(v) for v in obj]
            elif isinstance(obj, np.ndarray):
                return obj.tolist()
            elif hasattr(obj, &#39;tolist&#39;):
                return obj.tolist()
            elif isinstance(obj, (int, float, str, type(None), bool)):
                return obj
            else:
                return str(obj)

        serializable_data = make_json_serializable(self.data)
        data = {
            &#39;timestamp&#39;: datetime.datetime.now().isoformat(),
            &#39;output&#39;: serializable_data
        }
        with open(output_path, &#39;w&#39;) as file:
            json.dump(data, file)
        
        # ?? delete image wasnt used
        temp_img_dir = os.path.join(temp_dir, &#39;temp&#39;)
        if os.path.exists(temp_img_dir):
            used_images = set()
            for output in serializable_data:
                result = output.get(&#34;result&#34;, {})
                plot_path = result.get(&#34;Plot&#34;)
                if plot_path and isinstance(plot_path, str):
                    used_images.add(os.path.abspath(plot_path))
            for output in self.data:
                result = output.get(&#34;result&#34;, {})
                plot_paths = result.get(&#34;Plot&#34;)
                if isinstance(plot_paths, list):
                    for p in plot_paths:
                        used_images.add(os.path.abspath(p))
                elif isinstance(plot_paths, str):
                    used_images.add(os.path.abspath(plot_paths))
            # Hapus file di temp yang tidak digunakan
            for fname in os.listdir(temp_img_dir):
                fpath = os.path.abspath(os.path.join(temp_img_dir, fname))
                if fpath not in used_images:
                    try:
                        os.remove(fpath)
                    except Exception:
                        pass
        if self.isActiveWindow():
            self.show_toast()
        

    def load_temp_data(self):
        &#34;&#34;&#34;
        Load data1 and data2 from parquet, and output from JSON, if they exist.
        &#34;&#34;&#34;
        app_path = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
        temp_dir = os.path.join(app_path, &#39;file-data&#39;)
        data1_path = os.path.join(temp_dir, &#39;sae_pisan_data1.parquet&#39;)
        data2_path = os.path.join(temp_dir, &#39;sae_pisan_data2.parquet&#39;)
        output_path = os.path.join(temp_dir, &#39;sae_pisan_output.json&#39;)
        if os.path.exists(data1_path) and os.path.exists(data2_path) and os.path.exists(output_path):
            reply = QMessageBox.question(self, &#39;Load Temporary Data&#39;,
                                         &#39;Temporary data was found. Do you want to load it?&#39;,
                                         QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No,
                                         QMessageBox.StandardButton.No)
            if reply == QMessageBox.StandardButton.Yes:
                self.data1 = pl.read_parquet(data1_path)
                self.data2 = pl.read_parquet(data2_path)
                self.model1.set_data(self.data1)
                self.model2.set_data(self.data2)
                self.update_table(1, self.model1)
                self.update_table(2, self.model2)
                with open(output_path, &#39;r&#39;) as file:
                    data = json.load(file)
                    self.set_output_data(data.get(&#39;output&#39;, []), timestamp=data.get(&#39;timestamp&#39;))
        else:
            QMessageBox.warning(self, &#39;No Recent Data&#39;, &#39;No recent data file was found.&#39;)

    def set_output_data(parent, output_data, timestamp=None):
        &#34;&#34;&#34;
        Menampilkan kembali output card dari data hasil get_output_data.
        &#34;&#34;&#34;
        for output in output_data:
            r_script = output.get(&#34;r_script&#34;, &#34;&#34;)
            results = output.get(&#34;result&#34;, &#34;&#34;)
            for key, value in results.items():
                if isinstance(value, dict):
                    df = pl.DataFrame(value)
                    results[key] = df
                else:
                    results[key] = value
            if &#34;Plot&#34; in results:
                display_script_and_output(parent, r_script, results, plot_paths=results[&#34;Plot&#34;], timestamps=timestamp)
            else:
                display_script_and_output(parent, r_script, results, plot_paths=None, timestamps=timestamp)
        
    def show_header_icon_info(self):
        &#34;&#34;&#34;
        Show a dialog explaining the meaning of header icons in the data table.
        &#34;&#34;&#34;
        msg = (
            &#34;&lt;b&gt;Header Icon Legend:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&#34;
            &#34;&lt;div style=&#39;display:flex; flex-direction:column; gap:8px;&#39;&gt;&#34;
            &#34;&lt;div&gt;&lt;img src=&#39;assets/nominal.svg&#39; width=&#39;24&#39; height=&#39;24&#39; style=&#39;vertical-align:middle;&#39;&gt; &lt;b&gt;Nominal/String&lt;/b&gt;&lt;/div&gt;&#34;
            &#34;&lt;div&gt;&lt;img src=&#39;assets/null.svg&#39; width=&#39;24&#39; height=&#39;24&#39; style=&#39;vertical-align:middle;&#39;&gt; &lt;b&gt;Null/Empty&lt;/b&gt;&lt;/div&gt;&#34;
            &#34;&lt;div&gt;&lt;img src=&#39;assets/numeric.svg&#39; width=&#39;24&#39; height=&#39;24&#39; style=&#39;vertical-align:middle;&#39;&gt; &lt;b&gt;Numeric&lt;/b&gt;&lt;/div&gt;&#34;
            &#34;&lt;/div&gt;&lt;br&gt;&#34;
            &#34;&lt;div style=&#39;max-width:350px;&#39;&gt;&#34;
            &#34;These icons indicate the data type of each column in the table. &#34;
            &#34;Nominal/String columns are represented by the nominal icon, &#34;
            &#34;Null/Empty columns are represented by the null icon, and &#34;
            &#34;Numeric columns are represented by the numeric icon.&#34;
            &#34;&lt;/div&gt;&#34;
        )
        QMessageBox.information(self, &#34;Header Icon Info&#34;, msg)
    
    def show_r_packages_info(self):
        &#34;&#34;&#34;
        Show a dialog listing the R packages used and their versions in a single table with 6 columns (3 pairs of Package/Version side by side).
        &#34;&#34;&#34;
        try:
            import rpy2.robjects as ro
            packages = [
                &#34;sae&#34;, &#34;arrow&#34;, &#34;sae.projection&#34;, &#34;emdi&#34;, &#34;xgboost&#34;, &#34;LiblineaR&#34;,
                &#34;kernlab&#34;, &#34;GGally&#34;, &#34;ggplot2&#34;, &#34;ggcorrplot&#34;, &#34;car&#34;, &#34;nortest&#34;,
                &#34;tidyr&#34;, &#34;carData&#34;, &#34;dplyr&#34;, &#34;tseries&#34;, &#34;FSelector&#34;, &#34;rjags&#34;, &#34;saeHB&#34;
            ]
            versions = []
            for pkg in packages:
                try:
                    ver = ro.r(f&#34;as.character(packageVersion(&#39;{pkg}&#39;))&#34;)[0]
                except Exception:
                    ver = &#34;Not Installed&#34;
                versions.append((pkg, ver))

            # Arrange into 3 columns (each column is Package/Version pair)
            n_cols = 3
            n_rows = (len(versions) + n_cols - 1) // n_cols
            table_cells = []
            for i in range(n_rows):
                row = []
                for j in range(n_cols):
                    idx = i + j * n_rows
                    if idx &lt; len(versions):
                        row.extend(versions[idx])
                    else:
                        row.extend((&#34;&#34;, &#34;&#34;))
                table_cells.append(row)

            msg = &#34;&lt;b&gt;R Packages Used:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&#34;
            msg += &#34;&lt;table style=&#39;border-collapse:collapse;font-size:13px;&#39;&gt;&#34;
            # Header
            msg += &#34;&lt;tr style=&#39;background-color:#f2f2f2;&#39;&gt;&#34;
            for i in range(n_cols):
                msg += &#34;&lt;th style=&#39;border:1px solid #bbb; padding:6px 16px;&#39;&gt;Package&lt;/th&gt;&#34;
                msg += &#34;&lt;th style=&#39;border:1px solid #bbb; padding:6px 16px;&#39;&gt;Version&lt;/th&gt;&#34;
            msg += &#34;&lt;/tr&gt;&#34;
            # Rows
            for row in table_cells:
                msg += &#34;&lt;tr&gt;&#34;
                for cell in row:
                    msg += f&#34;&lt;td style=&#39;border:1px solid #bbb; padding:6px 16px;&#39;&gt;{cell}&lt;/td&gt;&#34;
                msg += &#34;&lt;/tr&gt;&#34;
            msg += &#34;&lt;/table&gt;&#34;
        except Exception as e:
            msg = f&#34;Could not retrieve R package versions.&lt;br&gt;Error: {e}&#34;
        QMessageBox.information(self, &#34;R Packages Used&#34;, msg)
            
    def show_toast(self):
        toast = CustomToast(
            parent=self,
            title=&#34;Saved&#34;,
            text=&#34;Data, Data Output, and Output was saved&#34;,
            duration=3000,
            position=&#34;top-right&#34;
        )
        toast.set_border_radius(8)
        toast.show()
    
    def closeEvent(self, event):
        &#34;&#34;&#34;Handle the close event to show a confirmation dialog.&#34;&#34;&#34;
        reply = QMessageBox.question(self, &#39;Confirm Exit&#39;,
                                     &#39;Are you sure you want to exit?&#39;,
                                     QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No,
                                     QMessageBox.StandardButton.No)
        if reply == QMessageBox.StandardButton.Yes:
            self.autosave_data()
            import rpy2.robjects as ro
            if &#39;saeHB&#39; in ro.r(&#39;loadedNamespaces()&#39;):
                ro.r(&#39;detach(&#34;package:saeHB&#34;, unload=TRUE)&#39;)
            if &#39;rjags&#39; in ro.r(&#39;loadedNamespaces()&#39;):
                ro.r(&#34;unloadNamespace(&#39;rjags&#39;)&#34;)
            
            #to kill the process
            import os
            import psutil

            current_system_pid = os.getpid()

            ThisSystem = psutil.Process(current_system_pid)
            ThisSystem.terminate()
            event.accept()
        else:
            event.ignore()</code></pre>
</details>
<div class="desc"><p>Main application window for SAE Pisan: Small Area Estimation Programming for Statistical Analysis.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>data1</code></strong> :&ensp;<code>pl.DataFrame</code></dt>
<dd>DataFrame for the first sheet (Data Editor).</dd>
<dt><strong><code>data2</code></strong> :&ensp;<code>pl.DataFrame</code></dt>
<dd>DataFrame for the second sheet (Data Output).</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>TableModel</code></dt>
<dd>Table model for the first sheet.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>TableModel</code></dt>
<dd>Table model for the second sheet.</dd>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>Path to the application directory.</dd>
<dt><strong><code>font_size</code></strong> :&ensp;<code>int</code></dt>
<dd>Default font size for the application.</dd>
<dt><strong><code>show_modeling_sae_dialog</code></strong> :&ensp;<code>ModelingSaeDialog</code></dt>
<dd>Dialog for SAE modeling.</dd>
<dt><strong><code>show_modeling_saeHB_dialog</code></strong> :&ensp;<code>ModelingSaeHBDialog</code></dt>
<dd>Dialog for SAE HB modeling.</dd>
<dt><strong><code>show_modeling_sae_unit_dialog</code></strong> :&ensp;<code>ModelingSaeUnitDialog</code></dt>
<dd>Dialog for SAE unit modeling.</dd>
<dt><strong><code>show_modeling_saeHB_normal_dialog</code></strong> :&ensp;<code>ModelingSaeHBNormalDialog</code></dt>
<dd>Dialog for SAE HB normal modeling.</dd>
<dt><strong><code>show_modellig_sae_pseudo_dialog</code></strong> :&ensp;<code>ModelingSaePseudoDialog</code></dt>
<dd>Dialog for SAE pseudo modeling.</dd>
<dt><strong><code>show_compute_variable_dialog</code></strong> :&ensp;<code>ComputeVariableDialog</code></dt>
<dd>Dialog for computing new variables.</dd>
<dt><strong><code>show_projection_variabel_dialog</code></strong> :&ensp;<code>ProjectionDialog</code></dt>
<dd>Dialog for variable projection.</dd>
<dt><strong><code>menu_bar</code></strong> :&ensp;<code>QMenuBar</code></dt>
<dd>Menu bar for the application.</dd>
<dt><strong><code>toolBar</code></strong> :&ensp;<code>QToolBar</code></dt>
<dd>Tool bar for the application.</dd>
<dt><strong><code>tab_widget</code></strong> :&ensp;<code>QTabWidget</code></dt>
<dd>Tab widget containing the different sheets.</dd>
<dt><strong><code>spreadsheet</code></strong> :&ensp;<code>QTableView</code></dt>
<dd>Table view for the first sheet.</dd>
<dt><strong><code>table_view2</code></strong> :&ensp;<code>QTableView</code></dt>
<dd>Table view for the second sheet.</dd>
<dt><strong><code>scroll_area</code></strong> :&ensp;<code>QScrollArea</code></dt>
<dd>Scroll area for the output tab.</dd>
<dt><strong><code>output_layout</code></strong> :&ensp;<code>QVBoxLayout</code></dt>
<dd>Layout for displaying output in the output tab.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>init_ui(): Initializes the user interface.
change_font_size(): Opens a dialog to change the font size.
set_font_size(size): Sets the font size for the application.
load_stylesheet_with_font_size(size): Loads the stylesheet with the specified font size.
open_summary_data_dialog_lazy(): Lazily opens the summary data dialog.
open_normality_test_dialog_lazy(): Lazily opens the normality test dialog.
open_multicollinearity_dialog_lazy(): Lazily opens the multicollinearity dialog.
open_variable_selection_dialog_lazy(): Lazily opens the variable selection dialog.
open_scatter_plot_dialog_lazy(): Lazily opens the scatter plot dialog.
open_correlation_matrix_dialog_lazy(): Lazily opens the correlation matrix dialog.
open_box_plot_dialog_lazy(): Lazily opens the box plot dialog.
open_line_plot_dialog_lazy(): Lazily opens the line plot dialog.
open_histogram_dialog_lazy(): Lazily opens the histogram dialog.
open_summary_data_dialog(): Opens the summary data dialog.
open_normality_test_dialog(): Opens the normality test dialog.
open_scatter_plot_dialog(): Opens the scatter plot dialog.
open_line_plot_dialog(): Opens the line plot dialog.
open_box_plot_dialog(): Opens the box plot dialog.
open_correlation_matrix_dialog(): Opens the correlation matrix dialog.
open_multicollinearity_dialog(): Opens the multicollinearity dialog.
open_histogram_dialog(): Opens the histogram dialog.
open_variable_selection_dialog(): Opens the variable selection dialog.
show_modeling_sae_dialog_lazy(): Lazily shows the SAE modeling dialog.
show_modeling_saeHB_dialog_lazy(): Lazily shows the SAE HB modeling dialog.
show_modeling_sae_unit_dialog_lazy(): Lazily shows the SAE unit modeling dialog.
show_modeling_saeHB_normal_dialog_lazy(): Lazily shows the SAE HB normal modeling dialog.
show_modellig_sae_pseudo_dialog_lazy(): Lazily shows the SAE pseudo modeling dialog.
show_compute_variable_dialog_lazy(): Lazily shows the compute variable dialog.
show_projection_variabel_dialog_lazy(): Lazily shows the projection variable dialog.
open_about_dialog(): Opens the about dialog.
add_row(sheet_number): Adds a new row to the specified sheet.
add_column(sheet_number): Adds a new column to the specified sheet.
update_table(sheet_number, model): Updates the table for the specified sheet with a new model.
keyPressEvent(event): Handles keyboard shortcuts for copy, paste, undo, and redo.
copy_selection(): Copies the selected cells to the clipboard.
paste_selection(): Pastes the clipboard content to the selected cells.
undo_action(): Undoes the last action.
redo_action(): Redoes the last undone action.
group_by_row(selection): Groups selected indexes by row.
show_output(title, content): Displays output in the Output tab.
show_header_context_menu(pos): Shows the context menu for the header.
rename_column(column_index): Renames the column at the given index.
edit_data_type(column_index): Edits the data type of the column at the given index.
set_path(path): Sets the path for the application.
add_output(script_text, result_text=None, plot_paths=None, error_text=None): Adds output to the layout in the form of a card.
remove_output(card_frame): Removes output from the layout.
copy_output_image(card_frame): Copies the output image to the clipboard.
show_context_menu(pos, card_frame): Shows the context menu for each output.</p>
<p>Initializes the MainWindow class.
This constructor sets up the main window for the SAE Pisan application,
including setting the window title, initializing data frames, models,
and UI components.</p>
<h2 id="attributes_1">Attributes</h2>
<dl>
<dt><strong><code>data1</code></strong> :&ensp;<code>pl.DataFrame</code></dt>
<dd>A DataFrame with 100 columns and 100 empty rows.</dd>
<dt><strong><code>data2</code></strong> :&ensp;<code>pl.DataFrame</code></dt>
<dd>A DataFrame with columns "Estimated Value",
"Standar Error", and "CV", each with 100 empty rows.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>TableModel</code></dt>
<dd>The table model for the first data frame.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>TableModel</code></dt>
<dd>The table model for the second data frame.</dd>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path to the parent directory of the current file.</dd>
<dt><strong><code>font_size</code></strong> :&ensp;<code>int</code></dt>
<dd>The font size used in the UI.</dd>
</dl></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QMainWindow</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.MainWindow.MainWindow.add_column"><code class="name flex">
<span>def <span class="ident">add_column</span></span>(<span>self, sheet_number)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_column(self, sheet_number):
    &#34;&#34;&#34;Sinkronisasi data ketika kolom baru ditambahkan di SpreadsheetWidget.&#34;&#34;&#34;
    if sheet_number == 1:
        # Tambahkan kolom baru di DataFrame data1
        new_column_name = f&#34;Column {self.data1.shape[1] + 1}&#34;
        new_column = pl.DataFrame({new_column_name: [&#34;&#34;] * self.data1.shape[0]})
        self.data1 = pl.concat([self.data1, new_column], how=&#34;horizontal&#34;)
    elif sheet_number == 2:
        pass  # Tidak digunakan untuk Sheet 2</code></pre>
</details>
<div class="desc"><p>Sinkronisasi data ketika kolom baru ditambahkan di SpreadsheetWidget.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.add_output"><code class="name flex">
<span>def <span class="ident">add_output</span></span>(<span>self, script_text, result_text=None, plot_paths=None, error_text=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_output(self, script_text, result_text=None, plot_paths=None, error_text=None):
    &#34;&#34;&#34;Add output to the layout in the form of a card&#34;&#34;&#34;

    # Create a frame as a card
    card_frame = QFrame()
    card_frame.setStyleSheet(&#34;&#34;&#34;
        QFrame {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
        }
    &#34;&#34;&#34;)


    card_layout = QVBoxLayout(card_frame)
    card_layout.setSpacing(8)

    label_script = QLabel(&#34;&lt;b&gt;R Script:&lt;/b&gt;&#34;)
    label_script.setStyleSheet(&#34;color: #333; margin-bottom: 5px;&#34;)
    script_box = QTextEdit()
    script_box.setPlainText(script_text)
    script_box.setReadOnly(True)
    script_box.setStyleSheet(&#34;&#34;&#34;
        QTextEdit {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px;
            font-family: Consolas, Courier New, monospace;
        }
    &#34;&#34;&#34;)
    script_box.setFixedHeight(script_box.fontMetrics().lineSpacing() * (script_text.count(&#39;\n&#39;) + 3))

    card_layout.addWidget(label_script)
    card_layout.addWidget(script_box)

    if result_text:
        label_output = QLabel(&#34;&lt;b&gt;Output:&lt;/b&gt;&#34;)
        label_output.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
        result_box = QTextEdit()
        result_box.setPlainText(result_text)
        result_box.setReadOnly(True)
        result_box.setStyleSheet(&#34;&#34;&#34;
            QTextEdit {
                background-color: #fff;
                border: 1px solid #ccc;
                border-radius: 4px;
                padding: 5px;
                font-family: Consolas, Courier New, monospace;
            }
        &#34;&#34;&#34;)
        max_height = 400
        calculated_height = result_box.fontMetrics().lineSpacing() * (result_text.count(&#39;\n&#39;) + 3)
        result_box.setFixedHeight(min(calculated_height, max_height))
        result_box.setVerticalScrollBarPolicy(Qt.ScrollBarPolicy.ScrollBarAlwaysOn if calculated_height &gt; max_height else Qt.ScrollBarPolicy.ScrollBarAlwaysOff)

        card_layout.addWidget(label_output)
        card_layout.addWidget(result_box)

    if plot_paths:
        label_plot = QLabel(&#34;&lt;b&gt;Plot:&lt;/b&gt;&#34;)
        label_plot.setStyleSheet(&#34;color: #333; margin-top: 10px; margin-bottom: 5px;&#34;)
        card_layout.addWidget(label_plot)

        for plot_path in plot_paths:
            if os.path.exists(plot_path):
                pixmap = QPixmap(plot_path)
                label = QLabel()
                label.setPixmap(pixmap)
                label.setFixedSize(500, 350)
                label.setScaledContents(True)
                label.setStyleSheet(&#34;border: 1px solid #ccc; border-radius: 4px;&#34;)
                card_layout.addWidget(label)

    if error_text:
        label_error = QLabel(&#34;&lt;b&gt;Error:&lt;/b&gt;&#34;)
        label_error.setStyleSheet(&#34;color: #a94442; margin-top: 10px; margin-bottom: 5px;&#34;)
        error_box = QTextEdit()
        error_box.setPlainText(error_text)
        error_box.setReadOnly(True)
        error_box.setStyleSheet(&#34;&#34;&#34;
            QTextEdit {
                background-color: #f8d7da;
                border: 1px solid #f5c6cb;
                border-radius: 4px;
                padding: 5px;
                font-family: Consolas, Courier New, monospace;
                color: #721c24;
            }
        &#34;&#34;&#34;)
        error_box.setFixedHeight(error_box.fontMetrics().lineSpacing() * (error_text.count(&#39;\n&#39;) + 3))

        card_layout.addWidget(label_error)
        card_layout.addWidget(error_box)

    card_frame.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    card_frame.customContextMenuRequested.connect(lambda pos: self.show_context_menu(pos, card_frame))

    if self.output_layout.count() &gt; 0:
        last_item = self.output_layout.itemAt(self.output_layout.count() - 1)
        if isinstance(last_item.spacerItem(), QSpacerItem):
            self.output_layout.removeItem(last_item)

    self.output_layout.addWidget(card_frame)
    if self.output_layout.count() == 1:
        self.output_layout.addStretch()

    self.tab_widget.setCurrentWidget(self.tab3)

    if plot_paths:
        for plot_path in plot_paths:
            if os.path.exists(plot_path):
                os.remove(plot_path)</code></pre>
</details>
<div class="desc"><p>Add output to the layout in the form of a card</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.add_row"><code class="name flex">
<span>def <span class="ident">add_row</span></span>(<span>self, sheet_number)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_row(self, sheet_number):
    &#34;&#34;&#34;Sinkronisasi data ketika baris baru ditambahkan di SpreadsheetWidget.&#34;&#34;&#34;
    if sheet_number == 1:
        # Tambahkan baris baru di DataFrame data1
        new_row = pl.DataFrame({col: [&#34;&#34;] for col in self.data1.columns})
        self.data1 = pl.concat([self.data1, new_row])
    elif sheet_number == 2:
        pass  # Tidak digunakan untuk Sheet 2</code></pre>
</details>
<div class="desc"><p>Sinkronisasi data ketika baris baru ditambahkan di SpreadsheetWidget.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.autosave_data"><code class="name flex">
<span>def <span class="ident">autosave_data</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def autosave_data(self):
    &#34;&#34;&#34;
    Save the current state of data1, data2 (as parquet), and output (as JSON) to temporary files.
    &#34;&#34;&#34;
    app_data_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
    os.makedirs(app_data_dir, exist_ok=True)
    temp_dir = os.path.join(app_data_dir, &#39;file-data&#39;)
    os.makedirs(temp_dir, exist_ok=True)
    # Save data1 and data2 as parquet
    data1_path = os.path.join(temp_dir, &#39;sae_pisan_data1.parquet&#39;)
    data2_path = os.path.join(temp_dir, &#39;sae_pisan_data2.parquet&#39;)
    self.model1.get_data().write_parquet(data1_path)
    self.model2.get_data().write_parquet(data2_path)
    # Save output as JSON
    output_path = os.path.join(temp_dir, &#39;sae_pisan_output.json&#39;)
    import numpy as np

    def make_json_serializable(obj):
        if isinstance(obj, dict):
            return {k: make_json_serializable(v) for k, v in obj.items()}
        elif isinstance(obj, list):
            return [make_json_serializable(v) for v in obj]
        elif isinstance(obj, np.ndarray):
            return obj.tolist()
        elif hasattr(obj, &#39;tolist&#39;):
            return obj.tolist()
        elif isinstance(obj, (int, float, str, type(None), bool)):
            return obj
        else:
            return str(obj)

    serializable_data = make_json_serializable(self.data)
    data = {
        &#39;timestamp&#39;: datetime.datetime.now().isoformat(),
        &#39;output&#39;: serializable_data
    }
    with open(output_path, &#39;w&#39;) as file:
        json.dump(data, file)
    
    # ?? delete image wasnt used
    temp_img_dir = os.path.join(temp_dir, &#39;temp&#39;)
    if os.path.exists(temp_img_dir):
        used_images = set()
        for output in serializable_data:
            result = output.get(&#34;result&#34;, {})
            plot_path = result.get(&#34;Plot&#34;)
            if plot_path and isinstance(plot_path, str):
                used_images.add(os.path.abspath(plot_path))
        for output in self.data:
            result = output.get(&#34;result&#34;, {})
            plot_paths = result.get(&#34;Plot&#34;)
            if isinstance(plot_paths, list):
                for p in plot_paths:
                    used_images.add(os.path.abspath(p))
            elif isinstance(plot_paths, str):
                used_images.add(os.path.abspath(plot_paths))
        # Hapus file di temp yang tidak digunakan
        for fname in os.listdir(temp_img_dir):
            fpath = os.path.abspath(os.path.join(temp_img_dir, fname))
            if fpath not in used_images:
                try:
                    os.remove(fpath)
                except Exception:
                    pass
    if self.isActiveWindow():
        self.show_toast()</code></pre>
</details>
<div class="desc"><p>Save the current state of data1, data2 (as parquet), and output (as JSON) to temporary files.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.change_font_size"><code class="name flex">
<span>def <span class="ident">change_font_size</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def change_font_size(self):
    &#34;&#34;&#34;
    Opens a dialog to change the font size of the application.
    The dialog presents three font size options: &#34;Small&#34;, &#34;Medium&#34;, and &#34;Big&#34;.
    The user can select a font size from a combo box, and the selected size
    will be applied to the application if the user confirms the selection.
    The dialog also displays a sample text (&#34;AaBbCc&#34;) that updates in real-time
    to reflect the selected font size.
    Attributes:
        sizes (dict): A dictionary mapping font size names to their corresponding pixel values.
        items (list): A list of font size names.
        dialog (QDialog): The dialog window for selecting the font size.
        layout (QVBoxLayout): The main layout of the dialog.
        combo_box (QComboBox): The combo box for selecting the font size.
        display (QLabel): The label displaying the sample text with the selected font size.
        button_box (QHBoxLayout): The layout containing the OK and Cancel buttons.
        ok_button (QPushButton): The button to confirm the font size selection.
        cancel_button (QPushButton): The button to cancel the font size selection.
    Methods:
        update_display_font_size: Updates the sample text&#39;s font size based on the selected size in the combo box.
    &#34;&#34;&#34;
    
    sizes = {&#34;Small&#34;: 10, &#34;Medium&#34;: 12, &#34;Big&#34;: 16}
    items = list(sizes.keys())

    dialog = QDialog(self)
    dialog.setWindowTitle(&#34;Select Font Size&#34;)
    dialog.setMinimumWidth(200)

    layout = QVBoxLayout(dialog)

    combo_box = QComboBox()
    combo_box.addItems(items)
    default_size = next(key for key, value in sizes.items() if value == self.font_size)
    combo_box.setCurrentText(default_size)
    layout.addWidget(combo_box)
    
    display = QLabel(&#34;AaBbCc&#34;)
    display.setAlignment(Qt.AlignmentFlag.AlignCenter)
    display.setStyleSheet(f&#34;font-size: {self.font_size}px;&#34;)
    layout.addWidget(display)

    def update_display_font_size():
        size = combo_box.currentText()
        display.setStyleSheet(f&#34;font-size: {sizes[size]}px;&#34;)

    combo_box.currentTextChanged.connect(update_display_font_size)

    button_box = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    button_box.addWidget(ok_button)
    button_box.addWidget(cancel_button)
    layout.addLayout(button_box)

    ok_button.clicked.connect(dialog.accept)
    cancel_button.clicked.connect(dialog.reject)

    dialog.setLayout(layout)

    if dialog.exec() == QDialog.DialogCode.Accepted:
        selected_size = combo_box.currentText()
        self.set_font_size(sizes[selected_size])
        self.font_size = sizes[selected_size]</code></pre>
</details>
<div class="desc"><p>Opens a dialog to change the font size of the application.
The dialog presents three font size options: "Small", "Medium", and "Big".
The user can select a font size from a combo box, and the selected size
will be applied to the application if the user confirms the selection.
The dialog also displays a sample text ("AaBbCc") that updates in real-time
to reflect the selected font size.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>sizes</code></strong> :&ensp;<code>dict</code></dt>
<dd>A dictionary mapping font size names to their corresponding pixel values.</dd>
<dt><strong><code>items</code></strong> :&ensp;<code>list</code></dt>
<dd>A list of font size names.</dd>
<dt><strong><code>dialog</code></strong> :&ensp;<code>QDialog</code></dt>
<dd>The dialog window for selecting the font size.</dd>
<dt><strong><code>layout</code></strong> :&ensp;<code>QVBoxLayout</code></dt>
<dd>The main layout of the dialog.</dd>
<dt><strong><code>combo_box</code></strong> :&ensp;<code>QComboBox</code></dt>
<dd>The combo box for selecting the font size.</dd>
<dt><strong><code>display</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>The label displaying the sample text with the selected font size.</dd>
<dt><strong><code>button_box</code></strong> :&ensp;<code>QHBoxLayout</code></dt>
<dd>The layout containing the OK and Cancel buttons.</dd>
<dt><strong><code>ok_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>The button to confirm the font size selection.</dd>
<dt><strong><code>cancel_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>The button to cancel the font size selection.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>update_display_font_size: Updates the sample text's font size based on the selected size in the combo box.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    &#34;&#34;&#34;Handle the close event to show a confirmation dialog.&#34;&#34;&#34;
    reply = QMessageBox.question(self, &#39;Confirm Exit&#39;,
                                 &#39;Are you sure you want to exit?&#39;,
                                 QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No,
                                 QMessageBox.StandardButton.No)
    if reply == QMessageBox.StandardButton.Yes:
        self.autosave_data()
        import rpy2.robjects as ro
        if &#39;saeHB&#39; in ro.r(&#39;loadedNamespaces()&#39;):
            ro.r(&#39;detach(&#34;package:saeHB&#34;, unload=TRUE)&#39;)
        if &#39;rjags&#39; in ro.r(&#39;loadedNamespaces()&#39;):
            ro.r(&#34;unloadNamespace(&#39;rjags&#39;)&#34;)
        
        #to kill the process
        import os
        import psutil

        current_system_pid = os.getpid()

        ThisSystem = psutil.Process(current_system_pid)
        ThisSystem.terminate()
        event.accept()
    else:
        event.ignore()</code></pre>
</details>
<div class="desc"><p>Handle the close event to show a confirmation dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.copy_output_image"><code class="name flex">
<span>def <span class="ident">copy_output_image</span></span>(<span>self, card_frame)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def copy_output_image(self, card_frame):
    &#34;&#34;&#34;Menyalin gambar output ke clipboard&#34;&#34;&#34;
    for child in card_frame.findChildren(QLabel):
        pixmap = child.pixmap()
        
        if pixmap and not pixmap.isNull():
            temp_folder = os.path.join(self.path, &#39;temp&#39;)
            temp_path = os.path.join(temp_folder, &#39;temp_image.png&#39;)

            os.makedirs(temp_folder, exist_ok=True)

            if pixmap.save(temp_path):
                print(f&#34;Gambar disimpan di: {temp_path}&#34;)
                
                clipboard = QApplication.clipboard()
                clipboard.setPixmap(QPixmap(temp_path))

                if os.path.exists(temp_path):  
                    os.remove(temp_path)
            break</code></pre>
</details>
<div class="desc"><p>Menyalin gambar output ke clipboard</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.copy_selection"><code class="name flex">
<span>def <span class="ident">copy_selection</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def copy_selection(self):
    &#34;&#34;&#34;Copy selected cells to clipboard.&#34;&#34;&#34;
    selection = self.spreadsheet.selectionModel().selectedIndexes()
    if selection:
        data = &#39;\n&#39;.join([&#39;\t&#39;.join([self.model1.data(index, Qt.ItemDataRole.DisplayRole) for index in row]) for row in self.group_by_row(selection)])
        clipboard = QApplication.clipboard()
        clipboard.setText(data)</code></pre>
</details>
<div class="desc"><p>Copy selected cells to clipboard.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.edit_data_type"><code class="name flex">
<span>def <span class="ident">edit_data_type</span></span>(<span>self, column_index)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def edit_data_type(self, column_index):
    &#34;&#34;&#34;Edit the data type of the column at the given index.&#34;&#34;&#34;
    current_type = self.model1.get_column_type(column_index)
    if current_type==pl.Utf8:
        current_type = &#34;String&#34;
    elif current_type==pl.Int64:
        current_type = &#34;Integer&#34;
    elif current_type==pl.Float64:
        current_type = &#34;Float&#34;
    type_list = [&#34;String&#34;, &#34;Integer&#34;, &#34;Float&#34;]
    current_index = type_list.index(current_type)
    new_type, ok = QInputDialog.getItem(self, &#34;Edit Data Type&#34;, &#34;Select new data type:&#34;, type_list, current=current_index)
    if ok and new_type:
        self.model1.set_column_type(column_index, new_type)
        self.update_table(1, self.model1)</code></pre>
</details>
<div class="desc"><p>Edit the data type of the column at the given index.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.group_by_row"><code class="name flex">
<span>def <span class="ident">group_by_row</span></span>(<span>self, selection)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def group_by_row(self, selection):
    &#34;&#34;&#34;Group selected indexes by row.&#34;&#34;&#34;
    rows = {}
    for index in selection:
        if index.row() not in rows:
            rows[index.row()] = []
        rows[index.row()].append(index)
    return [rows[row] for row in sorted(rows)]</code></pre>
</details>
<div class="desc"><p>Group selected indexes by row.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.init_ui"><code class="name flex">
<span>def <span class="ident">init_ui</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_ui(self):
    &#34;&#34;&#34;
    Initialize the user interface of the main window.
    This method sets up the main layout, including a splitter, tab widgets, 
    and various tabs for data editing, data output, and other functionalities. 
    It also configures the menu bar with different menus and actions, 
    and sets up the toolbar with various actions and icons.
    Tabs:
        - Data Editor: Allows editing of data in a spreadsheet format.
        - Data Output: Displays output data in a table view.
        - Output: Displays output in a scrollable area.
    Menus:
        - File: Contains actions to load and save files.
        - Exploration: Contains actions for data exploration such as summary data, normality test, correlation, etc.
        - Graph: Contains actions to generate different types of plots.
        - Model: Contains actions related to different modeling techniques.
        - Compute: Contains actions to compute new variables.
        - About: Contains information about the application.
        - Settings: Contains actions to change application settings.
    Toolbar:
        - Load File: Action to load a file.
        - Save Data: Action to save data.
        - Undo: Action to undo the last operation.
        - Redo: Action to redo the last undone operation.
        - Compute New Variable: Action to compute a new variable.
        - Setting: Action to open settings.
    Shortcuts:
        - Go to Start Row: Ctrl + Up
        - Go to End Row: Ctrl + Down
        - Go to Start Column: Ctrl + Left
        - Go to End Column: Ctrl + Right
    Layout:
        - The main layout is a vertical box layout containing the tab widget.
        - The central widget is set with this layout.
        - The main window is resized to a default size of 800x600.
    &#34;&#34;&#34;
    
    # Membuat splitter utama untuk membagi halaman menjadi dua bagian (kiri dan kanan)
    self.splitter_main = QSplitter(Qt.Orientation.Horizontal, self)

    # Bagian kiri: QTabWidget untuk dua sheet
    self.tab_widget = QTabWidget(self.splitter_main)  # Ditambahkan ke splitter utama
    self.tab_widget.setTabPosition(QTabWidget.TabPosition.South)
    
    self.show_modeling_sae_dialog = None
    self.show_modeling_saeHB_dialog = None
    self.show_modeling_sae_unit_dialog = None
    self.show_modeling_saeHB_normal_dialog = None
    self.show_modellig_sae_pseudo_dialog = None
    self.show_compute_variable_dialog = None
    self.show_projection_variabel_dialog = None
    

    # Tab pertama (Data Editor)
    self.tab1 = QWidget()
    self.spreadsheet = QTableView(self.tab1)
    self.spreadsheet.setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    self.spreadsheet.customContextMenuRequested.connect(lambda pos: show_context_menu(self, pos))
    self.spreadsheet.setModel(self.model1)
    self.spreadsheet.horizontalHeader().setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    self.spreadsheet.horizontalHeader().customContextMenuRequested.connect(self.show_header_context_menu)
    self.spreadsheet.horizontalHeader().sectionDoubleClicked.connect(self.rename_column)
    self.spreadsheet.verticalHeader().setContextMenuPolicy(Qt.ContextMenuPolicy.CustomContextMenu)
    self.spreadsheet.verticalHeader().customContextMenuRequested.connect(lambda pos: show_context_menu(self, pos))

    tab1_layout = QVBoxLayout(self.tab1)
    tab1_layout.addWidget(self.spreadsheet)
    self.spreadsheet.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)

    # Tab kedua (Data Output)
    self.tab2 = QWidget()
    self.table_view2 = QTableView(self.tab2)
    self.table_view2.setModel(self.model2)
    self.table_view2.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)

    tab2_layout = QVBoxLayout(self.tab2)
    tab2_layout.addWidget(self.table_view2)

    # Tab ketiga (Output)
    self.tab3 = QWidget()
    self.scroll_area = QScrollArea(self.tab3)
    
    # Tab output
    self.output_tab = QWidget()
    self.scroll_area = QScrollArea(self.output_tab)
    self.scroll_area.setWidgetResizable(True)
    self.output_container = QWidget()
    self.output_layout = QVBoxLayout(self.output_container)
    self.scroll_area.verticalScrollBar().rangeChanged.connect(lambda: self.scroll_area.verticalScrollBar().setValue(self.scroll_area.verticalScrollBar().maximum()))
    self.output_container.setLayout(self.output_layout)
    self.scroll_area.setWidget(self.output_container)
    
    # Atur layout output
    self.output_layout.setAlignment(Qt.AlignmentFlag.AlignTop)
    self.output_layout.setSpacing(0)

    tab3_layout = QVBoxLayout(self.tab3)
    tab3_layout.addWidget(self.scroll_area)

    # Menambahkan tab ke QTabWidget
    self.tab_widget.addTab(self.tab1, &#34;Data Editor&#34;)
    self.tab_widget.addTab(self.tab2, &#34;Data Output&#34;)
    self.tab_widget.addTab(self.tab3, &#34;Output&#34;)  # Tab baru untuk output

    # Membuat layout utama
    layout = QVBoxLayout()
    layout.addWidget(self.tab_widget)
    

    # Widget utama dan layout
    central_widget = QWidget(self)
    central_widget.setLayout(layout)
    self.setCentralWidget(central_widget)

    # Membuat menu bar
    self.menu_bar = self.menuBar()

    # Membuat menu File -&gt; Load dan Save
    self.file_menu = self.menu_bar.addMenu(&#34;File&#34;)
    
    self.recent_data = QAction(&#34;Open Recent data&#34;, self)
    self.recent_data.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_D))
    self.recent_data.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;recentdata.svg&#39;)))
    self.recent_data.setStatusTip(&#34;Ctrl+D&#34;)
    
    self.load_action = QAction(&#34;Load File&#34;, self)
    self.load_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_O))
    self.load_action.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;open.svg&#39;)))
    self.load_action.setStatusTip(&#34;Ctrl+O&#34;)
    
    self.load_secondary_data = QAction(&#34;Load File for Secondary Data&#34;, self)
    self.load_secondary_data.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_2))
    self.load_secondary_data.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;secondary.svg&#39;)))
    self.load_secondary_data.setStatusTip(&#34;Ctrl+2&#34;)
    
    self.save_action = QAction(&#34;Save Data&#34;, self)
    self.save_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_S))
    self.save_action.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;savedata.svg&#39;)))
    self.save_action.setStatusTip(&#34;Ctrl+S&#34;)
    
    self.save_data_output_action = QAction(&#34;Save Data Output&#34;, self)
    self.save_data_output_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Modifier.SHIFT | Qt.Key.Key_S))
    self.save_data_output_action.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;savedataoutput.svg&#39;)))
    self.save_action.setStatusTip(&#34;Ctrl+Shift+S&#34;)
    
    self.save_output_pdf = QAction(&#34;Save Output to PDF&#34;, self)
    self.save_output_pdf.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_P))
    self.save_output_pdf.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;savepdf.svg&#39;)))
    self.save_output_pdf.setStatusTip(&#34;Ctrl+P&#34;)

    self.file_menu.addAction(self.recent_data)
    self.file_menu.addAction(self.load_action)
    self.file_menu.addAction(self.load_secondary_data)
    self.file_menu.addAction(self.save_action)
    self.file_menu.addAction(self.save_data_output_action)
    self.file_menu.addAction(self.save_output_pdf)

    # Menu &#34;Exploration&#34;
    self.menu_exploration = self.menu_bar.addMenu(&#34;Pre-Modeling&#34;)

    self.action_summary_data = QAction(&#34;Data Summary&#34;, self)
    self.action_summary_data.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;summary.svg&#39;)))
    self.action_summary_data.triggered.connect(self.open_summary_data_dialog_lazy)

    self.action_normality_test = QAction(&#34;Normality Test&#34;, self)
    self.action_normality_test.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;normality.svg&#39;)))
    self.action_normality_test.triggered.connect(self.open_normality_test_dialog_lazy)

    self.action_correlation = QAction(&#34;Correlation&#34;, self)
    self.action_correlation.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;correlation.svg&#39;)))
    self.action_correlation.triggered.connect(self.open_correlation_matrix_dialog_lazy)

    self.action_multicollinearity = QAction(&#34;Multicollinearity&#34;, self)
    self.action_multicollinearity.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;multicolinierity.svg&#39;)))
    self.action_multicollinearity.triggered.connect(self.open_multicollinearity_dialog_lazy)

    self.action_variable_selection = QAction(&#34;Variable Selection&#34;, self)
    self.action_variable_selection.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;varselection.svg&#39;)))
    self.action_variable_selection.triggered.connect(self.open_variable_selection_dialog_lazy)

    self.menu_exploration.addAction(self.action_summary_data)
    self.menu_exploration.addAction(self.action_normality_test)
    self.menu_exploration.addAction(self.action_correlation)
    self.menu_exploration.addAction(self.action_multicollinearity)
    self.menu_exploration.addAction(self.action_variable_selection)

    # Menu &#34;Graph&#34;
    self.menu_graph = self.menu_bar.addMenu(&#34;Graph&#34;)

    self.action_scatter_plot = QAction(&#34;Scatter Plot&#34;, self)
    self.action_scatter_plot.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;scatterplot.svg&#39;)))
    self.action_scatter_plot.triggered.connect(self.open_scatter_plot_dialog_lazy)

    self.action_box_plot = QAction(&#34;Box Plot&#34;, self)
    self.action_box_plot.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;boxplot.svg&#39;)))
    self.action_box_plot.triggered.connect(self.open_box_plot_dialog_lazy)

    self.action_line_plot = QAction(&#34;Line Plot&#34;, self)
    self.action_line_plot.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;lineplot.svg&#39;)))
    self.action_line_plot.triggered.connect(self.open_line_plot_dialog_lazy)

    self.action_histogram = QAction(&#34;Histogram&#34;, self)
    self.action_histogram.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;histogram.svg&#39;)))
    self.action_histogram.triggered.connect(self.open_histogram_dialog_lazy)

    # Menambahkan plot-plot ke menu Graph
    self.menu_graph.addAction(self.action_scatter_plot)
    self.menu_graph.addAction(self.action_box_plot)
    self.menu_graph.addAction(self.action_line_plot)
    self.menu_graph.addAction(self.action_histogram)
    # Menu &#34;Model&#34;
    menu_model = self.menu_bar.addMenu(&#34;Model&#34;)

    # Submenu &#34;Area Level&#34;
    menu_area_level = QMenu(&#34;Area Level&#34;, self)
    menu_area_level.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;arealevel.svg&#39;)))
    action_eblup_area = QAction(&#34;EBLUP&#34;, self)
    action_eblup_area.triggered.connect(self.show_modeling_sae_dialog_lazy)
    action_hb_beta = QAction(&#34;HB Beta&#34;, self)
    action_hb_beta.triggered.connect(self.show_modeling_saeHB_dialog_lazy)
    menu_area_level.addAction(action_eblup_area)
    menu_area_level.addAction(action_hb_beta)

    # Submenu &#34;Unit Level&#34;
    menu_unit_level = QMenu(&#34;Unit Level&#34;, self)
    menu_unit_level.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;unitlevel.svg&#39;)))
    action_eblup_unit = QAction(&#34;EBLUP&#34;, self)
    action_eblup_unit.triggered.connect(self.show_modeling_sae_unit_dialog_lazy)
    action_hb_normal = QAction(&#34;HB Normal&#34;, self)
    action_hb_normal.triggered.connect(self.show_modeling_saeHB_normal_dialog_lazy)
    menu_unit_level.addAction(action_eblup_unit)
    menu_unit_level.addAction(action_hb_normal)

    # Submenu &#34;Pseudo&#34;
    menu_pseudo = QMenu(&#34;Pseudo&#34;, self)
    menu_pseudo.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;pseudo.svg&#39;)))
    action_eblup_pseudo = QAction(&#34;EBLUP&#34;, self)
    action_eblup_pseudo.triggered.connect(self.show_modellig_sae_pseudo_dialog_lazy)
    menu_pseudo.addAction(action_eblup_pseudo)

    # Submenu &#34;Projection&#34;
    menu_projection = QMenu(&#34;Projection&#34;, self)
    menu_projection.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;projection.svg&#39;)))
    action_projection = QAction(&#34;Projection&#34;, self)
    action_projection.triggered.connect(self.show_projection_variabel_dialog_lazy)
    menu_projection.addAction(action_projection)


    # Menambahkan submenu ke menu &#34;Model&#34;
    menu_model.addMenu(menu_area_level)
    menu_model.addMenu(menu_unit_level)
    menu_model.addMenu(menu_pseudo)
    menu_model.addMenu(menu_projection)



     # Menu &#39;Compute&#39;
    menu_compute = self.menu_bar.addMenu(&#34;Compute&#34;)
    compute_new_var = QAction(&#34;Compute New Variable&#34;, self)
    compute_new_var.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;compute.svg&#39;)))
    compute_new_var.triggered.connect(self.show_compute_variable_dialog_lazy)
    menu_compute.addAction(compute_new_var)
    
    # Menu &#34;About&#34;
    menu_about = self.menu_bar.addMenu(&#34;About&#34;)
    action_about_info = QAction(&#34;About This App&#34;, self)
    action_about_info.triggered.connect(self.open_about_dialog)
    action_about_info.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;about.svg&#39;)))
    menu_about.addAction(action_about_info)
    
    action_header_icon_info = QAction(&#34;Header Icon Info&#34;, self)
    action_header_icon_info.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;information.svg&#39;)))
    action_header_icon_info.triggered.connect(self.show_header_icon_info)
    menu_about.addAction(action_header_icon_info)
    
    # Add R Packages Used menu
    action_r_packages_info = QAction(&#34;R Packages Used&#34;, self)
    action_r_packages_info.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;Rinfo.svg&#39;)))
    action_r_packages_info.triggered.connect(self.show_r_packages_info)
    menu_about.addAction(action_r_packages_info)
    

    # Tool Bar
    self.toolBar = QToolBar(self)
    self.toolBar.setIconSize(QSize(45, 35))
    self.toolBar.setObjectName(&#34;toolBar&#34;)
    self.addToolBar(Qt.ToolBarArea.TopToolBarArea, self.toolBar)  # Perbaikan dilakukan di sini
    # Actions for Toolbar
    self.actionLoad_file = QAction(self)  # Menggunakan self untuk referensi instance
    icon_load = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;open.svg&#39;))
    self.actionLoad_file.setIcon(icon_load)
    self.actionLoad_file.setText(&#34;Load File&#34;)
    self.toolBar.addAction(self.actionLoad_file)

    self.actionSave_Data = QAction(self)  # Menggunakan self untuk referensi instance
    icon_save = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;save.svg&#39;))
    self.actionSave_Data.setIcon(icon_save)
    self.actionSave_Data.setText(&#34;Save Data&#34;)
    self.toolBar.addAction(self.actionSave_Data)

    self.actionUndo = QAction(self)
    icon_undo = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;undo.svg&#39;))
    self.actionUndo.setIcon(icon_undo)
    self.actionUndo.setText(&#34;Undo&#34;)
    self.actionUndo.triggered.connect(self.undo_action)
    self.toolBar.addAction(self.actionUndo)

    self.actionRedo = QAction(self)
    icon_redo = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;redo.svg&#39;))
    self.actionRedo.setIcon(icon_redo)
    self.actionRedo.setText(&#34;Redo&#34;)
    self.actionRedo.triggered.connect(self.redo_action)
    self.toolBar.addAction(self.actionRedo)
    
    self.actionCompute = QAction(self)
    icon_compute = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;compute.svg&#39;))
    self.actionCompute.setIcon(icon_compute)
    self.actionCompute.setText(&#34;Compute New Variable&#34;)
    self.actionCompute.triggered.connect(self.show_compute_variable_dialog_lazy)
    self.toolBar.addAction(self.actionCompute)
    
    # Shortcuts for &#34;Go to Start/End Row/Column&#34;
    self.go_to_start_row_action = QAction(self)
    self.go_to_start_row_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Up))
    self.go_to_start_row_action.triggered.connect(lambda : go_to_start_row(self))
    self.addAction(self.go_to_start_row_action)

    self.go_to_end_row_action = QAction(self)
    self.go_to_end_row_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Down))
    self.go_to_end_row_action.triggered.connect(lambda : go_to_end_row(self))
    self.addAction(self.go_to_end_row_action)

    self.go_to_start_column_action = QAction(self)
    self.go_to_start_column_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Left))
    self.go_to_start_column_action.triggered.connect(lambda : go_to_start_column(self))
    self.addAction(self.go_to_start_column_action)

    self.go_to_end_column_action = QAction(self)
    self.go_to_end_column_action.setShortcut(QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_Right))
    self.go_to_end_column_action.triggered.connect(lambda : go_to_end_column(self))
    self.addAction(self.go_to_end_column_action)

    # Add spacer to push following items to the right
    spacer = QWidget(self)
    spacer.setSizePolicy(QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Preferred)
    self.toolBar.addWidget(spacer)

    # Add &#34;Setting&#34; button to the right
    self.actionSetting = QAction(self)
    icon_setting = QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;setting.svg&#39;))
    self.actionSetting.setIcon(icon_setting)
    self.actionSetting.setText(&#34;Setting&#34;)
    self.actionSetting.triggered.connect(self.change_font_size)
    self.toolBar.addAction(self.actionSetting)
    

    # Menu &#34;Settings&#34;
    menu_settings = self.menu_bar.addMenu(&#34;Settings&#34;)
    action_change_font_size = QAction(&#34;Change Font Size&#34;, self)
    action_change_font_size.setIcon(QIcon(os.path.join(os.path.dirname(__file__), &#39;..&#39;, &#39;assets&#39;, &#39;setting.svg&#39;)))
    action_change_font_size.triggered.connect(self.change_font_size)
    menu_settings.addAction(action_change_font_size)

    # Menetapkan ukuran default
    self.resize(800, 600)</code></pre>
</details>
<div class="desc"><p>Initialize the user interface of the main window.
This method sets up the main layout, including a splitter, tab widgets,
and various tabs for data editing, data output, and other functionalities.
It also configures the menu bar with different menus and actions,
and sets up the toolbar with various actions and icons.</p>
<h2 id="tabs">Tabs</h2>
<ul>
<li>Data Editor: Allows editing of data in a spreadsheet format.</li>
<li>Data Output: Displays output data in a table view.</li>
<li>Output: Displays output in a scrollable area.</li>
</ul>
<h2 id="menus">Menus</h2>
<ul>
<li>File: Contains actions to load and save files.</li>
<li>Exploration: Contains actions for data exploration such as summary data, normality test, correlation, etc.</li>
<li>Graph: Contains actions to generate different types of plots.</li>
<li>Model: Contains actions related to different modeling techniques.</li>
<li>Compute: Contains actions to compute new variables.</li>
<li>About: Contains information about the application.</li>
<li>Settings: Contains actions to change application settings.</li>
</ul>
<h2 id="toolbar">Toolbar</h2>
<ul>
<li>Load File: Action to load a file.</li>
<li>Save Data: Action to save data.</li>
<li>Undo: Action to undo the last operation.</li>
<li>Redo: Action to redo the last undone operation.</li>
<li>Compute New Variable: Action to compute a new variable.</li>
<li>Setting: Action to open settings.</li>
</ul>
<h2 id="shortcuts">Shortcuts</h2>
<ul>
<li>Go to Start Row: Ctrl + Up</li>
<li>Go to End Row: Ctrl + Down</li>
<li>Go to Start Column: Ctrl + Left</li>
<li>Go to End Column: Ctrl + Right</li>
</ul>
<h2 id="layout">Layout</h2>
<ul>
<li>The main layout is a vertical box layout containing the tab widget.</li>
<li>The central widget is set with this layout.</li>
<li>The main window is resized to a default size of 800x600.</li>
</ul></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.keyPressEvent"><code class="name flex">
<span>def <span class="ident">keyPressEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def keyPressEvent(self, event):
    &#34;&#34;&#34;Handle keyboard shortcuts for copy, paste, undo, and redo.&#34;&#34;&#34;
    if event.matches(QKeySequence.StandardKey.Copy):
        self.copy_selection()
    elif event.matches(QKeySequence.StandardKey.Paste):
        self.paste_selection()
    elif event.matches(QKeySequence.StandardKey.Undo):
        self.undo_action()
    elif event.matches(QKeySequence.StandardKey.Redo):
        self.redo_action()
    else:
        super().keyPressEvent(event)</code></pre>
</details>
<div class="desc"><p>Handle keyboard shortcuts for copy, paste, undo, and redo.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.load_stylesheet_with_font_size"><code class="name flex">
<span>def <span class="ident">load_stylesheet_with_font_size</span></span>(<span>self, size)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load_stylesheet_with_font_size(self, size):
    &#34;&#34;&#34;
    Memuat stylesheet dan mengganti ukuran font global.
    &#34;&#34;&#34;
    stylesheet_path = os.path.join(self.path, &#39;assets&#39;, &#39;style&#39;, &#39;style.qss&#39;)
    if os.path.exists(stylesheet_path):
        with open(stylesheet_path, &#39;r&#39;) as file:
            stylesheet = file.read()
            # stylesheet = stylesheet.replace(&#34;font-size: 12px;&#34;, f&#34;font-size: {size}px;&#34;)
            stylesheet = stylesheet.replace(&#34;__FONT_SIZE__&#34;, f&#34;{size}px&#34;)
            return stylesheet
    else:
        print(f&#34;Stylesheet tidak ditemukan di {stylesheet_path}&#34;)
        return &#34;&#34;</code></pre>
</details>
<div class="desc"><p>Memuat stylesheet dan mengganti ukuran font global.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.load_temp_data"><code class="name flex">
<span>def <span class="ident">load_temp_data</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load_temp_data(self):
    &#34;&#34;&#34;
    Load data1 and data2 from parquet, and output from JSON, if they exist.
    &#34;&#34;&#34;
    app_path = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
    temp_dir = os.path.join(app_path, &#39;file-data&#39;)
    data1_path = os.path.join(temp_dir, &#39;sae_pisan_data1.parquet&#39;)
    data2_path = os.path.join(temp_dir, &#39;sae_pisan_data2.parquet&#39;)
    output_path = os.path.join(temp_dir, &#39;sae_pisan_output.json&#39;)
    if os.path.exists(data1_path) and os.path.exists(data2_path) and os.path.exists(output_path):
        reply = QMessageBox.question(self, &#39;Load Temporary Data&#39;,
                                     &#39;Temporary data was found. Do you want to load it?&#39;,
                                     QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No,
                                     QMessageBox.StandardButton.No)
        if reply == QMessageBox.StandardButton.Yes:
            self.data1 = pl.read_parquet(data1_path)
            self.data2 = pl.read_parquet(data2_path)
            self.model1.set_data(self.data1)
            self.model2.set_data(self.data2)
            self.update_table(1, self.model1)
            self.update_table(2, self.model2)
            with open(output_path, &#39;r&#39;) as file:
                data = json.load(file)
                self.set_output_data(data.get(&#39;output&#39;, []), timestamp=data.get(&#39;timestamp&#39;))
    else:
        QMessageBox.warning(self, &#39;No Recent Data&#39;, &#39;No recent data file was found.&#39;)</code></pre>
</details>
<div class="desc"><p>Load data1 and data2 from parquet, and output from JSON, if they exist.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_about_dialog"><code class="name flex">
<span>def <span class="ident">open_about_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_about_dialog(self):
    &#34;&#34;&#34;
    Opens the About dialog window.
    This method creates an instance of the AboutDialog class, passing the
    current instance as the parent, and then executes the dialog.
    &#34;&#34;&#34;
    
    about_dialog = AboutDialog(self)
    about_dialog.exec()</code></pre>
</details>
<div class="desc"><p>Opens the About dialog window.
This method creates an instance of the AboutDialog class, passing the
current instance as the parent, and then executes the dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_box_plot_dialog"><code class="name flex">
<span>def <span class="ident">open_box_plot_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_box_plot_dialog(self):
    &#34;&#34;&#34;
    Opens the box plot dialog and sets the models for the dialog.
    This method sets the models for the box plot dialog using `self.model1` and `self.model2`,
    and then displays the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    self.show_box_plot_dialog.set_model(self.model1, self.model2)
    self.show_box_plot_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the box plot dialog and sets the models for the dialog.
This method sets the models for the box plot dialog using <code>self.model1</code> and <code>self.model2</code>,
and then displays the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_box_plot_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_box_plot_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_box_plot_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the box plot dialog.
    This method checks if the &#39;show_box_plot_dialog&#39; attribute exists.
    If it does not, it initializes &#39;show_box_plot_dialog&#39; with an instance
    of BoxPlotDialog. Then, it calls the method to open the box plot dialog.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_box_plot_dialog&#39;):
        self.show_box_plot_dialog = BoxPlotDialog(self)
    self.open_box_plot_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the box plot dialog.
This method checks if the 'show_box_plot_dialog' attribute exists.
If it does not, it initializes 'show_box_plot_dialog' with an instance
of BoxPlotDialog. Then, it calls the method to open the box plot dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_correlation_matrix_dialog"><code class="name flex">
<span>def <span class="ident">open_correlation_matrix_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_correlation_matrix_dialog(self):
    &#34;&#34;&#34;
    Opens the correlation matrix dialog.
    This method sets the model data for the correlation matrix dialog
    and then displays the dialog to the user.
    The models used are `self.model1` and `self.model2`.
    &#34;&#34;&#34;
    
    self.show_correlation_matrix_dialog.set_model(self.model1, self.model2)
    self.show_correlation_matrix_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the correlation matrix dialog.
This method sets the model data for the correlation matrix dialog
and then displays the dialog to the user.
The models used are <code>self.model1</code> and <code>self.model2</code>.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_correlation_matrix_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_correlation_matrix_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_correlation_matrix_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the correlation matrix dialog.
    This method checks if the correlation matrix dialog has already been created.
    If not, it initializes the dialog. Then, it opens the dialog.
    Attributes:
        show_correlation_matrix_dialog (CorrelationMatrixDialog): The correlation matrix dialog instance.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_correlation_matrix_dialog&#39;):
        self.show_correlation_matrix_dialog = CorrelationMatrixDialog(self)
    self.open_correlation_matrix_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the correlation matrix dialog.
This method checks if the correlation matrix dialog has already been created.
If not, it initializes the dialog. Then, it opens the dialog.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>show_correlation_matrix_dialog</code></strong> :&ensp;<code>CorrelationMatrixDialog</code></dt>
<dd>The correlation matrix dialog instance.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_histogram_dialog"><code class="name flex">
<span>def <span class="ident">open_histogram_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_histogram_dialog(self):
    &#34;&#34;&#34;
    Opens the histogram dialog and sets the models for it.
    This method sets the models for the histogram dialog using `self.model1` and `self.model2`,
    and then displays the histogram dialog.
    &#34;&#34;&#34;
    
    self.show_histogram_dialog.set_model(self.model1, self.model2)
    self.show_histogram_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the histogram dialog and sets the models for it.
This method sets the models for the histogram dialog using <code>self.model1</code> and <code>self.model2</code>,
and then displays the histogram dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_histogram_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_histogram_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_histogram_dialog_lazy(self):
    &#34;&#34;&#34;
    Opens the histogram dialog lazily.
    This method checks if the histogram dialog has already been created.
    If not, it initializes the HistogramDialog and assigns it to the 
    &#39;show_histogram_dialog&#39; attribute. Then, it opens the histogram dialog.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_histogram_dialog&#39;):
        self.show_histogram_dialog = HistogramDialog(self)
    self.open_histogram_dialog()</code></pre>
</details>
<div class="desc"><p>Opens the histogram dialog lazily.
This method checks if the histogram dialog has already been created.
If not, it initializes the HistogramDialog and assigns it to the
'show_histogram_dialog' attribute. Then, it opens the histogram dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_line_plot_dialog"><code class="name flex">
<span>def <span class="ident">open_line_plot_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_line_plot_dialog(self):
    &#34;&#34;&#34;
    Opens the line plot dialog and sets the models for the dialog.
    This method sets the models for the line plot dialog using `self.model1` 
    and `self.model2`, and then displays the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    self.show_line_plot_dialog.set_model(self.model1, self.model2)
    self.show_line_plot_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the line plot dialog and sets the models for the dialog.
This method sets the models for the line plot dialog using <code>self.model1</code>
and <code>self.model2</code>, and then displays the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_line_plot_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_line_plot_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_line_plot_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the line plot dialog.
    This method checks if the &#39;show_line_plot_dialog&#39; attribute exists.
    If it does not, it initializes &#39;show_line_plot_dialog&#39; with an instance
    of LinePlotDialog. Then, it calls the method to open the line plot dialog.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_line_plot_dialog&#39;):
        self.show_line_plot_dialog = LinePlotDialog(self)
    self.open_line_plot_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the line plot dialog.
This method checks if the 'show_line_plot_dialog' attribute exists.
If it does not, it initializes 'show_line_plot_dialog' with an instance
of LinePlotDialog. Then, it calls the method to open the line plot dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_multicollinearity_dialog"><code class="name flex">
<span>def <span class="ident">open_multicollinearity_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_multicollinearity_dialog(self):
    &#34;&#34;&#34;
    Opens the multicollinearity dialog and sets the models for it.
    This method sets the models for the multicollinearity dialog using
    `self.model1` and `self.model2`, and then displays the dialog.
    &#34;&#34;&#34;
    
    self.show_multicollinearity_dialog.set_model(self.model1, self.model2)
    self.show_multicollinearity_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the multicollinearity dialog and sets the models for it.
This method sets the models for the multicollinearity dialog using
<code>self.model1</code> and <code>self.model2</code>, and then displays the dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_multicollinearity_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_multicollinearity_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_multicollinearity_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the multicollinearity dialog.
    This method checks if the &#39;show_multicollinearity_dialog&#39; attribute exists.
    If it does not, it initializes it with an instance of MulticollinearityDialog.
    Then, it opens the multicollinearity dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_multicollinearity_dialog&#39;):
        self.show_multicollinearity_dialog = MulticollinearityDialog(self)
    self.open_multicollinearity_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the multicollinearity dialog.
This method checks if the 'show_multicollinearity_dialog' attribute exists.
If it does not, it initializes it with an instance of MulticollinearityDialog.
Then, it opens the multicollinearity dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_normality_test_dialog"><code class="name flex">
<span>def <span class="ident">open_normality_test_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_normality_test_dialog(self):
    &#34;&#34;&#34;
    Opens the normality test dialog.
    This method sets the models for the normality test dialog and then displays the dialog.
    It uses `self.model1` and `self.model2` as the models to be set in the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    self.show_normality_test_dialog.set_model( self.model1, self.model2)
    self.show_normality_test_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the normality test dialog.
This method sets the models for the normality test dialog and then displays the dialog.
It uses <code>self.model1</code> and <code>self.model2</code> as the models to be set in the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_normality_test_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_normality_test_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_normality_test_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the normality test dialog.
    This method checks if the normality test dialog has already been created.
    If not, it initializes the dialog and then opens it. If the dialog has 
    already been created, it simply opens the existing instance.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_normality_test_dialog&#39;):
        self.show_normality_test_dialog = NormalityTestDialog(self)
    self.open_normality_test_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the normality test dialog.
This method checks if the normality test dialog has already been created.
If not, it initializes the dialog and then opens it. If the dialog has
already been created, it simply opens the existing instance.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_scatter_plot_dialog"><code class="name flex">
<span>def <span class="ident">open_scatter_plot_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_scatter_plot_dialog(self):
    &#34;&#34;&#34;
    Opens the scatter plot dialog and sets the models for the dialog.
    This method sets the models for the scatter plot dialog using 
    `self.model1` and `self.model2`, and then displays the dialog.
    &#34;&#34;&#34;
    
    self.show_scatter_plot_dialog.set_model(self.model1, self.model2)
    self.show_scatter_plot_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the scatter plot dialog and sets the models for the dialog.
This method sets the models for the scatter plot dialog using
<code>self.model1</code> and <code>self.model2</code>, and then displays the dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_scatter_plot_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_scatter_plot_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_scatter_plot_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the scatter plot dialog.
    This method checks if the scatter plot dialog has already been created.
    If not, it initializes the dialog and then opens it. This ensures that
    the dialog is only created when needed, potentially saving resources.
    Attributes:
        show_scatter_plot_dialog (ScatterPlotDialog): The scatter plot dialog instance.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_scatter_plot_dialog&#39;):
        self.show_scatter_plot_dialog = ScatterPlotDialog(self)
    self.open_scatter_plot_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the scatter plot dialog.
This method checks if the scatter plot dialog has already been created.
If not, it initializes the dialog and then opens it. This ensures that
the dialog is only created when needed, potentially saving resources.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>show_scatter_plot_dialog</code></strong> :&ensp;<code>ScatterPlotDialog</code></dt>
<dd>The scatter plot dialog instance.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_summary_data_dialog"><code class="name flex">
<span>def <span class="ident">open_summary_data_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_summary_data_dialog(self):
    &#34;&#34;&#34;
    Opens the summary data dialog.
    This method sets the models for the summary data dialog and then displays the dialog.
    It uses `self.model1` and `self.model2` as the models to be set in the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    self.show_summary_data_dialog.set_model(self.model1, self.model2)
    self.show_summary_data_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the summary data dialog.
This method sets the models for the summary data dialog and then displays the dialog.
It uses <code>self.model1</code> and <code>self.model2</code> as the models to be set in the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_summary_data_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_summary_data_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_summary_data_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the summary data dialog.
    This method checks if the &#39;show_summary_data_dialog&#39; attribute exists.
    If it does not exist, it initializes it with an instance of SummaryDataDialog.
    Then, it calls the &#39;open_summary_data_dialog&#39; method to open the dialog.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_summary_data_dialog&#39;):
        self.show_summary_data_dialog = SummaryDataDialog(self)
    self.open_summary_data_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the summary data dialog.
This method checks if the 'show_summary_data_dialog' attribute exists.
If it does not exist, it initializes it with an instance of SummaryDataDialog.
Then, it calls the 'open_summary_data_dialog' method to open the dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_variable_selection_dialog"><code class="name flex">
<span>def <span class="ident">open_variable_selection_dialog</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_variable_selection_dialog(self):
    &#34;&#34;&#34;
    Opens the variable selection dialog.
    This method sets the model for the variable selection dialog using 
    `self.model1` and `self.model2`, and then displays the dialog.
    &#34;&#34;&#34;
    
    self.show_variable_selection_dialog.set_model(self.model1, self.model2)
    self.show_variable_selection_dialog.show()</code></pre>
</details>
<div class="desc"><p>Opens the variable selection dialog.
This method sets the model for the variable selection dialog using
<code>self.model1</code> and <code>self.model2</code>, and then displays the dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.open_variable_selection_dialog_lazy"><code class="name flex">
<span>def <span class="ident">open_variable_selection_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def open_variable_selection_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and opens the variable selection dialog.
    This method checks if the &#39;show_variable_selection_dialog&#39; attribute
    exists. If it does not, it initializes it with an instance of 
    VariableSelectionDialog. Then, it calls the method to open the 
    variable selection dialog.
    &#34;&#34;&#34;
    
    if not hasattr(self, &#39;show_variable_selection_dialog&#39;):
        self.show_variable_selection_dialog = VariableSelectionDialog(self)
    self.open_variable_selection_dialog()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and opens the variable selection dialog.
This method checks if the 'show_variable_selection_dialog' attribute
exists. If it does not, it initializes it with an instance of
VariableSelectionDialog. Then, it calls the method to open the
variable selection dialog.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.paste_selection"><code class="name flex">
<span>def <span class="ident">paste_selection</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def paste_selection(self):
    &#34;&#34;&#34;Paste clipboard content to selected cells.&#34;&#34;&#34;
    clipboard = QApplication.clipboard()
    data = clipboard.text().split(&#39;\n&#39;)
    selection = self.spreadsheet.selectionModel().selectedIndexes()
    if selection:
        start_row = selection[0].row()
        start_col = selection[0].column()
        for i, row in enumerate(data):
            for j, value in enumerate(row.split(&#39;\t&#39;)):
                index = self.model1.index(start_row + i, start_col + j)
                self.model1.setData(index, value, Qt.ItemDataRole.EditRole)</code></pre>
</details>
<div class="desc"><p>Paste clipboard content to selected cells.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.redo_action"><code class="name flex">
<span>def <span class="ident">redo_action</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def redo_action(self):
    &#34;&#34;&#34;Redo the last undone action.&#34;&#34;&#34;
    self.model1.redo()</code></pre>
</details>
<div class="desc"><p>Redo the last undone action.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.remove_output"><code class="name flex">
<span>def <span class="ident">remove_output</span></span>(<span>self, card_frame)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_output(self, card_frame):
    &#34;&#34;&#34;Menghapus output dari layout&#34;&#34;&#34;
    self.output_layout.removeWidget(card_frame)
    card_frame.deleteLater()

    # Hapus spacer jika masih ada widget lain
    if self.output_layout.count() &gt; 0:
        last_item = self.output_layout.itemAt(self.output_layout.count() - 1)
        if isinstance(last_item.spacerItem(), QSpacerItem):
            self.output_layout.removeItem(last_item)

    # Tambahkan stretch hanya jika tidak ada output tersisa
    if self.output_layout.count() == 0:
        self.output_layout.addStretch()</code></pre>
</details>
<div class="desc"><p>Menghapus output dari layout</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.rename_column"><code class="name flex">
<span>def <span class="ident">rename_column</span></span>(<span>self, column_index)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rename_column(self, column_index):
    &#34;&#34;&#34;Rename the column at the given index.&#34;&#34;&#34;
    current_name = self.model1.headerData(column_index, Qt.Orientation.Horizontal, Qt.ItemDataRole.DisplayRole)
    new_name, ok = QInputDialog.getText(self, &#34;Rename Column&#34;, &#34;New column name:&#34;, text=current_name)
    if ok and new_name:
        self.model1.rename_column(column_index, new_name)
        self.update_table(1, self.model1)</code></pre>
</details>
<div class="desc"><p>Rename the column at the given index.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.set_font_size"><code class="name flex">
<span>def <span class="ident">set_font_size</span></span>(<span>self, size)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_font_size(self, size):
    &#34;&#34;&#34;
    Sets the font size for the main window.
    Args:
        size (int): The desired font size to be set.
    This method updates the stylesheet of the main window with the specified font size.
    &#34;&#34;&#34;
    
    stylesheet = self.load_stylesheet_with_font_size(size)
    self.setStyleSheet(stylesheet)</code></pre>
</details>
<div class="desc"><p>Sets the font size for the main window.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>size</code></strong> :&ensp;<code>int</code></dt>
<dd>The desired font size to be set.</dd>
</dl>
<p>This method updates the stylesheet of the main window with the specified font size.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.set_output_data"><code class="name flex">
<span>def <span class="ident">set_output_data</span></span>(<span>parent, output_data, timestamp=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_output_data(parent, output_data, timestamp=None):
    &#34;&#34;&#34;
    Menampilkan kembali output card dari data hasil get_output_data.
    &#34;&#34;&#34;
    for output in output_data:
        r_script = output.get(&#34;r_script&#34;, &#34;&#34;)
        results = output.get(&#34;result&#34;, &#34;&#34;)
        for key, value in results.items():
            if isinstance(value, dict):
                df = pl.DataFrame(value)
                results[key] = df
            else:
                results[key] = value
        if &#34;Plot&#34; in results:
            display_script_and_output(parent, r_script, results, plot_paths=results[&#34;Plot&#34;], timestamps=timestamp)
        else:
            display_script_and_output(parent, r_script, results, plot_paths=None, timestamps=timestamp)</code></pre>
</details>
<div class="desc"><p>Menampilkan kembali output card dari data hasil get_output_data.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.set_path"><code class="name flex">
<span>def <span class="ident">set_path</span></span>(<span>self, path)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_path(self, path):
    &#34;&#34;&#34;
    Sets the path attribute for the MainWindow instance.
    Args:
        path (str): The path to be set.
    &#34;&#34;&#34;
    
    self.path=path</code></pre>
</details>
<div class="desc"><p>Sets the path attribute for the MainWindow instance.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path to be set.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_compute_variable_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_compute_variable_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_compute_variable_dialog_lazy(self):
    &#34;&#34;&#34;
    Displays the Compute Variable dialog lazily.
    This method initializes the Compute Variable dialog if it hasn&#39;t been created yet,
    sets its model to `self.model1`, and then shows the dialog.
    If `self.show_compute_variable_dialog` is already initialized, it simply updates
    the model and shows the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    if self.show_compute_variable_dialog is None:
        self.show_compute_variable_dialog = ComputeVariableDialog(self)
    self.show_compute_variable_dialog.set_model(self.model1)
    self.show_compute_variable_dialog.show()</code></pre>
</details>
<div class="desc"><p>Displays the Compute Variable dialog lazily.
This method initializes the Compute Variable dialog if it hasn't been created yet,
sets its model to <code>self.model1</code>, and then shows the dialog.
If <code>self.show_compute_variable_dialog</code> is already initialized, it simply updates
the model and shows the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_context_menu"><code class="name flex">
<span>def <span class="ident">show_context_menu</span></span>(<span>self, pos, card_frame)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_context_menu(self, pos, card_frame):
    &#34;&#34;&#34;Menampilkan menu klik kanan di setiap output&#34;&#34;&#34;
    menu = QMenu(self)
    delete_action = menu.addAction(&#34;Hapus Output&#34;)
    copy_image_action = menu.addAction(&#34;Copy Output Image&#34;)
    action = menu.exec(card_frame.mapToGlobal(pos))

    if action == delete_action:
        self.remove_output(card_frame)
    elif action == copy_image_action:
        self.copy_output_image(card_frame)</code></pre>
</details>
<div class="desc"><p>Menampilkan menu klik kanan di setiap output</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_header_context_menu"><code class="name flex">
<span>def <span class="ident">show_header_context_menu</span></span>(<span>self, pos)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_header_context_menu(self, pos):
    &#34;&#34;&#34;Show context menu for header.&#34;&#34;&#34;
    header = self.spreadsheet.horizontalHeader()
    logical_index = header.logicalIndexAt(pos)
    menu = QMenu(self)
    rename_action = QAction(&#34;Rename Column&#34;, self)
    rename_action.triggered.connect(lambda: self.rename_column(logical_index))
    menu.addAction(rename_action)
    
    edit_type_action = QAction(&#34;Edit Data Type&#34;, self)
    edit_type_action.triggered.connect(lambda: self.edit_data_type(logical_index))
    menu.addAction(edit_type_action)
    
    selection = self.spreadsheet.selectionModel().selectedIndexes()
    has_selection = bool(selection)
    
    delete_column_action = QAction(&#34;Delete Column&#34;, self)
    delete_column_action.triggered.connect(lambda : confirm_delete_selected_columns(self))
    delete_column_action.setEnabled(has_selection)
    menu.addAction(delete_column_action)
    
    add_column_before_action = QAction(&#34;Add Column Before&#34;, self)
    add_column_before_action.triggered.connect(lambda: show_add_column_before_dialog(self))
    add_column_before_action.setEnabled(has_selection)
    menu.addAction(add_column_before_action)
    
    add_column_after_action = QAction(&#34;Add Column After&#34;, self)
    add_column_after_action.triggered.connect(lambda: show_add_column_after_dialog(self))
    add_column_after_action.setEnabled(has_selection)
    menu.addAction(add_column_after_action)
    
    menu.exec(header.mapToGlobal(pos))</code></pre>
</details>
<div class="desc"><p>Show context menu for header.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_header_icon_info"><code class="name flex">
<span>def <span class="ident">show_header_icon_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_header_icon_info(self):
    &#34;&#34;&#34;
    Show a dialog explaining the meaning of header icons in the data table.
    &#34;&#34;&#34;
    msg = (
        &#34;&lt;b&gt;Header Icon Legend:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&#34;
        &#34;&lt;div style=&#39;display:flex; flex-direction:column; gap:8px;&#39;&gt;&#34;
        &#34;&lt;div&gt;&lt;img src=&#39;assets/nominal.svg&#39; width=&#39;24&#39; height=&#39;24&#39; style=&#39;vertical-align:middle;&#39;&gt; &lt;b&gt;Nominal/String&lt;/b&gt;&lt;/div&gt;&#34;
        &#34;&lt;div&gt;&lt;img src=&#39;assets/null.svg&#39; width=&#39;24&#39; height=&#39;24&#39; style=&#39;vertical-align:middle;&#39;&gt; &lt;b&gt;Null/Empty&lt;/b&gt;&lt;/div&gt;&#34;
        &#34;&lt;div&gt;&lt;img src=&#39;assets/numeric.svg&#39; width=&#39;24&#39; height=&#39;24&#39; style=&#39;vertical-align:middle;&#39;&gt; &lt;b&gt;Numeric&lt;/b&gt;&lt;/div&gt;&#34;
        &#34;&lt;/div&gt;&lt;br&gt;&#34;
        &#34;&lt;div style=&#39;max-width:350px;&#39;&gt;&#34;
        &#34;These icons indicate the data type of each column in the table. &#34;
        &#34;Nominal/String columns are represented by the nominal icon, &#34;
        &#34;Null/Empty columns are represented by the null icon, and &#34;
        &#34;Numeric columns are represented by the numeric icon.&#34;
        &#34;&lt;/div&gt;&#34;
    )
    QMessageBox.information(self, &#34;Header Icon Info&#34;, msg)</code></pre>
</details>
<div class="desc"><p>Show a dialog explaining the meaning of header icons in the data table.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_modeling_saeHB_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_modeling_saeHB_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_modeling_saeHB_dialog_lazy(self):
    &#34;&#34;&#34;
    Displays the ModelingSaeHBDialog lazily.
    This method initializes the ModelingSaeHBDialog if it has not been created yet,
    sets its model to `self.model1`, and then shows the dialog.
    Attributes:
        show_modeling_saeHB_dialog (ModelingSaeHBDialog): The dialog instance to be shown.
        model1: The model to be set in the dialog.
    &#34;&#34;&#34;
    
    if self.show_modeling_saeHB_dialog is None:
        self.show_modeling_saeHB_dialog = ModelingSaeHBDialog(self)
    self.show_modeling_saeHB_dialog.set_model(self.model1)
    self.show_modeling_saeHB_dialog.show()</code></pre>
</details>
<div class="desc"><p>Displays the ModelingSaeHBDialog lazily.
This method initializes the ModelingSaeHBDialog if it has not been created yet,
sets its model to <code>self.model1</code>, and then shows the dialog.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>show_modeling_saeHB_dialog</code></strong> :&ensp;<code>ModelingSaeHBDialog</code></dt>
<dd>The dialog instance to be shown.</dd>
<dt><strong><code>model1</code></strong></dt>
<dd>The model to be set in the dialog.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_modeling_saeHB_normal_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_modeling_saeHB_normal_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_modeling_saeHB_normal_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and displays the ModelingSaeHBNormalDialog.
    If the dialog has not been created yet, it initializes a new instance
    of ModelingSaeHBNormalDialog and sets its model to self.model1. 
    Then, it shows the dialog.
    Attributes:
        show_modeling_saeHB_normal_dialog (ModelingSaeHBNormalDialog): 
        The dialog instance to be displayed.
        model1: The model to be set in the dialog.
    &#34;&#34;&#34;
    
    if self.show_modeling_saeHB_normal_dialog is None:
        self.show_modeling_saeHB_normal_dialog = ModelingSaeHBNormalDialog(self)
    self.show_modeling_saeHB_normal_dialog.set_model(self.model1)
    self.show_modeling_saeHB_normal_dialog.show()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and displays the ModelingSaeHBNormalDialog.
If the dialog has not been created yet, it initializes a new instance
of ModelingSaeHBNormalDialog and sets its model to self.model1.
Then, it shows the dialog.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>show_modeling_saeHB_normal_dialog</code></strong> :&ensp;<code>ModelingSaeHBNormalDialog</code></dt>
<dd>&nbsp;</dd>
<dt>The dialog instance to be displayed.</dt>
<dt><strong><code>model1</code></strong></dt>
<dd>The model to be set in the dialog.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_modeling_sae_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_modeling_sae_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_modeling_sae_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and displays the ModelingSaeDialog.
    If the ModelingSaeDialog has not been created yet, this method will
    instantiate it and set its model to `self.model1`. Then, it will
    display the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    if self.show_modeling_sae_dialog is None:
        self.show_modeling_sae_dialog = ModelingSaeDialog(self)
    self.show_modeling_sae_dialog.set_model(self.model1)
    self.show_modeling_sae_dialog.show()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and displays the ModelingSaeDialog.
If the ModelingSaeDialog has not been created yet, this method will
instantiate it and set its model to <code>self.model1</code>. Then, it will
display the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_modeling_sae_unit_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_modeling_sae_unit_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_modeling_sae_unit_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and displays the ModelingSaeUnitDialog.
    If the dialog has not been created yet, it initializes it with the current instance.
    Then, it sets the model for the dialog and shows it.
    Attributes:
        show_modeling_sae_unit_dialog (ModelingSaeUnitDialog): The dialog for modeling SAE units.
        model1: The model to be set in the dialog.
    &#34;&#34;&#34;
    
    if self.show_modeling_sae_unit_dialog is None:
        self.show_modeling_sae_unit_dialog = ModelingSaeUnitDialog(self)
    self.show_modeling_sae_unit_dialog.set_model(self.model1)
    self.show_modeling_sae_unit_dialog.show()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and displays the ModelingSaeUnitDialog.
If the dialog has not been created yet, it initializes it with the current instance.
Then, it sets the model for the dialog and shows it.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>show_modeling_sae_unit_dialog</code></strong> :&ensp;<code>ModelingSaeUnitDialog</code></dt>
<dd>The dialog for modeling SAE units.</dd>
<dt><strong><code>model1</code></strong></dt>
<dd>The model to be set in the dialog.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_modellig_sae_pseudo_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_modellig_sae_pseudo_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_modellig_sae_pseudo_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and displays the Modeling SAE Pseudo dialog.
    This method checks if the `show_modellig_sae_pseudo_dialog` attribute is None.
    If it is, it initializes a new instance of `ModelingSaePseudoDialog` with the current
    instance (`self`) as the parent. It then sets the model for the dialog using `self.model1`
    and displays the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    if self.show_modellig_sae_pseudo_dialog is None:
        self.show_modellig_sae_pseudo_dialog = ModelingSaePseudoDialog(self)
    self.show_modellig_sae_pseudo_dialog.set_model(self.model1)
    self.show_modellig_sae_pseudo_dialog.show()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and displays the Modeling SAE Pseudo dialog.
This method checks if the <code>show_modellig_sae_pseudo_dialog</code> attribute is None.
If it is, it initializes a new instance of <code>ModelingSaePseudoDialog</code> with the current
instance (<code>self</code>) as the parent. It then sets the model for the dialog using <code>self.model1</code>
and displays the dialog.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_output"><code class="name flex">
<span>def <span class="ident">show_output</span></span>(<span>self, title, content)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_output(self, title, content):
    &#34;&#34;&#34;Display output in the Output tab&#34;&#34;&#34;
    label = QLabel(content)
    self.output_layout.addWidget(label)
    self.output_tab_widget.setCurrentIndex(0)</code></pre>
</details>
<div class="desc"><p>Display output in the Output tab</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_projection_variabel_dialog_lazy"><code class="name flex">
<span>def <span class="ident">show_projection_variabel_dialog_lazy</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_projection_variabel_dialog_lazy(self):
    &#34;&#34;&#34;
    Lazily initializes and displays the ProjectionDialog.
    This method checks if the `show_projection_variabel_dialog` attribute is None.
    If it is, it initializes it with a new instance of `ProjectionDialog`.
    It then sets the model for the dialog and checks if the prerequisites for
    showing the dialog are met. If they are, it displays the dialog.
    Attributes:
        show_projection_variabel_dialog (ProjectionDialog): The dialog to be shown.
        model1: The model to be set in the dialog.
    Returns:
        None
    &#34;&#34;&#34;
    
    if self.show_projection_variabel_dialog is None:
        self.show_projection_variabel_dialog = ProjectionDialog(self)
    self.show_projection_variabel_dialog.set_model(self.model1)
    if self.show_projection_variabel_dialog.show_prerequisites():
        self.show_projection_variabel_dialog.show()</code></pre>
</details>
<div class="desc"><p>Lazily initializes and displays the ProjectionDialog.
This method checks if the <code>show_projection_variabel_dialog</code> attribute is None.
If it is, it initializes it with a new instance of <code>ProjectionDialog</code>.
It then sets the model for the dialog and checks if the prerequisites for
showing the dialog are met. If they are, it displays the dialog.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>show_projection_variabel_dialog</code></strong> :&ensp;<code>ProjectionDialog</code></dt>
<dd>The dialog to be shown.</dd>
<dt><strong><code>model1</code></strong></dt>
<dd>The model to be set in the dialog.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_r_packages_info"><code class="name flex">
<span>def <span class="ident">show_r_packages_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_r_packages_info(self):
    &#34;&#34;&#34;
    Show a dialog listing the R packages used and their versions in a single table with 6 columns (3 pairs of Package/Version side by side).
    &#34;&#34;&#34;
    try:
        import rpy2.robjects as ro
        packages = [
            &#34;sae&#34;, &#34;arrow&#34;, &#34;sae.projection&#34;, &#34;emdi&#34;, &#34;xgboost&#34;, &#34;LiblineaR&#34;,
            &#34;kernlab&#34;, &#34;GGally&#34;, &#34;ggplot2&#34;, &#34;ggcorrplot&#34;, &#34;car&#34;, &#34;nortest&#34;,
            &#34;tidyr&#34;, &#34;carData&#34;, &#34;dplyr&#34;, &#34;tseries&#34;, &#34;FSelector&#34;, &#34;rjags&#34;, &#34;saeHB&#34;
        ]
        versions = []
        for pkg in packages:
            try:
                ver = ro.r(f&#34;as.character(packageVersion(&#39;{pkg}&#39;))&#34;)[0]
            except Exception:
                ver = &#34;Not Installed&#34;
            versions.append((pkg, ver))

        # Arrange into 3 columns (each column is Package/Version pair)
        n_cols = 3
        n_rows = (len(versions) + n_cols - 1) // n_cols
        table_cells = []
        for i in range(n_rows):
            row = []
            for j in range(n_cols):
                idx = i + j * n_rows
                if idx &lt; len(versions):
                    row.extend(versions[idx])
                else:
                    row.extend((&#34;&#34;, &#34;&#34;))
            table_cells.append(row)

        msg = &#34;&lt;b&gt;R Packages Used:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&#34;
        msg += &#34;&lt;table style=&#39;border-collapse:collapse;font-size:13px;&#39;&gt;&#34;
        # Header
        msg += &#34;&lt;tr style=&#39;background-color:#f2f2f2;&#39;&gt;&#34;
        for i in range(n_cols):
            msg += &#34;&lt;th style=&#39;border:1px solid #bbb; padding:6px 16px;&#39;&gt;Package&lt;/th&gt;&#34;
            msg += &#34;&lt;th style=&#39;border:1px solid #bbb; padding:6px 16px;&#39;&gt;Version&lt;/th&gt;&#34;
        msg += &#34;&lt;/tr&gt;&#34;
        # Rows
        for row in table_cells:
            msg += &#34;&lt;tr&gt;&#34;
            for cell in row:
                msg += f&#34;&lt;td style=&#39;border:1px solid #bbb; padding:6px 16px;&#39;&gt;{cell}&lt;/td&gt;&#34;
            msg += &#34;&lt;/tr&gt;&#34;
        msg += &#34;&lt;/table&gt;&#34;
    except Exception as e:
        msg = f&#34;Could not retrieve R package versions.&lt;br&gt;Error: {e}&#34;
    QMessageBox.information(self, &#34;R Packages Used&#34;, msg)</code></pre>
</details>
<div class="desc"><p>Show a dialog listing the R packages used and their versions in a single table with 6 columns (3 pairs of Package/Version side by side).</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.show_toast"><code class="name flex">
<span>def <span class="ident">show_toast</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_toast(self):
    toast = CustomToast(
        parent=self,
        title=&#34;Saved&#34;,
        text=&#34;Data, Data Output, and Output was saved&#34;,
        duration=3000,
        position=&#34;top-right&#34;
    )
    toast.set_border_radius(8)
    toast.show()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.undo_action"><code class="name flex">
<span>def <span class="ident">undo_action</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def undo_action(self):
    &#34;&#34;&#34;Undo the last action.&#34;&#34;&#34;
    self.model1.undo()</code></pre>
</details>
<div class="desc"><p>Undo the last action.</p></div>
</dd>
<dt id="saePisan.view.MainWindow.MainWindow.update_table"><code class="name flex">
<span>def <span class="ident">update_table</span></span>(<span>self, sheet_number, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_table(self, sheet_number, model):
    &#34;&#34;&#34;Memperbarui tabel pada sheet tertentu dengan model baru&#34;&#34;&#34;
    if sheet_number == 1:
        self.spreadsheet.setModel(model)
        self.model1 = model
        self.spreadsheet.resizeColumnsToContents()
        self.tab_widget.setCurrentWidget(self.tab1)
        if self.show_modeling_sae_dialog:
            self.show_modeling_sae_dialog.set_model(model)
        if self.show_modeling_saeHB_dialog:
            self.show_modeling_saeHB_dialog.set_model(model)
        if self.show_modeling_sae_unit_dialog:
            self.show_modeling_sae_unit_dialog.set_model(model)
        if self.show_modeling_saeHB_normal_dialog:
            self.show_modeling_saeHB_normal_dialog.set_model(model)
        if self.show_modellig_sae_pseudo_dialog:
            self.show_modellig_sae_pseudo_dialog.set_model(model)
        if self.show_compute_variable_dialog:
            self.show_compute_variable_dialog.set_model(model)
        if self.show_projection_variabel_dialog:
            self.show_projection_variabel_dialog.set_model(model)
    elif sheet_number == 2:
        self.table_view2.setModel(model)
        self.model2 = model
        self.table_view2.resizeColumnsToContents()</code></pre>
</details>
<div class="desc"><p>Memperbarui tabel pada sheet tertentu dengan model baru</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view" href="index.html">saePisan.view</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.MainWindow.MainWindow" href="#saePisan.view.MainWindow.MainWindow">MainWindow</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.MainWindow.MainWindow.add_column" href="#saePisan.view.MainWindow.MainWindow.add_column">add_column</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.add_output" href="#saePisan.view.MainWindow.MainWindow.add_output">add_output</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.add_row" href="#saePisan.view.MainWindow.MainWindow.add_row">add_row</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.autosave_data" href="#saePisan.view.MainWindow.MainWindow.autosave_data">autosave_data</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.change_font_size" href="#saePisan.view.MainWindow.MainWindow.change_font_size">change_font_size</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.closeEvent" href="#saePisan.view.MainWindow.MainWindow.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.copy_output_image" href="#saePisan.view.MainWindow.MainWindow.copy_output_image">copy_output_image</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.copy_selection" href="#saePisan.view.MainWindow.MainWindow.copy_selection">copy_selection</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.edit_data_type" href="#saePisan.view.MainWindow.MainWindow.edit_data_type">edit_data_type</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.group_by_row" href="#saePisan.view.MainWindow.MainWindow.group_by_row">group_by_row</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.init_ui" href="#saePisan.view.MainWindow.MainWindow.init_ui">init_ui</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.keyPressEvent" href="#saePisan.view.MainWindow.MainWindow.keyPressEvent">keyPressEvent</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.load_stylesheet_with_font_size" href="#saePisan.view.MainWindow.MainWindow.load_stylesheet_with_font_size">load_stylesheet_with_font_size</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.load_temp_data" href="#saePisan.view.MainWindow.MainWindow.load_temp_data">load_temp_data</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_about_dialog" href="#saePisan.view.MainWindow.MainWindow.open_about_dialog">open_about_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_box_plot_dialog" href="#saePisan.view.MainWindow.MainWindow.open_box_plot_dialog">open_box_plot_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_box_plot_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_box_plot_dialog_lazy">open_box_plot_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_correlation_matrix_dialog" href="#saePisan.view.MainWindow.MainWindow.open_correlation_matrix_dialog">open_correlation_matrix_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_correlation_matrix_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_correlation_matrix_dialog_lazy">open_correlation_matrix_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_histogram_dialog" href="#saePisan.view.MainWindow.MainWindow.open_histogram_dialog">open_histogram_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_histogram_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_histogram_dialog_lazy">open_histogram_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_line_plot_dialog" href="#saePisan.view.MainWindow.MainWindow.open_line_plot_dialog">open_line_plot_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_line_plot_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_line_plot_dialog_lazy">open_line_plot_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_multicollinearity_dialog" href="#saePisan.view.MainWindow.MainWindow.open_multicollinearity_dialog">open_multicollinearity_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_multicollinearity_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_multicollinearity_dialog_lazy">open_multicollinearity_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_normality_test_dialog" href="#saePisan.view.MainWindow.MainWindow.open_normality_test_dialog">open_normality_test_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_normality_test_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_normality_test_dialog_lazy">open_normality_test_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_scatter_plot_dialog" href="#saePisan.view.MainWindow.MainWindow.open_scatter_plot_dialog">open_scatter_plot_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_scatter_plot_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_scatter_plot_dialog_lazy">open_scatter_plot_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_summary_data_dialog" href="#saePisan.view.MainWindow.MainWindow.open_summary_data_dialog">open_summary_data_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_summary_data_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_summary_data_dialog_lazy">open_summary_data_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_variable_selection_dialog" href="#saePisan.view.MainWindow.MainWindow.open_variable_selection_dialog">open_variable_selection_dialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.open_variable_selection_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.open_variable_selection_dialog_lazy">open_variable_selection_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.paste_selection" href="#saePisan.view.MainWindow.MainWindow.paste_selection">paste_selection</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.redo_action" href="#saePisan.view.MainWindow.MainWindow.redo_action">redo_action</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.remove_output" href="#saePisan.view.MainWindow.MainWindow.remove_output">remove_output</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.rename_column" href="#saePisan.view.MainWindow.MainWindow.rename_column">rename_column</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.set_font_size" href="#saePisan.view.MainWindow.MainWindow.set_font_size">set_font_size</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.set_output_data" href="#saePisan.view.MainWindow.MainWindow.set_output_data">set_output_data</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.set_path" href="#saePisan.view.MainWindow.MainWindow.set_path">set_path</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_compute_variable_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_compute_variable_dialog_lazy">show_compute_variable_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_context_menu" href="#saePisan.view.MainWindow.MainWindow.show_context_menu">show_context_menu</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_header_context_menu" href="#saePisan.view.MainWindow.MainWindow.show_header_context_menu">show_header_context_menu</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_header_icon_info" href="#saePisan.view.MainWindow.MainWindow.show_header_icon_info">show_header_icon_info</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_modeling_saeHB_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_modeling_saeHB_dialog_lazy">show_modeling_saeHB_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_modeling_saeHB_normal_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_modeling_saeHB_normal_dialog_lazy">show_modeling_saeHB_normal_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_modeling_sae_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_modeling_sae_dialog_lazy">show_modeling_sae_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_modeling_sae_unit_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_modeling_sae_unit_dialog_lazy">show_modeling_sae_unit_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_modellig_sae_pseudo_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_modellig_sae_pseudo_dialog_lazy">show_modellig_sae_pseudo_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_output" href="#saePisan.view.MainWindow.MainWindow.show_output">show_output</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_projection_variabel_dialog_lazy" href="#saePisan.view.MainWindow.MainWindow.show_projection_variabel_dialog_lazy">show_projection_variabel_dialog_lazy</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_r_packages_info" href="#saePisan.view.MainWindow.MainWindow.show_r_packages_info">show_r_packages_info</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.show_toast" href="#saePisan.view.MainWindow.MainWindow.show_toast">show_toast</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.undo_action" href="#saePisan.view.MainWindow.MainWindow.undo_action">undo_action</a></code></li>
<li><code><a title="saePisan.view.MainWindow.MainWindow.update_table" href="#saePisan.view.MainWindow.MainWindow.update_table">update_table</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_3">
                <div class="file-header">
                    <div>ğŸ“„ AboutDialog</div>
                    <div class="file-path">view/components/AboutDialog.html (12.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.AboutDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.AboutDialog.AboutDialog"><code class="flex name class">
<span>class <span class="ident">AboutDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class AboutDialog(QDialog):
    &#34;&#34;&#34;AboutDialog is a custom QDialog that provides information about the SAE Pisan application.
    Attributes:
        parent (QWidget): The parent widget of the dialog.
    Methods:
        __init__(parent):
            Initializes the AboutDialog with the given parent widget.&#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.setWindowTitle(&#34;About SAE Pisan&#34;)
        self.setFixedSize(500, 400)
        self.setStyleSheet(&#34;background-color: white; font-family: Arial; font-size: 12px;&#34;)
        
        layout = QVBoxLayout()
        
        # Logo
        logo_label = QLabel(self)
        pixmap = QPixmap(&#34;assets/icon.svg&#34;)
        logo_label.setPixmap(pixmap.scaled(80, 80, QtCore.Qt.AspectRatioMode.KeepAspectRatio))
        logo_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        layout.addWidget(logo_label)
        
        # SAE Pisan Title
        title_label = QLabel(&#34;SAE Pisan&#34;)
        title_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        title_label.setStyleSheet(&#34;font-size: 20px; font-weight: bold; color: black;&#34;)
        layout.addWidget(title_label)

        # Information and Description Frame
        info_frame = QFrame()
        info_frame.setFrameShape(QFrame.Shape.Box)
        info_frame.setFrameShadow(QFrame.Shadow.Sunken)
        info_layout = QVBoxLayout()
        
        
        version_label = QLabel(&#34;&lt;b&gt;Version:&lt;/b&gt; SAE Pisan 1.0.0&#34;)
        version_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(version_label)
        
        built_label = QLabel(&#34;&lt;b&gt;Built on:&lt;/b&gt; 2024 (Indonesian)&#34;)
        built_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(built_label)
        
        download_label = QLabel(&#34;&lt;b&gt;Download:&lt;/b&gt; &lt;a href=&#39;https://sae-pisan-web.vercel.app/downloads&#39;&gt;Click here&lt;/a&gt;&#34;)
        download_label.setOpenExternalLinks(True)
        download_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(download_label)
        
        desc_label = QLabel(
            &#34;&#34;&#34;SAE Pisan (Small Area Estimation Programming for Statistical Analysis) is a GUI-based desktop application designed to perform small area estimation (SAE) using statistical methods based on R.
            &#34;&#34;&#34;
        )
        desc_label.setWordWrap(True)
        desc_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(desc_label)
        
        institution_label = QLabel(&#34;&#34;&#34;&lt;b&gt;Sae Pisan is suported by Politeknik Statistika STIS&lt;/b&gt;&#34;&#34;&#34;)
        institution_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(institution_label)
        
        support_label = QLabel(
            &#34;&#34;&#34;&lt;b&gt;Support:&lt;/b&gt; For more information, please contact &lt;a href=&#39;mailto: &#39;&gt;&lt;/a&gt;&#34;&#34;&#34;)
        support_label.setOpenExternalLinks(True)
        support_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(support_label)
        
        copyright_label = QLabel(
            &#34;&#34;&#34;&lt;b&gt;Â© 2024 SAE Pisan. All rights reserved.&lt;/b&gt;
            &#34;&#34;&#34;
        )
        copyright_label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        info_layout.addWidget(copyright_label)

        info_frame.setLayout(info_layout)
        layout.addWidget(info_frame)

        # OK Button
        button_layout = QHBoxLayout()
        ok_button = QPushButton(&#34;OK&#34;)
        ok_button.setStyleSheet(&#34;padding: 8px; background-color: #005a9e; color: white; border-radius: 5px; min-width: 100px;&#34;)
        ok_button.clicked.connect(self.accept)
        button_layout.addStretch()
        button_layout.addWidget(ok_button)
        button_layout.addStretch()
        layout.addLayout(button_layout)
        
        self.setLayout(layout)</code></pre>
</details>
<div class="desc"><p>AboutDialog is a custom QDialog that provides information about the SAE Pisan application.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget of the dialog.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(parent):
Initializes the AboutDialog with the given parent widget.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.AboutDialog.AboutDialog" href="#saePisan.view.components.AboutDialog.AboutDialog">AboutDialog</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_4">
                <div class="file-header">
                    <div>ğŸ“„ ComputeVariableDialog</div>
                    <div class="file-path">view/components/ComputeVariableDialog.html (28.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ComputeVariableDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog"><code class="flex name class">
<span>class <span class="ident">ComputeVariableDialog</span></span>
<span>(</span><span>parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ComputeVariableDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for computing new variables based on user-defined templates and R scripts.
    Attributes:
        parent (QWidget): The parent widget.
        model (QAbstractTableModel): The data model from the parent.
        column_names (list): List of column names from the model.
        templates (dict): Dictionary of templates loaded from a file.
    Methods:
        __init__(parent=None):
            Initializes the dialog with the given parent.
        load_templates():
            Loads templates from a file and returns them as a dictionary.
        save_template():
            Saves the current script as a new template.
        init_ui():
            Initializes the user interface components of the dialog.
        update_script_input(index):
            Updates the script input field based on the selected template and variables.
        set_model(model):
            Sets the data model and updates the column names.
        get_script():
            Returns the current script from the script input field.
        accept():
            Validates the input, computes the new variable, and updates the model.
    &#34;&#34;&#34;
    
    def __init__(self, parent=None):
        super().__init__(parent)
        self.parent = parent
        self.model = parent.model1
        self.column_names = self.model.get_data().columns
        self.templates = self.load_templates()

        self.setWindowTitle(&#34;Compute New Variable&#34;)
        self.init_ui()

    def load_templates(self):
        app_data_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
        os.makedirs(app_data_dir, exist_ok=True)
        templates = {}
        template_file = os.path.join(self.parent.path, &#39;file-data&#39;, &#39;template.dat&#39;)
        appdata_template_file = os.path.join(app_data_dir, &#39;template.dat&#39;)
        
        if not os.path.exists(appdata_template_file):
            # Copy template.dat to appdata_template_file if it doesn&#39;t exist
            shutil.copyfile(template_file, appdata_template_file)
            template_file = appdata_template_file
            
        with open(template_file, &#39;r&#39;) as file:
            lines = file.readlines()
            for line in lines:
                name, script = line.strip().split(&#39;=&#39;, 1)
                templates[name] = script
        return templates

    def save_template(self):
        self.save_template_button.setText(&#34;Saving...&#34;)
        self.save_template_button.setEnabled(False)
        template_name, ok = QInputDialog.getText(self, &#34;Save Template&#34;, &#34;Enter template name:&#34;)
        if ok and template_name:
            script = self.get_script()
            self.templates[template_name] = script
            template_file = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;, &#39;template.dat&#39;)
            with open(template_file, &#39;a&#39;) as file:
                file.write(f&#34;{template_name}={script}\n&#34;)
            self.template_selection.addItem(template_name)
            QMessageBox.information(self, &#34;Success&#34;, &#34;Template saved successfully!&#34;)

    def init_ui(self):
        self.layout = QVBoxLayout()

        self.column_label = QLabel(&#34;Enter new column name:&#34;)
        self.layout.addWidget(self.column_label)
        self.column_name_input = QLineEdit()
        self.column_name_input.setPlaceholderText(&#34;Enter column name here&#34;)
        self.layout.addWidget(self.column_name_input)

        self.template_label = QLabel(&#34;Select template:&#34;)
        self.layout.addWidget(self.template_label)
        self.template_selection = QComboBox()
        self.template_selection.addItems(self.templates.keys())
        self.template_selection.setCurrentIndex(0)
        self.layout.addWidget(self.template_selection)

        self.variable1_label = QLabel(&#34;Select Nominator:&#34;)
        self.variable1_label.setVisible(False)
        self.layout.addWidget(self.variable1_label)
        self.variable1_selection = QComboBox()
        self.variable1_selection.addItems(self.column_names)
        self.variable1_selection.setVisible(False)
        self.layout.addWidget(self.variable1_selection)

        self.variable2_label = QLabel(&#34;Select Denominator:&#34;)
        self.variable2_label.setVisible(False)
        self.layout.addWidget(self.variable2_label)
        self.variable2_selection = QComboBox()
        self.variable2_selection.addItems(self.column_names)
        self.variable2_selection.setVisible(False)
        self.layout.addWidget(self.variable2_selection)

        self.script_label = QLabel(&#34;R Script:&#34;)

        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)
        self.icon_label.setVisible(False)

        # Create a horizontal layout to place the script_label and icon_label in one row
        script_layout = QHBoxLayout()
        script_layout.addWidget(self.script_label)
        script_layout.addWidget(self.icon_label)

        self.layout.addLayout(script_layout)
        self.script_input = QTextEdit()
        self.script_input.setPlaceholderText(&#34;Write r script here...&#34;)
        self.layout.addWidget(self.script_input)

        # Tombol OK dan Cancel
        self.button_layout = QHBoxLayout()
        self.ok_button = QPushButton(&#34;OK&#34;)
        self.ok_button.clicked.connect(self.accept)
        self.button_layout.addWidget(self.ok_button)
        self.save_template_button = QPushButton(&#34;Save Template&#34;)
        self.save_template_button.clicked.connect(self.save_template)
        self.button_layout.addWidget(self.save_template_button)

        self.layout.addLayout(self.button_layout)
        self.setLayout(self.layout)

        # Event handler untuk perubahan template
        self.template_selection.currentIndexChanged.connect(self.update_script_input)
        self.variable1_selection.currentIndexChanged.connect(self.update_script_input)
        self.variable2_selection.currentIndexChanged.connect(self.update_script_input)

        # Initialize script input with the first template
        self.update_script_input(0)

    def update_script_input(self, index):
        template_name = self.template_selection.currentText()
        script = self.templates.get(template_name, &#34;&#34;)
        if template_name == &#34;Compute RSE&#34;:
            self.variable1_label.setVisible(True)
            self.variable1_selection.setVisible(True)
            self.variable2_label.setVisible(True)
            self.variable2_selection.setVisible(True)
            variable1 = self.variable1_selection.currentText()
            variable2 = self.variable2_selection.currentText()
            script = script.replace(&#34;{variable1}&#34;, variable1).replace(&#34;{variable2}&#34;, variable2)
        else:
            self.variable1_label.setVisible(False)
            self.variable1_selection.setVisible(False)
            self.variable2_label.setVisible(False)
            self.variable2_selection.setVisible(False)
        self.script_input.setPlainText(script)

    def set_model(self, model):
        self.model = model
        self.column_names = [col.replace(&#34; &#34;, &#34;_&#34;) for col in self.model.get_data().columns]
        self.variable1_selection.clear()
        self.variable1_selection.addItems(self.column_names)
        self.variable2_selection.clear()
        self.variable2_selection.addItems(self.column_names)

    def get_script(self):
        return self.script_input.toPlainText()

    def accept(self):
        if self.column_name_input.text() == &#34;&#34;:
            QMessageBox.warning(self, &#34;Error&#34;, &#34;Column name cannot be empty!&#34;)
            return
        self.ok_button.setText(&#34;Computing...&#34;)
        self.ok_button.setEnabled(False)
        self.icon_label.setVisible(True)
        df = self.model.get_data()
        new_column_series = run_compute(self)
        self.model.set_data(df.with_columns(new_column_series))
        self.parent.update_table(1, self.model)
        self.icon_label.setVisible(False)
        self.ok_button.setText(&#34;OK&#34;)
        self.ok_button.setEnabled(True)
        super().accept()</code></pre>
</details>
<div class="desc"><p>A dialog for computing new variables based on user-defined templates and R scripts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model</code></strong> :&ensp;<code>QAbstractTableModel</code></dt>
<dd>The data model from the parent.</dd>
<dt><strong><code>column_names</code></strong> :&ensp;<code>list</code></dt>
<dd>List of column names from the model.</dd>
<dt><strong><code>templates</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary of templates loaded from a file.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(parent=None):
Initializes the dialog with the given parent.
load_templates():
Loads templates from a file and returns them as a dictionary.
save_template():
Saves the current script as a new template.
init_ui():
Initializes the user interface components of the dialog.
update_script_input(index):
Updates the script input field based on the selected template and variables.
set_model(model):
Sets the data model and updates the column names.
get_script():
Returns the current script from the script input field.
accept():
Validates the input, computes the new variable, and updates the model.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    if self.column_name_input.text() == &#34;&#34;:
        QMessageBox.warning(self, &#34;Error&#34;, &#34;Column name cannot be empty!&#34;)
        return
    self.ok_button.setText(&#34;Computing...&#34;)
    self.ok_button.setEnabled(False)
    self.icon_label.setVisible(True)
    df = self.model.get_data()
    new_column_series = run_compute(self)
    self.model.set_data(df.with_columns(new_column_series))
    self.parent.update_table(1, self.model)
    self.icon_label.setVisible(False)
    self.ok_button.setText(&#34;OK&#34;)
    self.ok_button.setEnabled(True)
    super().accept()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.get_script"><code class="name flex">
<span>def <span class="ident">get_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_script(self):
    return self.script_input.toPlainText()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.init_ui"><code class="name flex">
<span>def <span class="ident">init_ui</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_ui(self):
    self.layout = QVBoxLayout()

    self.column_label = QLabel(&#34;Enter new column name:&#34;)
    self.layout.addWidget(self.column_label)
    self.column_name_input = QLineEdit()
    self.column_name_input.setPlaceholderText(&#34;Enter column name here&#34;)
    self.layout.addWidget(self.column_name_input)

    self.template_label = QLabel(&#34;Select template:&#34;)
    self.layout.addWidget(self.template_label)
    self.template_selection = QComboBox()
    self.template_selection.addItems(self.templates.keys())
    self.template_selection.setCurrentIndex(0)
    self.layout.addWidget(self.template_selection)

    self.variable1_label = QLabel(&#34;Select Nominator:&#34;)
    self.variable1_label.setVisible(False)
    self.layout.addWidget(self.variable1_label)
    self.variable1_selection = QComboBox()
    self.variable1_selection.addItems(self.column_names)
    self.variable1_selection.setVisible(False)
    self.layout.addWidget(self.variable1_selection)

    self.variable2_label = QLabel(&#34;Select Denominator:&#34;)
    self.variable2_label.setVisible(False)
    self.layout.addWidget(self.variable2_label)
    self.variable2_selection = QComboBox()
    self.variable2_selection.addItems(self.column_names)
    self.variable2_selection.setVisible(False)
    self.layout.addWidget(self.variable2_selection)

    self.script_label = QLabel(&#34;R Script:&#34;)

    self.icon_label = QLabel()
    self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
    self.icon_label.setFixedSize(16, 30)
    self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)
    self.icon_label.setVisible(False)

    # Create a horizontal layout to place the script_label and icon_label in one row
    script_layout = QHBoxLayout()
    script_layout.addWidget(self.script_label)
    script_layout.addWidget(self.icon_label)

    self.layout.addLayout(script_layout)
    self.script_input = QTextEdit()
    self.script_input.setPlaceholderText(&#34;Write r script here...&#34;)
    self.layout.addWidget(self.script_input)

    # Tombol OK dan Cancel
    self.button_layout = QHBoxLayout()
    self.ok_button = QPushButton(&#34;OK&#34;)
    self.ok_button.clicked.connect(self.accept)
    self.button_layout.addWidget(self.ok_button)
    self.save_template_button = QPushButton(&#34;Save Template&#34;)
    self.save_template_button.clicked.connect(self.save_template)
    self.button_layout.addWidget(self.save_template_button)

    self.layout.addLayout(self.button_layout)
    self.setLayout(self.layout)

    # Event handler untuk perubahan template
    self.template_selection.currentIndexChanged.connect(self.update_script_input)
    self.variable1_selection.currentIndexChanged.connect(self.update_script_input)
    self.variable2_selection.currentIndexChanged.connect(self.update_script_input)

    # Initialize script input with the first template
    self.update_script_input(0)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.load_templates"><code class="name flex">
<span>def <span class="ident">load_templates</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load_templates(self):
    app_data_dir = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;)
    os.makedirs(app_data_dir, exist_ok=True)
    templates = {}
    template_file = os.path.join(self.parent.path, &#39;file-data&#39;, &#39;template.dat&#39;)
    appdata_template_file = os.path.join(app_data_dir, &#39;template.dat&#39;)
    
    if not os.path.exists(appdata_template_file):
        # Copy template.dat to appdata_template_file if it doesn&#39;t exist
        shutil.copyfile(template_file, appdata_template_file)
        template_file = appdata_template_file
        
    with open(template_file, &#39;r&#39;) as file:
        lines = file.readlines()
        for line in lines:
            name, script = line.strip().split(&#39;=&#39;, 1)
            templates[name] = script
    return templates</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.save_template"><code class="name flex">
<span>def <span class="ident">save_template</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save_template(self):
    self.save_template_button.setText(&#34;Saving...&#34;)
    self.save_template_button.setEnabled(False)
    template_name, ok = QInputDialog.getText(self, &#34;Save Template&#34;, &#34;Enter template name:&#34;)
    if ok and template_name:
        script = self.get_script()
        self.templates[template_name] = script
        template_file = os.path.join(os.getenv(&#34;APPDATA&#34;), &#34;saePisan&#34;, &#39;template.dat&#39;)
        with open(template_file, &#39;a&#39;) as file:
            file.write(f&#34;{template_name}={script}\n&#34;)
        self.template_selection.addItem(template_name)
        QMessageBox.information(self, &#34;Success&#34;, &#34;Template saved successfully!&#34;)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model):
    self.model = model
    self.column_names = [col.replace(&#34; &#34;, &#34;_&#34;) for col in self.model.get_data().columns]
    self.variable1_selection.clear()
    self.variable1_selection.addItems(self.column_names)
    self.variable2_selection.clear()
    self.variable2_selection.addItems(self.column_names)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.update_script_input"><code class="name flex">
<span>def <span class="ident">update_script_input</span></span>(<span>self, index)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_script_input(self, index):
    template_name = self.template_selection.currentText()
    script = self.templates.get(template_name, &#34;&#34;)
    if template_name == &#34;Compute RSE&#34;:
        self.variable1_label.setVisible(True)
        self.variable1_selection.setVisible(True)
        self.variable2_label.setVisible(True)
        self.variable2_selection.setVisible(True)
        variable1 = self.variable1_selection.currentText()
        variable2 = self.variable2_selection.currentText()
        script = script.replace(&#34;{variable1}&#34;, variable1).replace(&#34;{variable2}&#34;, variable2)
    else:
        self.variable1_label.setVisible(False)
        self.variable1_selection.setVisible(False)
        self.variable2_label.setVisible(False)
        self.variable2_selection.setVisible(False)
    self.script_input.setPlainText(script)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog">ComputeVariableDialog</a></code></h4>
<ul class="two-column">
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.accept" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.get_script" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.get_script">get_script</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.init_ui" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.init_ui">init_ui</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.load_templates" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.load_templates">load_templates</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.save_template" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.save_template">save_template</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.set_model" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.update_script_input" href="#saePisan.view.components.ComputeVariableDialog.ComputeVariableDialog.update_script_input">update_script_input</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_5">
                <div class="file-header">
                    <div>ğŸ“„ ConsoleDialog</div>
                    <div class="file-path">view/components/ConsoleDialog.html (11.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ConsoleDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ConsoleDialog.ConsoleDialog"><code class="flex name class">
<span>class <span class="ident">ConsoleDialog</span></span>
<span>(</span><span>parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConsoleDialog(QDialog):
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setWindowTitle(&#34;R Console Output&#34;)
        self.setMinimumWidth(500)
        layout = QVBoxLayout(self)
        self.console = QTextEdit()
        self.console.setReadOnly(True)
        self.loading_label = QLabel()
        self.loading_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        self.loading_movie = QMovie(&#34;assets/loading.gif&#34;)
        self.loading_movie.setScaledSize(QSize(25, 25))
        self.loading_label.setMovie(self.loading_movie)
        layout.addWidget(self.loading_label)
        self.loading_movie.start()
        layout.addWidget(self.console)

    def append_text(self, text):
        doc = self.console.document()
        block_count = doc.blockCount()
        if block_count &gt; 1:
            cursor = self.console.textCursor()
            cursor.movePosition(QTextCursor.MoveOperation.End)
            cursor.movePosition(QTextCursor.MoveOperation.StartOfBlock, QTextCursor.MoveMode.KeepAnchor)
            cursor.removeSelectedText()
            cursor.deletePreviousChar()
            cursor.insertText(text)
        else:
            self.console.setPlainText(text)
        self.console.moveCursor(QTextCursor.MoveOperation.End)

    def stop_loading(self):
        self.loading_movie.stop()
        self.loading_label.setVisible(False)</code></pre>
</details>
<div class="desc"><p>QDialog(parent: Optional[QWidget] = None, flags: Qt.WindowType = Qt.WindowFlags())</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ConsoleDialog.ConsoleDialog.append_text"><code class="name flex">
<span>def <span class="ident">append_text</span></span>(<span>self, text)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def append_text(self, text):
    doc = self.console.document()
    block_count = doc.blockCount()
    if block_count &gt; 1:
        cursor = self.console.textCursor()
        cursor.movePosition(QTextCursor.MoveOperation.End)
        cursor.movePosition(QTextCursor.MoveOperation.StartOfBlock, QTextCursor.MoveMode.KeepAnchor)
        cursor.removeSelectedText()
        cursor.deletePreviousChar()
        cursor.insertText(text)
    else:
        self.console.setPlainText(text)
    self.console.moveCursor(QTextCursor.MoveOperation.End)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ConsoleDialog.ConsoleDialog.stop_loading"><code class="name flex">
<span>def <span class="ident">stop_loading</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def stop_loading(self):
    self.loading_movie.stop()
    self.loading_label.setVisible(False)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ConsoleDialog.ConsoleDialog" href="#saePisan.view.components.ConsoleDialog.ConsoleDialog">ConsoleDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ConsoleDialog.ConsoleDialog.append_text" href="#saePisan.view.components.ConsoleDialog.ConsoleDialog.append_text">append_text</a></code></li>
<li><code><a title="saePisan.view.components.ConsoleDialog.ConsoleDialog.stop_loading" href="#saePisan.view.components.ConsoleDialog.ConsoleDialog.stop_loading">stop_loading</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_6">
                <div class="file-header">
                    <div>ğŸ“„ CsvDialogOption</div>
                    <div class="file-path">view/components/CsvDialogOption.html (18.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.CsvDialogOption</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.CsvDialogOption.CSVOptionsDialog"><code class="flex name class">
<span>class <span class="ident">CSVOptionsDialog</span></span>
<span>(</span><span>parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CSVOptionsDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for selecting CSV file options and previewing the CSV content.
    Attributes:
        file_path (str): The path to the selected CSV file.
        separator (str): The separator used in the CSV file.
        header (bool): Whether the first row is treated as a header.
    Methods:
        __init__(parent=None):
            Initializes the dialog with default values and sets up the UI.
        init_ui():
            Sets up the user interface components of the dialog.
        select_file():
            Opens a file picker dialog to select a CSV file and updates the preview.
        update_preview():
            Updates the preview table based on the selected file, separator, and header options.
        get_csv_options():
            Returns the selected CSV options if the dialog is accepted.
    &#34;&#34;&#34;
    
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setWindowTitle(&#34;CSV Options&#34;)

        self.file_path = None
        self.separator = &#34;,&#34;
        self.header = True

        self.init_ui()

    def init_ui(self):
        layout = QVBoxLayout()

        # File picker
        self.file_label = QLabel(&#34;No file selected&#34;)
        layout.addWidget(self.file_label)
        self.file_button = QPushButton(&#34;Select File&#34;)
        self.file_button.clicked.connect(self.select_file)
        layout.addWidget(self.file_button)

        # Separator input
        layout.addWidget(QLabel(&#34;Separator (e.g. , or ; For tab use \\t)&#34;))
        self.separator_input = QLineEdit(&#34;,&#34;)
        self.separator_input.textChanged.connect(self.update_preview)
        layout.addWidget(self.separator_input)

        # Header checkbox
        self.header_checkbox = QCheckBox(&#34;First row as header&#34;)
        self.header_checkbox.setChecked(True)  # Default header True
        self.header_checkbox.toggled.connect(self.update_preview)
        layout.addWidget(self.header_checkbox)

        # Preview Table
        self.preview_label = QLabel(&#34;Preview&#34;)
        layout.addWidget(self.preview_label)
        self.preview_table = QTableView()
        layout.addWidget(self.preview_table)

        # OK/Cancel buttons
        self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
        self.buttons.accepted.connect(self.accept)
        self.buttons.rejected.connect(self.reject)
        layout.addWidget(self.buttons)

        self.setLayout(layout)

    def select_file(self):
        &#34;&#34;&#34;File picker untuk memilih file CSV.&#34;&#34;&#34;
        file_path, _ = QFileDialog.getOpenFileName(self, &#34;Open CSV File&#34;, &#34;&#34;, &#34;CSV Files (*.csv)&#34;)
        if file_path:
            self.file_path = file_path
            self.file_label.setText(f&#34;Selected: {file_path}&#34;)
            self.update_preview()

    def update_preview(self):
        &#34;&#34;&#34;Perbarui preview tabel berdasarkan input.&#34;&#34;&#34;
        if not self.file_path:
            self.preview_table.setModel(None)
            return

        sep = self.separator_input.text()
        if sep == r&#34;\t&#34;:  # Jika input adalah string literal &#34;\t&#34;
            sep = &#34;\t&#34;
        hdr = True if self.header_checkbox.isChecked() else False
        try:
            preview_data = pl.read_csv(self.file_path, separator=sep, has_header=hdr, ignore_errors=True, null_values=[&#34;NA&#34;, &#34;NULL&#34;, &#34;na&#34;, &#34;null&#34;]).head(10)
            model = QStandardItemModel()
            
            model.setHorizontalHeaderLabels(preview_data.columns)

            for row in preview_data.to_numpy():
                items = [QStandardItem(str(cell)) for cell in row]
                model.appendRow(items)

            self.preview_table.setModel(model)
        except Exception as e:
            print(f&#34;Error: {e}&#34;)
            self.preview_table.setModel(None)

    def get_csv_options(self):
        &#34;&#34;&#34;Mengembalikan opsi CSV jika dialog diterima.&#34;&#34;&#34;
        if self.exec() == QDialog.DialogCode.Accepted and self.file_path:
            return self.file_path, self.separator_input.text(), self.header_checkbox.isChecked()
        return None, None, None</code></pre>
</details>
<div class="desc"><p>A dialog for selecting CSV file options and previewing the CSV content.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>file_path</code></strong> :&ensp;<code>str</code></dt>
<dd>The path to the selected CSV file.</dd>
<dt><strong><code>separator</code></strong> :&ensp;<code>str</code></dt>
<dd>The separator used in the CSV file.</dd>
<dt><strong><code>header</code></strong> :&ensp;<code>bool</code></dt>
<dd>Whether the first row is treated as a header.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(parent=None):
Initializes the dialog with default values and sets up the UI.
init_ui():
Sets up the user interface components of the dialog.
select_file():
Opens a file picker dialog to select a CSV file and updates the preview.
update_preview():
Updates the preview table based on the selected file, separator, and header options.
get_csv_options():
Returns the selected CSV options if the dialog is accepted.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.get_csv_options"><code class="name flex">
<span>def <span class="ident">get_csv_options</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_csv_options(self):
    &#34;&#34;&#34;Mengembalikan opsi CSV jika dialog diterima.&#34;&#34;&#34;
    if self.exec() == QDialog.DialogCode.Accepted and self.file_path:
        return self.file_path, self.separator_input.text(), self.header_checkbox.isChecked()
    return None, None, None</code></pre>
</details>
<div class="desc"><p>Mengembalikan opsi CSV jika dialog diterima.</p></div>
</dd>
<dt id="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.init_ui"><code class="name flex">
<span>def <span class="ident">init_ui</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_ui(self):
    layout = QVBoxLayout()

    # File picker
    self.file_label = QLabel(&#34;No file selected&#34;)
    layout.addWidget(self.file_label)
    self.file_button = QPushButton(&#34;Select File&#34;)
    self.file_button.clicked.connect(self.select_file)
    layout.addWidget(self.file_button)

    # Separator input
    layout.addWidget(QLabel(&#34;Separator (e.g. , or ; For tab use \\t)&#34;))
    self.separator_input = QLineEdit(&#34;,&#34;)
    self.separator_input.textChanged.connect(self.update_preview)
    layout.addWidget(self.separator_input)

    # Header checkbox
    self.header_checkbox = QCheckBox(&#34;First row as header&#34;)
    self.header_checkbox.setChecked(True)  # Default header True
    self.header_checkbox.toggled.connect(self.update_preview)
    layout.addWidget(self.header_checkbox)

    # Preview Table
    self.preview_label = QLabel(&#34;Preview&#34;)
    layout.addWidget(self.preview_label)
    self.preview_table = QTableView()
    layout.addWidget(self.preview_table)

    # OK/Cancel buttons
    self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
    self.buttons.accepted.connect(self.accept)
    self.buttons.rejected.connect(self.reject)
    layout.addWidget(self.buttons)

    self.setLayout(layout)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.select_file"><code class="name flex">
<span>def <span class="ident">select_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def select_file(self):
    &#34;&#34;&#34;File picker untuk memilih file CSV.&#34;&#34;&#34;
    file_path, _ = QFileDialog.getOpenFileName(self, &#34;Open CSV File&#34;, &#34;&#34;, &#34;CSV Files (*.csv)&#34;)
    if file_path:
        self.file_path = file_path
        self.file_label.setText(f&#34;Selected: {file_path}&#34;)
        self.update_preview()</code></pre>
</details>
<div class="desc"><p>File picker untuk memilih file CSV.</p></div>
</dd>
<dt id="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.update_preview"><code class="name flex">
<span>def <span class="ident">update_preview</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_preview(self):
    &#34;&#34;&#34;Perbarui preview tabel berdasarkan input.&#34;&#34;&#34;
    if not self.file_path:
        self.preview_table.setModel(None)
        return

    sep = self.separator_input.text()
    if sep == r&#34;\t&#34;:  # Jika input adalah string literal &#34;\t&#34;
        sep = &#34;\t&#34;
    hdr = True if self.header_checkbox.isChecked() else False
    try:
        preview_data = pl.read_csv(self.file_path, separator=sep, has_header=hdr, ignore_errors=True, null_values=[&#34;NA&#34;, &#34;NULL&#34;, &#34;na&#34;, &#34;null&#34;]).head(10)
        model = QStandardItemModel()
        
        model.setHorizontalHeaderLabels(preview_data.columns)

        for row in preview_data.to_numpy():
            items = [QStandardItem(str(cell)) for cell in row]
            model.appendRow(items)

        self.preview_table.setModel(model)
    except Exception as e:
        print(f&#34;Error: {e}&#34;)
        self.preview_table.setModel(None)</code></pre>
</details>
<div class="desc"><p>Perbarui preview tabel berdasarkan input.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.CsvDialogOption.CSVOptionsDialog" href="#saePisan.view.components.CsvDialogOption.CSVOptionsDialog">CSVOptionsDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.get_csv_options" href="#saePisan.view.components.CsvDialogOption.CSVOptionsDialog.get_csv_options">get_csv_options</a></code></li>
<li><code><a title="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.init_ui" href="#saePisan.view.components.CsvDialogOption.CSVOptionsDialog.init_ui">init_ui</a></code></li>
<li><code><a title="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.select_file" href="#saePisan.view.components.CsvDialogOption.CSVOptionsDialog.select_file">select_file</a></code></li>
<li><code><a title="saePisan.view.components.CsvDialogOption.CSVOptionsDialog.update_preview" href="#saePisan.view.components.CsvDialogOption.CSVOptionsDialog.update_preview">update_preview</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_7">
                <div class="file-header">
                    <div>ğŸ“„ CustomToast</div>
                    <div class="file-path">view/components/CustomToast.html (33.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.CustomToast</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.CustomToast.CustomToast"><code class="flex name class">
<span>class <span class="ident">CustomToast</span></span>
<span>(</span><span>parent=None, title='', text='', duration=3000, position='top-right', icon_path=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CustomToast(QWidget):
    &#34;&#34;&#34;
    Custom Toast Notification Widget
    This widget displays a toast notification with a title, text, icon, and a progress bar.
    It can be customized with different positions, colors, and icons.
    The toast will automatically close after a specified duration, but can be paused by hovering over it.
    It supports various customization options such as border radius, icon size, background color, title color,
    close button icon color, duration bar color, and text color.
    Parameters:
        parent (QWidget): The parent widget for the toast.
        title (str): The title of the toast notification.
        text (str): The text content of the toast notification.
        duration (int): Duration in milliseconds before the toast automatically closes. Default is 3000 ms.
        position (str): Position of the toast on the screen. Options are &#34;top-right&#34;, &#34;top-left&#34;, &#34;bottom-right&#34;, &#34;bottom-left&#34;. Default is &#34;top-right&#34;.
        icon_path (str): Path to the icon image to be displayed on the left side of the toast. Default is None, which uses a default icon.
    &#34;&#34;&#34;
    def __init__(self, parent=None, title=&#34;&#34;, text=&#34;&#34;, duration=3000, position=&#34;top-right&#34;, icon_path=None):
        &#34;&#34;&#34;Initialize the CustomToast widget.&#34;&#34;&#34;
        super().__init__(parent)
        self.setWindowFlags(
            Qt.WindowType.FramelessWindowHint |
            Qt.WindowType.Tool |
            Qt.WindowType.WindowStaysOnTopHint
        )
        self.setAttribute(Qt.WidgetAttribute.WA_TranslucentBackground)
        self.setAttribute(Qt.WidgetAttribute.WA_ShowWithoutActivating)
        self.is_paused = False

        # Main layout
        main_layout = QVBoxLayout(self)
        main_layout.setContentsMargins(0, 0, 0, 0)
        main_layout.setSpacing(0)

        # Card container for solid background
        card = QWidget(self)
        card.setObjectName(&#34;toastCard&#34;)
        # Bawah 0 agar progressbar nempel ke bawah card
        card_layout = QVBoxLayout(card)
        card_layout.setContentsMargins(18, 14, 18, 0)
        card_layout.setSpacing(0)

        # Top area: icon kiri, garis, title &amp; text kanan (pakai grid)
        top_grid = QGridLayout()
        top_grid.setHorizontalSpacing(12)
        top_grid.setVerticalSpacing(2)
        top_grid.setContentsMargins(0, 0, 0, 0)

        # Icon kiri
        icon_label = QLabel()
        if icon_path:
            pixmap = QPixmap(icon_path)
            icon_label.setPixmap(pixmap.scaled(36, 36, Qt.AspectRatioMode.KeepAspectRatio, Qt.TransformationMode.SmoothTransformation))
        else:
            pixmap = QPixmap(&#34;assets/information.svg&#34;)
            icon_label.setPixmap(pixmap.scaled(36, 36, Qt.AspectRatioMode.KeepAspectRatio, Qt.TransformationMode.SmoothTransformation))
        icon_label.setFixedSize(40, 40)
        icon_label.setAlignment(Qt.AlignmentFlag.AlignTop | Qt.AlignmentFlag.AlignHCenter)
        icon_label.setStyleSheet(&#34;background: transparent;&#34;)
        top_grid.addWidget(icon_label, 0, 0, 2, 1, Qt.AlignmentFlag.AlignTop)

        # Garis vertikal pembatas
        line = QWidget()
        line.setFixedWidth(1)
        line.setStyleSheet(&#34;background: #b0bec5; margin-top: 2px; margin-bottom: 2px;&#34;)
        top_grid.addWidget(line, 0, 1, 2, 1)

        # Title kanan atas
        self.title_label = QLabel(title)
        self.title_label.setFont(QFont(&#34;Arial&#34;, 10, QFont.Weight.Bold))
        self.title_label.setStyleSheet(&#34;color: #222; background: transparent;&#34;)
        self.title_label.setWordWrap(True)
        top_grid.addWidget(self.title_label, 0, 2, 1, 2, Qt.AlignmentFlag.AlignLeft | Qt.AlignmentFlag.AlignTop)

        # Close button kanan atas
        close_btn = QPushButton(&#34;âœ•&#34;)
        close_btn.setFixedSize(24, 24)
        close_btn.setStyleSheet(&#34;&#34;&#34;
            QPushButton {
                border: none;
                background: transparent;
                font-size: 16px;
                color: #444;
            }
            QPushButton:hover {
                color: #d00;
                background: #e3f1fa;
            }
        &#34;&#34;&#34;)
        close_btn.clicked.connect(self.close)
        top_grid.addWidget(close_btn, 0, 4, Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Text kanan bawah
        self.text_label = QLabel(text)
        self.text_label.setFont(QFont(&#34;Arial&#34;, 8))
        self.text_label.setStyleSheet(&#34;color: #333; background: transparent;&#34;)
        self.text_label.setWordWrap(True)
        self.text_label.setMinimumWidth(250)
        self.text_label.setMaximumWidth(400)
        top_grid.addWidget(self.text_label, 1, 2, 1, 3, Qt.AlignmentFlag.AlignLeft | Qt.AlignmentFlag.AlignTop)

        card_layout.addLayout(top_grid)
        card_layout.addSpacing(8)

        # Duration bar di paling bawah, tanpa space kosong
        self.progress = QProgressBar()
        self.progress.setMaximum(duration)
        self.progress.setValue(duration)
        self.progress.setTextVisible(False)
        self.progress.setFixedHeight(9)
        self.progress.setStyleSheet(&#34;&#34;&#34;
            QProgressBar {
                border: none;
                background: #e0e0e0;
                border-radius: 3px;
                margin-bottom: 5px;
            }
            QProgressBar::chunk {
                background: #2196f3;
                border-radius: 3px;
            }
        &#34;&#34;&#34;)
        card_layout.addWidget(self.progress)

        # Set card background and border
        card.setStyleSheet(&#34;&#34;&#34;
            QWidget#toastCard {
                background: #eaf6fd;
                border: 1.5px solid #90caf9;
                border-radius: 0px;
            }
        &#34;&#34;&#34;)

        main_layout.addWidget(card)

        self.adjustSize()
        self.duration = duration
        self.position = position

        # Timer for auto-close and progress bar
        self.timer = QTimer(self)
        self.timer.timeout.connect(self.update_progress)
        self.timer.start(15)
        self.elapsed = 0

    def showEvent(self, event):
        &#34;&#34;&#34;Handle the show event to adjust size and position.&#34;&#34;&#34;
        super().showEvent(event)
        self.adjustSize()
        self.move_to_position()

    def move_to_position(self):
        &#34;&#34;&#34;_summary_
        Move the toast to the specified position relative to its parent widget.
        If the parent widget is not set, it will center the toast on the screen.
        If the parent widget is set, it will position the toast at the specified corner with a margin.
        Supported positions are &#34;top-right&#34;, &#34;top-left&#34;, &#34;bottom-right&#34;, &#34;bottom-left&#34;, and &#34;center&#34;.
        If the position is not recognized, it defaults to centering the toast on the parent widget.
        &#34;&#34;&#34;
        parent = self.parentWidget()
        if parent:
            parent_rect = parent.geometry()
            margin = 32
            if self.position == &#34;top-right&#34;:
                x = parent_rect.x() + parent_rect.width() - self.width() - margin
                y = parent_rect.y() + margin
            elif self.position == &#34;top-left&#34;:
                x = parent_rect.x() + margin
                y = parent_rect.y() + margin
            elif self.position == &#34;bottom-right&#34;:
                x = parent_rect.x() + parent_rect.width() - self.width() - margin
                y = parent_rect.y() + parent_rect.height() - self.height() - margin
            elif self.position == &#34;bottom-left&#34;:
                x = parent_rect.x() + margin
                y = parent_rect.y() + parent_rect.height() - self.height() - margin
            else:
                x = parent_rect.x() + (parent_rect.width() - self.width()) // 2
                y = parent_rect.y() + (parent_rect.height() - self.height()) // 2
            self.move(x, y)

    def enterEvent(self, event):
        &#34;&#34;&#34;Pause the toast when the mouse enters.&#34;&#34;&#34;
        self.is_paused = True
        self.timer.stop()
        super().enterEvent(event)

    def leaveEvent(self, event):
        &#34;&#34;&#34;Resume the toast when the mouse leaves.&#34;&#34;&#34;
        self.is_paused = False
        self.timer.start(15)
        super().leaveEvent(event)

    def update_progress(self):
        &#34;&#34;&#34;Update the progress bar and check if the toast should close.&#34;&#34;&#34;
        if self.is_paused:
            return
        self.elapsed += 15
        remaining = max(0, self.duration - self.elapsed)
        self.progress.setValue(remaining)
        if self.elapsed &gt;= self.duration:
            self.timer.stop()
            self.close()
    
    def set_border_radius(self, radius: int):
        &#34;&#34;&#34;
        Set the border radius of the toast card.

        Args:
            radius (int): The desired border radius in pixels to be applied to the toast card.

        This method updates the stylesheet of the widget named &#34;toastCard&#34; to reflect the specified border radius.
        &#34;&#34;&#34;
        style = f&#34;&#34;&#34;
            QWidget#toastCard {{
                background: #eaf6fd;
                border: 1.5px solid #90caf9;
                border-radius: {radius}px;
            }}
        &#34;&#34;&#34;
        self.findChild(QWidget, &#34;toastCard&#34;).setStyleSheet(style)
        
    def set_icon_size(self, width: int, height: int):
        &#34;&#34;&#34;Atur ukuran icon pada toast.&#34;&#34;&#34;
        icon_label = self.findChild(QLabel)
        if icon_label:
            pixmap = icon_label.pixmap()
            if pixmap:
                icon_label.setPixmap(pixmap.scaled(width, height, Qt.AspectRatioMode.KeepAspectRatio, Qt.TransformationMode.SmoothTransformation))
            icon_label.setFixedSize(width, height)

    def set_background_color(self, color: str):
        &#34;&#34;&#34;Atur warna background card toast.&#34;&#34;&#34;
        card = self.findChild(QWidget, &#34;toastCard&#34;)
        style = f&#34;&#34;&#34;
            QWidget#toastCard {{
                background: {color};
                border: 1.5px solid #90caf9;
                border-radius: 0px;
            }}
        &#34;&#34;&#34;
        card.setStyleSheet(style)

    def set_title_color(self, color: str):
        &#34;&#34;&#34;Atur warna teks title.&#34;&#34;&#34;
        self.title_label.setStyleSheet(f&#34;color: {color}; background: transparent;&#34;)

    def set_close_button_icon_color(self, color: str):
        &#34;&#34;&#34;Atur warna icon tombol close.&#34;&#34;&#34;
        close_btn = self.findChildren(QPushButton)[0]
        close_btn.setStyleSheet(f&#34;&#34;&#34;
            QPushButton {{
                border: none;
                background: transparent;
                font-size: 16px;
                color: {color};
            }}
            QPushButton:hover {{
                color: #d00;
                background: #e3f1fa;
            }}
        &#34;&#34;&#34;)

    def set_duration_bar_color(self, color: str):
        &#34;&#34;&#34;Atur warna progress bar durasi.&#34;&#34;&#34;
        self.progress.setStyleSheet(f&#34;&#34;&#34;
            QProgressBar {{
                border: none;
                background: #e0e0e0;
                border-radius: 3px;
                margin-bottom: 5px;
            }}
            QProgressBar::chunk {{
                background: {color};
                border-radius: 3px;
            }}
        &#34;&#34;&#34;)

    def set_text_color(self, color: str):
        &#34;&#34;&#34;Atur warna teks isi toast.&#34;&#34;&#34;
        self.text_label.setStyleSheet(f&#34;color: {color}; background: transparent;&#34;)</code></pre>
</details>
<div class="desc"><p>Custom Toast Notification Widget
This widget displays a toast notification with a title, text, icon, and a progress bar.
It can be customized with different positions, colors, and icons.
The toast will automatically close after a specified duration, but can be paused by hovering over it.
It supports various customization options such as border radius, icon size, background color, title color,
close button icon color, duration bar color, and text color.</p>
<h2 id="parameters">Parameters</h2>
<p>parent (QWidget): The parent widget for the toast.
title (str): The title of the toast notification.
text (str): The text content of the toast notification.
duration (int): Duration in milliseconds before the toast automatically closes. Default is 3000 ms.
position (str): Position of the toast on the screen. Options are "top-right", "top-left", "bottom-right", "bottom-left". Default is "top-right".
icon_path (str): Path to the icon image to be displayed on the left side of the toast. Default is None, which uses a default icon.</p>
<p>Initialize the CustomToast widget.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.CustomToast.CustomToast.enterEvent"><code class="name flex">
<span>def <span class="ident">enterEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def enterEvent(self, event):
    &#34;&#34;&#34;Pause the toast when the mouse enters.&#34;&#34;&#34;
    self.is_paused = True
    self.timer.stop()
    super().enterEvent(event)</code></pre>
</details>
<div class="desc"><p>Pause the toast when the mouse enters.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.leaveEvent"><code class="name flex">
<span>def <span class="ident">leaveEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def leaveEvent(self, event):
    &#34;&#34;&#34;Resume the toast when the mouse leaves.&#34;&#34;&#34;
    self.is_paused = False
    self.timer.start(15)
    super().leaveEvent(event)</code></pre>
</details>
<div class="desc"><p>Resume the toast when the mouse leaves.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.move_to_position"><code class="name flex">
<span>def <span class="ident">move_to_position</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def move_to_position(self):
    &#34;&#34;&#34;_summary_
    Move the toast to the specified position relative to its parent widget.
    If the parent widget is not set, it will center the toast on the screen.
    If the parent widget is set, it will position the toast at the specified corner with a margin.
    Supported positions are &#34;top-right&#34;, &#34;top-left&#34;, &#34;bottom-right&#34;, &#34;bottom-left&#34;, and &#34;center&#34;.
    If the position is not recognized, it defaults to centering the toast on the parent widget.
    &#34;&#34;&#34;
    parent = self.parentWidget()
    if parent:
        parent_rect = parent.geometry()
        margin = 32
        if self.position == &#34;top-right&#34;:
            x = parent_rect.x() + parent_rect.width() - self.width() - margin
            y = parent_rect.y() + margin
        elif self.position == &#34;top-left&#34;:
            x = parent_rect.x() + margin
            y = parent_rect.y() + margin
        elif self.position == &#34;bottom-right&#34;:
            x = parent_rect.x() + parent_rect.width() - self.width() - margin
            y = parent_rect.y() + parent_rect.height() - self.height() - margin
        elif self.position == &#34;bottom-left&#34;:
            x = parent_rect.x() + margin
            y = parent_rect.y() + parent_rect.height() - self.height() - margin
        else:
            x = parent_rect.x() + (parent_rect.width() - self.width()) // 2
            y = parent_rect.y() + (parent_rect.height() - self.height()) // 2
        self.move(x, y)</code></pre>
</details>
<div class="desc"><p><em>summary</em>
Move the toast to the specified position relative to its parent widget.
If the parent widget is not set, it will center the toast on the screen.
If the parent widget is set, it will position the toast at the specified corner with a margin.
Supported positions are "top-right", "top-left", "bottom-right", "bottom-left", and "center".
If the position is not recognized, it defaults to centering the toast on the parent widget.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_background_color"><code class="name flex">
<span>def <span class="ident">set_background_color</span></span>(<span>self, color:Â str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_background_color(self, color: str):
    &#34;&#34;&#34;Atur warna background card toast.&#34;&#34;&#34;
    card = self.findChild(QWidget, &#34;toastCard&#34;)
    style = f&#34;&#34;&#34;
        QWidget#toastCard {{
            background: {color};
            border: 1.5px solid #90caf9;
            border-radius: 0px;
        }}
    &#34;&#34;&#34;
    card.setStyleSheet(style)</code></pre>
</details>
<div class="desc"><p>Atur warna background card toast.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_border_radius"><code class="name flex">
<span>def <span class="ident">set_border_radius</span></span>(<span>self, radius:Â int)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_border_radius(self, radius: int):
    &#34;&#34;&#34;
    Set the border radius of the toast card.

    Args:
        radius (int): The desired border radius in pixels to be applied to the toast card.

    This method updates the stylesheet of the widget named &#34;toastCard&#34; to reflect the specified border radius.
    &#34;&#34;&#34;
    style = f&#34;&#34;&#34;
        QWidget#toastCard {{
            background: #eaf6fd;
            border: 1.5px solid #90caf9;
            border-radius: {radius}px;
        }}
    &#34;&#34;&#34;
    self.findChild(QWidget, &#34;toastCard&#34;).setStyleSheet(style)</code></pre>
</details>
<div class="desc"><p>Set the border radius of the toast card.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>radius</code></strong> :&ensp;<code>int</code></dt>
<dd>The desired border radius in pixels to be applied to the toast card.</dd>
</dl>
<p>This method updates the stylesheet of the widget named "toastCard" to reflect the specified border radius.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_close_button_icon_color"><code class="name flex">
<span>def <span class="ident">set_close_button_icon_color</span></span>(<span>self, color:Â str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_close_button_icon_color(self, color: str):
    &#34;&#34;&#34;Atur warna icon tombol close.&#34;&#34;&#34;
    close_btn = self.findChildren(QPushButton)[0]
    close_btn.setStyleSheet(f&#34;&#34;&#34;
        QPushButton {{
            border: none;
            background: transparent;
            font-size: 16px;
            color: {color};
        }}
        QPushButton:hover {{
            color: #d00;
            background: #e3f1fa;
        }}
    &#34;&#34;&#34;)</code></pre>
</details>
<div class="desc"><p>Atur warna icon tombol close.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_duration_bar_color"><code class="name flex">
<span>def <span class="ident">set_duration_bar_color</span></span>(<span>self, color:Â str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_duration_bar_color(self, color: str):
    &#34;&#34;&#34;Atur warna progress bar durasi.&#34;&#34;&#34;
    self.progress.setStyleSheet(f&#34;&#34;&#34;
        QProgressBar {{
            border: none;
            background: #e0e0e0;
            border-radius: 3px;
            margin-bottom: 5px;
        }}
        QProgressBar::chunk {{
            background: {color};
            border-radius: 3px;
        }}
    &#34;&#34;&#34;)</code></pre>
</details>
<div class="desc"><p>Atur warna progress bar durasi.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_icon_size"><code class="name flex">
<span>def <span class="ident">set_icon_size</span></span>(<span>self, width:Â int, height:Â int)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_icon_size(self, width: int, height: int):
    &#34;&#34;&#34;Atur ukuran icon pada toast.&#34;&#34;&#34;
    icon_label = self.findChild(QLabel)
    if icon_label:
        pixmap = icon_label.pixmap()
        if pixmap:
            icon_label.setPixmap(pixmap.scaled(width, height, Qt.AspectRatioMode.KeepAspectRatio, Qt.TransformationMode.SmoothTransformation))
        icon_label.setFixedSize(width, height)</code></pre>
</details>
<div class="desc"><p>Atur ukuran icon pada toast.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_text_color"><code class="name flex">
<span>def <span class="ident">set_text_color</span></span>(<span>self, color:Â str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_text_color(self, color: str):
    &#34;&#34;&#34;Atur warna teks isi toast.&#34;&#34;&#34;
    self.text_label.setStyleSheet(f&#34;color: {color}; background: transparent;&#34;)</code></pre>
</details>
<div class="desc"><p>Atur warna teks isi toast.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.set_title_color"><code class="name flex">
<span>def <span class="ident">set_title_color</span></span>(<span>self, color:Â str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_title_color(self, color: str):
    &#34;&#34;&#34;Atur warna teks title.&#34;&#34;&#34;
    self.title_label.setStyleSheet(f&#34;color: {color}; background: transparent;&#34;)</code></pre>
</details>
<div class="desc"><p>Atur warna teks title.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.showEvent"><code class="name flex">
<span>def <span class="ident">showEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def showEvent(self, event):
    &#34;&#34;&#34;Handle the show event to adjust size and position.&#34;&#34;&#34;
    super().showEvent(event)
    self.adjustSize()
    self.move_to_position()</code></pre>
</details>
<div class="desc"><p>Handle the show event to adjust size and position.</p></div>
</dd>
<dt id="saePisan.view.components.CustomToast.CustomToast.update_progress"><code class="name flex">
<span>def <span class="ident">update_progress</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_progress(self):
    &#34;&#34;&#34;Update the progress bar and check if the toast should close.&#34;&#34;&#34;
    if self.is_paused:
        return
    self.elapsed += 15
    remaining = max(0, self.duration - self.elapsed)
    self.progress.setValue(remaining)
    if self.elapsed &gt;= self.duration:
        self.timer.stop()
        self.close()</code></pre>
</details>
<div class="desc"><p>Update the progress bar and check if the toast should close.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.CustomToast.CustomToast" href="#saePisan.view.components.CustomToast.CustomToast">CustomToast</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.enterEvent" href="#saePisan.view.components.CustomToast.CustomToast.enterEvent">enterEvent</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.leaveEvent" href="#saePisan.view.components.CustomToast.CustomToast.leaveEvent">leaveEvent</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.move_to_position" href="#saePisan.view.components.CustomToast.CustomToast.move_to_position">move_to_position</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_background_color" href="#saePisan.view.components.CustomToast.CustomToast.set_background_color">set_background_color</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_border_radius" href="#saePisan.view.components.CustomToast.CustomToast.set_border_radius">set_border_radius</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_close_button_icon_color" href="#saePisan.view.components.CustomToast.CustomToast.set_close_button_icon_color">set_close_button_icon_color</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_duration_bar_color" href="#saePisan.view.components.CustomToast.CustomToast.set_duration_bar_color">set_duration_bar_color</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_icon_size" href="#saePisan.view.components.CustomToast.CustomToast.set_icon_size">set_icon_size</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_text_color" href="#saePisan.view.components.CustomToast.CustomToast.set_text_color">set_text_color</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.set_title_color" href="#saePisan.view.components.CustomToast.CustomToast.set_title_color">set_title_color</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.showEvent" href="#saePisan.view.components.CustomToast.CustomToast.showEvent">showEvent</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast.CustomToast.update_progress" href="#saePisan.view.components.CustomToast.CustomToast.update_progress">update_progress</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_8">
                <div class="file-header">
                    <div>ğŸ“„ DragDropListView</div>
                    <div class="file-path">view/components/DragDropListView.html (14.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.DragDropListView</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.DragDropListView.DragDropListView"><code class="flex name class">
<span>class <span class="ident">DragDropListView</span></span>
<span>(</span><span>parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DragDropListView(QListView):
    def __init__(self, parent=None):
        super().__init__(parent)
        self.parent = parent
        self.setDragEnabled(True)
        self.setAcceptDrops(True)
        self.setDropIndicatorShown(True)
        self.setDefaultDropAction(Qt.DropAction.MoveAction)
        self.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)

    def dragEnterEvent(self, event):
        if event.mimeData().hasText():
            event.acceptProposedAction()
        else:
            super().dragEnterEvent(event)
    
    def edit(self, index, trigger, event):
        return False

    def dragMoveEvent(self, event):
        if event.mimeData().hasText():
            event.acceptProposedAction()
        else:
            super().dragMoveEvent(event)

    def dropEvent(self, event):
        if self.parent and hasattr(self.parent, &#34;handle_drop&#34;):
            items = []
            if event.mimeData().hasUrls():
                for url in event.mimeData().urls():
                    items.append(url.toLocalFile())
            if event.mimeData().hasText():
                items = event.mimeData().text().split(&#39;\n&#39;)
            self.parent.handle_drop(self, [i for i in items if i])
            event.accept()
        else:
            super().dropEvent(event)

    def startDrag(self, supportedActions):
        selected = self.selectedIndexes()
        if not selected:
            return
        data = &#39;\n&#39;.join([self.model().data(i) for i in selected])
        mime = QMimeData()
        mime.setText(data)
        drag = QDrag(self)
        drag.setMimeData(mime)
        drag.exec(Qt.DropAction.MoveAction)</code></pre>
</details>
<div class="desc"><p>QListView(parent: Optional[QWidget] = None)</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QListView</li>
<li>PyQt6.QtWidgets.QAbstractItemView</li>
<li>PyQt6.QtWidgets.QAbstractScrollArea</li>
<li>PyQt6.QtWidgets.QFrame</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.DragDropListView.DragDropListView.dragEnterEvent"><code class="name flex">
<span>def <span class="ident">dragEnterEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def dragEnterEvent(self, event):
    if event.mimeData().hasText():
        event.acceptProposedAction()
    else:
        super().dragEnterEvent(event)</code></pre>
</details>
<div class="desc"><p>dragEnterEvent(self, e: Optional[QDragEnterEvent])</p></div>
</dd>
<dt id="saePisan.view.components.DragDropListView.DragDropListView.dragMoveEvent"><code class="name flex">
<span>def <span class="ident">dragMoveEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def dragMoveEvent(self, event):
    if event.mimeData().hasText():
        event.acceptProposedAction()
    else:
        super().dragMoveEvent(event)</code></pre>
</details>
<div class="desc"><p>dragMoveEvent(self, e: Optional[QDragMoveEvent])</p></div>
</dd>
<dt id="saePisan.view.components.DragDropListView.DragDropListView.dropEvent"><code class="name flex">
<span>def <span class="ident">dropEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def dropEvent(self, event):
    if self.parent and hasattr(self.parent, &#34;handle_drop&#34;):
        items = []
        if event.mimeData().hasUrls():
            for url in event.mimeData().urls():
                items.append(url.toLocalFile())
        if event.mimeData().hasText():
            items = event.mimeData().text().split(&#39;\n&#39;)
        self.parent.handle_drop(self, [i for i in items if i])
        event.accept()
    else:
        super().dropEvent(event)</code></pre>
</details>
<div class="desc"><p>dropEvent(self, e: Optional[QDropEvent])</p></div>
</dd>
<dt id="saePisan.view.components.DragDropListView.DragDropListView.edit"><code class="name flex">
<span>def <span class="ident">edit</span></span>(<span>self, index, trigger, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def edit(self, index, trigger, event):
    return False</code></pre>
</details>
<div class="desc"><p>edit(self, index: QModelIndex)
edit(self, index: QModelIndex, trigger: QAbstractItemView.EditTrigger, event: Optional[QEvent]) -&gt; bool</p></div>
</dd>
<dt id="saePisan.view.components.DragDropListView.DragDropListView.startDrag"><code class="name flex">
<span>def <span class="ident">startDrag</span></span>(<span>self, supportedActions)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def startDrag(self, supportedActions):
    selected = self.selectedIndexes()
    if not selected:
        return
    data = &#39;\n&#39;.join([self.model().data(i) for i in selected])
    mime = QMimeData()
    mime.setText(data)
    drag = QDrag(self)
    drag.setMimeData(mime)
    drag.exec(Qt.DropAction.MoveAction)</code></pre>
</details>
<div class="desc"><p>startDrag(self, supportedActions: Qt.DropAction)</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.DragDropListView.DragDropListView" href="#saePisan.view.components.DragDropListView.DragDropListView">DragDropListView</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.DragDropListView.DragDropListView.dragEnterEvent" href="#saePisan.view.components.DragDropListView.DragDropListView.dragEnterEvent">dragEnterEvent</a></code></li>
<li><code><a title="saePisan.view.components.DragDropListView.DragDropListView.dragMoveEvent" href="#saePisan.view.components.DragDropListView.DragDropListView.dragMoveEvent">dragMoveEvent</a></code></li>
<li><code><a title="saePisan.view.components.DragDropListView.DragDropListView.dropEvent" href="#saePisan.view.components.DragDropListView.DragDropListView.dropEvent">dropEvent</a></code></li>
<li><code><a title="saePisan.view.components.DragDropListView.DragDropListView.edit" href="#saePisan.view.components.DragDropListView.DragDropListView.edit">edit</a></code></li>
<li><code><a title="saePisan.view.components.DragDropListView.DragDropListView.startDrag" href="#saePisan.view.components.DragDropListView.DragDropListView.startDrag">startDrag</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_8_9">
                <div class="file-header">
                    <div>ğŸ“„ ExcelDialogOption</div>
                    <div class="file-path">view/components/ExcelDialogOption.html (17.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ExcelDialogOption</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog"><code class="flex name class">
<span>class <span class="ident">ExcelOptionsDialog</span></span>
<span>(</span><span>parent=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ExcelOptionsDialog(QDialog):
    &#34;&#34;&#34;
    Dialog to select an Excel file, sheet, and preview data.
    &#34;&#34;&#34;
    def __init__(self, parent=None):
        super().__init__(parent)
        self.setWindowTitle(&#34;Excel Options&#34;)
        self.file_path = None
        self.sheet_names = []
        self.header = True
        self.init_ui()

    def init_ui(self):
        layout = QVBoxLayout()

        # File picker
        self.file_label = QLabel(&#34;No file selected&#34;)
        layout.addWidget(self.file_label)
        self.file_button = QPushButton(&#34;Select Excel File&#34;)
        self.file_button.clicked.connect(self.select_file)
        layout.addWidget(self.file_button)

        # Sheet selector
        self.sheet_combo = QComboBox()
        self.sheet_combo.addItems(self.sheet_names)
        self.sheet_combo.currentIndexChanged.connect(self.update_preview)
        layout.addWidget(QLabel(&#34;Select Sheet&#34;))
        layout.addWidget(self.sheet_combo)
        
        # Header checkbox
        self.header_checkbox = QCheckBox(&#34;First row as header&#34;)
        self.header_checkbox.setChecked(True)  # Default header True
        self.header_checkbox.toggled.connect(self.update_preview)
        layout.addWidget(self.header_checkbox)

        # Preview Table
        self.preview_label = QLabel(&#34;Preview&#34;)
        layout.addWidget(self.preview_label)
        self.preview_table = QTableView()
        layout.addWidget(self.preview_table)

        # OK/Cancel buttons
        self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
        self.buttons.accepted.connect(self.accept)
        self.buttons.rejected.connect(self.reject)
        layout.addWidget(self.buttons)

        self.setLayout(layout)

    def select_file(self):
        &#34;&#34;&#34;File picker to select an Excel file.&#34;&#34;&#34;
        file_path, _ = QFileDialog.getOpenFileName(self, &#34;Open Excel File&#34;, &#34;&#34;, &#34;Excel Files (*.xlsx *.xls)&#34;)
        if file_path:
            self.file_path = file_path
            self.file_label.setText(f&#34;Selected: {file_path}&#34;)
            try:
                import pandas as pd
                xls = pd.ExcelFile(file_path)
                self.sheet_names = xls.sheet_names
                self.sheet_combo.clear()
                self.sheet_combo.addItems(self.sheet_names)
                self.update_preview()
            except Exception as e:
                self.sheet_combo.clear()
                self.preview_table.setModel(None)
                self.file_label.setText(f&#34;Error: {e}&#34;)

    def update_preview(self):
        &#34;&#34;&#34;Update the preview table based on the selected sheet.&#34;&#34;&#34;
        if not self.file_path:
            self.preview_table.setModel(None)
            return
        
        sheet = self.sheet_combo.currentText()
        hdr = True if self.header_checkbox.isChecked() else False
        try:
            df = pl.read_excel(source=self.file_path, sheet_name=sheet, has_header=hdr).head(10)
            model = QStandardItemModel()
            model.setHorizontalHeaderLabels(df.columns)
            for row in df.to_numpy():
                items = [QStandardItem(str(cell)) for cell in row]
                model.appendRow(items)
            self.preview_table.setModel(model)
        except Exception as e:
            print(f&#34;Error: {e}&#34;)
            self.preview_table.setModel(None)
    
    def get_excel_options(self):
        &#34;&#34;&#34;Return path file dan name selected sheet&#34;&#34;&#34;
        if self.exec()== QDialog.DialogCode.Accepted and self.file_path and self.sheet_combo.currentText():
            return self.file_path, self.sheet_combo.currentText(), self.header_checkbox.isChecked()
        return None, None, None</code></pre>
</details>
<div class="desc"><p>Dialog to select an Excel file, sheet, and preview data.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.get_excel_options"><code class="name flex">
<span>def <span class="ident">get_excel_options</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_excel_options(self):
    &#34;&#34;&#34;Return path file dan name selected sheet&#34;&#34;&#34;
    if self.exec()== QDialog.DialogCode.Accepted and self.file_path and self.sheet_combo.currentText():
        return self.file_path, self.sheet_combo.currentText(), self.header_checkbox.isChecked()
    return None, None, None</code></pre>
</details>
<div class="desc"><p>Return path file dan name selected sheet</p></div>
</dd>
<dt id="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.init_ui"><code class="name flex">
<span>def <span class="ident">init_ui</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_ui(self):
    layout = QVBoxLayout()

    # File picker
    self.file_label = QLabel(&#34;No file selected&#34;)
    layout.addWidget(self.file_label)
    self.file_button = QPushButton(&#34;Select Excel File&#34;)
    self.file_button.clicked.connect(self.select_file)
    layout.addWidget(self.file_button)

    # Sheet selector
    self.sheet_combo = QComboBox()
    self.sheet_combo.addItems(self.sheet_names)
    self.sheet_combo.currentIndexChanged.connect(self.update_preview)
    layout.addWidget(QLabel(&#34;Select Sheet&#34;))
    layout.addWidget(self.sheet_combo)
    
    # Header checkbox
    self.header_checkbox = QCheckBox(&#34;First row as header&#34;)
    self.header_checkbox.setChecked(True)  # Default header True
    self.header_checkbox.toggled.connect(self.update_preview)
    layout.addWidget(self.header_checkbox)

    # Preview Table
    self.preview_label = QLabel(&#34;Preview&#34;)
    layout.addWidget(self.preview_label)
    self.preview_table = QTableView()
    layout.addWidget(self.preview_table)

    # OK/Cancel buttons
    self.buttons = QDialogButtonBox(QDialogButtonBox.StandardButton.Ok | QDialogButtonBox.StandardButton.Cancel)
    self.buttons.accepted.connect(self.accept)
    self.buttons.rejected.connect(self.reject)
    layout.addWidget(self.buttons)

    self.setLayout(layout)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.select_file"><code class="name flex">
<span>def <span class="ident">select_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def select_file(self):
    &#34;&#34;&#34;File picker to select an Excel file.&#34;&#34;&#34;
    file_path, _ = QFileDialog.getOpenFileName(self, &#34;Open Excel File&#34;, &#34;&#34;, &#34;Excel Files (*.xlsx *.xls)&#34;)
    if file_path:
        self.file_path = file_path
        self.file_label.setText(f&#34;Selected: {file_path}&#34;)
        try:
            import pandas as pd
            xls = pd.ExcelFile(file_path)
            self.sheet_names = xls.sheet_names
            self.sheet_combo.clear()
            self.sheet_combo.addItems(self.sheet_names)
            self.update_preview()
        except Exception as e:
            self.sheet_combo.clear()
            self.preview_table.setModel(None)
            self.file_label.setText(f&#34;Error: {e}&#34;)</code></pre>
</details>
<div class="desc"><p>File picker to select an Excel file.</p></div>
</dd>
<dt id="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.update_preview"><code class="name flex">
<span>def <span class="ident">update_preview</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_preview(self):
    &#34;&#34;&#34;Update the preview table based on the selected sheet.&#34;&#34;&#34;
    if not self.file_path:
        self.preview_table.setModel(None)
        return
    
    sheet = self.sheet_combo.currentText()
    hdr = True if self.header_checkbox.isChecked() else False
    try:
        df = pl.read_excel(source=self.file_path, sheet_name=sheet, has_header=hdr).head(10)
        model = QStandardItemModel()
        model.setHorizontalHeaderLabels(df.columns)
        for row in df.to_numpy():
            items = [QStandardItem(str(cell)) for cell in row]
            model.appendRow(items)
        self.preview_table.setModel(model)
    except Exception as e:
        print(f&#34;Error: {e}&#34;)
        self.preview_table.setModel(None)</code></pre>
</details>
<div class="desc"><p>Update the preview table based on the selected sheet.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog" href="#saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog">ExcelOptionsDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.get_excel_options" href="#saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.get_excel_options">get_excel_options</a></code></li>
<li><code><a title="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.init_ui" href="#saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.init_ui">init_ui</a></code></li>
<li><code><a title="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.select_file" href="#saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.select_file">select_file</a></code></li>
<li><code><a title="saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.update_preview" href="#saePisan.view.components.ExcelDialogOption.ExcelOptionsDialog.update_preview">update_preview</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_0">
                <div class="file-header">
                    <div>ğŸ“„ MenuContext</div>
                    <div class="file-path">view/components/MenuContext.html (11.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.MenuContext</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="saePisan.view.components.MenuContext.show_context_menu"><code class="name flex">
<span>def <span class="ident">show_context_menu</span></span>(<span>parent, position)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_context_menu(parent, position):
        &#34;&#34;&#34;
        Displays a context menu at the given position within the parent widget.
        Parameters:
        parent (QWidget): The parent widget where the context menu will be displayed.
        position (QPoint): The position within the parent widget where the context menu will appear.
        The context menu provides the following options:
        - Add Row Before: Adds a new row before the selected row(s).
        - Add Row After: Adds a new row after the selected row(s).
        - Add Column Before: Adds a new column before the selected column(s).
        - Add Column After: Adds a new column after the selected column(s).
        - Delete Row: Deletes the selected row(s).
        - Delete Column: Deletes the selected column(s).
        The actions are enabled only if there is a selection in the spreadsheet.
        &#34;&#34;&#34;
        
        context_menu = QMenu(parent)

        selection = parent.spreadsheet.selectionModel().selectedIndexes()
        has_selection = bool(selection)

        add_row_before_action = QAction(&#34;Add Row Before&#34;, parent)
        add_row_before_action.triggered.connect(lambda: show_add_row_before_dialog(parent))
        add_row_before_action.setEnabled(has_selection)
        context_menu.addAction(add_row_before_action)

        add_row_after_action = QAction(&#34;Add Row After&#34;, parent)
        add_row_after_action.triggered.connect(lambda: show_add_row_after_dialog(parent))
        add_row_after_action.setEnabled(has_selection)
        context_menu.addAction(add_row_after_action)

        add_column_before_action = QAction(&#34;Add Column Before&#34;, parent)
        add_column_before_action.triggered.connect(lambda: show_add_column_before_dialog(parent))
        add_column_before_action.setEnabled(has_selection)
        context_menu.addAction(add_column_before_action)

        add_column_after_action = QAction(&#34;Add Column After&#34;, parent)
        add_column_after_action.triggered.connect(lambda: show_add_column_after_dialog(parent))
        add_column_after_action.setEnabled(has_selection)
        context_menu.addAction(add_column_after_action)

        delete_row_action = QAction(&#34;Delete Row&#34;, parent)
        delete_row_action.triggered.connect(lambda : confirm_delete_selected_rows(parent))
        delete_row_action.setEnabled(has_selection)
        context_menu.addAction(delete_row_action)

        delete_column_action = QAction(&#34;Delete Column&#34;, parent)
        delete_column_action.triggered.connect(lambda : confirm_delete_selected_columns(parent))
        delete_column_action.setEnabled(has_selection)
        context_menu.addAction(delete_column_action)
        
        context_menu.exec(parent.spreadsheet.viewport().mapToGlobal(position))</code></pre>
</details>
<div class="desc"><p>Displays a context menu at the given position within the parent widget.
Parameters:
parent (QWidget): The parent widget where the context menu will be displayed.
position (QPoint): The position within the parent widget where the context menu will appear.
The context menu provides the following options:
- Add Row Before: Adds a new row before the selected row(s).
- Add Row After: Adds a new row after the selected row(s).
- Add Column Before: Adds a new column before the selected column(s).
- Add Column After: Adds a new column after the selected column(s).
- Delete Row: Deletes the selected row(s).
- Delete Column: Deletes the selected column(s).
The actions are enabled only if there is a selection in the spreadsheet.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="saePisan.view.components.MenuContext.show_context_menu" href="#saePisan.view.components.MenuContext.show_context_menu">show_context_menu</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_1">
                <div class="file-header">
                    <div>ğŸ“„ ModelingSaeEblupAreaDialog</div>
                    <div class="file-path">view/components/ModelingSaeEblupAreaDialog.html (54.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ModelingSaeEblupAreaDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream"><code class="flex name class">
<span>class <span class="ident">ConsoleStream</span></span>
<span>(</span><span>signal)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConsoleStream:
    def __init__(self, signal):
        self.signal = signal
    def write(self, text):
        if text.strip():
            self.signal.emit(text)
    def flush(self):
        pass</code></pre>
</details>
<div class="desc"></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream.flush"><code class="name flex">
<span>def <span class="ident">flush</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flush(self):
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream.write"><code class="name flex">
<span>def <span class="ident">write</span></span>(<span>self, text)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write(self, text):
    if text.strip():
        self.signal.emit(text)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog"><code class="flex name class">
<span>class <span class="ident">ModelingSaeDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ModelingSaeDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for modeling SAE EBLUP (Small Area Estimation Empirical Best Linear Unbiased Prediction) area level.
    Attributes:
        run_model_finished (pyqtSignal): Signal emitted when the model run is finished.
        parent (QWidget): The parent widget.
        model2 (object): The second model from the parent.
        columns (list): List of column names.
        variables_label (QLabel): Label for the variables list.
        variables_list (QListView): List view for the variables.
        variables_model (QStringListModel): Model for the variables list.
        unassign_button (QPushButton): Button to unassign variables.
        assign_of_interest_button (QPushButton): Button to assign variable of interest.
        assign_aux_button (QPushButton): Button to assign auxiliary variables.
        assign_as_factor_button (QPushButton): Button to assign variables as factors.
        assign_vardir_button (QPushButton): Button to assign direct variance variables.
        of_interest_label (QLabel): Label for the variable of interest list.
        of_interest_list (QListView): List view for the variable of interest.
        of_interest_model (QStringListModel): Model for the variable of interest list.
        auxilary_label (QLabel): Label for the auxiliary variables list.
        auxilary_list (QListView): List view for the auxiliary variables.
        auxilary_model (QStringListModel): Model for the auxiliary variables list.
        as_factor_label (QLabel): Label for the factors of auxiliary variables list.
        as_factor_list (QListView): List view for the factors of auxiliary variables.
        as_factor_model (QStringListModel): Model for the factors of auxiliary variables list.
        vardir_label (QLabel): Label for the direct variance list.
        vardir_list (QListView): List view for the direct variance variables.
        vardir_model (QStringListModel): Model for the direct variance variables list.
        option_button (QPushButton): Button to show options.
        text_script (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        r_script_edit (QTextEdit): Text edit area for the R script.
        ok_button (QPushButton): Button to run the model.
        of_interest_var (list): List of variables of interest.
        auxilary_vars (list): List of auxiliary variables.
        vardir_var (list): List of direct variance variables.
        as_factor_var (list): List of factors of auxiliary variables.
        selection_method (str): Method of selection.
        method (str): Method for the model.
        finnish (bool): Flag to indicate if the model run is finished.
        stop_thread (threading.Event): Event to stop the thread.
    Methods:
        closeEvent(event): Handles the close event of the dialog.
        set_model(model): Sets the model and updates the variables list.
        accept(): Validates inputs and runs the model.
        on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.
    &#34;&#34;&#34;
    
    run_model_finished = pyqtSignal(object, object, object, object)
    update_console = pyqtSignal(str)

    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model2 = parent.model2
        self.setWindowTitle(&#34;SAE Eblup&#34;)
        screen_height = self.parent.screen().size().height()
        self.setMinimumHeight(int(round(screen_height * 0.82)))
        self.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)

        self.columns = []

        self.main_layout = QVBoxLayout()

        # Layout utama untuk membagi area menjadi dua bagian (kiri dan kanan)
        self.split_layout = QHBoxLayout()

        # Layout kiri untuk daftar variabel
        self.left_layout = QVBoxLayout()
        self.variables_label = QLabel(&#34;Select Variables:&#34;)
        self.variables_list = DragDropListView(parent=self)
        self.variables_model = QStringListModel(self.columns)
        self.variables_list.setModel(self.variables_model)
        self.variables_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.variables_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.left_layout.addWidget(self.variables_label)
        self.left_layout.addWidget(self.variables_list)
        
        self.middle_layout1 = QVBoxLayout()
        self.unassign_button = QPushButton(&#34;ğŸ¡„&#34;)
        self.unassign_button.setObjectName(&#34;arrow_button&#34;)
        self.middle_layout1.addWidget(self.unassign_button)

        # Layout tengah untuk tombol panah
        self.middle_layout = QVBoxLayout()
        self.assign_of_interest_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_of_interest_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_aux_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_as_factor_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_as_factor_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_vardir_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_vardir_button.setObjectName(&#34;arrow_button&#34;)

        self.assign_of_interest_button.clicked.connect(lambda: assign_of_interest(self))
        self.assign_aux_button.clicked.connect(lambda: assign_auxilary(self))
        self.assign_vardir_button.clicked.connect(lambda: assign_vardir(self))
        self.assign_as_factor_button.clicked.connect(lambda: assign_as_factor(self))
        self.unassign_button.clicked.connect(lambda: unassign_variable(self))
        self.middle_layout.addWidget(self.assign_of_interest_button)
        self.middle_layout.addWidget(self.assign_aux_button)
        self.middle_layout.addWidget(self.assign_as_factor_button)
        self.middle_layout.addWidget(self.assign_vardir_button)

        # Layout kanan untuk daftar dependen, independen, vardir, dan major area
        self.right_layout = QVBoxLayout()
        self.of_interest_label = QLabel(&#34;Variable of interest:&#34;)
        self.of_interest_list = DragDropListView(parent=self)
        self.of_interest_model = QStringListModel()
        self.of_interest_list.setModel(self.of_interest_model)
        self.of_interest_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.right_layout.addWidget(self.of_interest_label)
        self.right_layout.addWidget(self.of_interest_list)

        self.auxilary_label = QLabel(&#34;Auxilary Variable(s):&#34;)
        self.auxilary_list = DragDropListView(parent=self)
        self.auxilary_model = QStringListModel()
        self.auxilary_list.setModel(self.auxilary_model)
        self.auxilary_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.auxilary_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.auxilary_label)
        self.right_layout.addWidget(self.auxilary_list)

        self.as_factor_label = QLabel(&#34;as Factor of Auxilary Variable(s):&#34;)
        self.as_factor_list = DragDropListView(parent=self)
        self.as_factor_model = QStringListModel()
        self.as_factor_list.setModel(self.as_factor_model)
        self.as_factor_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.as_factor_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.as_factor_label)
        self.right_layout.addWidget(self.as_factor_list)
        
        self.vardir_label = QLabel(&#34;Direct Variance:&#34;)
        self.vardir_list = DragDropListView(parent=self)
        self.vardir_model = QStringListModel()
        self.vardir_list.setModel(self.vardir_model)
        self.vardir_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.vardir_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.vardir_label)
        self.right_layout.addWidget(self.vardir_list)

        # Menambahkan layout kiri, tengah, dan kanan ke layout utama
        self.split_layout.addLayout(self.left_layout)
        self.split_layout.addLayout(self.middle_layout1)
        self.split_layout.addLayout(self.middle_layout)
        self.split_layout.addLayout(self.right_layout)

        self.main_layout.addLayout(self.split_layout)

        # Tombol untuk menghasilkan skrip R
        self.option_button = QPushButton(&#34;Option&#34;)
        self.option_button.setFixedWidth(150)
        
        self.text_script = QLabel(&#34;R Script:&#34;)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)
        
        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.text_script)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)
        
        # Create a horizontal layout to place the text_script and icon_label in one row
        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)

        self.show_console_first_checkbox = QCheckBox(&#34;Show R Console&#34;)
        self.show_console_first_checkbox.setChecked(False)  # default: show before
        # Tambahkan ke layout sebelum tombol Option
        self.main_layout.addWidget(self.show_console_first_checkbox)
        
        self.main_layout.addLayout(self.script_layout)
        self.option_button.clicked.connect(lambda: show_options(self))
        
        # Area teks untuk menampilkan dan mengedit skrip R
        self.r_script_edit = QTextEdit()
        self.r_script_edit.setFixedHeight(round(screen_height*0.20))
        self.r_script_edit.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.r_script_edit.setReadOnly(False)
        self.r_script_edit.setVisible(False)
        self.main_layout.addWidget(self.r_script_edit)
        
        

        # Tombol untuk tindakan dialog
        button_layout = QHBoxLayout()
        button_layout.setObjectName(&#34;button_layout&#34;)
        self.ok_button = QPushButton(&#34;Run Model&#34;)
        self.ok_button.setFixedWidth(150)
        self.ok_button.clicked.connect(self.accept)
        button_layout.addWidget(self.option_button)
        button_layout.addWidget(self.ok_button)
        self.main_layout.addLayout(button_layout)
        


        self.setLayout(self.main_layout)

        self.of_interest_var = []
        self.auxilary_vars = []
        self.vardir_var = []
        self.as_factor_var = []
        self.selection_method = &#34;None&#34;
        self.method = &#34;REML&#34;
        self.finnish = False

        self.run_model_finished.connect(self.on_run_model_finished)
        
        self.stop_thread = threading.Event()
        self.reply=None
        
        self.console_dialog = None
        self.update_console.connect(self._append_console)
    
    def _append_console(self, text):
        if self.console_dialog:
            self.console_dialog.append_text(text)
        
    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.r_script_edit.isVisible()
        self.r_script_edit.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    

    def handle_drop(self, target_list, items):
        mapping = {
            self.variables_list: &#34;variables&#34;,
            self.of_interest_list: &#34;of_interest&#34;,
            self.auxilary_list: &#34;auxilary&#34;,
            self.as_factor_list: &#34;as_factor&#34;,
            self.vardir_list: &#34;vardir&#34;
        }
        source_list = None
        for lst in mapping:
            if any(item in lst.model().stringList() for item in items):
                source_list = lst
                break

        # Drag dari variables_list ke kanan (assign)
        if source_list == self.variables_list:
            if target_list == self.of_interest_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_of_interest(self)
            elif target_list == self.auxilary_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_auxilary(self)
            elif target_list == self.as_factor_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_as_factor(self)
            elif target_list == self.vardir_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_vardir(self)
                
        
        # Drag dari kanan ke variables_list (unassign)
        elif target_list == self.variables_list:
            if source_list == self.of_interest_list:
                self.of_interest_list.clearSelection()
                for idx, val in enumerate(self.of_interest_model.stringList()):
                    if val in items:
                        self.of_interest_list.selectionModel().select(
                            self.of_interest_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.auxilary_list:
                self.auxilary_list.clearSelection()
                for idx, val in enumerate(self.auxilary_model.stringList()):
                    if val in items:
                        self.auxilary_list.selectionModel().select(
                            self.auxilary_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.as_factor_list:
                self.as_factor_list.clearSelection()
                for idx, val in enumerate(self.as_factor_model.stringList()):
                    if val in items:
                        self.as_factor_list.selectionModel().select(
                            self.as_factor_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.vardir_list:
                self.vardir_list.clearSelection()
                for idx, val in enumerate(self.vardir_model.stringList()):
                    if val in items:
                        self.vardir_list.selectionModel().select(
                            self.vardir_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)

    def closeEvent(self, event):
        if self.console_dialog:
            self.console_dialog.close()
        threads = threading.enumerate()
        for thread in threads:
            if thread.name == &#34;SAE EBLUP Area Level&#34; and thread.is_alive():
                if self.reply is None:
                    self.reply = QMessageBox(self)
                    self.reply.setWindowTitle(&#39;Run in Background&#39;)
                    self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                    self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                    self.reply.setDefaultButton(QMessageBox.StandardButton.No)
                if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                    self.stop_thread.set()
                    self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
        self.finnish=False
        self.reply=None
        event.accept()
        
    def set_model(self, model):
        self.model = model
        self.columns = [
            f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
            f&#34;{col} [NULL]&#34; if dtype == pl.Null else
            f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
            f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
            f&#34;{col} [Numeric]&#34;
            for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
        ]
        self.variables_model.setStringList(self.columns)
        self.vardir_model.setStringList([])
        self.auxilary_model.setStringList([])
        self.as_factor_model.setStringList([])
        self.of_interest_model.setStringList([])
        self.of_interest_var = []
        self.auxilary_vars = []
        self.vardir_var = []
        self.as_factor_var = []
        self.selection_method = &#34;None&#34;
        self.method = &#34;REML&#34;
    
    def accept(self):
        if (not self.vardir_var or self.vardir_var == [&#34;&#34;]) and (not self.of_interest_var or self.of_interest_var == [&#34;&#34;]):
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct and variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        if not self.vardir_var or self.vardir_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        
        r_script = get_script(self)
        if not check_script(r_script):
            return
        disable_service(self)

        view = self.parent
        sae_model = SaeEblup(self.model, self.model2, view)
        controller = SaeController(sae_model)
        
        current_context = contextvars.copy_context()
        
        show_console_first = self.show_console_first_checkbox.isChecked()
        if show_console_first:
            self.console_dialog = ConsoleDialog(self)
            self.console_dialog.show()
        
        def run_model_thread():
            result, error, df = None, None, None
            try:
                if self.console_dialog:
                    import sys
                    old_stdout = sys.stdout
                    sys.stdout = ConsoleStream(self.update_console)
                result, error, df = current_context.run(controller.run_model, r_script)
                if self.console_dialog:
                    sys.stdout = old_stdout
                if not error:
                    sae_model.model2.set_data(df)
            except Exception as e:
                error = e
            finally:
                if not self.stop_thread.is_set():
                    self.finnish = True
                    self.run_model_finished.emit(result, error, sae_model, r_script)
                else:
                    return

        def check_run_time():
            if thread.is_alive():
                self.parent.autosave_data()
                reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
                if reply == QMessageBox.StandardButton.No:
                    self.stop_thread.set()
                    QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                    enable_service(self, False, &#34;&#34;)


        thread = threading.Thread(target=run_model_thread, name=&#34;SAE EBLUP Area Level&#34;)
        thread.start()

        timer = QTimer(self)
        timer.setSingleShot(True)
        timer.timeout.connect(check_run_time)
        timer.start(60000)
    
    def on_run_model_finished(self, result, error, sae_model, r_script):
        if self.console_dialog:
            self.console_dialog.stop_loading()
            self.console_dialog.close()
        if not error:
            self.parent.update_table(2, sae_model.get_model2())
        if self.reply is not None:
            self.reply.reject()
        display_script_and_output(self.parent, r_script, result)
        enable_service(self, error, result)
        self.close()     </code></pre>
</details>
<div class="desc"><p>A dialog for modeling SAE EBLUP (Small Area Estimation Empirical Best Linear Unbiased Prediction) area level.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>run_model_finished</code></strong> :&ensp;<code>pyqtSignal</code></dt>
<dd>Signal emitted when the model run is finished.</dd>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model from the parent.</dd>
<dt><strong><code>columns</code></strong> :&ensp;<code>list</code></dt>
<dd>List of column names.</dd>
<dt><strong><code>variables_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variables list.</dd>
<dt><strong><code>variables_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the variables.</dd>
<dt><strong><code>variables_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variables list.</dd>
<dt><strong><code>unassign_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to unassign variables.</dd>
<dt><strong><code>assign_of_interest_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variable of interest.</dd>
<dt><strong><code>assign_aux_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary variables.</dd>
<dt><strong><code>assign_as_factor_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variables as factors.</dd>
<dt><strong><code>assign_vardir_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign direct variance variables.</dd>
<dt><strong><code>of_interest_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variable of interest list.</dd>
<dt><strong><code>of_interest_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the variable of interest.</dd>
<dt><strong><code>of_interest_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variable of interest list.</dd>
<dt><strong><code>auxilary_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the auxiliary variables list.</dd>
<dt><strong><code>auxilary_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the auxiliary variables.</dd>
<dt><strong><code>auxilary_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the auxiliary variables list.</dd>
<dt><strong><code>as_factor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the factors of auxiliary variables list.</dd>
<dt><strong><code>as_factor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the factors of auxiliary variables.</dd>
<dt><strong><code>as_factor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the factors of auxiliary variables list.</dd>
<dt><strong><code>vardir_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the direct variance list.</dd>
<dt><strong><code>vardir_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the direct variance variables.</dd>
<dt><strong><code>vardir_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the direct variance variables list.</dd>
<dt><strong><code>option_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to show options.</dd>
<dt><strong><code>text_script</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>r_script_edit</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit area for the R script.</dd>
<dt><strong><code>ok_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the model.</dd>
<dt><strong><code>of_interest_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of variables of interest.</dd>
<dt><strong><code>auxilary_vars</code></strong> :&ensp;<code>list</code></dt>
<dd>List of auxiliary variables.</dd>
<dt><strong><code>vardir_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of direct variance variables.</dd>
<dt><strong><code>as_factor_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of factors of auxiliary variables.</dd>
<dt><strong><code>selection_method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method of selection.</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method for the model.</dd>
<dt><strong><code>finnish</code></strong> :&ensp;<code>bool</code></dt>
<dd>Flag to indicate if the model run is finished.</dd>
<dt><strong><code>stop_thread</code></strong> :&ensp;<code>threading.Event</code></dt>
<dd>Event to stop the thread.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>closeEvent(event): Handles the close event of the dialog.
set_model(model): Sets the model and updates the variables list.
accept(): Validates inputs and runs the model.
on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    if (not self.vardir_var or self.vardir_var == [&#34;&#34;]) and (not self.of_interest_var or self.of_interest_var == [&#34;&#34;]):
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct and variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    if not self.vardir_var or self.vardir_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    
    r_script = get_script(self)
    if not check_script(r_script):
        return
    disable_service(self)

    view = self.parent
    sae_model = SaeEblup(self.model, self.model2, view)
    controller = SaeController(sae_model)
    
    current_context = contextvars.copy_context()
    
    show_console_first = self.show_console_first_checkbox.isChecked()
    if show_console_first:
        self.console_dialog = ConsoleDialog(self)
        self.console_dialog.show()
    
    def run_model_thread():
        result, error, df = None, None, None
        try:
            if self.console_dialog:
                import sys
                old_stdout = sys.stdout
                sys.stdout = ConsoleStream(self.update_console)
            result, error, df = current_context.run(controller.run_model, r_script)
            if self.console_dialog:
                sys.stdout = old_stdout
            if not error:
                sae_model.model2.set_data(df)
        except Exception as e:
            error = e
        finally:
            if not self.stop_thread.is_set():
                self.finnish = True
                self.run_model_finished.emit(result, error, sae_model, r_script)
            else:
                return

    def check_run_time():
        if thread.is_alive():
            self.parent.autosave_data()
            reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
            if reply == QMessageBox.StandardButton.No:
                self.stop_thread.set()
                QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                enable_service(self, False, &#34;&#34;)


    thread = threading.Thread(target=run_model_thread, name=&#34;SAE EBLUP Area Level&#34;)
    thread.start()

    timer = QTimer(self)
    timer.setSingleShot(True)
    timer.timeout.connect(check_run_time)
    timer.start(60000)</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    if self.console_dialog:
        self.console_dialog.close()
    threads = threading.enumerate()
    for thread in threads:
        if thread.name == &#34;SAE EBLUP Area Level&#34; and thread.is_alive():
            if self.reply is None:
                self.reply = QMessageBox(self)
                self.reply.setWindowTitle(&#39;Run in Background&#39;)
                self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                self.reply.setDefaultButton(QMessageBox.StandardButton.No)
            if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                self.stop_thread.set()
                self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
    self.finnish=False
    self.reply=None
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_list, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_list, items):
    mapping = {
        self.variables_list: &#34;variables&#34;,
        self.of_interest_list: &#34;of_interest&#34;,
        self.auxilary_list: &#34;auxilary&#34;,
        self.as_factor_list: &#34;as_factor&#34;,
        self.vardir_list: &#34;vardir&#34;
    }
    source_list = None
    for lst in mapping:
        if any(item in lst.model().stringList() for item in items):
            source_list = lst
            break

    # Drag dari variables_list ke kanan (assign)
    if source_list == self.variables_list:
        if target_list == self.of_interest_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_of_interest(self)
        elif target_list == self.auxilary_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_auxilary(self)
        elif target_list == self.as_factor_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_as_factor(self)
        elif target_list == self.vardir_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_vardir(self)
            
    
    # Drag dari kanan ke variables_list (unassign)
    elif target_list == self.variables_list:
        if source_list == self.of_interest_list:
            self.of_interest_list.clearSelection()
            for idx, val in enumerate(self.of_interest_model.stringList()):
                if val in items:
                    self.of_interest_list.selectionModel().select(
                        self.of_interest_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.auxilary_list:
            self.auxilary_list.clearSelection()
            for idx, val in enumerate(self.auxilary_model.stringList()):
                if val in items:
                    self.auxilary_list.selectionModel().select(
                        self.auxilary_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.as_factor_list:
            self.as_factor_list.clearSelection()
            for idx, val in enumerate(self.as_factor_model.stringList()):
                if val in items:
                    self.as_factor_list.selectionModel().select(
                        self.as_factor_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.vardir_list:
            self.vardir_list.clearSelection()
            for idx, val in enumerate(self.vardir_model.stringList()):
                if val in items:
                    self.vardir_list.selectionModel().select(
                        self.vardir_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.on_run_model_finished"><code class="name flex">
<span>def <span class="ident">on_run_model_finished</span></span>(<span>self, result, error, sae_model, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def on_run_model_finished(self, result, error, sae_model, r_script):
    if self.console_dialog:
        self.console_dialog.stop_loading()
        self.console_dialog.close()
    if not error:
        self.parent.update_table(2, sae_model.get_model2())
    if self.reply is not None:
        self.reply.reject()
    display_script_and_output(self.parent, r_script, result)
    enable_service(self, error, result)
    self.close()     </code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.run_model_finished"><code class="name flex">
<span>def <span class="ident">run_model_finished</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model):
    self.model = model
    self.columns = [
        f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
        f&#34;{col} [NULL]&#34; if dtype == pl.Null else
        f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
        f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
        f&#34;{col} [Numeric]&#34;
        for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
    ]
    self.variables_model.setStringList(self.columns)
    self.vardir_model.setStringList([])
    self.auxilary_model.setStringList([])
    self.as_factor_model.setStringList([])
    self.of_interest_model.setStringList([])
    self.of_interest_var = []
    self.auxilary_vars = []
    self.vardir_var = []
    self.as_factor_var = []
    self.selection_method = &#34;None&#34;
    self.method = &#34;REML&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.r_script_edit.isVisible()
    self.r_script_edit.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.update_console"><code class="name flex">
<span>def <span class="ident">update_console</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream">ConsoleStream</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream.flush" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream.flush">flush</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream.write" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ConsoleStream.write">write</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog">ModelingSaeDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.accept" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.closeEvent" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.handle_drop" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.on_run_model_finished" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.on_run_model_finished">on_run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.run_model_finished" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.run_model_finished">run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.set_model" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.toggle_r_script_visibility" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.update_console" href="#saePisan.view.components.ModelingSaeEblupAreaDialog.ModelingSaeDialog.update_console">update_console</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_2">
                <div class="file-header">
                    <div>ğŸ“„ ModelingSaeEblupPseudoDialog</div>
                    <div class="file-path">view/components/ModelingSaeEblupPseudoDialog.html (58.0 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ModelingSaeEblupPseudoDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream"><code class="flex name class">
<span>class <span class="ident">ConsoleStream</span></span>
<span>(</span><span>signal)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConsoleStream:
    def __init__(self, signal):
        self.signal = signal
    def write(self, text):
        if text.strip():
            self.signal.emit(text)
    def flush(self):
        pass</code></pre>
</details>
<div class="desc"></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream.flush"><code class="name flex">
<span>def <span class="ident">flush</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flush(self):
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream.write"><code class="name flex">
<span>def <span class="ident">write</span></span>(<span>self, text)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write(self, text):
    if text.strip():
        self.signal.emit(text)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog"><code class="flex name class">
<span>class <span class="ident">ModelingSaePseudoDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ModelingSaePseudoDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for configuring and running the SAE Pseudo Eblup model.
    Attributes:
        run_model_finished (pyqtSignal): Signal emitted when the model run is finished.
        parent (QWidget): The parent widget.
        model2 (object): The second model associated with the parent.
        columns (list): List of column names.
        variables_label (QLabel): Label for the variables list.
        variables_list (QListView): List view for selecting variables.
        variables_model (QStringListModel): Model for the variables list.
        unassign_button (QPushButton): Button to unassign variables.
        assign_of_interest_button (QPushButton): Button to assign variable of interest.
        assign_aux_button (QPushButton): Button to assign auxiliary variables.
        assign_as_factor_button (QPushButton): Button to assign variables as factors.
        assign_vardir_button (QPushButton): Button to assign direct variance.
        assign_domain_button (QPushButton): Button to assign domain.
        of_interest_label (QLabel): Label for the variable of interest list.
        of_interest_list (QListView): List view for the variable of interest.
        of_interest_model (QStringListModel): Model for the variable of interest list.
        auxilary_label (QLabel): Label for the auxiliary variables list.
        auxilary_list (QListView): List view for the auxiliary variables.
        auxilary_model (QStringListModel): Model for the auxiliary variables list.
        as_factor_label (QLabel): Label for the factors of auxiliary variables list.
        as_factor_list (QListView): List view for the factors of auxiliary variables.
        as_factor_model (QStringListModel): Model for the factors of auxiliary variables list.
        vardir_label (QLabel): Label for the direct variance list.
        vardir_list (QListView): List view for the direct variance.
        vardir_model (QStringListModel): Model for the direct variance list.
        domain_label (QLabel): Label for the domain list.
        domain_list (QListView): List view for the domain.
        domain_model (QStringListModel): Model for the domain list.
        option_button (QPushButton): Button to show options.
        text_script (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        r_script_edit (QTextEdit): Text edit for displaying and editing the R script.
        ok_button (QPushButton): Button to run the model.
        of_interest_var (list): List of variables of interest.
        auxilary_vars (list): List of auxiliary variables.
        vardir_var (list): List of direct variance variables.
        as_factor_var (list): List of factors of auxiliary variables.
        domain_var (list): List of domain variables.
        selection_method (str): Method of selection.
        finnish (bool): Flag indicating if the process is finished.
        stop_thread (threading.Event): Event to stop the thread.
    Methods:
        closeEvent(event): Handles the close event of the dialog.
        set_model(model): Sets the model and updates the variables list.
        accept(): Validates input and runs the model.
        on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.
    &#34;&#34;&#34;
    
    run_model_finished = pyqtSignal(object, object, object, object)
    update_console = pyqtSignal(str)
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model2 = parent.model2
        self.setWindowTitle(&#34;SAE Pseudo Eblup&#34;)
        screen_height = self.parent.screen().size().height()
        self.setMinimumHeight(int(round(screen_height * 0.82)))
        self.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)

        self.columns = []

        self.main_layout = QVBoxLayout()
        
        self.scroll_area = QScrollArea()
        self.scroll_area.setWidgetResizable(True)
        self.scroll_content = QWidget()
        self.scroll_layout = QVBoxLayout(self.scroll_content)

        # Layout utama untuk membagi area menjadi dua bagian (kiri dan kanan)
        self.split_layout = QHBoxLayout()

        # Layout kiri untuk daftar variabel
        self.left_layout = QVBoxLayout()
        self.variables_label = QLabel(&#34;Select Variables:&#34;)
        self.variables_list = DragDropListView(parent=self)
        self.variables_model = QStringListModel(self.columns)
        self.variables_list.setModel(self.variables_model)
        self.variables_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.variables_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.left_layout.addWidget(self.variables_label)
        self.left_layout.addWidget(self.variables_list)
        
        self.middle_layout1 = QVBoxLayout()
        self.unassign_button = QPushButton(&#34;ğŸ¡„&#34;)
        self.unassign_button.setObjectName(&#34;arrow_button&#34;)
        self.middle_layout1.addWidget(self.unassign_button)

        # Layout tengah untuk tombol panah
        self.middle_layout = QVBoxLayout()
        self.assign_of_interest_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_of_interest_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_aux_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_as_factor_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_as_factor_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_vardir_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_vardir_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_domain_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_domain_button.setObjectName(&#34;arrow_button&#34;)

        self.assign_of_interest_button.clicked.connect(lambda: assign_of_interest(self))
        self.assign_aux_button.clicked.connect(lambda: assign_auxilary(self))
        self.assign_vardir_button.clicked.connect(lambda: assign_vardir(self))
        self.assign_as_factor_button.clicked.connect(lambda: assign_as_factor(self))
        self.assign_domain_button.clicked.connect(lambda: assign_domain(self))
        self.unassign_button.clicked.connect(lambda: unassign_variable(self))
        self.middle_layout.addWidget(self.assign_of_interest_button)
        self.middle_layout.addWidget(self.assign_aux_button)
        self.middle_layout.addWidget(self.assign_as_factor_button)
        self.middle_layout.addWidget(self.assign_vardir_button)
        self.middle_layout.addWidget(self.assign_domain_button)

        # Layout kanan untuk daftar dependen, independen, vardir, dan major area
        self.right_layout = QVBoxLayout()
        self.of_interest_label = QLabel(&#34;Variable of interest:&#34;)
        self.of_interest_list = DragDropListView(parent=self)
        self.of_interest_model = QStringListModel()
        self.of_interest_list.setModel(self.of_interest_model)
        self.of_interest_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.of_interest_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.of_interest_label)
        self.right_layout.addWidget(self.of_interest_list)

        self.auxilary_label = QLabel(&#34;Auxilary Variable(s):&#34;)
        self.auxilary_list = DragDropListView(parent=self)
        self.auxilary_model = QStringListModel()
        self.auxilary_list.setModel(self.auxilary_model)
        self.auxilary_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.auxilary_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.auxilary_label)
        self.right_layout.addWidget(self.auxilary_list)

        self.as_factor_label = QLabel(&#34;as Factor of Auxilary Variable(s):&#34;)
        self.as_factor_list = DragDropListView(parent=self)
        self.as_factor_model = QStringListModel()
        self.as_factor_list.setModel(self.as_factor_model)
        self.as_factor_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.as_factor_label)
        self.right_layout.addWidget(self.as_factor_list)
        
        self.vardir_label = QLabel(&#34;Direct Variance:&#34;)
        self.vardir_list = DragDropListView(parent=self)
        self.vardir_model = QStringListModel()
        self.vardir_list.setModel(self.vardir_model)
        self.vardir_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.vardir_label)
        self.right_layout.addWidget(self.vardir_list)
        
        self.domain_label = QLabel(&#34;Domain:&#34;)
        self.domain_list = DragDropListView(parent=self)
        self.domain_model = QStringListModel()
        self.domain_list.setModel(self.domain_model)
        self.domain_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.domain_label)
        self.right_layout.addWidget(self.domain_list)

        # Menambahkan layout kiri, tengah, dan kanan ke layout utama
        self.split_layout.addLayout(self.left_layout)
        self.split_layout.addLayout(self.middle_layout1)
        self.split_layout.addLayout(self.middle_layout)
        self.split_layout.addLayout(self.right_layout)

        self.scroll_layout.addLayout(self.split_layout)
        self.scroll_area.setWidget(self.scroll_content)
        self.main_layout.addWidget(self.scroll_area)

        # Tombol untuk menghasilkan skrip R
        self.option_button = QPushButton(&#34;Option&#34;)
        self.option_button.setFixedWidth(150)
        self.text_script = QLabel(&#34;R Script:&#34;)
        
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Create a horizontal layout to place the text_script and icon_label in one row
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)
        
        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.text_script)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)
        
        # Create a horizontal layout to place the text_script and icon_label in one row
        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)

        self.show_console_first_checkbox = QCheckBox(&#34;Show R Console&#34;)
        self.show_console_first_checkbox.setChecked(False)  # default: show before
        # Tambahkan ke layout sebelum tombol Option
        self.main_layout.addWidget(self.show_console_first_checkbox)
        
        self.main_layout.addLayout(self.script_layout)
        
        # self.option_button.clicked.connect(lambda : show_options(self))
        self.option_button.setDisabled(True)
        
        # Area teks untuk menampilkan dan mengedit skrip R
        self.r_script_edit = QTextEdit()
        self.r_script_edit.setFixedHeight(round(screen_height*0.20))
        self.r_script_edit.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.r_script_edit.setReadOnly(False)
        self.r_script_edit.setVisible(False)
        self.main_layout.addWidget(self.r_script_edit)

        # Tombol untuk tindakan dialog
        self.button_layout = QHBoxLayout()
        self.button_layout.setObjectName(&#34;button_layout&#34;)
        self.ok_button = QPushButton(&#34;Run Model&#34;)
        self.ok_button.setFixedWidth(150)
        self.ok_button.clicked.connect(self.accept)
        self.button_layout.addWidget(self.option_button)
        self.button_layout.addWidget(self.ok_button)
        self.main_layout.addLayout(self.button_layout)

        self.setLayout(self.main_layout)

        self.of_interest_var = []
        self.auxilary_vars = []
        self.vardir_var = []
        self.as_factor_var = []
        self.domain_var = [] 
        self.selection_method = &#34;None&#34;
        self.finnish = False
        
        self.run_model_finished.connect(self.on_run_model_finished)
        
        self.stop_thread = threading.Event()
        self.reply=None
        
        self.console_dialog = None
        self.update_console.connect(self._append_console)
        
    def _append_console(self, text):
        if self.console_dialog:
            self.console_dialog.append_text(text)
        
    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.r_script_edit.isVisible()
        self.r_script_edit.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    
    def handle_drop(self, target_list, items):
        mapping = {
            self.variables_list: &#34;variables&#34;,
            self.of_interest_list: &#34;of_interest&#34;,
            self.auxilary_list: &#34;auxilary&#34;,
            self.as_factor_list: &#34;as_factor&#34;,
            self.vardir_list: &#34;vardir&#34;,
            self.domain_list: &#34;domain&#34;
        }
        source_list = None
        for lst in mapping:
            if any(item in lst.model().stringList() for item in items):
                source_list = lst
                break

        # Drag dari variables_list ke kanan (assign)
        if source_list == self.variables_list:
            if target_list == self.of_interest_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_of_interest(self)
            elif target_list == self.auxilary_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_auxilary(self)
            elif target_list == self.as_factor_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_as_factor(self)
            elif target_list == self.vardir_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_vardir(self)
            elif target_list == self.domain_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_domain(self)

        # Drag dari kanan ke variables_list (unassign)
        elif target_list == self.variables_list:
            if source_list == self.of_interest_list:
                self.of_interest_list.clearSelection()
                for idx, val in enumerate(self.of_interest_model.stringList()):
                    if val in items:
                        self.of_interest_list.selectionModel().select(
                            self.of_interest_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.auxilary_list:
                self.auxilary_list.clearSelection()
                for idx, val in enumerate(self.auxilary_model.stringList()):
                    if val in items:
                        self.auxilary_list.selectionModel().select(
                            self.auxilary_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.as_factor_list:
                self.as_factor_list.clearSelection()
                for idx, val in enumerate(self.as_factor_model.stringList()):
                    if val in items:
                        self.as_factor_list.selectionModel().select(
                            self.as_factor_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.vardir_list:
                self.vardir_list.clearSelection()
                for idx, val in enumerate(self.vardir_model.stringList()):
                    if val in items:
                        self.vardir_list.selectionModel().select(
                            self.vardir_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.domain_list:
                self.domain_list.clearSelection()
                for idx, val in enumerate(self.domain_model.stringList()):
                    if val in items:
                        self.domain_list.selectionModel().select(
                            self.domain_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
    
    def closeEvent(self, event):
        if self.console_dialog:
            self.console_dialog.close()
        threads = threading.enumerate()
        for thread in threads:
            if thread.name == &#34;Pseudo&#34; and thread.is_alive():
                if self.reply is None:
                    self.reply = QMessageBox(self)
                    self.reply.setWindowTitle(&#39;Run in Background&#39;)
                    self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                    self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                    self.reply.setDefaultButton(QMessageBox.StandardButton.No)
                if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                    self.stop_thread.set()
                    self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
        self.finnish=False
        self.reply=None
        event.accept()

    def set_model(self, model):
        self.model = model
        self.columns = [
            f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
            f&#34;{col} [NULL]&#34; if dtype == pl.Null else
            f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
            f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
            f&#34;{col} [Numeric]&#34;
            for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
        ]
        self.variables_model.setStringList(self.columns)
        self.vardir_model.setStringList([])
        self.auxilary_model.setStringList([])
        self.as_factor_model.setStringList([])
        self.domain_model.setStringList([])
        self.of_interest_model.setStringList([])
        self.of_interest_var = []
        self.auxilary_vars = []
        self.vardir_var = []
        self.as_factor_var = []
        self.domain_var = []
        self.selection_method = &#34;None&#34;
    
    def accept(self):
        if (not self.vardir_var or self.vardir_var == [&#34;&#34;]) and (not self.of_interest_var or self.of_interest_var == [&#34;&#34;]):
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct and variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        if not self.vardir_var or self.vardir_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        
        r_script = get_script(self)
        if not check_script(r_script):
            return
        disable_service(self)

        view = self.parent
        sae_model = SaeEblupPseudo(self.model, self.model2, view)
        controller = SaePseudoController(sae_model)
        
        show_console_first = self.show_console_first_checkbox.isChecked()
        if show_console_first:
            self.console_dialog = ConsoleDialog(self)
            self.console_dialog.show()
        
        current_context = contextvars.copy_context()
        
        def run_model_thread():
            result, error, df = None, None, None
            try:
                if self.console_dialog:
                    import sys
                    old_stdout = sys.stdout
                    sys.stdout = ConsoleStream(self.update_console)
                result, error, df = current_context.run(controller.run_model, r_script)
                if self.console_dialog:
                    sys.stdout = old_stdout
                if not error:
                    sae_model.model2.set_data(df)
            except Exception as e:
                error = e
            finally:
                if not self.stop_thread.is_set():
                    self.run_model_finished.emit(result, error, sae_model, r_script)
                    self.finnish = True

        def check_run_time():
            if thread.is_alive():
                self.parent.autosave_data()
                reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
                if reply == QMessageBox.StandardButton.No:
                    self.stop_thread.set()
                    QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                    enable_service(self, False, &#34;&#34;)


        thread = threading.Thread(target=run_model_thread, name=&#34;Pseudo&#34;)
        thread.start()

        timer = QTimer(self)
        timer.setSingleShot(True)
        timer.timeout.connect(check_run_time)
        timer.start(60000)
    
    def on_run_model_finished(self, result, error, sae_model, r_script):
        if self.console_dialog:
            self.console_dialog.stop_loading()
            self.console_dialog.close()
        if not error:
            self.parent.update_table(2, sae_model.get_model2())
        if self.reply is not None:
            self.reply.reject()
        display_script_and_output(self.parent, r_script, result)
        enable_service(self, error, result)
        self.finnish = True
        self.close()</code></pre>
</details>
<div class="desc"><p>A dialog for configuring and running the SAE Pseudo Eblup model.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>run_model_finished</code></strong> :&ensp;<code>pyqtSignal</code></dt>
<dd>Signal emitted when the model run is finished.</dd>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model associated with the parent.</dd>
<dt><strong><code>columns</code></strong> :&ensp;<code>list</code></dt>
<dd>List of column names.</dd>
<dt><strong><code>variables_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variables list.</dd>
<dt><strong><code>variables_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for selecting variables.</dd>
<dt><strong><code>variables_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variables list.</dd>
<dt><strong><code>unassign_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to unassign variables.</dd>
<dt><strong><code>assign_of_interest_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variable of interest.</dd>
<dt><strong><code>assign_aux_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary variables.</dd>
<dt><strong><code>assign_as_factor_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variables as factors.</dd>
<dt><strong><code>assign_vardir_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign direct variance.</dd>
<dt><strong><code>assign_domain_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign domain.</dd>
<dt><strong><code>of_interest_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variable of interest list.</dd>
<dt><strong><code>of_interest_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the variable of interest.</dd>
<dt><strong><code>of_interest_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variable of interest list.</dd>
<dt><strong><code>auxilary_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the auxiliary variables list.</dd>
<dt><strong><code>auxilary_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the auxiliary variables.</dd>
<dt><strong><code>auxilary_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the auxiliary variables list.</dd>
<dt><strong><code>as_factor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the factors of auxiliary variables list.</dd>
<dt><strong><code>as_factor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the factors of auxiliary variables.</dd>
<dt><strong><code>as_factor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the factors of auxiliary variables list.</dd>
<dt><strong><code>vardir_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the direct variance list.</dd>
<dt><strong><code>vardir_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the direct variance.</dd>
<dt><strong><code>vardir_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the direct variance list.</dd>
<dt><strong><code>domain_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the domain list.</dd>
<dt><strong><code>domain_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the domain.</dd>
<dt><strong><code>domain_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the domain list.</dd>
<dt><strong><code>option_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to show options.</dd>
<dt><strong><code>text_script</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>r_script_edit</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit for displaying and editing the R script.</dd>
<dt><strong><code>ok_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the model.</dd>
<dt><strong><code>of_interest_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of variables of interest.</dd>
<dt><strong><code>auxilary_vars</code></strong> :&ensp;<code>list</code></dt>
<dd>List of auxiliary variables.</dd>
<dt><strong><code>vardir_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of direct variance variables.</dd>
<dt><strong><code>as_factor_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of factors of auxiliary variables.</dd>
<dt><strong><code>domain_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of domain variables.</dd>
<dt><strong><code>selection_method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method of selection.</dd>
<dt><strong><code>finnish</code></strong> :&ensp;<code>bool</code></dt>
<dd>Flag indicating if the process is finished.</dd>
<dt><strong><code>stop_thread</code></strong> :&ensp;<code>threading.Event</code></dt>
<dd>Event to stop the thread.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>closeEvent(event): Handles the close event of the dialog.
set_model(model): Sets the model and updates the variables list.
accept(): Validates input and runs the model.
on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    if (not self.vardir_var or self.vardir_var == [&#34;&#34;]) and (not self.of_interest_var or self.of_interest_var == [&#34;&#34;]):
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct and variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    if not self.vardir_var or self.vardir_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    
    r_script = get_script(self)
    if not check_script(r_script):
        return
    disable_service(self)

    view = self.parent
    sae_model = SaeEblupPseudo(self.model, self.model2, view)
    controller = SaePseudoController(sae_model)
    
    show_console_first = self.show_console_first_checkbox.isChecked()
    if show_console_first:
        self.console_dialog = ConsoleDialog(self)
        self.console_dialog.show()
    
    current_context = contextvars.copy_context()
    
    def run_model_thread():
        result, error, df = None, None, None
        try:
            if self.console_dialog:
                import sys
                old_stdout = sys.stdout
                sys.stdout = ConsoleStream(self.update_console)
            result, error, df = current_context.run(controller.run_model, r_script)
            if self.console_dialog:
                sys.stdout = old_stdout
            if not error:
                sae_model.model2.set_data(df)
        except Exception as e:
            error = e
        finally:
            if not self.stop_thread.is_set():
                self.run_model_finished.emit(result, error, sae_model, r_script)
                self.finnish = True

    def check_run_time():
        if thread.is_alive():
            self.parent.autosave_data()
            reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
            if reply == QMessageBox.StandardButton.No:
                self.stop_thread.set()
                QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                enable_service(self, False, &#34;&#34;)


    thread = threading.Thread(target=run_model_thread, name=&#34;Pseudo&#34;)
    thread.start()

    timer = QTimer(self)
    timer.setSingleShot(True)
    timer.timeout.connect(check_run_time)
    timer.start(60000)</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    if self.console_dialog:
        self.console_dialog.close()
    threads = threading.enumerate()
    for thread in threads:
        if thread.name == &#34;Pseudo&#34; and thread.is_alive():
            if self.reply is None:
                self.reply = QMessageBox(self)
                self.reply.setWindowTitle(&#39;Run in Background&#39;)
                self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                self.reply.setDefaultButton(QMessageBox.StandardButton.No)
            if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                self.stop_thread.set()
                self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
    self.finnish=False
    self.reply=None
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_list, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_list, items):
    mapping = {
        self.variables_list: &#34;variables&#34;,
        self.of_interest_list: &#34;of_interest&#34;,
        self.auxilary_list: &#34;auxilary&#34;,
        self.as_factor_list: &#34;as_factor&#34;,
        self.vardir_list: &#34;vardir&#34;,
        self.domain_list: &#34;domain&#34;
    }
    source_list = None
    for lst in mapping:
        if any(item in lst.model().stringList() for item in items):
            source_list = lst
            break

    # Drag dari variables_list ke kanan (assign)
    if source_list == self.variables_list:
        if target_list == self.of_interest_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_of_interest(self)
        elif target_list == self.auxilary_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_auxilary(self)
        elif target_list == self.as_factor_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_as_factor(self)
        elif target_list == self.vardir_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_vardir(self)
        elif target_list == self.domain_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_domain(self)

    # Drag dari kanan ke variables_list (unassign)
    elif target_list == self.variables_list:
        if source_list == self.of_interest_list:
            self.of_interest_list.clearSelection()
            for idx, val in enumerate(self.of_interest_model.stringList()):
                if val in items:
                    self.of_interest_list.selectionModel().select(
                        self.of_interest_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.auxilary_list:
            self.auxilary_list.clearSelection()
            for idx, val in enumerate(self.auxilary_model.stringList()):
                if val in items:
                    self.auxilary_list.selectionModel().select(
                        self.auxilary_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.as_factor_list:
            self.as_factor_list.clearSelection()
            for idx, val in enumerate(self.as_factor_model.stringList()):
                if val in items:
                    self.as_factor_list.selectionModel().select(
                        self.as_factor_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.vardir_list:
            self.vardir_list.clearSelection()
            for idx, val in enumerate(self.vardir_model.stringList()):
                if val in items:
                    self.vardir_list.selectionModel().select(
                        self.vardir_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.domain_list:
            self.domain_list.clearSelection()
            for idx, val in enumerate(self.domain_model.stringList()):
                if val in items:
                    self.domain_list.selectionModel().select(
                        self.domain_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.on_run_model_finished"><code class="name flex">
<span>def <span class="ident">on_run_model_finished</span></span>(<span>self, result, error, sae_model, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def on_run_model_finished(self, result, error, sae_model, r_script):
    if self.console_dialog:
        self.console_dialog.stop_loading()
        self.console_dialog.close()
    if not error:
        self.parent.update_table(2, sae_model.get_model2())
    if self.reply is not None:
        self.reply.reject()
    display_script_and_output(self.parent, r_script, result)
    enable_service(self, error, result)
    self.finnish = True
    self.close()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.run_model_finished"><code class="name flex">
<span>def <span class="ident">run_model_finished</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model):
    self.model = model
    self.columns = [
        f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
        f&#34;{col} [NULL]&#34; if dtype == pl.Null else
        f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
        f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
        f&#34;{col} [Numeric]&#34;
        for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
    ]
    self.variables_model.setStringList(self.columns)
    self.vardir_model.setStringList([])
    self.auxilary_model.setStringList([])
    self.as_factor_model.setStringList([])
    self.domain_model.setStringList([])
    self.of_interest_model.setStringList([])
    self.of_interest_var = []
    self.auxilary_vars = []
    self.vardir_var = []
    self.as_factor_var = []
    self.domain_var = []
    self.selection_method = &#34;None&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.r_script_edit.isVisible()
    self.r_script_edit.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.update_console"><code class="name flex">
<span>def <span class="ident">update_console</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream">ConsoleStream</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream.flush" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream.flush">flush</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream.write" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ConsoleStream.write">write</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog">ModelingSaePseudoDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.accept" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.closeEvent" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.handle_drop" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.on_run_model_finished" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.on_run_model_finished">on_run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.run_model_finished" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.run_model_finished">run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.set_model" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.toggle_r_script_visibility" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.update_console" href="#saePisan.view.components.ModelingSaeEblupPseudoDialog.ModelingSaePseudoDialog.update_console">update_console</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_3">
                <div class="file-header">
                    <div>ğŸ“„ ModelingSaeEblupUnitDialog</div>
                    <div class="file-path">view/components/ModelingSaeEblupUnitDialog.html (66.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ModelingSaeEblupUnitDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream"><code class="flex name class">
<span>class <span class="ident">ConsoleStream</span></span>
<span>(</span><span>signal)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConsoleStream:
    def __init__(self, signal):
        self.signal = signal
    def write(self, text):
        if text.strip():
            self.signal.emit(text)
    def flush(self):
        pass</code></pre>
</details>
<div class="desc"></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream.flush"><code class="name flex">
<span>def <span class="ident">flush</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flush(self):
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream.write"><code class="name flex">
<span>def <span class="ident">write</span></span>(<span>self, text)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write(self, text):
    if text.strip():
        self.signal.emit(text)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog"><code class="flex name class">
<span>class <span class="ident">ModelingSaeUnitDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ModelingSaeUnitDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for modeling SAE Eblup Unit.
    Signals:
        run_model_finished (object, object, object, object): Emitted when the model run is finished.
    Attributes:
        parent (QWidget): The parent widget.
        model2 (object): The second model from the parent.
        columns (list): List of column names.
        variables_label (QLabel): Label for the variables list.
        variables_list (QListView): List view for selecting variables.
        variables_model (QStringListModel): Model for the variables list.
        unassign_button (QPushButton): Button to unassign variables.
        assign_of_interest_button (QPushButton): Button to assign variable of interest.
        assign_aux_button (QPushButton): Button to assign auxiliary variables.
        assign_as_factor_button (QPushButton): Button to assign as factor of auxiliary variables.
        assign_domains_button (QPushButton): Button to assign domains.
        assign_index_button (QPushButton): Button to assign index number of area.
        assign_aux_mean_button (QPushButton): Button to assign auxiliary variable means.
        assign_population_sample_size_button (QPushButton): Button to assign population sample size.
        of_interest_label (QLabel): Label for the variable of interest list.
        of_interest_list (QListView): List view for the variable of interest.
        of_interest_model (QStringListModel): Model for the variable of interest list.
        auxilary_label (QLabel): Label for the auxiliary variables list.
        auxilary_list (QListView): List view for the auxiliary variables.
        auxilary_model (QStringListModel): Model for the auxiliary variables list.
        as_factor_label (QLabel): Label for the as factor of auxiliary variables list.
        as_factor_list (QListView): List view for the as factor of auxiliary variables.
        as_factor_model (QStringListModel): Model for the as factor of auxiliary variables list.
        domain_label (QLabel): Label for the domain list.
        domain_list (QListView): List view for the domain.
        domain_model (QStringListModel): Model for the domain list.
        index_label (QLabel): Label for the index number of area list.
        index_list (QListView): List view for the index number of area.
        index_model (QStringListModel): Model for the index number of area list.
        auxilary_vars_mean (QLabel): Label for the auxiliary variable means list.
        auxilary_vars_mean_list (QListView): List view for the auxiliary variable means.
        aux_mean_model (QStringListModel): Model for the auxiliary variable means list.
        population_sample_size (QLabel): Label for the population sample size list.
        population_sample_size_list (QListView): List view for the population sample size.
        population_sample_size_model (QStringListModel): Model for the population sample size list.
        option_button (QPushButton): Button to show options.
        text_script (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        r_script_edit (QTextEdit): Text edit for displaying and editing the R script.
        ok_button (QPushButton): Button to run the model.
        of_interest_var (list): List of variables of interest.
        auxilary_vars (list): List of auxiliary variables.
        index_var (list): List of index variables.
        as_factor_var (list): List of as factor variables.
        domain_var (list): List of domain variables.
        aux_mean_vars (list): List of auxiliary mean variables.
        population_sample_size_var (list): List of population sample size variables.
        selection_method (str): Selection method.
        method (str): Method used for modeling.
        bootstrap (str): Number of bootstrap samples.
        finnish (bool): Flag indicating if the model run is finished.
        stop_thread (threading.Event): Event to stop the thread.
    Methods:
        closeEvent(event): Handles the close event of the dialog.
        set_model(model): Sets the model and updates the variables list.
        accept(): Validates the input and runs the model.
        on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.
    &#34;&#34;&#34;
    
    run_model_finished = pyqtSignal(object, object, object, object)
    update_console = pyqtSignal(str)
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model2 = parent.model2
        self.setWindowTitle(&#34;SAE Eblup&#34;)
        screen_height = self.parent.screen().size().height()
        self.setMinimumHeight(int(round(screen_height * 0.82)))
        self.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)

        self.columns = []

        self.main_layout = QVBoxLayout()

        # Create a scroll area
        self.scroll_area = QScrollArea()
        self.scroll_area.setWidgetResizable(True)
        self.scroll_content = QWidget()
        self.scroll_layout = QVBoxLayout(self.scroll_content)
        self.console_dialog = None
        self.update_console.connect(self._append_console)

        # Layout utama untuk membagi area menjadi dua bagian (kiri dan kanan)
        self.split_layout = QHBoxLayout()

        # Layout kiri untuk daftar variabel
        self.left_layout = QVBoxLayout()
        self.variables_label = QLabel(&#34;Select Variables:&#34;)
        self.variables_list = DragDropListView(parent=self)
        self.variables_model = QStringListModel(self.columns)
        self.variables_list.setModel(self.variables_model)
        self.variables_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.left_layout.addWidget(self.variables_label)
        self.left_layout.addWidget(self.variables_list)
        
        self.middle_layout1 = QVBoxLayout()
        self.unassign_button = QPushButton(&#34;ğŸ¡„&#34;)
        self.unassign_button.setObjectName(&#34;arrow_button&#34;)
        self.middle_layout1.addWidget(self.unassign_button)

        # Layout tengah untuk tombol panah
        self.middle_layout = QVBoxLayout()
        self.assign_of_interest_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_of_interest_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_aux_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_as_factor_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_as_factor_button.setVisible(False)
        self.assign_as_factor_button.setEnabled(False)
        self.assign_as_factor_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_domains_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_domains_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_index_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_index_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_mean_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_aux_mean_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_population_sample_size_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_population_sample_size_button.setObjectName(&#34;arrow_button&#34;)

        self.assign_of_interest_button.clicked.connect(lambda: assign_of_interest(self))
        self.assign_aux_button.clicked.connect(lambda: assign_auxilary(self))
        self.assign_index_button.clicked.connect(lambda: assign_index(self))
        self.assign_as_factor_button.clicked.connect(lambda: assign_as_factor(self))
        self.assign_domains_button.clicked.connect(lambda: assign_domains(self))
        self.assign_aux_mean_button.clicked.connect(lambda: assign_aux_mean(self))
        self.assign_population_sample_size_button.clicked.connect(lambda: assign_population_sample_size(self))
        self.unassign_button.clicked.connect(lambda: unassign_variable(self))
        self.middle_layout.addWidget(self.assign_of_interest_button)
        self.middle_layout.addWidget(self.assign_aux_button)
        self.middle_layout.addWidget(self.assign_as_factor_button)
        self.middle_layout.addWidget(self.assign_domains_button)
        self.middle_layout.addWidget(self.assign_index_button)
        self.middle_layout.addWidget(self.assign_aux_mean_button)
        self.middle_layout.addWidget(self.assign_population_sample_size_button)

        # Layout kanan untuk daftar dependen, independen, vardir, dan major area
        self.right_layout = QVBoxLayout()
        self.of_interest_label = QLabel(&#34;Variable of interest:&#34;)
        self.of_interest_list = DragDropListView(parent=self)
        self.of_interest_model = QStringListModel()
        self.of_interest_list.setModel(self.of_interest_model)
        self.of_interest_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.of_interest_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.of_interest_label)
        self.right_layout.addWidget(self.of_interest_list)

        self.auxilary_label = QLabel(&#34;Auxilary Variable(s):&#34;)
        self.auxilary_list = DragDropListView(parent=self)
        self.auxilary_model = QStringListModel()
        self.auxilary_list.setModel(self.auxilary_model)
        self.auxilary_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.auxilary_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.auxilary_label)
        self.right_layout.addWidget(self.auxilary_list)

        self.as_factor_label = QLabel(&#34;as Factor of Auxilary Variable(s):&#34;)
        self.as_factor_list = DragDropListView(parent=self)
        self.as_factor_model = QStringListModel()
        self.as_factor_list.setModel(self.as_factor_model)
        self.as_factor_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.as_factor_label)
        self.right_layout.addWidget(self.as_factor_list)
        self.as_factor_label.setVisible(False)
        self.as_factor_list.setVisible(False)
        self.as_factor_model.setStringList([])
        
        self.domain_label = QLabel(&#34;Domain:&#34;)
        self.domain_list = DragDropListView(parent=self)
        self.domain_model = QStringListModel()
        self.domain_list.setModel(self.domain_model)
        self.domain_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.domain_label)
        self.right_layout.addWidget(self.domain_list)
        
        self.index_label = QLabel(&#34;Index number of Area:&#34;)
        self.index_list = DragDropListView(parent=self)
        self.index_model = QStringListModel()
        self.index_list.setModel(self.index_model)
        self.index_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.index_label)
        self.right_layout.addWidget(self.index_list)
        
        self.auxilary_vars_mean = QLabel(&#34;Auxilary Variable(s) Mean:&#34;)
        self.auxilary_vars_mean_list = DragDropListView(parent=self)
        self.aux_mean_model = QStringListModel()
        self.auxilary_vars_mean_list.setModel(self.aux_mean_model)
        self.auxilary_vars_mean_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.auxilary_vars_mean)
        self.right_layout.addWidget(self.auxilary_vars_mean_list)
        
        self.population_sample_size = QLabel(&#34;Population Sample Size:&#34;)
        self.population_sample_size_list = DragDropListView(parent=self)
        self.population_sample_size_model = QStringListModel()
        self.population_sample_size_list.setModel(self.population_sample_size_model)
        self.population_sample_size_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.population_sample_size)
        self.right_layout.addWidget(self.population_sample_size_list)
        
        # Menambahkan layout kiri, tengah, dan kanan ke layout utama
        self.split_layout.addLayout(self.left_layout)
        self.split_layout.addLayout(self.middle_layout1)
        self.split_layout.addLayout(self.middle_layout)
        self.split_layout.addLayout(self.right_layout)

        self.scroll_layout.addLayout(self.split_layout)
        self.scroll_area.setWidget(self.scroll_content)
        self.main_layout.addWidget(self.scroll_area)

        # Tombol untuk menghasilkan skrip R
        self.option_button = QPushButton(&#34;Option&#34;)
        self.option_button.setFixedWidth(150)
        self.text_script = QLabel(&#34;R Script:&#34;)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Create a horizontal layout to place the text_script and icon_label in one row
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)
        
        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.text_script)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)
        
        # Create a horizontal layout to place the text_script and icon_label in one row
        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)

        self.show_console_first_checkbox = QCheckBox(&#34;Show R Console&#34;)
        self.show_console_first_checkbox.setChecked(False)  # default: show before
        # Tambahkan ke layout sebelum tombol Option
        self.main_layout.addWidget(self.show_console_first_checkbox)
        
        self.main_layout.addLayout(self.script_layout)
        self.option_button.clicked.connect(lambda : show_options(self))
        
        # Area teks untuk menampilkan dan mengedit skrip R
        self.r_script_edit = QTextEdit()
        self.r_script_edit.setFixedHeight(round(screen_height*0.20))
        self.r_script_edit.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.r_script_edit.setReadOnly(False)
        self.r_script_edit.setVisible(False)
        self.main_layout.addWidget(self.r_script_edit)

        # Tombol untuk tindakan dialog
        self.button_layout = QHBoxLayout()
        self.button_layout.setObjectName(&#34;button_layout&#34;)
        self.ok_button = QPushButton(&#34;Run Model&#34;)
        self.ok_button.setFixedWidth(150)
        self.ok_button.clicked.connect(self.accept)
        self.button_layout.addWidget(self.option_button)
        self.button_layout.addWidget(self.ok_button)
        self.main_layout.addLayout(self.button_layout)

        self.setLayout(self.main_layout)

        self.of_interest_var = []
        self.auxilary_vars = []
        self.index_var = []
        self.as_factor_var = []
        self.domain_var = []
        self.aux_mean_vars = []
        self.population_sample_size_var = []
        self.selection_method = &#34;None&#34;
        self.method = &#34;REML&#34;
        self.bootstrap = &#34;50&#34;
        self.finnish = False
        
        self.run_model_finished.connect(self.on_run_model_finished)
        
        self.reply=None
        self.stop_thread = threading.Event()
        
    def _append_console(self, text):
        if self.console_dialog:
            if any(char.isdigit() for char in text):
                text = f&#34;Bootstrap={text}&#34;
            self.console_dialog.append_text(text)
    
    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.r_script_edit.isVisible()
        self.r_script_edit.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    
    def handle_drop(self, target_list, items):
        &#34;&#34;&#34;
        Handle drag and drop between variable lists.
        &#34;&#34;&#34;
        from PyQt6.QtCore import QItemSelectionModel

        mapping = {
            self.variables_list: &#34;variables&#34;,
            self.of_interest_list: &#34;of_interest&#34;,
            self.auxilary_list: &#34;auxilary&#34;,
            self.as_factor_list: &#34;as_factor&#34;,
            self.domain_list: &#34;domain&#34;,
            self.index_list: &#34;index&#34;,
            self.auxilary_vars_mean_list: &#34;aux_mean&#34;,
            self.population_sample_size_list: &#34;population_sample_size&#34;
        }
        source_list = None
        for lst in mapping:
            if any(item in lst.model().stringList() for item in items):
                source_list = lst
                break

        # Drag dari variables_list ke kanan (assign)
        if source_list == self.variables_list:
            if target_list == self.of_interest_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_of_interest(self)
            elif target_list == self.auxilary_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_auxilary(self)
            elif target_list == self.as_factor_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_as_factor(self)
            elif target_list == self.domain_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_domains(self)
            elif target_list == self.index_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_index(self)
            elif target_list == self.auxilary_vars_mean_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_aux_mean(self)
            elif target_list == self.population_sample_size_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_population_sample_size(self)

        # Drag dari kanan ke variables_list (unassign)
        elif target_list == self.variables_list:
            if source_list == self.of_interest_list:
                self.of_interest_list.clearSelection()
                for idx, val in enumerate(self.of_interest_model.stringList()):
                    if val in items:
                        self.of_interest_list.selectionModel().select(
                            self.of_interest_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.auxilary_list:
                self.auxilary_list.clearSelection()
                for idx, val in enumerate(self.auxilary_model.stringList()):
                    if val in items:
                        self.auxilary_list.selectionModel().select(
                            self.auxilary_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.as_factor_list:
                self.as_factor_list.clearSelection()
                for idx, val in enumerate(self.as_factor_model.stringList()):
                    if val in items:
                        self.as_factor_list.selectionModel().select(
                            self.as_factor_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.domain_list:
                self.domain_list.clearSelection()
                for idx, val in enumerate(self.domain_model.stringList()):
                    if val in items:
                        self.domain_list.selectionModel().select(
                            self.domain_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.index_list:
                self.index_list.clearSelection()
                for idx, val in enumerate(self.index_model.stringList()):
                    if val in items:
                        self.index_list.selectionModel().select(
                            self.index_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.auxilary_vars_mean_list:
                self.auxilary_vars_mean_list.clearSelection()
                for idx, val in enumerate(self.aux_mean_model.stringList()):
                    if val in items:
                        self.auxilary_vars_mean_list.selectionModel().select(
                            self.aux_mean_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.population_sample_size_list:
                self.population_sample_size_list.clearSelection()
                for idx, val in enumerate(self.population_sample_size_model.stringList()):
                    if val in items:
                        self.population_sample_size_list.selectionModel().select(
                            self.population_sample_size_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
    
    def closeEvent(self, event):
        if self.console_dialog:
            self.console_dialog.close()
        threads = threading.enumerate()
        for thread in threads:
            if thread.name == &#34;Unit Level&#34; and thread.is_alive():
                self.parent.autosave_data()
                if self.reply is None:
                    self.reply = QMessageBox(self)
                    self.reply.setWindowTitle(&#39;Run in Background&#39;)
                    self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                    self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                    self.reply.setDefaultButton(QMessageBox.StandardButton.No)
                if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                    self.stop_thread.set()
                    self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
        self.finnish=False
        self.reply=None
        event.accept()
        

    def set_model(self, model):
        self.model = model
        self.columns = [
            f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
            f&#34;{col} [NULL]&#34; if dtype == pl.Null else
            f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
            f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
            f&#34;{col} [Numeric]&#34;
            for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
        ]
        self.variables_model.setStringList(self.columns)
        self.aux_mean_model.setStringList([])
        self.auxilary_model.setStringList([])
        self.of_interest_model.setStringList([])
        self.domain_model.setStringList([])
        self.index_model.setStringList([])
        self.population_sample_size_model.setStringList([])
        self.as_factor_model.setStringList([])
        self.of_interest_var = []
        self.auxilary_vars = []
        self.index_var = []
        self.as_factor_var = []
        self.domain_var = []
        self.aux_mean_vars = []
        self.population_sample_size_var = []
        self.selection_method = &#34;None&#34;
        self.method = &#34;REML&#34;
        self.bootstrap = &#34;50&#34;
    
    def accept(self):
        if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        
        r_script = get_script(self)
        if not check_script(r_script):
            return
        disable_service(self)

        view = self.parent
        sae_model = SaeEblupUnit(self.model, self.model2, view)
        controller = SaeEblupUnitController(sae_model)
        
        current_context = contextvars.copy_context()
        
        show_console_first = self.show_console_first_checkbox.isChecked()
        if show_console_first:
            self.console_dialog = ConsoleDialog(self)
            self.console_dialog.show()
        
        def run_model_thread():
            results, error, df = None, None, None
            try:
                if self.console_dialog:
                    import sys
                    old_stdout = sys.stdout
                    sys.stdout = ConsoleStream(self.update_console)
                results, error, df = current_context.run(controller.run_model, r_script)
                if self.console_dialog:
                    sys.stdout = old_stdout
                if not error:
                    sae_model.model2.set_data(df)
            except Exception as e:
                error = e
            finally:
                if not self.stop_thread.is_set():
                    self.run_model_finished.emit(results, error, sae_model, r_script)
                    self.finnish = True

        def check_run_time():
            if thread.is_alive():
                reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
                if reply == QMessageBox.StandardButton.No:
                    self.stop_thread.set()
                    QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                    enable_service(self, False, &#34;&#34;)


        thread = threading.Thread(target=run_model_thread, name=&#34;Unit Level&#34;)
        thread.start()

        timer = QTimer(self)
        timer.setSingleShot(True)
        timer.timeout.connect(check_run_time)
        timer.start(60000)
    
    def on_run_model_finished(self, results, error, sae_model, r_script):
        if self.console_dialog:
            self.console_dialog.stop_loading()
            self.console_dialog.close()
        if not error:
            self.parent.update_table(2, sae_model.get_model2())
        if self.reply is not None:
            self.reply.reject()
        display_script_and_output(self.parent, r_script, results)
        self.console_dialog.close()
        enable_service(self, error, results)
        self.finnish = True
        self.close()</code></pre>
</details>
<div class="desc"><p>A dialog for modeling SAE Eblup Unit.</p>
<h2 id="signals">Signals</h2>
<p>run_model_finished (object, object, object, object): Emitted when the model run is finished.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model from the parent.</dd>
<dt><strong><code>columns</code></strong> :&ensp;<code>list</code></dt>
<dd>List of column names.</dd>
<dt><strong><code>variables_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variables list.</dd>
<dt><strong><code>variables_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for selecting variables.</dd>
<dt><strong><code>variables_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variables list.</dd>
<dt><strong><code>unassign_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to unassign variables.</dd>
<dt><strong><code>assign_of_interest_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variable of interest.</dd>
<dt><strong><code>assign_aux_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary variables.</dd>
<dt><strong><code>assign_as_factor_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign as factor of auxiliary variables.</dd>
<dt><strong><code>assign_domains_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign domains.</dd>
<dt><strong><code>assign_index_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign index number of area.</dd>
<dt><strong><code>assign_aux_mean_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary variable means.</dd>
<dt><strong><code>assign_population_sample_size_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign population sample size.</dd>
<dt><strong><code>of_interest_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variable of interest list.</dd>
<dt><strong><code>of_interest_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the variable of interest.</dd>
<dt><strong><code>of_interest_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variable of interest list.</dd>
<dt><strong><code>auxilary_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the auxiliary variables list.</dd>
<dt><strong><code>auxilary_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the auxiliary variables.</dd>
<dt><strong><code>auxilary_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the auxiliary variables list.</dd>
<dt><strong><code>as_factor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the as factor of auxiliary variables list.</dd>
<dt><strong><code>as_factor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the as factor of auxiliary variables.</dd>
<dt><strong><code>as_factor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the as factor of auxiliary variables list.</dd>
<dt><strong><code>domain_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the domain list.</dd>
<dt><strong><code>domain_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the domain.</dd>
<dt><strong><code>domain_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the domain list.</dd>
<dt><strong><code>index_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the index number of area list.</dd>
<dt><strong><code>index_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the index number of area.</dd>
<dt><strong><code>index_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the index number of area list.</dd>
<dt><strong><code>auxilary_vars_mean</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the auxiliary variable means list.</dd>
<dt><strong><code>auxilary_vars_mean_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the auxiliary variable means.</dd>
<dt><strong><code>aux_mean_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the auxiliary variable means list.</dd>
<dt><strong><code>population_sample_size</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the population sample size list.</dd>
<dt><strong><code>population_sample_size_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the population sample size.</dd>
<dt><strong><code>population_sample_size_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the population sample size list.</dd>
<dt><strong><code>option_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to show options.</dd>
<dt><strong><code>text_script</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>r_script_edit</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit for displaying and editing the R script.</dd>
<dt><strong><code>ok_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the model.</dd>
<dt><strong><code>of_interest_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of variables of interest.</dd>
<dt><strong><code>auxilary_vars</code></strong> :&ensp;<code>list</code></dt>
<dd>List of auxiliary variables.</dd>
<dt><strong><code>index_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of index variables.</dd>
<dt><strong><code>as_factor_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of as factor variables.</dd>
<dt><strong><code>domain_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of domain variables.</dd>
<dt><strong><code>aux_mean_vars</code></strong> :&ensp;<code>list</code></dt>
<dd>List of auxiliary mean variables.</dd>
<dt><strong><code>population_sample_size_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of population sample size variables.</dd>
<dt><strong><code>selection_method</code></strong> :&ensp;<code>str</code></dt>
<dd>Selection method.</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method used for modeling.</dd>
<dt><strong><code>bootstrap</code></strong> :&ensp;<code>str</code></dt>
<dd>Number of bootstrap samples.</dd>
<dt><strong><code>finnish</code></strong> :&ensp;<code>bool</code></dt>
<dd>Flag indicating if the model run is finished.</dd>
<dt><strong><code>stop_thread</code></strong> :&ensp;<code>threading.Event</code></dt>
<dd>Event to stop the thread.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>closeEvent(event): Handles the close event of the dialog.
set_model(model): Sets the model and updates the variables list.
accept(): Validates the input and runs the model.
on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    
    r_script = get_script(self)
    if not check_script(r_script):
        return
    disable_service(self)

    view = self.parent
    sae_model = SaeEblupUnit(self.model, self.model2, view)
    controller = SaeEblupUnitController(sae_model)
    
    current_context = contextvars.copy_context()
    
    show_console_first = self.show_console_first_checkbox.isChecked()
    if show_console_first:
        self.console_dialog = ConsoleDialog(self)
        self.console_dialog.show()
    
    def run_model_thread():
        results, error, df = None, None, None
        try:
            if self.console_dialog:
                import sys
                old_stdout = sys.stdout
                sys.stdout = ConsoleStream(self.update_console)
            results, error, df = current_context.run(controller.run_model, r_script)
            if self.console_dialog:
                sys.stdout = old_stdout
            if not error:
                sae_model.model2.set_data(df)
        except Exception as e:
            error = e
        finally:
            if not self.stop_thread.is_set():
                self.run_model_finished.emit(results, error, sae_model, r_script)
                self.finnish = True

    def check_run_time():
        if thread.is_alive():
            reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
            if reply == QMessageBox.StandardButton.No:
                self.stop_thread.set()
                QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                enable_service(self, False, &#34;&#34;)


    thread = threading.Thread(target=run_model_thread, name=&#34;Unit Level&#34;)
    thread.start()

    timer = QTimer(self)
    timer.setSingleShot(True)
    timer.timeout.connect(check_run_time)
    timer.start(60000)</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    if self.console_dialog:
        self.console_dialog.close()
    threads = threading.enumerate()
    for thread in threads:
        if thread.name == &#34;Unit Level&#34; and thread.is_alive():
            self.parent.autosave_data()
            if self.reply is None:
                self.reply = QMessageBox(self)
                self.reply.setWindowTitle(&#39;Run in Background&#39;)
                self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                self.reply.setDefaultButton(QMessageBox.StandardButton.No)
            if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                self.stop_thread.set()
                self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
    self.finnish=False
    self.reply=None
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_list, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_list, items):
    &#34;&#34;&#34;
    Handle drag and drop between variable lists.
    &#34;&#34;&#34;
    from PyQt6.QtCore import QItemSelectionModel

    mapping = {
        self.variables_list: &#34;variables&#34;,
        self.of_interest_list: &#34;of_interest&#34;,
        self.auxilary_list: &#34;auxilary&#34;,
        self.as_factor_list: &#34;as_factor&#34;,
        self.domain_list: &#34;domain&#34;,
        self.index_list: &#34;index&#34;,
        self.auxilary_vars_mean_list: &#34;aux_mean&#34;,
        self.population_sample_size_list: &#34;population_sample_size&#34;
    }
    source_list = None
    for lst in mapping:
        if any(item in lst.model().stringList() for item in items):
            source_list = lst
            break

    # Drag dari variables_list ke kanan (assign)
    if source_list == self.variables_list:
        if target_list == self.of_interest_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_of_interest(self)
        elif target_list == self.auxilary_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_auxilary(self)
        elif target_list == self.as_factor_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_as_factor(self)
        elif target_list == self.domain_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_domains(self)
        elif target_list == self.index_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_index(self)
        elif target_list == self.auxilary_vars_mean_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_aux_mean(self)
        elif target_list == self.population_sample_size_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_population_sample_size(self)

    # Drag dari kanan ke variables_list (unassign)
    elif target_list == self.variables_list:
        if source_list == self.of_interest_list:
            self.of_interest_list.clearSelection()
            for idx, val in enumerate(self.of_interest_model.stringList()):
                if val in items:
                    self.of_interest_list.selectionModel().select(
                        self.of_interest_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.auxilary_list:
            self.auxilary_list.clearSelection()
            for idx, val in enumerate(self.auxilary_model.stringList()):
                if val in items:
                    self.auxilary_list.selectionModel().select(
                        self.auxilary_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.as_factor_list:
            self.as_factor_list.clearSelection()
            for idx, val in enumerate(self.as_factor_model.stringList()):
                if val in items:
                    self.as_factor_list.selectionModel().select(
                        self.as_factor_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.domain_list:
            self.domain_list.clearSelection()
            for idx, val in enumerate(self.domain_model.stringList()):
                if val in items:
                    self.domain_list.selectionModel().select(
                        self.domain_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.index_list:
            self.index_list.clearSelection()
            for idx, val in enumerate(self.index_model.stringList()):
                if val in items:
                    self.index_list.selectionModel().select(
                        self.index_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.auxilary_vars_mean_list:
            self.auxilary_vars_mean_list.clearSelection()
            for idx, val in enumerate(self.aux_mean_model.stringList()):
                if val in items:
                    self.auxilary_vars_mean_list.selectionModel().select(
                        self.aux_mean_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.population_sample_size_list:
            self.population_sample_size_list.clearSelection()
            for idx, val in enumerate(self.population_sample_size_model.stringList()):
                if val in items:
                    self.population_sample_size_list.selectionModel().select(
                        self.population_sample_size_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)</code></pre>
</details>
<div class="desc"><p>Handle drag and drop between variable lists.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.on_run_model_finished"><code class="name flex">
<span>def <span class="ident">on_run_model_finished</span></span>(<span>self, results, error, sae_model, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def on_run_model_finished(self, results, error, sae_model, r_script):
    if self.console_dialog:
        self.console_dialog.stop_loading()
        self.console_dialog.close()
    if not error:
        self.parent.update_table(2, sae_model.get_model2())
    if self.reply is not None:
        self.reply.reject()
    display_script_and_output(self.parent, r_script, results)
    self.console_dialog.close()
    enable_service(self, error, results)
    self.finnish = True
    self.close()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.run_model_finished"><code class="name flex">
<span>def <span class="ident">run_model_finished</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model):
    self.model = model
    self.columns = [
        f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
        f&#34;{col} [NULL]&#34; if dtype == pl.Null else
        f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
        f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
        f&#34;{col} [Numeric]&#34;
        for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
    ]
    self.variables_model.setStringList(self.columns)
    self.aux_mean_model.setStringList([])
    self.auxilary_model.setStringList([])
    self.of_interest_model.setStringList([])
    self.domain_model.setStringList([])
    self.index_model.setStringList([])
    self.population_sample_size_model.setStringList([])
    self.as_factor_model.setStringList([])
    self.of_interest_var = []
    self.auxilary_vars = []
    self.index_var = []
    self.as_factor_var = []
    self.domain_var = []
    self.aux_mean_vars = []
    self.population_sample_size_var = []
    self.selection_method = &#34;None&#34;
    self.method = &#34;REML&#34;
    self.bootstrap = &#34;50&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.r_script_edit.isVisible()
    self.r_script_edit.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
<dt id="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.update_console"><code class="name flex">
<span>def <span class="ident">update_console</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream">ConsoleStream</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream.flush" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream.flush">flush</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream.write" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ConsoleStream.write">write</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog">ModelingSaeUnitDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.accept" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.closeEvent" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.handle_drop" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.on_run_model_finished" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.on_run_model_finished">on_run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.run_model_finished" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.run_model_finished">run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.set_model" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.toggle_r_script_visibility" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.update_console" href="#saePisan.view.components.ModelingSaeEblupUnitDialog.ModelingSaeUnitDialog.update_console">update_console</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_4">
                <div class="file-header">
                    <div>ğŸ“„ ModellingSaeHBDialog</div>
                    <div class="file-path">view/components/ModellingSaeHBDialog.html (58.2 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ModellingSaeHBDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ConsoleStream"><code class="flex name class">
<span>class <span class="ident">ConsoleStream</span></span>
<span>(</span><span>signal)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConsoleStream:
    def __init__(self, signal):
        self.signal = signal
    def write(self, text):
        if text.strip():
            self.signal.emit(text)
    def flush(self):
        pass</code></pre>
</details>
<div class="desc"></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ConsoleStream.flush"><code class="name flex">
<span>def <span class="ident">flush</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flush(self):
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ConsoleStream.write"><code class="name flex">
<span>def <span class="ident">write</span></span>(<span>self, text)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write(self, text):
    if text.strip():
        self.signal.emit(text)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog"><code class="flex name class">
<span>class <span class="ident">ModelingSaeHBDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ModelingSaeHBDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for configuring and running the SAE HB Beta model.
    Attributes:
        run_model_finished (pyqtSignal): Signal emitted when the model run is finished.
        parent (QWidget): The parent widget.
        model2 (Model): The secondary model from the parent.
        columns (list): List of column names.
        model_method (str): The method used for the model, default is &#34;Beta&#34;.
        variables_label (QLabel): Label for the variables list.
        variables_list (QListView): List view for selecting variables.
        variables_model (QStringListModel): Model for the variables list.
        unassign_button (QPushButton): Button to unassign variables.
        assign_of_interest_button (QPushButton): Button to assign variable of interest.
        assign_aux_button (QPushButton): Button to assign auxiliary variables.
        assign_as_factor_button (QPushButton): Button to assign as factor of auxiliary variables.
        assign_vardir_button (QPushButton): Button to assign direct variance.
        of_interest_label (QLabel): Label for the variable of interest list.
        of_interest_list (QListView): List view for the variable of interest.
        of_interest_model (QStringListModel): Model for the variable of interest list.
        auxilary_label (QLabel): Label for the auxiliary variables list.
        auxilary_list (QListView): List view for the auxiliary variables.
        auxilary_model (QStringListModel): Model for the auxiliary variables list.
        as_factor_label (QLabel): Label for the factor of auxiliary variables list.
        as_factor_list (QListView): List view for the factor of auxiliary variables.
        as_factor_model (QStringListModel): Model for the factor of auxiliary variables list.
        vardir_label (QLabel): Label for the direct variance list.
        vardir_list (QListView): List view for the direct variance.
        vardir_model (QStringListModel): Model for the direct variance list.
        option_button (QPushButton): Button to show options.
        text_script (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        r_script_edit (QTextEdit): Text edit area for the R script.
        ok_button (QPushButton): Button to run the model.
        of_interest_var (list): List of variables of interest.
        auxilary_vars (list): List of auxiliary variables.
        vardir_var (list): List of direct variance variables.
        as_factor_var (list): List of factor of auxiliary variables.
        selection_method (str): Method of selection.
        iter_update (str): Number of update iterations.
        iter_mcmc (str): Number of MCMC iterations.
        burn_in (str): Number of burn-in iterations.
        stop_thread (threading.Event): Event to stop the thread.
        finnish (bool): Flag to indicate if the process is finished.
    Methods:
        closeEvent(event): Handles the close event of the dialog.
        set_model(model): Sets the model and updates the variables list.
        accept(): Validates inputs and runs the model.
        on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.
    &#34;&#34;&#34;
    
    run_model_finished = pyqtSignal(object, object, object, object, object)
    update_console = pyqtSignal(str)
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model2 = parent.model2
        self.setWindowTitle(&#34;SAE HB Beta&#34;)
        screen_height = self.parent.screen().size().height()
        self.setMinimumHeight(int(round(screen_height * 0.82)))
        self.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)

        self.columns = []
        self.model_method = &#34;Beta&#34;

        self.main_layout = QVBoxLayout()

        # Layout utama untuk membagi area menjadi dua bagian (kiri dan kanan)
        self.split_layout = QHBoxLayout()

        # Layout kiri untuk daftar variabel
        self.left_layout = QVBoxLayout()
        self.variables_label = QLabel(&#34;Select Variables:&#34;)
        self.variables_list = DragDropListView(parent=self)
        self.variables_model = QStringListModel(self.columns)
        self.variables_list.setModel(self.variables_model)
        self.variables_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.left_layout.addWidget(self.variables_label)
        self.left_layout.addWidget(self.variables_list)
        
        self.middle_layout1 = QVBoxLayout()
        self.unassign_button = QPushButton(&#34;ğŸ¡„&#34;)
        self.unassign_button.setObjectName(&#34;arrow_button&#34;)
        self.middle_layout1.addWidget(self.unassign_button)

        # Layout tengah untuk tombol panah
        self.middle_layout = QVBoxLayout()
        self.assign_of_interest_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_of_interest_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_aux_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_as_factor_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_as_factor_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_vardir_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_vardir_button.setObjectName(&#34;arrow_button&#34;)

        self.assign_of_interest_button.clicked.connect(lambda: assign_of_interest(self))
        self.assign_aux_button.clicked.connect(lambda: assign_auxilary(self))
        self.assign_vardir_button.clicked.connect(lambda: assign_vardir(self))
        self.assign_as_factor_button.clicked.connect(lambda: assign_as_factor(self))
        self.unassign_button.clicked.connect(lambda: unassign_variable(self))
        self.middle_layout.addWidget(self.assign_of_interest_button)
        self.middle_layout.addWidget(self.assign_aux_button)
        self.middle_layout.addWidget(self.assign_as_factor_button)
        self.middle_layout.addWidget(self.assign_vardir_button)

        # Layout kanan untuk daftar dependen, independen, vardir, dan major area
        self.right_layout = QVBoxLayout()
        self.of_interest_label = QLabel(&#34;Variable of interest:&#34;)
        self.of_interest_list = DragDropListView(parent=self)
        self.of_interest_model = QStringListModel()
        self.of_interest_list.setModel(self.of_interest_model)
        self.of_interest_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.of_interest_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.of_interest_label)
        self.right_layout.addWidget(self.of_interest_list)

        self.auxilary_label = QLabel(&#34;Auxilary Variable(s):&#34;)
        self.auxilary_list = DragDropListView(parent=self)
        self.auxilary_model = QStringListModel()
        self.auxilary_list.setModel(self.auxilary_model)
        self.auxilary_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.auxilary_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.auxilary_label)
        self.right_layout.addWidget(self.auxilary_list)

        self.as_factor_label = QLabel(&#34;as Factor of Auxilary Variable(s):&#34;)
        self.as_factor_list = DragDropListView(parent=self)
        self.as_factor_model = QStringListModel()
        self.as_factor_list.setModel(self.as_factor_model)
        self.as_factor_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.as_factor_label)
        self.right_layout.addWidget(self.as_factor_list)
        
        self.vardir_label = QLabel(&#34;Direct Variance:&#34;)
        self.vardir_list = DragDropListView(parent=self)
        self.vardir_model = QStringListModel()
        self.vardir_list.setModel(self.vardir_model)
        self.vardir_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.vardir_label)
        self.right_layout.addWidget(self.vardir_list)

        # Menambahkan layout kiri, tengah, dan kanan ke layout utama
        self.split_layout.addLayout(self.left_layout)
        self.split_layout.addLayout(self.middle_layout1)
        self.split_layout.addLayout(self.middle_layout)
        self.split_layout.addLayout(self.right_layout)

        self.main_layout.addLayout(self.split_layout)

        # Tombol untuk menghasilkan skrip R
        self.option_button = QPushButton(&#34;Option&#34;)
        self.option_button.setFixedWidth(150)
        self.text_script = QLabel(&#34;R Script:&#34;)
        self.option_button.clicked.connect(lambda : show_options(self))
        
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Create a horizontal layout to place the text_script and icon_label in one row
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)
        
        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.text_script)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)
        
        # Create a horizontal layout to place the text_script and icon_label in one row
        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)

        self.show_console_first_checkbox = QCheckBox(&#34;Show R Console&#34;)
        self.show_console_first_checkbox.setChecked(False)  # default: show before
        # Tambahkan ke layout sebelum tombol Option
        self.main_layout.addWidget(self.show_console_first_checkbox)
        
        self.main_layout.addLayout(self.script_layout)
        
        # Area teks untuk menampilkan dan mengedit skrip R
        self.r_script_edit = QTextEdit()
        self.r_script_edit.setFixedHeight(round(screen_height*0.20))
        self.r_script_edit.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.r_script_edit.setReadOnly(False)
        self.r_script_edit.setVisible(False)
        self.main_layout.addWidget(self.r_script_edit)

        # Tombol untuk tindakan dialog
        self.button_layout = QHBoxLayout()
        self.button_layout.setObjectName(&#34;button_layout&#34;)
        self.ok_button = QPushButton(&#34;Run Model&#34;)
        self.ok_button.setFixedWidth(150)
        self.ok_button.clicked.connect(self.accept)
        self.button_layout.addWidget(self.option_button)
        self.button_layout.addWidget(self.ok_button)
        self.main_layout.addLayout(self.button_layout)

        self.setLayout(self.main_layout)

        self.of_interest_var = []
        self.auxilary_vars = []
        self.vardir_var = []
        self.as_factor_var = []
        self.selection_method = &#34;None&#34;
        self.iter_update=&#34;3&#34;
        self.iter_mcmc=&#34;2000&#34;
        
        self.burn_in=&#34;1000&#34;
        
        self.run_model_finished.connect(self.on_run_model_finished)
        
        self.stop_thread = threading.Event()
        self.reply=None
        self.finnish = False
        
        self.console_dialog = None
        self.update_console.connect(self._append_console)
        
    def _append_console(self, text):
        self.console_dialog.append_text(text)
        
    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.r_script_edit.isVisible()
        self.r_script_edit.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    
    def closeEvent(self, event):
        if self.console_dialog:
            self.console_dialog.close()
        threads = threading.enumerate()
        for thread in threads:
            if thread.name == &#34;SAE HB&#34; and thread.is_alive():
                self.parent.autosave_data()
                if self.reply is None:
                    self.reply = QMessageBox(self)
                    self.reply.setWindowTitle(&#39;Run in Background&#39;)
                    self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                    self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                    self.reply.setDefaultButton(QMessageBox.StandardButton.No)
                if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                    self.stop_thread.set()
                    print(self.stop_thread.is_set())
                    self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;, None)
        self.finnish=False
        self.reply=None
        event.accept()

    def set_model(self, model):
        self.model = model
        self.columns = [
            f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
            f&#34;{col} [NULL]&#34; if dtype == pl.Null else
            f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
            f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
            f&#34;{col} [Numeric]&#34;
            for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
        ]
        self.variables_model.setStringList(self.columns)
        self.of_interest_model.setStringList([])
        self.auxilary_model.setStringList([])
        self.as_factor_model.setStringList([])
        self.vardir_model.setStringList([])
        self.of_interest_var = []
        self.auxilary_vars = []
        self.vardir_var = []
        self.as_factor_var = []
        self.selection_method = &#34;None&#34;
        self.iter_update=&#34;3&#34;
        self.iter_mcmc=&#34;2000&#34;
        self.burn_in=&#34;1000&#34;
    
    def handle_drop(self, target_list, items):
        from PyQt6.QtCore import QItemSelectionModel
        mapping = {
            self.variables_list: &#34;variables&#34;,
            self.of_interest_list: &#34;of_interest&#34;,
            self.auxilary_list: &#34;auxilary&#34;,
            self.as_factor_list: &#34;as_factor&#34;,
            self.vardir_list: &#34;vardir&#34;
        }
        source_list = None
        for lst in mapping:
            if any(item in lst.model().stringList() for item in items):
                source_list = lst
                break

        # Drag dari variables_list ke kanan (assign)
        if source_list == self.variables_list:
            if target_list == self.of_interest_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_of_interest(self)
            elif target_list == self.auxilary_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_auxilary(self)
            elif target_list == self.as_factor_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_as_factor(self)
            elif target_list == self.vardir_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_vardir(self)

        # Drag dari kanan ke variables_list (unassign)
        elif target_list == self.variables_list:
            if source_list == self.of_interest_list:
                self.of_interest_list.clearSelection()
                for idx, val in enumerate(self.of_interest_model.stringList()):
                    if val in items:
                        self.of_interest_list.selectionModel().select(
                            self.of_interest_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.auxilary_list:
                self.auxilary_list.clearSelection()
                for idx, val in enumerate(self.auxilary_model.stringList()):
                    if val in items:
                        self.auxilary_list.selectionModel().select(
                            self.auxilary_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.as_factor_list:
                self.as_factor_list.clearSelection()
                for idx, val in enumerate(self.as_factor_model.stringList()):
                    if val in items:
                        self.as_factor_list.selectionModel().select(
                            self.as_factor_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
            elif source_list == self.vardir_list:
                self.vardir_list.clearSelection()
                for idx, val in enumerate(self.vardir_model.stringList()):
                    if val in items:
                        self.vardir_list.selectionModel().select(
                            self.vardir_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)
    
    import sys
    class ConsoleStream:
        def __init__(self, signal):
            self.signal = signal
        def write(self, text):
            if text.strip():
                self.signal.emit(text)
        def flush(self):
            pass
    
    def accept(self):
        if (not self.vardir_var or self.vardir_var == [&#34;&#34;]) and (not self.of_interest_var or self.of_interest_var == [&#34;&#34;]):
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct and variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        if not self.vardir_var or self.vardir_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        
        data = self.model.get_data()
        variable = self.of_interest_var[0].split(&#39;[&#39;)[0].strip()
        if not (data[variable].dtype == pl.Float64 and (data[variable] &gt;= 0).all() and (data[variable] &lt;= 1).all()):
            QMessageBox.warning(self, &#34;Warning&#34;, f&#34;The &#39;{variable}&#39; column must be of type float and have values between 0 and 1.&#34;)
            return
        
        r_script = get_script(self)
        if not check_script(r_script):
            return
        
        disable_service(self)

        view = self.parent
        sae_model = SaeHB(self.model, self.model2, view)
        controller = SaeHBController(sae_model)
        
        current_context = contextvars.copy_context()
        
        show_console_first = self.show_console_first_checkbox.isChecked()
        if show_console_first:
            self.console_dialog = ConsoleDialog(self)
            self.console_dialog.show()
        
        def run_model_thread():
            import sys
            results, error, df = None, None, None
            try:
                if self.console_dialog:
                    old_stdout = sys.stdout
                    sys.stdout = ConsoleStream(self.update_console)
                result, error, df, plot_paths = current_context.run(controller.run_model, r_script)
                if self.console_dialog:
                    sys.stdout = old_stdout
                if not error:
                    sae_model.model2.set_data(df)
            except Exception as e:
                error=True
                if result is None:
                    result = str(e)
            finally:
                if not self.stop_thread.is_set():
                    self.run_model_finished.emit(result, error, sae_model, r_script, plot_paths)
                    self.finnish = True
                    return
                else:
                    import os
                    temp_dir = os.path.join(os.getcwd(), &#34;temp&#34;)
                    if os.path.exists(temp_dir):
                        for file in os.listdir(temp_dir):
                            file_path = os.path.join(temp_dir, file)
                            try:
                                if os.path.isfile(file_path):
                                    os.remove(file_path)
                            except Exception as e:
                                print(f&#34;Error deleting file {file_path}: {e}&#34;)

        def check_run_time():
            if thread.is_alive():
                reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
                if reply == QMessageBox.StandardButton.No:
                    self.stop_thread.set()
                    print(self.stop_thread.is_set())
                    QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                    enable_service(self, False, &#34;&#34;)


        thread = threading.Thread(target=run_model_thread, name=&#34;SAE HB&#34;)
        thread.start()

        timer = QTimer(self)
        timer.setSingleShot(True)
        timer.timeout.connect(check_run_time)
        timer.start(60000)
    
    def on_run_model_finished(self, result, error, sae_model, r_script, plot_paths):
        if self.console_dialog:
            self.console_dialog.stop_loading()
            self.console_dialog.close()
        if not error:
            self.parent.update_table(2, sae_model.get_model2())
        if self.reply is not None:
            self.reply.reject()
        display_script_and_output(self.parent, r_script, result, plot_paths)
        enable_service(self, error, result)
        self.finnish = True
        self.close()</code></pre>
</details>
<div class="desc"><p>A dialog for configuring and running the SAE HB Beta model.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>run_model_finished</code></strong> :&ensp;<code>pyqtSignal</code></dt>
<dd>Signal emitted when the model run is finished.</dd>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Model</code></dt>
<dd>The secondary model from the parent.</dd>
<dt><strong><code>columns</code></strong> :&ensp;<code>list</code></dt>
<dd>List of column names.</dd>
<dt><strong><code>model_method</code></strong> :&ensp;<code>str</code></dt>
<dd>The method used for the model, default is "Beta".</dd>
<dt><strong><code>variables_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variables list.</dd>
<dt><strong><code>variables_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for selecting variables.</dd>
<dt><strong><code>variables_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variables list.</dd>
<dt><strong><code>unassign_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to unassign variables.</dd>
<dt><strong><code>assign_of_interest_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variable of interest.</dd>
<dt><strong><code>assign_aux_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary variables.</dd>
<dt><strong><code>assign_as_factor_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign as factor of auxiliary variables.</dd>
<dt><strong><code>assign_vardir_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign direct variance.</dd>
<dt><strong><code>of_interest_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variable of interest list.</dd>
<dt><strong><code>of_interest_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the variable of interest.</dd>
<dt><strong><code>of_interest_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variable of interest list.</dd>
<dt><strong><code>auxilary_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the auxiliary variables list.</dd>
<dt><strong><code>auxilary_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the auxiliary variables.</dd>
<dt><strong><code>auxilary_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the auxiliary variables list.</dd>
<dt><strong><code>as_factor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the factor of auxiliary variables list.</dd>
<dt><strong><code>as_factor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the factor of auxiliary variables.</dd>
<dt><strong><code>as_factor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the factor of auxiliary variables list.</dd>
<dt><strong><code>vardir_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the direct variance list.</dd>
<dt><strong><code>vardir_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the direct variance.</dd>
<dt><strong><code>vardir_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the direct variance list.</dd>
<dt><strong><code>option_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to show options.</dd>
<dt><strong><code>text_script</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>r_script_edit</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit area for the R script.</dd>
<dt><strong><code>ok_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the model.</dd>
<dt><strong><code>of_interest_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of variables of interest.</dd>
<dt><strong><code>auxilary_vars</code></strong> :&ensp;<code>list</code></dt>
<dd>List of auxiliary variables.</dd>
<dt><strong><code>vardir_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of direct variance variables.</dd>
<dt><strong><code>as_factor_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of factor of auxiliary variables.</dd>
<dt><strong><code>selection_method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method of selection.</dd>
<dt><strong><code>iter_update</code></strong> :&ensp;<code>str</code></dt>
<dd>Number of update iterations.</dd>
<dt><strong><code>iter_mcmc</code></strong> :&ensp;<code>str</code></dt>
<dd>Number of MCMC iterations.</dd>
<dt><strong><code>burn_in</code></strong> :&ensp;<code>str</code></dt>
<dd>Number of burn-in iterations.</dd>
<dt><strong><code>stop_thread</code></strong> :&ensp;<code>threading.Event</code></dt>
<dd>Event to stop the thread.</dd>
<dt><strong><code>finnish</code></strong> :&ensp;<code>bool</code></dt>
<dd>Flag to indicate if the process is finished.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>closeEvent(event): Handles the close event of the dialog.
set_model(model): Sets the model and updates the variables list.
accept(): Validates inputs and runs the model.
on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.ConsoleStream"><code class="name">var <span class="ident">ConsoleStream</span></code></dt>
<dd>
<div class="desc"><p>The type of the None singleton.</p></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.sys"><code class="name">var <span class="ident">sys</span></code></dt>
<dd>
<div class="desc"><p>The type of the None singleton.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    if (not self.vardir_var or self.vardir_var == [&#34;&#34;]) and (not self.of_interest_var or self.of_interest_var == [&#34;&#34;]):
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct and variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    if not self.vardir_var or self.vardir_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Varians Direct cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    
    data = self.model.get_data()
    variable = self.of_interest_var[0].split(&#39;[&#39;)[0].strip()
    if not (data[variable].dtype == pl.Float64 and (data[variable] &gt;= 0).all() and (data[variable] &lt;= 1).all()):
        QMessageBox.warning(self, &#34;Warning&#34;, f&#34;The &#39;{variable}&#39; column must be of type float and have values between 0 and 1.&#34;)
        return
    
    r_script = get_script(self)
    if not check_script(r_script):
        return
    
    disable_service(self)

    view = self.parent
    sae_model = SaeHB(self.model, self.model2, view)
    controller = SaeHBController(sae_model)
    
    current_context = contextvars.copy_context()
    
    show_console_first = self.show_console_first_checkbox.isChecked()
    if show_console_first:
        self.console_dialog = ConsoleDialog(self)
        self.console_dialog.show()
    
    def run_model_thread():
        import sys
        results, error, df = None, None, None
        try:
            if self.console_dialog:
                old_stdout = sys.stdout
                sys.stdout = ConsoleStream(self.update_console)
            result, error, df, plot_paths = current_context.run(controller.run_model, r_script)
            if self.console_dialog:
                sys.stdout = old_stdout
            if not error:
                sae_model.model2.set_data(df)
        except Exception as e:
            error=True
            if result is None:
                result = str(e)
        finally:
            if not self.stop_thread.is_set():
                self.run_model_finished.emit(result, error, sae_model, r_script, plot_paths)
                self.finnish = True
                return
            else:
                import os
                temp_dir = os.path.join(os.getcwd(), &#34;temp&#34;)
                if os.path.exists(temp_dir):
                    for file in os.listdir(temp_dir):
                        file_path = os.path.join(temp_dir, file)
                        try:
                            if os.path.isfile(file_path):
                                os.remove(file_path)
                        except Exception as e:
                            print(f&#34;Error deleting file {file_path}: {e}&#34;)

    def check_run_time():
        if thread.is_alive():
            reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
            if reply == QMessageBox.StandardButton.No:
                self.stop_thread.set()
                print(self.stop_thread.is_set())
                QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                enable_service(self, False, &#34;&#34;)


    thread = threading.Thread(target=run_model_thread, name=&#34;SAE HB&#34;)
    thread.start()

    timer = QTimer(self)
    timer.setSingleShot(True)
    timer.timeout.connect(check_run_time)
    timer.start(60000)</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    if self.console_dialog:
        self.console_dialog.close()
    threads = threading.enumerate()
    for thread in threads:
        if thread.name == &#34;SAE HB&#34; and thread.is_alive():
            self.parent.autosave_data()
            if self.reply is None:
                self.reply = QMessageBox(self)
                self.reply.setWindowTitle(&#39;Run in Background&#39;)
                self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                self.reply.setDefaultButton(QMessageBox.StandardButton.No)
            if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                self.stop_thread.set()
                print(self.stop_thread.is_set())
                self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;, None)
    self.finnish=False
    self.reply=None
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_list, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_list, items):
    from PyQt6.QtCore import QItemSelectionModel
    mapping = {
        self.variables_list: &#34;variables&#34;,
        self.of_interest_list: &#34;of_interest&#34;,
        self.auxilary_list: &#34;auxilary&#34;,
        self.as_factor_list: &#34;as_factor&#34;,
        self.vardir_list: &#34;vardir&#34;
    }
    source_list = None
    for lst in mapping:
        if any(item in lst.model().stringList() for item in items):
            source_list = lst
            break

    # Drag dari variables_list ke kanan (assign)
    if source_list == self.variables_list:
        if target_list == self.of_interest_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_of_interest(self)
        elif target_list == self.auxilary_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_auxilary(self)
        elif target_list == self.as_factor_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_as_factor(self)
        elif target_list == self.vardir_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_vardir(self)

    # Drag dari kanan ke variables_list (unassign)
    elif target_list == self.variables_list:
        if source_list == self.of_interest_list:
            self.of_interest_list.clearSelection()
            for idx, val in enumerate(self.of_interest_model.stringList()):
                if val in items:
                    self.of_interest_list.selectionModel().select(
                        self.of_interest_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.auxilary_list:
            self.auxilary_list.clearSelection()
            for idx, val in enumerate(self.auxilary_model.stringList()):
                if val in items:
                    self.auxilary_list.selectionModel().select(
                        self.auxilary_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.as_factor_list:
            self.as_factor_list.clearSelection()
            for idx, val in enumerate(self.as_factor_model.stringList()):
                if val in items:
                    self.as_factor_list.selectionModel().select(
                        self.as_factor_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)
        elif source_list == self.vardir_list:
            self.vardir_list.clearSelection()
            for idx, val in enumerate(self.vardir_model.stringList()):
                if val in items:
                    self.vardir_list.selectionModel().select(
                        self.vardir_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            unassign_variable(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.on_run_model_finished"><code class="name flex">
<span>def <span class="ident">on_run_model_finished</span></span>(<span>self, result, error, sae_model, r_script, plot_paths)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def on_run_model_finished(self, result, error, sae_model, r_script, plot_paths):
    if self.console_dialog:
        self.console_dialog.stop_loading()
        self.console_dialog.close()
    if not error:
        self.parent.update_table(2, sae_model.get_model2())
    if self.reply is not None:
        self.reply.reject()
    display_script_and_output(self.parent, r_script, result, plot_paths)
    enable_service(self, error, result)
    self.finnish = True
    self.close()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.run_model_finished"><code class="name flex">
<span>def <span class="ident">run_model_finished</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model):
    self.model = model
    self.columns = [
        f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
        f&#34;{col} [NULL]&#34; if dtype == pl.Null else
        f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
        f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
        f&#34;{col} [Numeric]&#34;
        for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
    ]
    self.variables_model.setStringList(self.columns)
    self.of_interest_model.setStringList([])
    self.auxilary_model.setStringList([])
    self.as_factor_model.setStringList([])
    self.vardir_model.setStringList([])
    self.of_interest_var = []
    self.auxilary_vars = []
    self.vardir_var = []
    self.as_factor_var = []
    self.selection_method = &#34;None&#34;
    self.iter_update=&#34;3&#34;
    self.iter_mcmc=&#34;2000&#34;
    self.burn_in=&#34;1000&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.r_script_edit.isVisible()
    self.r_script_edit.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
<dt id="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.update_console"><code class="name flex">
<span>def <span class="ident">update_console</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ModellingSaeHBDialog.ConsoleStream" href="#saePisan.view.components.ModellingSaeHBDialog.ConsoleStream">ConsoleStream</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ConsoleStream.flush" href="#saePisan.view.components.ModellingSaeHBDialog.ConsoleStream.flush">flush</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ConsoleStream.write" href="#saePisan.view.components.ModellingSaeHBDialog.ConsoleStream.write">write</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog">ModelingSaeHBDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.ConsoleStream" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.ConsoleStream">ConsoleStream</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.accept" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.closeEvent" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.handle_drop" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.on_run_model_finished" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.on_run_model_finished">on_run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.run_model_finished" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.run_model_finished">run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.set_model" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.sys" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.sys">sys</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.toggle_r_script_visibility" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.update_console" href="#saePisan.view.components.ModellingSaeHBDialog.ModelingSaeHBDialog.update_console">update_console</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_5">
                <div class="file-header">
                    <div>ğŸ“„ ModellingSaeHbNormal</div>
                    <div class="file-path">view/components/ModellingSaeHbNormal.html (8.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ModellingSaeHbNormal</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ModellingSaeHbNormal.ModelingSaeHBNormalDialog"><code class="flex name class">
<span>class <span class="ident">ModelingSaeHBNormalDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ModelingSaeHBNormalDialog(ModelingSaeHBDialog):
    &#34;&#34;&#34;
    A dialog class for modeling SAE HB with a normal distribution.
    Inherits from:
        ModelingSaeHBDialog: The base class for SAE HB modeling dialogs.
    Attributes:
        model_method (str): The method used for modeling, set to &#34;Normal&#34;.
    Methods:
        __init__(parent): Initializes the dialog with the given parent.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.setWindowTitle(&#34;SAE HB Normal&#34;)
        self.model_method = &#34;Normal&#34;</code></pre>
</details>
<div class="desc"><p>A dialog class for modeling SAE HB with a normal distribution.
Inherits from:
ModelingSaeHBDialog: The base class for SAE HB modeling dialogs.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>model_method</code></strong> :&ensp;<code>str</code></dt>
<dd>The method used for modeling, set to "Normal".</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(parent): Initializes the dialog with the given parent.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>view.components.ModellingSaeHBDialog.ModelingSaeHBDialog</li>
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ModellingSaeHbNormal.ModelingSaeHBNormalDialog" href="#saePisan.view.components.ModellingSaeHbNormal.ModelingSaeHBNormalDialog">ModelingSaeHBNormalDialog</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_6">
                <div class="file-header">
                    <div>ğŸ“„ ProjectionDialog</div>
                    <div class="file-path">view/components/ProjectionDialog.html (68.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.ProjectionDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.ProjectionDialog.ConsoleStream"><code class="flex name class">
<span>class <span class="ident">ConsoleStream</span></span>
<span>(</span><span>signal)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ConsoleStream:
    def __init__(self, signal):
        self.signal = signal
    def write(self, text):
        if text.strip():
            self.signal.emit(text)
    def flush(self):
        pass</code></pre>
</details>
<div class="desc"></div>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ProjectionDialog.ConsoleStream.flush"><code class="name flex">
<span>def <span class="ident">flush</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flush(self):
    pass</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ConsoleStream.write"><code class="name flex">
<span>def <span class="ident">write</span></span>(<span>self, text)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write(self, text):
    if text.strip():
        self.signal.emit(text)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog"><code class="flex name class">
<span>class <span class="ident">ProjectionDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ProjectionDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for configuring and running a projection model in a PyQt application.
    Attributes:
        run_model_finished (pyqtSignal): Signal emitted when the model run is finished.
        parent (QWidget): The parent widget.
        model2 (object): The second model from the parent.
        columns (list): List of column names.
        variables_label (QLabel): Label for the variables list.
        variables_list (QListView): List view for selecting variables.
        variables_model (QStringListModel): Model for the variables list.
        unassign_button (QPushButton): Button to unassign variables.
        assign_of_interest_button (QPushButton): Button to assign variable of interest.
        assign_aux_button (QPushButton): Button to assign auxiliary variables.
        assign_as_factor_button (QPushButton): Button to assign variables as factors.
        assign_domains_button (QPushButton): Button to assign domain variables.
        assign_index_button (QPushButton): Button to assign index variables.
        assign_aux_mean_button (QPushButton): Button to assign auxiliary mean variables.
        assign_weight_button (QPushButton): Button to assign weight variables.
        assign_strata_button (QPushButton): Button to assign strata variables.
        of_interest_label (QLabel): Label for the variable of interest list.
        of_interest_list (QListView): List view for the variable of interest.
        of_interest_model (QStringListModel): Model for the variable of interest list.
        auxilary_label (QLabel): Label for the auxiliary variables list.
        auxilary_list (QListView): List view for the auxiliary variables.
        auxilary_model (QStringListModel): Model for the auxiliary variables list.
        as_factor_label (QLabel): Label for the as factor variables list.
        as_factor_list (QListView): List view for the as factor variables.
        as_factor_model (QStringListModel): Model for the as factor variables list.
        domain_label (QLabel): Label for the domain variables list.
        domain_list (QListView): List view for the domain variables.
        domain_model (QStringListModel): Model for the domain variables list.
        index_label (QLabel): Label for the index variables list.
        index_list (QListView): List view for the index variables.
        index_model (QStringListModel): Model for the index variables list.
        weight_label (QLabel): Label for the weight variables list.
        weight_list (QListView): List view for the weight variables.
        weight_model (QStringListModel): Model for the weight variables list.
        strata_label (QLabel): Label for the strata variables list.
        strata_list (QListView): List view for the strata variables.
        strata_model (QStringListModel): Model for the strata variables list.
        option_button (QPushButton): Button to show options.
        text_script (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        r_script_edit (QTextEdit): Text edit for the R script.
        ok_button (QPushButton): Button to run the model.
        of_interest_var (list): List of variables of interest.
        auxilary_vars (list): List of auxiliary variables.
        index_var (list): List of index variables.
        as_factor_var (list): List of as factor variables.
        domain_var (list): List of domain variables.
        weight_var (list): List of weight variables.
        strata_var (list): List of strata variables.
        selection_method (str): Method of selection.
        projection_method (str): Method of projection.
        metric (str): Metric used.
        k_fold (str): Number of folds for k-fold cross-validation.
        grid (str): Grid size.
        epoch (str): Number of epochs.
        learning_rate (str): Learning rate.
        finnish (bool): Flag indicating if the process is finished.
        stop_thread (threading.Event): Event to stop the thread.
    Methods:
        closeEvent(event): Handles the close event of the dialog.
        show_prerequisites(): Shows the prerequisites dialog.
        set_model(model): Sets the model and updates the columns.
        accept(): Accepts the dialog and runs the model.
        on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.
    &#34;&#34;&#34;
    
    run_model_finished = pyqtSignal(object, object, object, object)
    update_console = pyqtSignal(str)
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model2 = parent.model2
        self.setWindowTitle(&#34;Projection SAE&#34;)
        screen_height = self.parent.screen().size().height()
        self.setMinimumHeight(int(round(screen_height * 0.82)))
        self.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)

        self.columns = []

        self.main_layout = QVBoxLayout()

        # Create a scroll area
        self.scroll_area = QScrollArea()
        self.scroll_area.setWidgetResizable(True)
        self.scroll_content = QWidget()
        self.scroll_layout = QVBoxLayout(self.scroll_content)

        # Layout utama untuk membagi area menjadi dua bagian (kiri dan kanan)
        self.split_layout = QHBoxLayout()

        # Layout kiri untuk daftar variabel
        self.left_layout = QVBoxLayout()
        self.variables_label = QLabel(&#34;Select Variables:&#34;)
        self.variables_list = DragDropListView(parent=self)
        self.variables_model = QStringListModel(self.columns)
        self.variables_list.setModel(self.variables_model)
        self.variables_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.left_layout.addWidget(self.variables_label)
        self.left_layout.addWidget(self.variables_list)
        
        self.middle_layout1 = QVBoxLayout()
        self.unassign_button = QPushButton(&#34;ğŸ¡„&#34;)
        self.unassign_button.setObjectName(&#34;arrow_button&#34;)
        self.middle_layout1.addWidget(self.unassign_button)

        # Layout tengah untuk tombol panah
        self.middle_layout = QVBoxLayout()
        self.assign_of_interest_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_of_interest_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_aux_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_as_factor_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_as_factor_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_domains_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_domains_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_index_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_index_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_aux_mean_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_weight_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_weight_button.setObjectName(&#34;arrow_button&#34;)
        self.assign_strata_button = QPushButton(&#34;ğŸ¡†&#34;)
        self.assign_strata_button.setObjectName(&#34;arrow_button&#34;)

        self.assign_of_interest_button.clicked.connect(lambda: assign_of_interest(self))
        self.assign_aux_button.clicked.connect(lambda: assign_auxilary(self))
        self.assign_index_button.clicked.connect(lambda: assign_index(self))
        self.assign_as_factor_button.clicked.connect(lambda: assign_as_factor(self))
        self.assign_domains_button.clicked.connect(lambda: assign_domains(self))
        self.assign_weight_button.clicked.connect(lambda: assign_weight(self))
        self.assign_strata_button.clicked.connect(lambda: assign_strata(self))
        self.unassign_button.clicked.connect(lambda: unassign_variable(self))
        self.middle_layout.addWidget(self.assign_of_interest_button)
        self.middle_layout.addWidget(self.assign_aux_button)
        self.middle_layout.addWidget(self.assign_as_factor_button)
        self.middle_layout.addWidget(self.assign_domains_button)
        self.middle_layout.addWidget(self.assign_index_button)
        self.middle_layout.addWidget(self.assign_weight_button)
        self.middle_layout.addWidget(self.assign_strata_button)

        
        
        # Layout kanan untuk daftar dependen, independen, vardir, dan major area
        self.right_layout = QVBoxLayout()
        # right_layout.minimumSize(0, 650)
        self.of_interest_label = QLabel(&#34;Variable of interest:&#34;)
        self.of_interest_list = DragDropListView(parent=self)
        self.of_interest_list.setMinimumHeight(100)
        self.of_interest_model = QStringListModel()
        self.of_interest_list.setModel(self.of_interest_model)
        self.of_interest_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.of_interest_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.of_interest_label)
        self.right_layout.addWidget(self.of_interest_list)

        self.auxilary_label = QLabel(&#34;Auxilary Variable(s):&#34;)
        self.auxilary_list = DragDropListView(parent=self)
        self.auxilary_list.setMinimumHeight(100)
        self.auxilary_model = QStringListModel()
        self.auxilary_list.setModel(self.auxilary_model)
        self.auxilary_list.setSelectionMode(QAbstractItemView.SelectionMode.ExtendedSelection)
        self.auxilary_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.auxilary_label)
        self.right_layout.addWidget(self.auxilary_list)

        self.as_factor_label = QLabel(&#34;as Factor of Auxilary Variable(s):&#34;)
        self.as_factor_list = DragDropListView(parent=self)
        self.as_factor_list.setMinimumHeight(100)
        self.as_factor_model = QStringListModel()
        self.as_factor_list.setModel(self.as_factor_model)
        self.as_factor_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.as_factor_label)
        self.right_layout.addWidget(self.as_factor_list)
        
        self.domain_label = QLabel(&#34;Domain:&#34;)
        self.domain_list = DragDropListView(parent=self)
        self.domain_list.setMinimumHeight(100)
        self.domain_model = QStringListModel()
        self.domain_list.setModel(self.domain_model)
        self.domain_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.domain_label)
        self.right_layout.addWidget(self.domain_list)
        
        self.index_label = QLabel(&#34;Index number of Area:&#34;)
        self.index_list = DragDropListView(parent=self)
        self.index_list.setMinimumHeight(100)
        self.index_model = QStringListModel()
        self.index_list.setModel(self.index_model)
        self.index_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.index_label)
        self.right_layout.addWidget(self.index_list)
        

        self.weight_label = QLabel(&#34;Weight:&#34;)
        self.weight_list = DragDropListView(parent=self)
        self.weight_list.setMinimumHeight(100)
        self.weight_model = QStringListModel()
        self.weight_list.setModel(self.weight_model)
        self.weight_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.weight_label)
        self.right_layout.addWidget(self.weight_list)

        self.strata_label = QLabel(&#34;Strata:&#34;)
        self.strata_list = DragDropListView(parent=self)
        self.strata_list.setMinimumHeight(100)
        self.strata_model = QStringListModel()
        self.strata_list.setModel(self.strata_model)
        self.strata_list.setEditTriggers(QAbstractItemView.EditTrigger.NoEditTriggers)
        self.right_layout.addWidget(self.strata_label)
        self.right_layout.addWidget(self.strata_list)
        
        # Menambahkan layout kiri, tengah, dan kanan ke layout utama
        self.split_layout.addLayout(self.left_layout)
        self.split_layout.addLayout(self.middle_layout1)
        self.split_layout.addLayout(self.middle_layout)
        self.split_layout.addLayout(self.right_layout)

        self.scroll_layout.addLayout(self.split_layout)
        self.scroll_area.setWidget(self.scroll_content)
        self.main_layout.addWidget(self.scroll_area)

        # Tombol untuk menghasilkan skrip R
        self.option_button = QPushButton(&#34;Option&#34;)
        self.option_button.setFixedWidth(150)
        self.text_script = QLabel(&#34;R Script:&#34;)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Create a horizontal layout to place the text_script and icon_label in one row
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)
        
        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.text_script)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)
        
        # Create a horizontal layout to place the text_script and icon_label in one row
        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.text_script, Qt.AlignmentFlag.AlignLeft)

        self.show_console_first_checkbox = QCheckBox(&#34;Show R Console&#34;)
        self.show_console_first_checkbox.setChecked(False)  # default: show before
        # Tambahkan ke layout sebelum tombol Option
        self.main_layout.addWidget(self.show_console_first_checkbox)
        
        self.main_layout.addLayout(self.script_layout)
        self.option_button.clicked.connect(lambda : show_options(self))
        
        # Area teks untuk menampilkan dan mengedit skrip R
        self.r_script_edit = QTextEdit()
        self.r_script_edit.setFixedHeight(round(screen_height*0.18))
        self.r_script_edit.setVisible(False)
        self.r_script_edit.setReadOnly(False)
        self.r_script_edit.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.main_layout.addWidget(self.r_script_edit)

        # Tombol untuk tindakan dialog
        self.button_layout = QHBoxLayout()
        self.button_layout.setObjectName(&#34;button_layout&#34;)
        self.ok_button = QPushButton(&#34;Run Model&#34;)
        self.ok_button.setFixedWidth(150)
        self.ok_button.clicked.connect(self.accept)
        self.button_layout.addWidget(self.option_button)
        self.button_layout.addWidget(self.ok_button)
        self.main_layout.addLayout(self.button_layout)

        self.setLayout(self.main_layout)

        self.of_interest_var = []
        self.auxilary_vars = []
        self.index_var = []
        self.as_factor_var = []
        self.domain_var = []
        self.weight_var = []
        self.strata_var = []
        self.selection_method = &#34;None&#34;
        self.projection_method= &#34;Linear&#34;
        self.metric = &#34;NULL&#34;
        self.k_fold = &#34;3&#34;
        self.grid=&#34;10&#34;
        self.epoch=&#34;10&#34;
        self.learning_rate = &#34;0.01&#34;
        self.finnish = False
        
        self.run_model_finished.connect(self.on_run_model_finished)
        
        self.stop_thread = threading.Event()
        self.reply=None
        
        self.console_dialog = None
        self.update_console.connect(self._append_console)

    def _append_console(self, text):
        if self.console_dialog:
            self.console_dialog.append_text(text)
        
    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.r_script_edit.isVisible()
        self.r_script_edit.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    
    def closeEvent(self, event):
        if self.console_dialog:
            self.console_dialog.close()
        threads = threading.enumerate()
        for thread in threads:
            if thread.name == &#34;Projection&#34; and thread.is_alive():
                if self.reply is None:
                    self.reply = QMessageBox(self)
                    self.reply.setWindowTitle(&#39;Run in Background&#39;)
                    self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                    self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                    self.reply.setDefaultButton(QMessageBox.StandardButton.No)
                if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                    self.stop_thread.set()
                    self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
        self.finnish=False
        self.reply=None
        event.accept()
    
    def show_prerequisites(self):
        dialog = QDialog(self)
        dialog.setWindowTitle(&#34;Prerequisites&#34;)
        dialog.setModal(True)  # Membuat dialog tetap di atas

        layout = QVBoxLayout(dialog)

        # Separator selection
        layout.addWidget(QLabel(&#34;Separator:&#34;))
        self.separator_combo = QComboBox()
        self.separator_combo.addItems([&#34;.&#34;, &#34;;&#34;, &#34;|&#34;])
        layout.addWidget(self.separator_combo)

        # Variable position selection
        layout.addWidget(QLabel(&#34;Variable position relative to separator:&#34;))
        self.var_position_combo = QComboBox()
        self.var_position_combo.addItems([&#34;Before&#34;, &#34;After&#34;])
        layout.addWidget(self.var_position_combo)

        layout.addWidget(QLabel(&#34;The difference between data projection and model (after separator)&#34;))

        # Model name input
        layout.addWidget(QLabel(&#34;Model name:&#34;))
        self.model_name_edit = QLineEdit()  # Menggunakan QLineEdit karena lebih cocok untuk input pendek
        layout.addWidget(self.model_name_edit)

        # Projection name input
        layout.addWidget(QLabel(&#34;Projection name:&#34;))
        self.projection_name_edit = QLineEdit()  
        layout.addWidget(self.projection_name_edit)
        
        # Model selection
        layout.addWidget(QLabel(&#34;Select Model:&#34;))
        self.model_combo = QComboBox()
        self.model_combo.addItems([&#34;Linear&#34;, &#34;Logistic&#34;, &#34;SVM Linear&#34;, &#34;SVM RBF&#34;, &#34;Gradient Boost&#34;, &#34;Neural Network&#34;])
        layout.addWidget(self.model_combo)

        # Button Layout
        button_layout = QHBoxLayout()
        ok_button = QPushButton(&#34;OK&#34;)
        cancel_button = QPushButton(&#34;Cancel&#34;)
        ok_button.clicked.connect(dialog.accept)
        cancel_button.clicked.connect(dialog.reject)
        button_layout.addWidget(ok_button)
        button_layout.addWidget(cancel_button)
        layout.addLayout(button_layout)

        # Execute the dialog and check if accepted
        if dialog.exec() == QDialog.DialogCode.Accepted:
            self.separator = self.separator_combo.currentText()
            self.var_position = self.var_position_combo.currentText()
            self.model_name = self.model_name_edit.text()
            self.projection_name = self.projection_name_edit.text()
            self.projection_method = self.model_combo.currentText()

            # Filtering unique columns based on separator position
            unique_columns = {}
            for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes):
                col_key = col.split(self.separator)[0] if self.var_position == &#34;Before&#34; else col.split(self.separator)[-1]

                # Format dengan tipe data
                col_key_formatted = f&#34;{col_key} [{dtype}]&#34; if dtype == pl.Utf8 else f&#34;{col_key} [Numeric]&#34;
                
                # Menyimpan hanya jika belum ada dalam unique_columns
                if col_key not in unique_columns:
                    unique_columns[col_key] = col_key_formatted

            self.columns_new = list(unique_columns.values())
            self.variables_model.setStringList(self.columns_new)
            
            return True

        return False
    
    def set_model(self, model):
        self.model = model
        self.columns = [
            f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
            f&#34;{col} [NULL]&#34; if dtype == pl.Null else
            f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
            f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
            f&#34;{col} [Numeric]&#34;
            for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
        ]
        self.of_interest_model.setStringList([])
        self.auxilary_model.setStringList([])
        self.as_factor_model.setStringList([])
        self.domain_model.setStringList([])
        self.index_model.setStringList([])
        self.weight_model.setStringList([])
        self.strata_model.setStringList([])
        self.of_interest_var = []
        self.auxilary_vars = []
        self.index_var = []
        self.as_factor_var = []
        self.domain_var = []
        self.weight_var = []
        self.strata_var = []
        self.selection_method = &#34;None&#34;
        self.projection_method= &#34;Linear&#34;
        self.metric = &#34;NULL&#34;
        self.k_fold = &#34;3&#34;
        self.grid=&#34;10&#34;
        self.epoch=&#34;10&#34;
        self.hidden_unit = &#34;5&#34;
        self.learning_rate = &#34;0.01&#34;
        
    def handle_drop(self, target_list, items):
        from PyQt6.QtCore import QItemSelectionModel
        # Mirip dengan handle_drop di dialog lain, sesuaikan mapping dan aksi assign/unassign
        mapping = {
            self.variables_list: &#34;variables&#34;,
            self.of_interest_list: &#34;of_interest&#34;,
            self.auxilary_list: &#34;auxilary&#34;,
            self.as_factor_list: &#34;as_factor&#34;,
            self.domain_list: &#34;domain&#34;,
            self.index_list: &#34;index&#34;,
            self.weight_list: &#34;weight&#34;,
            self.strata_list: &#34;strata&#34;
        }
        source_list = None
        for lst in mapping:
            if any(item in lst.model().stringList() for item in items):
                source_list = lst
                break

        # Drag dari variables_list ke kanan (assign)
        if source_list == self.variables_list:
            if target_list == self.of_interest_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_of_interest(self)
            elif target_list == self.auxilary_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_auxilary(self)
            elif target_list == self.as_factor_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_as_factor(self)
            elif target_list == self.domain_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_domains(self)
            elif target_list == self.index_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_index(self)
            elif target_list == self.weight_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_weight(self)
            elif target_list == self.strata_list:
                self.variables_list.clearSelection()
                for idx, val in enumerate(self.variables_model.stringList()):
                    if val in items:
                        self.variables_list.selectionModel().select(
                            self.variables_model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                assign_strata(self)

        # Drag dari kanan ke variables_list (unassign)
        elif target_list == self.variables_list:
            for lst, model in [
                (self.of_interest_list, self.of_interest_model),
                (self.auxilary_list, self.auxilary_model),
                (self.as_factor_list, self.as_factor_model),
                (self.domain_list, self.domain_model),
                (self.index_list, self.index_model),
                (self.weight_list, self.weight_model),
                (self.strata_list, self.strata_model)
            ]:
                if source_list == lst:
                    lst.clearSelection()
                    for idx, val in enumerate(model.stringList()):
                        if val in items:
                            lst.selectionModel().select(
                                model.index(idx),
                                QItemSelectionModel.SelectionFlag.Select
                            )
                    unassign_variable(self)
    
    def accept(self):
        if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
            self.ok_button.setEnabled(True)
            self.option_button.setEnabled(True)
            self.ok_button.setText(&#34;Run Model&#34;)
            return
        
        r_script = get_script(self)
        if not check_script(r_script):
            return
        disable_service(self)

        view = self.parent
        sae_model = Projection(self.model, self.model2, view)
        controller = ProjectionController(sae_model)
        
        show_console_first = self.show_console_first_checkbox.isChecked()
        if show_console_first:
            self.console_dialog = ConsoleDialog(self)
            self.console_dialog.show()
        
        current_context = contextvars.copy_context()
        
        def run_model_thread():
            result, error, df = None, None, None
            try:
                if self.console_dialog:
                    old_stdout = sys.stdout
                    sys.stdout = ConsoleStream(self.update_console)
                result, error, df = current_context.run(controller.run_model, r_script)
                if self.console_dialog:
                    sys.stdout = old_stdout
                if not error:
                    sae_model.model2.set_data(df)
            except Exception as e:
                error = e
            finally:
                if not self.stop_thread.is_set():
                    self.run_model_finished.emit(result, error, sae_model, r_script)
                    self.finnish = True

        def check_run_time():
            if thread.is_alive():
                self.parent.autosave_data()
                reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
                if reply == QMessageBox.StandardButton.No:
                    self.stop_thread.set()
                    QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                    enable_service(self, False, &#34;&#34;)


        thread = threading.Thread(target=run_model_thread, name=&#34;Projection&#34;)
        thread.start()

        timer = QTimer(self)
        timer.setSingleShot(True)
        timer.timeout.connect(check_run_time)
        timer.start(60000)
    
    def on_run_model_finished(self, result, error, sae_model, r_script):
        if self.console_dialog:
            self.console_dialog.stop_loading()
            self.console_dialog.close()
        if not error:
            self.parent.update_table(2, sae_model.get_model2())
        if self.reply is not None:
            self.reply.reject()
        display_script_and_output(self.parent, r_script, result)
        enable_service(self, error, result)
        self.finnish = True
        self.close()</code></pre>
</details>
<div class="desc"><p>A dialog for configuring and running a projection model in a PyQt application.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>run_model_finished</code></strong> :&ensp;<code>pyqtSignal</code></dt>
<dd>Signal emitted when the model run is finished.</dd>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>object</code></dt>
<dd>The second model from the parent.</dd>
<dt><strong><code>columns</code></strong> :&ensp;<code>list</code></dt>
<dd>List of column names.</dd>
<dt><strong><code>variables_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variables list.</dd>
<dt><strong><code>variables_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for selecting variables.</dd>
<dt><strong><code>variables_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variables list.</dd>
<dt><strong><code>unassign_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to unassign variables.</dd>
<dt><strong><code>assign_of_interest_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variable of interest.</dd>
<dt><strong><code>assign_aux_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary variables.</dd>
<dt><strong><code>assign_as_factor_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign variables as factors.</dd>
<dt><strong><code>assign_domains_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign domain variables.</dd>
<dt><strong><code>assign_index_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign index variables.</dd>
<dt><strong><code>assign_aux_mean_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign auxiliary mean variables.</dd>
<dt><strong><code>assign_weight_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign weight variables.</dd>
<dt><strong><code>assign_strata_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to assign strata variables.</dd>
<dt><strong><code>of_interest_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the variable of interest list.</dd>
<dt><strong><code>of_interest_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the variable of interest.</dd>
<dt><strong><code>of_interest_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the variable of interest list.</dd>
<dt><strong><code>auxilary_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the auxiliary variables list.</dd>
<dt><strong><code>auxilary_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the auxiliary variables.</dd>
<dt><strong><code>auxilary_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the auxiliary variables list.</dd>
<dt><strong><code>as_factor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the as factor variables list.</dd>
<dt><strong><code>as_factor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the as factor variables.</dd>
<dt><strong><code>as_factor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the as factor variables list.</dd>
<dt><strong><code>domain_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the domain variables list.</dd>
<dt><strong><code>domain_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the domain variables.</dd>
<dt><strong><code>domain_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the domain variables list.</dd>
<dt><strong><code>index_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the index variables list.</dd>
<dt><strong><code>index_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the index variables.</dd>
<dt><strong><code>index_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the index variables list.</dd>
<dt><strong><code>weight_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the weight variables list.</dd>
<dt><strong><code>weight_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the weight variables.</dd>
<dt><strong><code>weight_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the weight variables list.</dd>
<dt><strong><code>strata_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the strata variables list.</dd>
<dt><strong><code>strata_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the strata variables.</dd>
<dt><strong><code>strata_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the strata variables list.</dd>
<dt><strong><code>option_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to show options.</dd>
<dt><strong><code>text_script</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>r_script_edit</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit for the R script.</dd>
<dt><strong><code>ok_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the model.</dd>
<dt><strong><code>of_interest_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of variables of interest.</dd>
<dt><strong><code>auxilary_vars</code></strong> :&ensp;<code>list</code></dt>
<dd>List of auxiliary variables.</dd>
<dt><strong><code>index_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of index variables.</dd>
<dt><strong><code>as_factor_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of as factor variables.</dd>
<dt><strong><code>domain_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of domain variables.</dd>
<dt><strong><code>weight_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of weight variables.</dd>
<dt><strong><code>strata_var</code></strong> :&ensp;<code>list</code></dt>
<dd>List of strata variables.</dd>
<dt><strong><code>selection_method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method of selection.</dd>
<dt><strong><code>projection_method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method of projection.</dd>
<dt><strong><code>metric</code></strong> :&ensp;<code>str</code></dt>
<dd>Metric used.</dd>
<dt><strong><code>k_fold</code></strong> :&ensp;<code>str</code></dt>
<dd>Number of folds for k-fold cross-validation.</dd>
<dt><strong><code>grid</code></strong> :&ensp;<code>str</code></dt>
<dd>Grid size.</dd>
<dt><strong><code>epoch</code></strong> :&ensp;<code>str</code></dt>
<dd>Number of epochs.</dd>
<dt><strong><code>learning_rate</code></strong> :&ensp;<code>str</code></dt>
<dd>Learning rate.</dd>
<dt><strong><code>finnish</code></strong> :&ensp;<code>bool</code></dt>
<dd>Flag indicating if the process is finished.</dd>
<dt><strong><code>stop_thread</code></strong> :&ensp;<code>threading.Event</code></dt>
<dd>Event to stop the thread.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>closeEvent(event): Handles the close event of the dialog.
show_prerequisites(): Shows the prerequisites dialog.
set_model(model): Sets the model and updates the columns.
accept(): Accepts the dialog and runs the model.
on_run_model_finished(result, error, sae_model, r_script): Handles the completion of the model run.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    if not self.of_interest_var or self.of_interest_var == [&#34;&#34;]:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Variable of interest cannot be empty.&#34;)
        self.ok_button.setEnabled(True)
        self.option_button.setEnabled(True)
        self.ok_button.setText(&#34;Run Model&#34;)
        return
    
    r_script = get_script(self)
    if not check_script(r_script):
        return
    disable_service(self)

    view = self.parent
    sae_model = Projection(self.model, self.model2, view)
    controller = ProjectionController(sae_model)
    
    show_console_first = self.show_console_first_checkbox.isChecked()
    if show_console_first:
        self.console_dialog = ConsoleDialog(self)
        self.console_dialog.show()
    
    current_context = contextvars.copy_context()
    
    def run_model_thread():
        result, error, df = None, None, None
        try:
            if self.console_dialog:
                old_stdout = sys.stdout
                sys.stdout = ConsoleStream(self.update_console)
            result, error, df = current_context.run(controller.run_model, r_script)
            if self.console_dialog:
                sys.stdout = old_stdout
            if not error:
                sae_model.model2.set_data(df)
        except Exception as e:
            error = e
        finally:
            if not self.stop_thread.is_set():
                self.run_model_finished.emit(result, error, sae_model, r_script)
                self.finnish = True

    def check_run_time():
        if thread.is_alive():
            self.parent.autosave_data()
            reply = QMessageBox.question(self, &#39;Warning&#39;, &#39;Run has been running for more than 1 minute. Do you want to continue?&#39;)
            if reply == QMessageBox.StandardButton.No:
                self.stop_thread.set()
                QMessageBox.information(self, &#39;Info&#39;, &#39;Run has been stopped.&#39;)
                enable_service(self, False, &#34;&#34;)


    thread = threading.Thread(target=run_model_thread, name=&#34;Projection&#34;)
    thread.start()

    timer = QTimer(self)
    timer.setSingleShot(True)
    timer.timeout.connect(check_run_time)
    timer.start(60000)</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    if self.console_dialog:
        self.console_dialog.close()
    threads = threading.enumerate()
    for thread in threads:
        if thread.name == &#34;Projection&#34; and thread.is_alive():
            if self.reply is None:
                self.reply = QMessageBox(self)
                self.reply.setWindowTitle(&#39;Run in Background&#39;)
                self.reply.setText(&#39;Do you want to run the model in the background?&#39;)
                self.reply.setStandardButtons(QMessageBox.StandardButton.Yes | QMessageBox.StandardButton.No)
                self.reply.setDefaultButton(QMessageBox.StandardButton.No)
            if self.reply.exec() != QMessageBox.StandardButton.Yes and not self.finnish:
                self.stop_thread.set()
                self.run_model_finished.emit(&#34;Threads are stopped&#34;, True, &#34;sae_model&#34;, &#34;&#34;)
    self.finnish=False
    self.reply=None
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_list, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_list, items):
    from PyQt6.QtCore import QItemSelectionModel
    # Mirip dengan handle_drop di dialog lain, sesuaikan mapping dan aksi assign/unassign
    mapping = {
        self.variables_list: &#34;variables&#34;,
        self.of_interest_list: &#34;of_interest&#34;,
        self.auxilary_list: &#34;auxilary&#34;,
        self.as_factor_list: &#34;as_factor&#34;,
        self.domain_list: &#34;domain&#34;,
        self.index_list: &#34;index&#34;,
        self.weight_list: &#34;weight&#34;,
        self.strata_list: &#34;strata&#34;
    }
    source_list = None
    for lst in mapping:
        if any(item in lst.model().stringList() for item in items):
            source_list = lst
            break

    # Drag dari variables_list ke kanan (assign)
    if source_list == self.variables_list:
        if target_list == self.of_interest_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_of_interest(self)
        elif target_list == self.auxilary_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_auxilary(self)
        elif target_list == self.as_factor_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_as_factor(self)
        elif target_list == self.domain_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_domains(self)
        elif target_list == self.index_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_index(self)
        elif target_list == self.weight_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_weight(self)
        elif target_list == self.strata_list:
            self.variables_list.clearSelection()
            for idx, val in enumerate(self.variables_model.stringList()):
                if val in items:
                    self.variables_list.selectionModel().select(
                        self.variables_model.index(idx),
                        QItemSelectionModel.SelectionFlag.Select
                    )
            assign_strata(self)

    # Drag dari kanan ke variables_list (unassign)
    elif target_list == self.variables_list:
        for lst, model in [
            (self.of_interest_list, self.of_interest_model),
            (self.auxilary_list, self.auxilary_model),
            (self.as_factor_list, self.as_factor_model),
            (self.domain_list, self.domain_model),
            (self.index_list, self.index_model),
            (self.weight_list, self.weight_model),
            (self.strata_list, self.strata_model)
        ]:
            if source_list == lst:
                lst.clearSelection()
                for idx, val in enumerate(model.stringList()):
                    if val in items:
                        lst.selectionModel().select(
                            model.index(idx),
                            QItemSelectionModel.SelectionFlag.Select
                        )
                unassign_variable(self)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.on_run_model_finished"><code class="name flex">
<span>def <span class="ident">on_run_model_finished</span></span>(<span>self, result, error, sae_model, r_script)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def on_run_model_finished(self, result, error, sae_model, r_script):
    if self.console_dialog:
        self.console_dialog.stop_loading()
        self.console_dialog.close()
    if not error:
        self.parent.update_table(2, sae_model.get_model2())
    if self.reply is not None:
        self.reply.reject()
    display_script_and_output(self.parent, r_script, result)
    enable_service(self, error, result)
    self.finnish = True
    self.close()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.run_model_finished"><code class="name flex">
<span>def <span class="ident">run_model_finished</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model):
    self.model = model
    self.columns = [
        f&#34;{col} [{dtype}]&#34; if dtype == pl.Utf8 else
        f&#34;{col} [NULL]&#34; if dtype == pl.Null else
        f&#34;{col} [Categorical]&#34; if dtype == pl.Categorical else
        f&#34;{col} [Boolean]&#34; if dtype == pl.Boolean else
        f&#34;{col} [Numeric]&#34;
        for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes)
    ]
    self.of_interest_model.setStringList([])
    self.auxilary_model.setStringList([])
    self.as_factor_model.setStringList([])
    self.domain_model.setStringList([])
    self.index_model.setStringList([])
    self.weight_model.setStringList([])
    self.strata_model.setStringList([])
    self.of_interest_var = []
    self.auxilary_vars = []
    self.index_var = []
    self.as_factor_var = []
    self.domain_var = []
    self.weight_var = []
    self.strata_var = []
    self.selection_method = &#34;None&#34;
    self.projection_method= &#34;Linear&#34;
    self.metric = &#34;NULL&#34;
    self.k_fold = &#34;3&#34;
    self.grid=&#34;10&#34;
    self.epoch=&#34;10&#34;
    self.hidden_unit = &#34;5&#34;
    self.learning_rate = &#34;0.01&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.show_prerequisites"><code class="name flex">
<span>def <span class="ident">show_prerequisites</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_prerequisites(self):
    dialog = QDialog(self)
    dialog.setWindowTitle(&#34;Prerequisites&#34;)
    dialog.setModal(True)  # Membuat dialog tetap di atas

    layout = QVBoxLayout(dialog)

    # Separator selection
    layout.addWidget(QLabel(&#34;Separator:&#34;))
    self.separator_combo = QComboBox()
    self.separator_combo.addItems([&#34;.&#34;, &#34;;&#34;, &#34;|&#34;])
    layout.addWidget(self.separator_combo)

    # Variable position selection
    layout.addWidget(QLabel(&#34;Variable position relative to separator:&#34;))
    self.var_position_combo = QComboBox()
    self.var_position_combo.addItems([&#34;Before&#34;, &#34;After&#34;])
    layout.addWidget(self.var_position_combo)

    layout.addWidget(QLabel(&#34;The difference between data projection and model (after separator)&#34;))

    # Model name input
    layout.addWidget(QLabel(&#34;Model name:&#34;))
    self.model_name_edit = QLineEdit()  # Menggunakan QLineEdit karena lebih cocok untuk input pendek
    layout.addWidget(self.model_name_edit)

    # Projection name input
    layout.addWidget(QLabel(&#34;Projection name:&#34;))
    self.projection_name_edit = QLineEdit()  
    layout.addWidget(self.projection_name_edit)
    
    # Model selection
    layout.addWidget(QLabel(&#34;Select Model:&#34;))
    self.model_combo = QComboBox()
    self.model_combo.addItems([&#34;Linear&#34;, &#34;Logistic&#34;, &#34;SVM Linear&#34;, &#34;SVM RBF&#34;, &#34;Gradient Boost&#34;, &#34;Neural Network&#34;])
    layout.addWidget(self.model_combo)

    # Button Layout
    button_layout = QHBoxLayout()
    ok_button = QPushButton(&#34;OK&#34;)
    cancel_button = QPushButton(&#34;Cancel&#34;)
    ok_button.clicked.connect(dialog.accept)
    cancel_button.clicked.connect(dialog.reject)
    button_layout.addWidget(ok_button)
    button_layout.addWidget(cancel_button)
    layout.addLayout(button_layout)

    # Execute the dialog and check if accepted
    if dialog.exec() == QDialog.DialogCode.Accepted:
        self.separator = self.separator_combo.currentText()
        self.var_position = self.var_position_combo.currentText()
        self.model_name = self.model_name_edit.text()
        self.projection_name = self.projection_name_edit.text()
        self.projection_method = self.model_combo.currentText()

        # Filtering unique columns based on separator position
        unique_columns = {}
        for col, dtype in zip(self.model.get_data().columns, self.model.get_data().dtypes):
            col_key = col.split(self.separator)[0] if self.var_position == &#34;Before&#34; else col.split(self.separator)[-1]

            # Format dengan tipe data
            col_key_formatted = f&#34;{col_key} [{dtype}]&#34; if dtype == pl.Utf8 else f&#34;{col_key} [Numeric]&#34;
            
            # Menyimpan hanya jika belum ada dalam unique_columns
            if col_key not in unique_columns:
                unique_columns[col_key] = col_key_formatted

        self.columns_new = list(unique_columns.values())
        self.variables_model.setStringList(self.columns_new)
        
        return True

    return False</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.r_script_edit.isVisible()
    self.r_script_edit.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
<dt id="saePisan.view.components.ProjectionDialog.ProjectionDialog.update_console"><code class="name flex">
<span>def <span class="ident">update_console</span></span>(<span>...)</span>
</code></dt>
<dd>
<div class="desc"><p>pyqtSignal(*types, name: str = &hellip;, revision: int = &hellip;, arguments: Sequence = &hellip;) -&gt; PYQT_SIGNAL</p>
<p>types is normally a sequence of individual types.
Each type is either a
type object or a string that is the name of a C++ type.
Alternatively
each type could itself be a sequence of types each describing a different
overloaded signal.
name is the optional C++ name of the signal.
If it is not specified then
the name of the class attribute that is bound to the signal is used.
revision is the optional revision of the signal that is exported to QML.
If it is not specified then 0 is used.
arguments is the optional sequence of the names of the signal's arguments.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.ProjectionDialog.ConsoleStream" href="#saePisan.view.components.ProjectionDialog.ConsoleStream">ConsoleStream</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ProjectionDialog.ConsoleStream.flush" href="#saePisan.view.components.ProjectionDialog.ConsoleStream.flush">flush</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ConsoleStream.write" href="#saePisan.view.components.ProjectionDialog.ConsoleStream.write">write</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog">ProjectionDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.accept" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.closeEvent" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.handle_drop" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.on_run_model_finished" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.on_run_model_finished">on_run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.run_model_finished" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.run_model_finished">run_model_finished</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.set_model" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.show_prerequisites" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.show_prerequisites">show_prerequisites</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.toggle_r_script_visibility" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog.ProjectionDialog.update_console" href="#saePisan.view.components.ProjectionDialog.ProjectionDialog.update_console">update_console</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_7">
                <div class="file-header">
                    <div>ğŸ“„ SplashScreen</div>
                    <div class="file-path">view/components/SplashScreen.html (12.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.SplashScreen</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.SplashScreen.SplashScreen"><code class="flex name class">
<span>class <span class="ident">SplashScreen</span></span>
<span>(</span><span>pixmap)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SplashScreen(QSplashScreen):
    &#34;&#34;&#34;
    A custom splash screen class that displays a series of messages during application startup.
    Attributes:
        label (QLabel): A label to display the current message.
        progress_bar (QProgressBar): Progress bar to show progress.
        layout (QVBoxLayout): A vertical box layout to manage the label&#39;s position.
        messages (list): A list of messages to be displayed sequentially.
        current_message_index (int): The index of the current message being displayed.
    Methods:
        update_message():
            Updates the label and progress bar to display the next message in the sequence.
    &#34;&#34;&#34;
    
    def __init__(self, pixmap):
        super().__init__(pixmap)
        self.setWindowFlags(Qt.WindowType.FramelessWindowHint | Qt.WindowType.WindowStaysOnTopHint)
        
        self.label = QLabel(&#34;Checking environment...&#34;, self)
        self.label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        self.label.setStyleSheet(&#34;color: black; font-size: 14px;&#34;)

        self.progress_bar = QProgressBar(self)
        self.progress_bar.setRange(0, 100)
        self.progress_bar.setValue(0)
        self.progress_bar.setTextVisible(True)
        self.progress_bar.setFormat(&#34;%p%&#34;)
        self.progress_bar.setFixedHeight(10)
        self.progress_anim = QPropertyAnimation(self.progress_bar, b&#34;value&#34;)
        self.progress_anim.setDuration(400)
        self.progress_bar.setStyleSheet(&#34;&#34;&#34;
            QProgressBar {
                border: 1px solid #bbb;
                border-radius: 5px;
                background: #eee;
                text-align: center;
                color: black;
                font-size: 8px;
            }
            QProgressBar::chunk {
                background-color: #4caf50;
                border-radius: 5px;
            }
        &#34;&#34;&#34;)

        self.layout = QVBoxLayout(self)
        self.layout.addWidget(self.label)
        self.layout.addWidget(self.progress_bar)
        self.layout.setAlignment(Qt.AlignmentFlag.AlignBottom)

        self.messages = [
            &#34;Checking environment...&#34;,
            &#34;Checking and Loading R...&#34;,
            &#34;Loading R Packages...&#34;,
            &#34;Setup Environment...&#34;,
            &#34;Loading Completed!&#34;
        ]
        self.current_message_index = 0

    def update_message(self):
        self.current_message_index = (self.current_message_index + 1) % len(self.messages)
        self.label.setText(self.messages[self.current_message_index])
        last_idx = len(self.messages) - 1
        if self.current_message_index &lt; last_idx:
            progress = int((self.current_message_index / (last_idx - 1)) * 99) if last_idx &gt; 1 else 99
        else:
            progress = 100
        self.progress_anim.stop()
        self.progress_anim.setStartValue(self.progress_bar.value())
        self.progress_anim.setEndValue(progress)
        self.progress_anim.start()
        QApplication.processEvents()</code></pre>
</details>
<div class="desc"><p>A custom splash screen class that displays a series of messages during application startup.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>A label to display the current message.</dd>
<dt><strong><code>progress_bar</code></strong> :&ensp;<code>QProgressBar</code></dt>
<dd>Progress bar to show progress.</dd>
<dt><strong><code>layout</code></strong> :&ensp;<code>QVBoxLayout</code></dt>
<dd>A vertical box layout to manage the label's position.</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>list</code></dt>
<dd>A list of messages to be displayed sequentially.</dd>
<dt><strong><code>current_message_index</code></strong> :&ensp;<code>int</code></dt>
<dd>The index of the current message being displayed.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>update_message():
Updates the label and progress bar to display the next message in the sequence.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QSplashScreen</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.SplashScreen.SplashScreen.update_message"><code class="name flex">
<span>def <span class="ident">update_message</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_message(self):
    self.current_message_index = (self.current_message_index + 1) % len(self.messages)
    self.label.setText(self.messages[self.current_message_index])
    last_idx = len(self.messages) - 1
    if self.current_message_index &lt; last_idx:
        progress = int((self.current_message_index / (last_idx - 1)) * 99) if last_idx &gt; 1 else 99
    else:
        progress = 100
    self.progress_anim.stop()
    self.progress_anim.setStartValue(self.progress_bar.value())
    self.progress_anim.setEndValue(progress)
    self.progress_anim.start()
    QApplication.processEvents()</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.SplashScreen.SplashScreen" href="#saePisan.view.components.SplashScreen.SplashScreen">SplashScreen</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.SplashScreen.SplashScreen.update_message" href="#saePisan.view.components.SplashScreen.SplashScreen.update_message">update_message</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_8">
                <div class="file-header">
                    <div>ğŸ“„ CorrelationMatrikDialog</div>
                    <div class="file-path">view/components/exploration/CorrelationMatrikDialog.html (46.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.exploration.CorrelationMatrikDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog"><code class="flex name class">
<span>class <span class="ident">CorrelationMatrixDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CorrelationMatrixDialog(QDialog):
    &#34;&#34;&#34;A dialog for selecting variables and generating a correlation matrix using R script.
    
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns in the first data model.
        all_columns_model2 (list): List of all columns in the second data model.
        selected_status (dict): Dictionary to store the selected variable status.
        data_editor_label (QLabel): Label for the data editor section.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output section.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (QListView): List view for the data output.
        add_button (QPushButton): Button to add selected variables.
        remove_button (QPushButton): Button to remove selected variables.
        selected_label (QLabel): Label for the selected variables section.
        selected_model (QStringListModel): Model for the selected variables list view.
        selected_list (QListView): List view for the selected variables.
        correlation_plot_checkbox (QCheckBox): Checkbox to show correlation plot.
        script_layout (QHBoxLayout): Layout for the R script section.
        script_label (QLabel): Label for the R script section.
        icon_label (QLabel): Label to show running icon.
        script_box (QTextEdit): Text box to display the generated R script.
        run_button (QPushButton): Button to run the generated R script.
    
    Methods:
        __init__(self, parent): Initializes the dialog with the given parent.
        set_model(self, model1, model2): Sets the data models for the dialog.
        get_column_with_dtype(self, model): Returns the columns with their data types.
        add_variable(self): Adds selected variables to the selected list.
        remove_variable(self): Removes selected variables from the selected list.
        get_selected_columns(self): Returns the selected columns without data types.
        generate_r_script(self): Generates the R script for the correlation matrix.
        accept(self): Runs the generated R script and handles the result.
        closeEvent(self, event): Handles the close event of the dialog.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Correlation&#34;)

        # Store selected variable status
        self.selected_status = {}

        # Main layout
        self.main_layout = QVBoxLayout(self)
        content_layout = QHBoxLayout()

        # Left layout for Data Editor and Data Output
        left_layout = QVBoxLayout()

        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Middle layout: Buttons
        button_layout = QVBoxLayout()
        self.add_button = QPushButton(&#34;ğŸ¡†&#34;, self)  
        self.add_button.clicked.connect(self.add_variable)
        self.add_button.setFixedSize(50, 35) 
        self.add_button.setStyleSheet(&#34;font-size: 24px;&#34;)  
        self.remove_button = QPushButton(&#34;ğŸ¡„&#34;, self)  
        self.remove_button.clicked.connect(self.remove_variable)
        self.remove_button.setFixedSize(50, 35)
        self.remove_button.setStyleSheet(&#34;font-size: 24px;&#34;) 
        button_layout.addStretch()
        button_layout.addWidget(self.add_button)
        button_layout.addWidget(self.remove_button)
        button_layout.addStretch()
        content_layout.addLayout(button_layout)

        # Right layout
        right_layout = QVBoxLayout()
        self.selected_label = QLabel(&#34;Variables&#34;, self)
        self.selected_model = QStringListModel()
        self.selected_list = DragDropListView(parent=self)
        self.selected_list.setModel(self.selected_model)
        self.selected_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        right_layout.addWidget(self.selected_label)
        right_layout.addWidget(self.selected_list)

        # Method group with checkboxes
        method_group = QGroupBox(&#34;Methods&#34;)
        method_layout = QVBoxLayout()
        self.pearson_checkbox = QCheckBox(&#34;Pearson&#34;)
        self.spearman_checkbox = QCheckBox(&#34;Spearman&#34;)
        self.kendall_checkbox = QCheckBox(&#34;Kendall&#34;)
        self.pearson_checkbox.stateChanged.connect(self.generate_r_script)
        self.spearman_checkbox.stateChanged.connect(self.generate_r_script)
        self.kendall_checkbox.stateChanged.connect(self.generate_r_script)
        method_layout.addWidget(self.pearson_checkbox)
        method_layout.addWidget(self.spearman_checkbox)
        method_layout.addWidget(self.kendall_checkbox)
        method_group.setLayout(method_layout)
        right_layout.addWidget(method_group)
        
        # Graph group
        graph_group = QGroupBox(&#34;Visualization&#34;)
        graph_layout = QVBoxLayout()
        self.correlation_plot_checkbox = QCheckBox(&#34;Show Correlation Plot&#34;, self)
        self.correlation_plot_checkbox.stateChanged.connect(self.generate_r_script)
        graph_layout.addWidget(self.correlation_plot_checkbox)
        graph_group.setLayout(graph_layout)
        right_layout.addWidget(graph_group)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        self.script_layout = QHBoxLayout()  
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        spacer = QSpacerItem(40, 10, QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Minimum)

        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Run button
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)

        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.selected_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Mapping widget to model
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.selected_list: (self.selected_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        filtered_items = []
        contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

        for item in items:
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                continue

            if target_widget == self.selected_list:
                filtered_items.append(item)
            else:
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                    filtered_items.append(item)

        if contains_string:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        for other_widget, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        if target_widget == self.data_editor_list:
            ordered = [col for col in self.all_columns_model1 if col in current_items]
            target_model.setStringList(ordered)
        elif target_widget == self.data_output_list:
            ordered = [col for col in self.all_columns_model2 if col in current_items]
            target_model.setStringList(ordered)
        else:
            target_model.setStringList(current_items)
        self.generate_r_script()

    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns


    def add_variable(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.selected_model.stringList()
        
        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
        selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()

    def remove_variable(self):
        &#34;&#34;&#34;
        Removes selected variables from the selected list and generates the R script.
        &#34;&#34;&#34;
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        selected_list = self.selected_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Check if the item belongs to model1 (editor) or model2 (output)
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
                    # Re-sort according to all_columns_model1
                    editor_list = [col for col in self.all_columns_model1 if col in editor_list]

            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)
                    # Re-sort according to all_columns_model2
                    output_list = [col for col in self.all_columns_model2 if col in output_list]

            # Remove from selected
            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.generate_r_script()

    def get_selected_columns(self):
        return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]

    def generate_r_script(self):
        &#34;&#34;&#34;Function to generate R script for Correlation Matrix using ggcorrplot&#34;&#34;&#34;
        selected_columns = self.get_selected_columns()
        if not selected_columns:
            self.script_box.setPlainText(&#34;&#34;)
            return

        formatted_columns = &#39;, &#39;.join(f&#39;&#34;{col}&#34;&#39; for col in selected_columns)
        r_script = &#34;&#34;

        # Step 1: Generate the correlation matrix and plots based on selected methods
        for method, checkbox in [(&#34;pearson&#34;, self.pearson_checkbox),
                                (&#34;spearman&#34;, self.spearman_checkbox),
                                (&#34;kendall&#34;, self.kendall_checkbox)]:
            if checkbox.isChecked():
                correlation_matrix_method = f&#34;correlation_matrix_{method}&#34;
                r_script += (
                    f&#34;{correlation_matrix_method} &lt;- cor(data[, c({formatted_columns})], &#34;
                    f&#34;use=&#39;complete.obs&#39;, method=&#39;{method}&#39;)\n&#34;
                )

                # Only generate the plot if the plot checkbox is checked
                if self.correlation_plot_checkbox.isChecked():
                    r_script += (
                        f&#34;correlation_plot_{method} &lt;- ggcorrplot({correlation_matrix_method}, &#34;
                        f&#34;method = &#39;square&#39;, type = &#39;upper&#39;, lab = TRUE) + &#34;
                        f&#34;ggtitle(&#39;{method.title()} Correlation Matrix&#39;)\n\n&#34;
                    )

        self.script_box.setPlainText(r_script)


    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)
        correlation_matrix = CorrelationMatrix(self.model1, self.model2)
        controller = CorrelationMatrixController(correlation_matrix)
        controller.run_model(r_script)

        if not correlation_matrix.error:
            QMessageBox.information(self, &#34;Correlation Matrix&#34;, &#34;Exploration has been completed.&#34;)
        else:
            QMessageBox.warning(self, &#34;Correlation Matrix&#34;, correlation_matrix.result)

        # self.parent.add_output(script_text = r_script, result_text =  correlation_matrix.result ,plot_paths = correlation_matrix.plot)
        display_script_and_output(self.parent, r_script, correlation_matrix.result, correlation_matrix.plot)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        self.selected_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)
        event.accept()</code></pre>
</details>
<div class="desc"><p>A dialog for selecting variables and generating a correlation matrix using R script.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in the first data model.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in the second data model.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the selected variable status.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor section.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output section.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>add_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add selected variables.</dd>
<dt><strong><code>remove_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>selected_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the selected variables section.</dd>
<dt><strong><code>selected_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the selected variables list view.</dd>
<dt><strong><code>selected_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the selected variables.</dd>
<dt><strong><code>correlation_plot_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox to show correlation plot.</dd>
<dt><strong><code>script_layout</code></strong> :&ensp;<code>QHBoxLayout</code></dt>
<dd>Layout for the R script section.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script section.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label to show running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the generated R script.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(self, parent): Initializes the dialog with the given parent.
set_model(self, model1, model2): Sets the data models for the dialog.
get_column_with_dtype(self, model): Returns the columns with their data types.
add_variable(self): Adds selected variables to the selected list.
remove_variable(self): Removes selected variables from the selected list.
get_selected_columns(self): Returns the selected columns without data types.
generate_r_script(self): Generates the R script for the correlation matrix.
accept(self): Runs the generated R script and handles the result.
closeEvent(self, event): Handles the close event of the dialog.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)
    correlation_matrix = CorrelationMatrix(self.model1, self.model2)
    controller = CorrelationMatrixController(correlation_matrix)
    controller.run_model(r_script)

    if not correlation_matrix.error:
        QMessageBox.information(self, &#34;Correlation Matrix&#34;, &#34;Exploration has been completed.&#34;)
    else:
        QMessageBox.warning(self, &#34;Correlation Matrix&#34;, correlation_matrix.result)

    # self.parent.add_output(script_text = r_script, result_text =  correlation_matrix.result ,plot_paths = correlation_matrix.plot)
    display_script_and_output(self.parent, r_script, correlation_matrix.result, correlation_matrix.plot)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.add_variable"><code class="name flex">
<span>def <span class="ident">add_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.selected_model.stringList()
    
    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
    selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.selected_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    self.selected_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    &#34;&#34;&#34;Function to generate R script for Correlation Matrix using ggcorrplot&#34;&#34;&#34;
    selected_columns = self.get_selected_columns()
    if not selected_columns:
        self.script_box.setPlainText(&#34;&#34;)
        return

    formatted_columns = &#39;, &#39;.join(f&#39;&#34;{col}&#34;&#39; for col in selected_columns)
    r_script = &#34;&#34;

    # Step 1: Generate the correlation matrix and plots based on selected methods
    for method, checkbox in [(&#34;pearson&#34;, self.pearson_checkbox),
                            (&#34;spearman&#34;, self.spearman_checkbox),
                            (&#34;kendall&#34;, self.kendall_checkbox)]:
        if checkbox.isChecked():
            correlation_matrix_method = f&#34;correlation_matrix_{method}&#34;
            r_script += (
                f&#34;{correlation_matrix_method} &lt;- cor(data[, c({formatted_columns})], &#34;
                f&#34;use=&#39;complete.obs&#39;, method=&#39;{method}&#39;)\n&#34;
            )

            # Only generate the plot if the plot checkbox is checked
            if self.correlation_plot_checkbox.isChecked():
                r_script += (
                    f&#34;correlation_plot_{method} &lt;- ggcorrplot({correlation_matrix_method}, &#34;
                    f&#34;method = &#39;square&#39;, type = &#39;upper&#39;, lab = TRUE) + &#34;
                    f&#34;ggtitle(&#39;{method.title()} Correlation Matrix&#39;)\n\n&#34;
                )

    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>Function to generate R script for Correlation Matrix using ggcorrplot</p></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.get_selected_columns"><code class="name flex">
<span>def <span class="ident">get_selected_columns</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_columns(self):
    return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Mapping widget to model
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.selected_list: (self.selected_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    filtered_items = []
    contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

    for item in items:
        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            continue

        if target_widget == self.selected_list:
            filtered_items.append(item)
        else:
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                filtered_items.append(item)

    if contains_string:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    for other_widget, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    if target_widget == self.data_editor_list:
        ordered = [col for col in self.all_columns_model1 if col in current_items]
        target_model.setStringList(ordered)
    elif target_widget == self.data_output_list:
        ordered = [col for col in self.all_columns_model2 if col in current_items]
        target_model.setStringList(ordered)
    else:
        target_model.setStringList(current_items)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    &#34;&#34;&#34;
    Removes selected variables from the selected list and generates the R script.
    &#34;&#34;&#34;
    selected_indexes = self.selected_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    selected_list = self.selected_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Check if the item belongs to model1 (editor) or model2 (output)
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
                # Re-sort according to all_columns_model1
                editor_list = [col for col in self.all_columns_model1 if col in editor_list]

        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)
                # Re-sort according to all_columns_model2
                output_list = [col for col in self.all_columns_model2 if col in output_list]

        # Remove from selected
        if item in selected_list:
            selected_list.remove(item)

    self.selected_model.setStringList(selected_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Removes selected variables from the selected list and generates the R script.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.exploration" href="index.html">saePisan.view.components.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog">CorrelationMatrixDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.accept" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.add_variable" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.add_variable">add_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.closeEvent" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.generate_r_script" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.get_column_with_dtype" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.get_selected_columns" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.get_selected_columns">get_selected_columns</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.handle_drop" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.remove_variable" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.set_model" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.toggle_r_script_visibility" href="#saePisan.view.components.exploration.CorrelationMatrikDialog.CorrelationMatrixDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_9_9">
                <div class="file-header">
                    <div>ğŸ“„ MulticollinearityDialog</div>
                    <div class="file-path">view/components/exploration/MulticollinearityDialog.html (57.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.exploration.MulticollinearityDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog"><code class="flex name class">
<span>class <span class="ident">MulticollinearityDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MulticollinearityDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for handling multicollinearity analysis in a dataset.
    
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns in model1.
        all_columns_model2 (list): List of all columns in model2.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor section.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output section.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (QListView): List view for the data output.
        remove_button1 (QPushButton): Button to remove selected variables.
        add_dependent_variable_button (QPushButton): Button to add a dependent variable.
        add_independent_variable_button (QPushButton): Button to add independent variables.
        dependent_variable_label (QLabel): Label for the dependent variable section.
        dependent_variable_model (QStringListModel): Model for the dependent variable list view.
        dependent_variable_list (QListView): List view for the dependent variable.
        independent_variable_label (QLabel): Label for the independent variable section.
        independent_variable_model (QStringListModel): Model for the independent variable list view.
        independent_variable_list (QListView): List view for the independent variable.
        regression_line_checkbox (QCheckBox): Checkbox to show regression model.
        script_label (QLabel): Label for the R script section.
        icon_label (QLabel): Label to show running icon.
        script_box (QTextEdit): Text edit box to display the generated R script.
        run_button (QPushButton): Button to run the analysis.
    
    Methods:
        __init__(self, parent): Initializes the dialog with the given parent.
        set_model(self, model1, model2): Sets the data models for the dialog.
        get_column_with_dtype(self, model): Returns columns with their data types.
        add_dependent_variable(self): Adds a selected variable as the dependent variable.
        add_independent_variables(self): Adds selected variables as independent variables.
        remove_variable(self): Removes selected variables from the dependent or independent lists.
        get_selected_dependent_variable(self): Returns the selected dependent variable.
        get_selected_independent_variables(self): Returns the selected independent variables.
        accept(self): Runs the multicollinearity analysis and displays the results.
        closeEvent(self, event): Clears selected variables and script when the dialog is closed.
        generate_r_script(self): Generates the R script for Variance Inflation Factor (VIF) calculation.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Multicollinearity&#34;)

        # Store the status of selected variables
        self.selected_status = {}

        # Main layout
        self.main_layout = QVBoxLayout(self)

        # Main content layout
        content_layout = QHBoxLayout()

        # Left layout: Data Editor and Data Output
        left_layout = QVBoxLayout()

        # Data Editor
        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        # Data Output
        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Central Layout: Buttons
        button_layout1 = QVBoxLayout()
        self.remove_button1 = QPushButton(&#34;ğŸ¡„&#34;, self)
        self.remove_button1.clicked.connect(self.remove_variable) 
        self.remove_button1.setStyleSheet(&#34;font-size: 24px;&#34;) 
        self.remove_button1.setFixedSize(50,35)
        button_layout1.addStretch(3)
        button_layout1.addWidget(self.remove_button1)
        button_layout1.addStretch(7)

        button_layout2 = QVBoxLayout()
        self.add_dependent_variable_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_dependent_variable_button.clicked.connect(self.add_dependent_variable)
        self.add_dependent_variable_button.setStyleSheet(&#34;font-size: 24px;&#34;)
        self.add_dependent_variable_button.setFixedSize(50,35)

        self.add_independent_variable_button = QPushButton(&#34;ğŸ¡†&#34;, self)  
        self.add_independent_variable_button.clicked.connect(self.add_independent_variables)
        self.add_independent_variable_button.setStyleSheet(&#34;font-size: 24px;&#34;)
        self.add_independent_variable_button.setFixedSize(50,35)

        button_layout2.addStretch(1)
        button_layout2.addWidget(self.add_dependent_variable_button)
        button_layout2.addStretch(5)
        button_layout2.addWidget(self.add_independent_variable_button)
        button_layout2.addStretch(6)

        # Add both button layouts to content_layout
        content_layout.addLayout(button_layout1)
        content_layout.addLayout(button_layout2)

        # Right layout: Selected variables, methods, and graphs
        right_layout = QVBoxLayout()

        # Dependent variable Axis
        dependent_variable_layout = QVBoxLayout()
        self.dependent_variable_label = QLabel(&#34;Dependent Variable&#34;, self)
        self.dependent_variable_model = QStringListModel()
        self.dependent_variable_list = DragDropListView(parent=self)
        self.dependent_variable_list.setModel(self.dependent_variable_model)
        self.dependent_variable_list.setSelectionMode(QListView.SelectionMode.MultiSelection)

        # Limit height 
        item_height = 30  
        self.dependent_variable_list.setFixedHeight(item_height + 4)  

        dependent_variable_layout.addWidget(self.dependent_variable_label)
        dependent_variable_layout.addWidget(self.dependent_variable_list)
        right_layout.addLayout(dependent_variable_layout)

        # Independent variable Axis
        independent_variable_layout = QVBoxLayout()
        self.independent_variable_label = QLabel(&#34;Independent Variable&#34;, self)
        self.independent_variable_model = QStringListModel()
        self.independent_variable_list = DragDropListView(parent=self)
        self.independent_variable_list.setModel(self.independent_variable_model)
        self.independent_variable_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        independent_variable_layout.addWidget(self.independent_variable_label)
        independent_variable_layout.addWidget(self.independent_variable_list)
        right_layout.addLayout(independent_variable_layout, 1)  # Set stretch factor to 1 to fill remaining space

        # Model options group
        model_options_group = QGroupBox(&#34;Model Options&#34;)  # Change the name of the model options group
        model_options_layout = QVBoxLayout()
        self.regression_line_checkbox = QCheckBox(&#34;Show Regression Model&#34;, self)  # New checkbox for regression line
        self.regression_line_checkbox.stateChanged.connect(self.generate_r_script)
        model_options_layout.addWidget(self.regression_line_checkbox)  # Add the regression line checkbox to the layout
        model_options_group.setLayout(model_options_layout)
        right_layout.addWidget(model_options_group)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        # Script box
        self.script_layout = QHBoxLayout() 
        self.script_label = QLabel(&#34;R Script:&#34;, self)

        self.icon_label = QLabel(self)
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight)

        spacer = QSpacerItem(40, 10, QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Minimum)

        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Run button
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)
        
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.independent_variable_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.dependent_variable_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Peta widget ke model dan daftar kolom asal
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.dependent_variable_list: (self.dependent_variable_model, None),
            self.independent_variable_list: (self.independent_variable_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        # Validasi: hanya 1 variabel untuk dependent
        if target_widget == self.dependent_variable_list:
            if len(items) &gt; 1 or len(current_items) &gt;= 1:
                QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
                return

        filtered_items = []
        contains_invalid = False

        for item in items:
            if target_widget in [self.dependent_variable_list, self.independent_variable_list]:
                # Tolak jika [String] atau [None]
                if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                    contains_invalid = True
                    continue
                filtered_items.append(item)
            else:
                # Editor/output hanya cocokkan dengan kolom aslinya
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and any(column_name == col.split(&#34; &#34;)[0] for col in allowed_columns):
                    filtered_items.append(item)

        # Tampilkan warning kalau ada item tidak valid, tapi tetap proses yang valid
        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Hapus dari semua model lain
        for _, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Tambahkan ke target jika belum ada
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Urutkan kembali jika editor atau output
        if target_widget in [self.data_editor_list, self.data_output_list]:
            if target_widget == self.data_editor_list:
                original_order = self.all_columns_model1
            else:
                original_order = self.all_columns_model2

            reference_map = {col: i for i, col in enumerate(original_order)}
            current_items = sorted(current_items, key=lambda x: reference_map.get(x, float(&#39;inf&#39;)))

        target_model.setStringList(current_items)
        self.generate_r_script()
        
    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns
    
    def add_dependent_variable(self):
        if len(self.dependent_variable_model.stringList()) &gt;= 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
            return

        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        if not selected_items:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select a variable first!&#34;)
            return

        if len(selected_items) &gt; 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select only one variable!&#34;)
            return

        item = selected_items[0]

        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variable must be of type Numeric.&#34;)
            return

        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        self.dependent_variable_model.setStringList([item])
        self.generate_r_script()

    
    def add_independent_variables(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.independent_variable_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
        selected_items = [item for item in selected_items if &#34;[String]&#34; not in item and &#34;[None]&#34; not in item]

        if contains_invalid:
            QMessageBox.warning(None, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.independent_variable_model.setStringList(selected_list)
        self.generate_r_script()

    def remove_variable(self):
        # Get selected indexes from dependent and independent lists
        selected_dependent_variable_indexes = self.dependent_variable_list.selectedIndexes()
        selected_independent_variable_indexes = self.independent_variable_list.selectedIndexes()

        # Get selected items
        selected_items = [index.data() for index in selected_dependent_variable_indexes + selected_independent_variable_indexes]

        # Get current variable lists
        dependent_variable_list = self.dependent_variable_model.stringList()
        independent_variable_list = self.independent_variable_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            # Check if it comes from model1 or model2 based on column name only (without type)
            column_name = item.split(&#34; &#34;)[0]

            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)

            # Remove from dependent and independent lists if present
            if item in dependent_variable_list:
                dependent_variable_list.remove(item)
            if item in independent_variable_list:
                independent_variable_list.remove(item)
            
        # Sort ulang agar urutannya konsisten seperti semula
        editor_list.sort(key=lambda x: self.all_columns_model1.index(x) if x in self.all_columns_model1 else float(&#39;inf&#39;))
        output_list.sort(key=lambda x: self.all_columns_model2.index(x) if x in self.all_columns_model2 else float(&#39;inf&#39;))

        # Update model-model
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.dependent_variable_model.setStringList(dependent_variable_list)
        self.independent_variable_model.setStringList(independent_variable_list)

        # Perbarui script
        self.generate_r_script()

    def get_selected_dependent_variable(self):
        return [
            item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
            for item in self.dependent_variable_model.stringList()
        ]
    
    def get_selected_independent_variables(self):
        return [
            item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
            for item in self.independent_variable_model.stringList()
        ]
    
    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return

        if len(self.get_selected_independent_variables()) &lt; 2:
            QMessageBox.warning(self, &#34;Invalid Independent Variables&#34;, &#34;Please select at least two independent variables.&#34;)
            return
        
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)

        multicollinearity = Multicollinearity(self.model1, self.model2)
        
        if self.regression_line_checkbox.isChecked():
            multicollinearity.reg_model = True
        
        controller = MulticollinearityController(multicollinearity)
        controller.run_model(r_script)

        if multicollinearity.error:
            QMessageBox.critical(self, &#34;Multicollinearity&#34;, multicollinearity.result)
        else:
            QMessageBox.information(self, &#34;Multicollinearity&#34;, &#34;Exploration has been completed.&#34;)
        # self.parent.add_output(script_text=r_script, result_text=multicollinearity.result)
        display_script_and_output(self.parent, r_script, multicollinearity.result)
        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.close()

    def closeEvent(self, event):
        &#34;&#34;&#34;Menghapus variabel yang dipilih ketika dialog ditutup.&#34;&#34;&#34;
        self.dependent_variable_model.setStringList([]) 
        self.independent_variable_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)  
        event.accept()

    def generate_r_script(self):
        &#34;&#34;&#34;Function to generate R script for Variance Inflation Factor (VIF) calculation&#34;&#34;&#34;
        # Get selected dependent and independent variables
        dependent_var = self.get_selected_dependent_variable()
        independent_vars = self.get_selected_independent_variables()

        # Check if dependent_var and independent_vars are empty
        if not dependent_var or not independent_vars:
            self.script_box.setPlainText(&#34;&#34;) 
            return

        # Pastikan dependent_var adalah string dan bersihkan tanda kutip
        if isinstance(dependent_var, list):
            dependent_var = dependent_var[0]  
        dependent_var = str(dependent_var).strip(&#34;[]&#39;\&#34;&#34;)  

        # Format independent variables dengan backticks jika mengandung karakter khusus
        formatted_independent_vars = &#34; + &#34;.join(
            [f&#34;`{var}`&#34; for var in independent_vars]
        )
        
        # Buat script R yang valid
        r_script = (
            f&#34;regression_model &lt;- lm(`{dependent_var}` ~ {formatted_independent_vars}, data=data)\n&#34;
            f&#34;vif_values &lt;- vif(regression_model)\n&#34;
        )

        # Display the generated R script
        self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>A dialog for handling multicollinearity analysis in a dataset.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in model1.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in model2.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor section.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output section.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>remove_button1</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>add_dependent_variable_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add a dependent variable.</dd>
<dt><strong><code>add_independent_variable_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add independent variables.</dd>
<dt><strong><code>dependent_variable_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the dependent variable section.</dd>
<dt><strong><code>dependent_variable_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the dependent variable list view.</dd>
<dt><strong><code>dependent_variable_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the dependent variable.</dd>
<dt><strong><code>independent_variable_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the independent variable section.</dd>
<dt><strong><code>independent_variable_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the independent variable list view.</dd>
<dt><strong><code>independent_variable_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the independent variable.</dd>
<dt><strong><code>regression_line_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox to show regression model.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script section.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label to show running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the analysis.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(self, parent): Initializes the dialog with the given parent.
set_model(self, model1, model2): Sets the data models for the dialog.
get_column_with_dtype(self, model): Returns columns with their data types.
add_dependent_variable(self): Adds a selected variable as the dependent variable.
add_independent_variables(self): Adds selected variables as independent variables.
remove_variable(self): Removes selected variables from the dependent or independent lists.
get_selected_dependent_variable(self): Returns the selected dependent variable.
get_selected_independent_variables(self): Returns the selected independent variables.
accept(self): Runs the multicollinearity analysis and displays the results.
closeEvent(self, event): Clears selected variables and script when the dialog is closed.
generate_r_script(self): Generates the R script for Variance Inflation Factor (VIF) calculation.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return

    if len(self.get_selected_independent_variables()) &lt; 2:
        QMessageBox.warning(self, &#34;Invalid Independent Variables&#34;, &#34;Please select at least two independent variables.&#34;)
        return
    
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)

    multicollinearity = Multicollinearity(self.model1, self.model2)
    
    if self.regression_line_checkbox.isChecked():
        multicollinearity.reg_model = True
    
    controller = MulticollinearityController(multicollinearity)
    controller.run_model(r_script)

    if multicollinearity.error:
        QMessageBox.critical(self, &#34;Multicollinearity&#34;, multicollinearity.result)
    else:
        QMessageBox.information(self, &#34;Multicollinearity&#34;, &#34;Exploration has been completed.&#34;)
    # self.parent.add_output(script_text=r_script, result_text=multicollinearity.result)
    display_script_and_output(self.parent, r_script, multicollinearity.result)
    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.add_dependent_variable"><code class="name flex">
<span>def <span class="ident">add_dependent_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_dependent_variable(self):
    if len(self.dependent_variable_model.stringList()) &gt;= 1:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
        return

    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    if not selected_items:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select a variable first!&#34;)
        return

    if len(selected_items) &gt; 1:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select only one variable!&#34;)
        return

    item = selected_items[0]

    if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variable must be of type Numeric.&#34;)
        return

    if item in self.data_editor_model.stringList():
        editor_list = self.data_editor_model.stringList()
        editor_list.remove(item)
        self.data_editor_model.setStringList(editor_list)
    elif item in self.data_output_model.stringList():
        output_list = self.data_output_model.stringList()
        output_list.remove(item)
        self.data_output_model.setStringList(output_list)

    self.dependent_variable_model.setStringList([item])
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.add_independent_variables"><code class="name flex">
<span>def <span class="ident">add_independent_variables</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_independent_variables(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.independent_variable_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
    selected_items = [item for item in selected_items if &#34;[String]&#34; not in item and &#34;[None]&#34; not in item]

    if contains_invalid:
        QMessageBox.warning(None, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.independent_variable_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    &#34;&#34;&#34;Menghapus variabel yang dipilih ketika dialog ditutup.&#34;&#34;&#34;
    self.dependent_variable_model.setStringList([]) 
    self.independent_variable_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)  
    event.accept()</code></pre>
</details>
<div class="desc"><p>Menghapus variabel yang dipilih ketika dialog ditutup.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    &#34;&#34;&#34;Function to generate R script for Variance Inflation Factor (VIF) calculation&#34;&#34;&#34;
    # Get selected dependent and independent variables
    dependent_var = self.get_selected_dependent_variable()
    independent_vars = self.get_selected_independent_variables()

    # Check if dependent_var and independent_vars are empty
    if not dependent_var or not independent_vars:
        self.script_box.setPlainText(&#34;&#34;) 
        return

    # Pastikan dependent_var adalah string dan bersihkan tanda kutip
    if isinstance(dependent_var, list):
        dependent_var = dependent_var[0]  
    dependent_var = str(dependent_var).strip(&#34;[]&#39;\&#34;&#34;)  

    # Format independent variables dengan backticks jika mengandung karakter khusus
    formatted_independent_vars = &#34; + &#34;.join(
        [f&#34;`{var}`&#34; for var in independent_vars]
    )
    
    # Buat script R yang valid
    r_script = (
        f&#34;regression_model &lt;- lm(`{dependent_var}` ~ {formatted_independent_vars}, data=data)\n&#34;
        f&#34;vif_values &lt;- vif(regression_model)\n&#34;
    )

    # Display the generated R script
    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>Function to generate R script for Variance Inflation Factor (VIF) calculation</p></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_selected_dependent_variable"><code class="name flex">
<span>def <span class="ident">get_selected_dependent_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_dependent_variable(self):
    return [
        item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
        for item in self.dependent_variable_model.stringList()
    ]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_selected_independent_variables"><code class="name flex">
<span>def <span class="ident">get_selected_independent_variables</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_independent_variables(self):
    return [
        item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
        for item in self.independent_variable_model.stringList()
    ]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Peta widget ke model dan daftar kolom asal
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.dependent_variable_list: (self.dependent_variable_model, None),
        self.independent_variable_list: (self.independent_variable_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    # Validasi: hanya 1 variabel untuk dependent
    if target_widget == self.dependent_variable_list:
        if len(items) &gt; 1 or len(current_items) &gt;= 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
            return

    filtered_items = []
    contains_invalid = False

    for item in items:
        if target_widget in [self.dependent_variable_list, self.independent_variable_list]:
            # Tolak jika [String] atau [None]
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                contains_invalid = True
                continue
            filtered_items.append(item)
        else:
            # Editor/output hanya cocokkan dengan kolom aslinya
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and any(column_name == col.split(&#34; &#34;)[0] for col in allowed_columns):
                filtered_items.append(item)

    # Tampilkan warning kalau ada item tidak valid, tapi tetap proses yang valid
    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Hapus dari semua model lain
    for _, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Tambahkan ke target jika belum ada
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Urutkan kembali jika editor atau output
    if target_widget in [self.data_editor_list, self.data_output_list]:
        if target_widget == self.data_editor_list:
            original_order = self.all_columns_model1
        else:
            original_order = self.all_columns_model2

        reference_map = {col: i for i, col in enumerate(original_order)}
        current_items = sorted(current_items, key=lambda x: reference_map.get(x, float(&#39;inf&#39;)))

    target_model.setStringList(current_items)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    # Get selected indexes from dependent and independent lists
    selected_dependent_variable_indexes = self.dependent_variable_list.selectedIndexes()
    selected_independent_variable_indexes = self.independent_variable_list.selectedIndexes()

    # Get selected items
    selected_items = [index.data() for index in selected_dependent_variable_indexes + selected_independent_variable_indexes]

    # Get current variable lists
    dependent_variable_list = self.dependent_variable_model.stringList()
    independent_variable_list = self.independent_variable_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        # Check if it comes from model1 or model2 based on column name only (without type)
        column_name = item.split(&#34; &#34;)[0]

        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)

        # Remove from dependent and independent lists if present
        if item in dependent_variable_list:
            dependent_variable_list.remove(item)
        if item in independent_variable_list:
            independent_variable_list.remove(item)
        
    # Sort ulang agar urutannya konsisten seperti semula
    editor_list.sort(key=lambda x: self.all_columns_model1.index(x) if x in self.all_columns_model1 else float(&#39;inf&#39;))
    output_list.sort(key=lambda x: self.all_columns_model2.index(x) if x in self.all_columns_model2 else float(&#39;inf&#39;))

    # Update model-model
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.dependent_variable_model.setStringList(dependent_variable_list)
    self.independent_variable_model.setStringList(independent_variable_list)

    # Perbarui script
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.exploration" href="index.html">saePisan.view.components.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog">MulticollinearityDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.accept" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.add_dependent_variable" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.add_dependent_variable">add_dependent_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.add_independent_variables" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.add_independent_variables">add_independent_variables</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.closeEvent" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.generate_r_script" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_column_with_dtype" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_selected_dependent_variable" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_selected_dependent_variable">get_selected_dependent_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_selected_independent_variables" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.get_selected_independent_variables">get_selected_independent_variables</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.handle_drop" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.remove_variable" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.set_model" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.toggle_r_script_visibility" href="#saePisan.view.components.exploration.MulticollinearityDialog.MulticollinearityDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_0">
                <div class="file-header">
                    <div>ğŸ“„ NormalityTestDialog</div>
                    <div class="file-path">view/components/exploration/NormalityTestDialog.html (51.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.exploration.NormalityTestDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog"><code class="flex name class">
<span>class <span class="ident">NormalityTestDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class NormalityTestDialog(QDialog):
    &#34;&#34;&#34;z
    A dialog for performing normality tests on selected variables from two data models.
    
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns in the first data model.
        all_columns_model2 (list): List of all columns in the second data model.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor section.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (DragDropListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output section.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (DragDropListView): List view for the data output.
        add_button (QPushButton): Button to add selected variables.
        remove_button (QPushButton): Button to remove selected variables.
        selected_label (QLabel): Label for the selected variables section.
        selected_model (QStringListModel): Model for the selected variables list view.
        selected_list (DragDropListView): List view for the selected variables.
        shapiro_checkbox (QCheckBox): Checkbox for the Shapiro-Wilk test.
        jarque_checkbox (QCheckBox): Checkbox for the Jarque-Bera test.
        lilliefors_checkbox (QCheckBox): Checkbox for the Lilliefors test.
        histogram_checkbox (QCheckBox): Checkbox for displaying histograms.
        qqplot_checkbox (QCheckBox): Checkbox for displaying Q-Q plots.
        script_layout (QHBoxLayout): Layout for the R script section.
        script_label (QLabel): Label for the R script section.
        icon_label (QLabel): Label for the running icon.
        script_box (QTextEdit): Text box for displaying the generated R script.
        run_button (QPushButton): Button to run the normality test.
    
    Methods:
        __init__(parent): Initializes the dialog and its components.
        set_model(model1, model2): Sets the data models and updates the data editor and output lists.
        get_column_with_dtype(model): Returns a list of columns with their data types from the given model.
        add_variable(): Adds selected variables to the selected list and updates the R script.
        remove_variable(): Removes selected variables from the selected list and updates the R script.
        get_selected_columns(): Returns a list of selected columns without their data types.
        generate_r_script(): Generates the R script based on selected variables, methods, and graph options.
        accept(): Runs the normality test using the generated R script and displays the results.
        closeEvent(event): Resets the dialog when it is closed.
        handle_drop(target_widget, items): Handles the drop event for drag-and-drop functionality.
        toggle_r_script_visibility(): Toggles the visibility of the R script text edit area.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Normality Test&#34;)

        # Store selected variable status
        self.selected_status = {}

        # Main layout
        self.main_layout = QVBoxLayout(self)

        # Main content layout
        content_layout = QHBoxLayout()

        # Left layout: Data Editor and Data Output
        left_layout = QVBoxLayout()

        # Data Editor
        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list =  DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        # Data Output
        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list =  DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Middle layout: Buttons
        button_layout = QVBoxLayout()
        self.add_button = QPushButton(&#34;ğŸ¡†&#34;, self)  
        self.add_button.clicked.connect(self.add_variable)
        self.add_button.setFixedSize(50, 35) 
        self.add_button.setStyleSheet(&#34;font-size: 24px;&#34;)  
        self.remove_button = QPushButton(&#34;ğŸ¡„&#34;, self)  
        self.remove_button.clicked.connect(self.remove_variable)
        self.remove_button.setFixedSize(50, 35)
        self.remove_button.setStyleSheet(&#34;font-size: 24px;&#34;) 
        button_layout.addStretch()
        button_layout.addWidget(self.add_button)
        button_layout.addWidget(self.remove_button)
        button_layout.addStretch()
        content_layout.addLayout(button_layout)

        # Right layout: Selected variables, methods, and graphs
        right_layout = QVBoxLayout()
        self.selected_label = QLabel(&#34;Variables&#34;, self)
        self.selected_model = QStringListModel()
        self.selected_list =  DragDropListView(parent=self)
        self.selected_list.setModel(self.selected_model)
        self.selected_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        right_layout.addWidget(self.selected_label)
        right_layout.addWidget(self.selected_list)

        # Method group with checkboxes
        method_group = QGroupBox(&#34;Methods&#34;)
        method_layout = QVBoxLayout()
        self.shapiro_checkbox = QCheckBox(&#34;Shapiro-Wilk&#34;)
        self.jarque_checkbox = QCheckBox(&#34;Jarque-Bera&#34;)
        self.lilliefors_checkbox = QCheckBox(&#34;Lilliefors&#34;)
        self.shapiro_checkbox.stateChanged.connect(self.generate_r_script)
        self.jarque_checkbox.stateChanged.connect(self.generate_r_script)
        self.lilliefors_checkbox.stateChanged.connect(self.generate_r_script)
        method_layout.addWidget(self.shapiro_checkbox)
        method_layout.addWidget(self.jarque_checkbox)
        method_layout.addWidget(self.lilliefors_checkbox)
        method_group.setLayout(method_layout)
        right_layout.addWidget(method_group)

        # Graph group
        graph_group = QGroupBox(&#34;Graph&#34;)
        graph_layout = QVBoxLayout()
        self.histogram_checkbox = QCheckBox(&#34;Histogram&#34;, self)
        self.histogram_checkbox.stateChanged.connect(self.generate_r_script)
        self.qqplot_checkbox = QCheckBox(&#34;Q-Q Plot&#34;, self)
        self.qqplot_checkbox.stateChanged.connect(self.generate_r_script)
        graph_layout.addWidget(self.histogram_checkbox)
        graph_layout.addWidget(self.qqplot_checkbox)
        graph_group.setLayout(graph_layout)
        right_layout.addWidget(graph_group)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        self.script_layout = QHBoxLayout() 
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        spacer = QSpacerItem(40, 10, QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Minimum)

        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Run button
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)

        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.selected_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Mapping widget to model
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.selected_list: (self.selected_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        filtered_items = []
        contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

        for item in items:
            # Tolak jika String atau None
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                continue

            if target_widget == self.selected_list:
                filtered_items.append(item)
            else:
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                    filtered_items.append(item)

        # â—ï¸Warning kalau ada String atau None
        if contains_string:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Tambahkan item yang valid ke target
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Hapus dari model lain
        for other_widget, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Urutkan kembali
        if target_widget == self.data_editor_list:
            ordered = [col for col in self.all_columns_model1 if col in current_items]
            target_model.setStringList(ordered)
        elif target_widget == self.data_output_list:
            ordered = [col for col in self.all_columns_model2 if col in current_items]
            target_model.setStringList(ordered)
        else:
            target_model.setStringList(current_items)

        self.generate_r_script()

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    

    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)


    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns

    
    def add_variable(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.selected_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

        selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

        # Tampilkan warning jika ada yang tidak valid
        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()


    def remove_variable(self):
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.selected_model.stringList()

        for item in selected_items:
            column_name = item.split(&#39; &#39;)[0]
            if column_name in [col.split(&#39; &#39;)[0] for col in self.all_columns_model1]:
                editor_list = self.data_editor_model.stringList()
                editor_list.append(item)
                self.data_editor_model.setStringList(editor_list)
            elif column_name in [col.split(&#39; &#39;)[0] for col in self.all_columns_model2]:
                output_list = self.data_output_model.stringList()
                output_list.append(item)
                self.data_output_model.setStringList(output_list)

            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()

    def remove_variable(self):
        &#34;&#34;&#34;
        Removes selected variables from the selected list and generates the R script.
        &#34;&#34;&#34;
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        selected_list = self.selected_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Check if the item belongs to model1 (editor) or model2 (output)
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
                    # Re-sort according to all_columns_model1
                    editor_list = [col for col in self.all_columns_model1 if col in editor_list]

            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)
                    # Re-sort according to all_columns_model2
                    output_list = [col for col in self.all_columns_model2 if col in output_list]

            # Remove from selected
            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.generate_r_script()
    
    def get_selected_columns(self):
        return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]

    def generate_r_script(self):
        selected_vars = self.get_selected_columns()
        
        if len(selected_vars) == 0:
            self.script_box.setPlainText(&#34;&#34;)
            return
        
        selected_methods = []
        if self.shapiro_checkbox.isChecked():
            selected_methods.append(&#34;shapiro&#34;)
        if self.jarque_checkbox.isChecked():
            selected_methods.append(&#34;jarque_bera&#34;)
        if self.lilliefors_checkbox.isChecked():
            selected_methods.append(&#34;lilliefors&#34;)
        
        if not selected_methods:
            self.script_box.setPlainText(&#34;&#34;)
            return

        show_histogram = self.histogram_checkbox.isChecked()
        show_qqplot = self.qqplot_checkbox.isChecked()

        r_script = &#39;&#39;

        for var in selected_vars:
            safe_var = var.replace(&#34; &#34;, &#34;_&#34;)  # Ganti spasi jadi underscore untuk nama variabel

            for method in selected_methods:
                if method == &#34;shapiro&#34;:
                    r_script += f&#34;normality_results_{safe_var}_shapiro &lt;- shapiro.test(data$`{var}`)\n&#34;
                elif method == &#34;jarque_bera&#34;:
                    r_script += f&#34;normality_results_{safe_var}_jarque &lt;- tseries::jarque.bera.test(data$`{var}`)\n&#34;
                elif method == &#34;lilliefors&#34;:
                    r_script += f&#34;normality_results_{safe_var}_lilliefors &lt;- nortest::lillie.test(data$`{var}`)\n&#34;

            if show_histogram:
                r_script += (
                    f&#34;histogram_{safe_var} &lt;- ggplot(data, aes(x = `{var}`)) +\n&#34;
                    f&#34;    geom_histogram(bins = 10, color = &#39;black&#39;, fill = &#39;darkorange3&#39;) +\n&#34;
                    f&#34;    ggtitle(&#39;Histogram of {var}&#39;) +\n&#34;
                    f&#34;    xlab(&#39;{var}&#39;) +\n&#34;
                    f&#34;    ylab(&#39;Frequency&#39;)\n&#34;
                )

            if show_qqplot:
                r_script += (
                    f&#34;qqplot_{safe_var} &lt;- ggplot(data, aes(sample = `{var}`)) +\n&#34;
                    f&#34;    stat_qq() +\n&#34;
                    f&#34;    stat_qq_line(color = &#39;darkorange3&#39;) +\n&#34;
                    f&#34;    ggtitle(&#39;Q-Q Plot of {var}&#39;) +\n&#34;
                    f&#34;    xlab(&#39;Theoretical Quantiles&#39;) +\n&#34;
                    f&#34;    ylab(&#39;Sample Quantiles&#39;)\n&#34;
                )

        self.script_box.setPlainText(r_script)

    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)
        normality_test = NormalityTest(self.model1, self.model2, self.get_selected_columns())
        print(&#34;Plot:&#34;, normality_test.plot)
        controller = NormalityTestController(normality_test)
        controller.run_model(r_script)

        if not normality_test.error:
            QMessageBox.information(self, &#34;Normality Test&#34;, &#34;Exploration has been completed.&#34;)
        else:
            QMessageBox.critical(self, &#34;Normality Test&#34;, normality_test.result) 
        print(&#34;Plot:&#34;, normality_test.plot)
        # self.parent.add_output(r_script, normality_test.result, normality_test.plot)
        display_script_and_output(self.parent, r_script, normality_test.result, normality_test.plot)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)
        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        self.selected_model.setStringList([]) 
        self.script_box.setPlainText(&#34;&#34;) 
        event.accept()</code></pre>
</details>
<div class="desc"><p>z
A dialog for performing normality tests on selected variables from two data models.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in the first data model.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in the second data model.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor section.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>DragDropListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output section.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>DragDropListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>add_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add selected variables.</dd>
<dt><strong><code>remove_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>selected_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the selected variables section.</dd>
<dt><strong><code>selected_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the selected variables list view.</dd>
<dt><strong><code>selected_list</code></strong> :&ensp;<code>DragDropListView</code></dt>
<dd>List view for the selected variables.</dd>
<dt><strong><code>shapiro_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for the Shapiro-Wilk test.</dd>
<dt><strong><code>jarque_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for the Jarque-Bera test.</dd>
<dt><strong><code>lilliefors_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for the Lilliefors test.</dd>
<dt><strong><code>histogram_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for displaying histograms.</dd>
<dt><strong><code>qqplot_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for displaying Q-Q plots.</dd>
<dt><strong><code>script_layout</code></strong> :&ensp;<code>QHBoxLayout</code></dt>
<dd>Layout for the R script section.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script section.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text box for displaying the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the normality test.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(parent): Initializes the dialog and its components.
set_model(model1, model2): Sets the data models and updates the data editor and output lists.
get_column_with_dtype(model): Returns a list of columns with their data types from the given model.
add_variable(): Adds selected variables to the selected list and updates the R script.
remove_variable(): Removes selected variables from the selected list and updates the R script.
get_selected_columns(): Returns a list of selected columns without their data types.
generate_r_script(): Generates the R script based on selected variables, methods, and graph options.
accept(): Runs the normality test using the generated R script and displays the results.
closeEvent(event): Resets the dialog when it is closed.
handle_drop(target_widget, items): Handles the drop event for drag-and-drop functionality.
toggle_r_script_visibility(): Toggles the visibility of the R script text edit area.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)
    normality_test = NormalityTest(self.model1, self.model2, self.get_selected_columns())
    print(&#34;Plot:&#34;, normality_test.plot)
    controller = NormalityTestController(normality_test)
    controller.run_model(r_script)

    if not normality_test.error:
        QMessageBox.information(self, &#34;Normality Test&#34;, &#34;Exploration has been completed.&#34;)
    else:
        QMessageBox.critical(self, &#34;Normality Test&#34;, normality_test.result) 
    print(&#34;Plot:&#34;, normality_test.plot)
    # self.parent.add_output(r_script, normality_test.result, normality_test.plot)
    display_script_and_output(self.parent, r_script, normality_test.result, normality_test.plot)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)
    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.add_variable"><code class="name flex">
<span>def <span class="ident">add_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.selected_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

    selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

    # Tampilkan warning jika ada yang tidak valid
    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.selected_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    self.selected_model.setStringList([]) 
    self.script_box.setPlainText(&#34;&#34;) 
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    selected_vars = self.get_selected_columns()
    
    if len(selected_vars) == 0:
        self.script_box.setPlainText(&#34;&#34;)
        return
    
    selected_methods = []
    if self.shapiro_checkbox.isChecked():
        selected_methods.append(&#34;shapiro&#34;)
    if self.jarque_checkbox.isChecked():
        selected_methods.append(&#34;jarque_bera&#34;)
    if self.lilliefors_checkbox.isChecked():
        selected_methods.append(&#34;lilliefors&#34;)
    
    if not selected_methods:
        self.script_box.setPlainText(&#34;&#34;)
        return

    show_histogram = self.histogram_checkbox.isChecked()
    show_qqplot = self.qqplot_checkbox.isChecked()

    r_script = &#39;&#39;

    for var in selected_vars:
        safe_var = var.replace(&#34; &#34;, &#34;_&#34;)  # Ganti spasi jadi underscore untuk nama variabel

        for method in selected_methods:
            if method == &#34;shapiro&#34;:
                r_script += f&#34;normality_results_{safe_var}_shapiro &lt;- shapiro.test(data$`{var}`)\n&#34;
            elif method == &#34;jarque_bera&#34;:
                r_script += f&#34;normality_results_{safe_var}_jarque &lt;- tseries::jarque.bera.test(data$`{var}`)\n&#34;
            elif method == &#34;lilliefors&#34;:
                r_script += f&#34;normality_results_{safe_var}_lilliefors &lt;- nortest::lillie.test(data$`{var}`)\n&#34;

        if show_histogram:
            r_script += (
                f&#34;histogram_{safe_var} &lt;- ggplot(data, aes(x = `{var}`)) +\n&#34;
                f&#34;    geom_histogram(bins = 10, color = &#39;black&#39;, fill = &#39;darkorange3&#39;) +\n&#34;
                f&#34;    ggtitle(&#39;Histogram of {var}&#39;) +\n&#34;
                f&#34;    xlab(&#39;{var}&#39;) +\n&#34;
                f&#34;    ylab(&#39;Frequency&#39;)\n&#34;
            )

        if show_qqplot:
            r_script += (
                f&#34;qqplot_{safe_var} &lt;- ggplot(data, aes(sample = `{var}`)) +\n&#34;
                f&#34;    stat_qq() +\n&#34;
                f&#34;    stat_qq_line(color = &#39;darkorange3&#39;) +\n&#34;
                f&#34;    ggtitle(&#39;Q-Q Plot of {var}&#39;) +\n&#34;
                f&#34;    xlab(&#39;Theoretical Quantiles&#39;) +\n&#34;
                f&#34;    ylab(&#39;Sample Quantiles&#39;)\n&#34;
            )

    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.get_selected_columns"><code class="name flex">
<span>def <span class="ident">get_selected_columns</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_columns(self):
    return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Mapping widget to model
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.selected_list: (self.selected_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    filtered_items = []
    contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

    for item in items:
        # Tolak jika String atau None
        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            continue

        if target_widget == self.selected_list:
            filtered_items.append(item)
        else:
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                filtered_items.append(item)

    # â—ï¸Warning kalau ada String atau None
    if contains_string:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Tambahkan item yang valid ke target
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Hapus dari model lain
    for other_widget, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Urutkan kembali
    if target_widget == self.data_editor_list:
        ordered = [col for col in self.all_columns_model1 if col in current_items]
        target_model.setStringList(ordered)
    elif target_widget == self.data_output_list:
        ordered = [col for col in self.all_columns_model2 if col in current_items]
        target_model.setStringList(ordered)
    else:
        target_model.setStringList(current_items)

    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    &#34;&#34;&#34;
    Removes selected variables from the selected list and generates the R script.
    &#34;&#34;&#34;
    selected_indexes = self.selected_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    selected_list = self.selected_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Check if the item belongs to model1 (editor) or model2 (output)
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
                # Re-sort according to all_columns_model1
                editor_list = [col for col in self.all_columns_model1 if col in editor_list]

        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)
                # Re-sort according to all_columns_model2
                output_list = [col for col in self.all_columns_model2 if col in output_list]

        # Remove from selected
        if item in selected_list:
            selected_list.remove(item)

    self.selected_model.setStringList(selected_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Removes selected variables from the selected list and generates the R script.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.exploration" href="index.html">saePisan.view.components.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog">NormalityTestDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.accept" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.add_variable" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.add_variable">add_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.closeEvent" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.generate_r_script" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.get_column_with_dtype" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.get_selected_columns" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.get_selected_columns">get_selected_columns</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.handle_drop" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.remove_variable" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.set_model" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.toggle_r_script_visibility" href="#saePisan.view.components.exploration.NormalityTestDialog.NormalityTestDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_1">
                <div class="file-header">
                    <div>ğŸ“„ SummaryDataDialog</div>
                    <div class="file-path">view/components/exploration/SummaryDataDialog.html (45.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.exploration.SummaryDataDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog"><code class="flex name class">
<span>class <span class="ident">SummaryDataDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SummaryDataDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for summarizing data from two models and generating an R script.
    
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns in model1.
        all_columns_model2 (list): List of all columns in model2.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor list.
        data_editor_model (QStringListModel): Model for the data editor list.
        data_editor_list (DragDropListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output list.
        data_output_model (QStringListModel): Model for the data output list.
        data_output_list (DragDropListView): List view for the data output.
        add_button (QPushButton): Button to add variables to the selected list.
        remove_button (QPushButton): Button to remove variables from the selected list.
        selected_label (QLabel): Label for the selected variables list.
        selected_model (QStringListModel): Model for the selected variables list.
        selected_list (DragDropListView): List view for the selected variables.
        script_label (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        script_box (QTextEdit): Text box to display the generated R script.
        run_button (QPushButton): Button to run the R script.
    Methods:
        __init__(self, parent): Initializes the dialog with the given parent.
        set_model(self, model1, model2): Sets the data models and updates the lists.
        get_column_with_dtype(self, model): Returns a list of columns with their data types.
        add_variable(self): Adds selected variables to the selected list and generates the R script.
        remove_variable(self): Removes selected variables from the selected list and generates the R script.
        get_selected_columns(self): Returns a list of selected columns without data types.
        generate_r_script(self): Generates the R script based on selected variables.
        accept(self): Runs the R script and handles the result.
        closeEvent(self, event): Resets the dialog when it is closed.
        handle_drop(self, target_widget, items): Handles the drop event for the list views.
        toggle_r_script_visibility(self): Toggles the visibility of the R script text edit area.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent) 
        self.parent = parent
        self.model1 = None
        self.model2 = None
        
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Summary Data&#34;)

        # Store selected variable status
        self.selected_status = {}

        # Main layout
        self.main_layout = QVBoxLayout(self)
        content_layout = QHBoxLayout()

        # Left layout for Data Editor and Data Output
        left_layout = QVBoxLayout()

        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Middle layout for buttons
        button_layout = QVBoxLayout()
        self.add_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_button.clicked.connect(self.add_variable)
        self.add_button.setFixedSize(50, 35) 
        self.add_button.setStyleSheet(&#34;font-size: 24px;&#34;)  
        self.remove_button = QPushButton(&#34;ğŸ¡„&#34;, self)
        self.remove_button.clicked.connect(self.remove_variable)
        self.remove_button.setFixedSize(50, 35)
        self.remove_button.setStyleSheet(&#34;font-size: 24px;&#34;) 
        button_layout.addStretch()
        button_layout.addWidget(self.add_button)
        button_layout.addWidget(self.remove_button)
        button_layout.addStretch()
        content_layout.addLayout(button_layout)

        # Right layout
        right_layout = QVBoxLayout()
        self.selected_label = QLabel(&#34;Variable&#34;, self)
        self.selected_model = QStringListModel()
        self.selected_list = DragDropListView(parent=self)
        self.selected_list.setModel(self.selected_model)
        self.selected_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        right_layout.addWidget(self.selected_label)
        right_layout.addWidget(self.selected_list)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        # Horizontal layout for label and icon
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)
        
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Run button
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)

        # Selection mode for list view
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.selected_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Mapping widget to model
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.selected_list: (self.selected_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        filtered_items = []
        contains_none = False

        for item in items:
            if &#34;[None]&#34; in item:
                contains_none = True
                continue

            if target_widget == self.selected_list:
                filtered_items.append(item)
            else:
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                    filtered_items.append(item)

        # â—ï¸Tampilkan peringatan jika ada item [None]
        if contains_none:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Cannot drop variables with type None.&#34;)

        # Tambahkan item yang lolos ke model target
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Hapus dari model lain
        for other_widget, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Atur ulang urutan
        if target_widget == self.data_editor_list:
            ordered = [col for col in self.all_columns_model1 if col in current_items]
            target_model.setStringList(ordered)
        elif target_widget == self.data_output_list:
            ordered = [col for col in self.all_columns_model2 if col in current_items]
            target_model.setStringList(ordered)
        else:
            target_model.setStringList(current_items)

        self.generate_r_script()


    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button icon.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    
    def set_model(self, model1, model2):
        &#34;&#34;&#34;
        Sets the data models and updates the lists in the dialog.
        
        Args:
            model1 (Any): The first data model.
            model2 (Any): The second data model.
        &#34;&#34;&#34;
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns

    def add_variable(self):
        &#34;&#34;&#34;
        Adds selected variables to the selected list and generates the R script.
        Variables of type None are not allowed.
        &#34;&#34;&#34;
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        contains_none = any(&#34;[None]&#34; in item for item in selected_items)
        if contains_none:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must not be of type None.&#34;)
            return

        selected_list = self.selected_model.stringList()

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()

    def remove_variable(self):
        &#34;&#34;&#34;
        Removes selected variables from the selected list and generates the R script.
        &#34;&#34;&#34;
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        selected_list = self.selected_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Check if the item belongs to model1 (editor) or model2 (output)
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
                    # Re-sort according to all_columns_model1
                    editor_list = [col for col in self.all_columns_model1 if col in editor_list]

            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)
                    # Re-sort according to all_columns_model2
                    output_list = [col for col in self.all_columns_model2 if col in output_list]

            # Remove from selected
            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.generate_r_script()

    def get_selected_columns(self):
        &#34;&#34;&#34;
        Returns a list of selected columns without data types.
        
        Returns:
            list: A list of selected column names.
        &#34;&#34;&#34;
        return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]

    def generate_r_script(self):
        &#34;&#34;&#34;
        Generates the R script based on selected variables and updates the script box.
        &#34;&#34;&#34;
        selected_columns = self.get_selected_columns()
        if not selected_columns:
            self.script_box.setPlainText(&#34;&#34;)
            return
        formatted_columns = &#39;, &#39;.join(f&#39;&#34;{col}&#34;&#39; for col in selected_columns)
        script = f&#34;summary_results &lt;- summary(data[, c({formatted_columns})])&#34;
        self.script_box.setPlainText(script)

    def accept(self):
        &#34;&#34;&#34;
        Runs the R script and handles the result, displaying messages based on success or failure.
        &#34;&#34;&#34;
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)
        summary_data = SummaryData(self.model1, self.model2)

        controller = SummaryDataController(summary_data)
        controller.run_model(r_script)

        if not summary_data.error:
            QMessageBox.information(self, &#34;Summary Data&#34;, &#34;Exploration has been completed.&#34;)
        else:
            QMessageBox.critical(self, &#34;Summary Data&#34;, summary_data.result)
            
        # self.parent.add_output(r_script, summary_data.result)
        print(r_script)
        display_script_and_output(self.parent, r_script, summary_data.result)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)
        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        &#34;&#34;&#34;
        Resets the dialog when it is closed.
        
        Args:
            event (QCloseEvent): The close event.
        &#34;&#34;&#34;
        self.selected_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)
        event.accept()</code></pre>
</details>
<div class="desc"><p>A dialog for summarizing data from two models and generating an R script.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in model1.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in model2.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor list.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>DragDropListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output list.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>DragDropListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>add_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add variables to the selected list.</dd>
<dt><strong><code>remove_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove variables from the selected list.</dd>
<dt><strong><code>selected_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the selected variables list.</dd>
<dt><strong><code>selected_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the selected variables list.</dd>
<dt><strong><code>selected_list</code></strong> :&ensp;<code>DragDropListView</code></dt>
<dd>List view for the selected variables.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the R script.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(self, parent): Initializes the dialog with the given parent.
set_model(self, model1, model2): Sets the data models and updates the lists.
get_column_with_dtype(self, model): Returns a list of columns with their data types.
add_variable(self): Adds selected variables to the selected list and generates the R script.
remove_variable(self): Removes selected variables from the selected list and generates the R script.
get_selected_columns(self): Returns a list of selected columns without data types.
generate_r_script(self): Generates the R script based on selected variables.
accept(self): Runs the R script and handles the result.
closeEvent(self, event): Resets the dialog when it is closed.
handle_drop(self, target_widget, items): Handles the drop event for the list views.
toggle_r_script_visibility(self): Toggles the visibility of the R script text edit area.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    &#34;&#34;&#34;
    Runs the R script and handles the result, displaying messages based on success or failure.
    &#34;&#34;&#34;
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)
    summary_data = SummaryData(self.model1, self.model2)

    controller = SummaryDataController(summary_data)
    controller.run_model(r_script)

    if not summary_data.error:
        QMessageBox.information(self, &#34;Summary Data&#34;, &#34;Exploration has been completed.&#34;)
    else:
        QMessageBox.critical(self, &#34;Summary Data&#34;, summary_data.result)
        
    # self.parent.add_output(r_script, summary_data.result)
    print(r_script)
    display_script_and_output(self.parent, r_script, summary_data.result)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)
    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>Runs the R script and handles the result, displaying messages based on success or failure.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.add_variable"><code class="name flex">
<span>def <span class="ident">add_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable(self):
    &#34;&#34;&#34;
    Adds selected variables to the selected list and generates the R script.
    Variables of type None are not allowed.
    &#34;&#34;&#34;
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    contains_none = any(&#34;[None]&#34; in item for item in selected_items)
    if contains_none:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must not be of type None.&#34;)
        return

    selected_list = self.selected_model.stringList()

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.selected_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Adds selected variables to the selected list and generates the R script.
Variables of type None are not allowed.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    &#34;&#34;&#34;
    Resets the dialog when it is closed.
    
    Args:
        event (QCloseEvent): The close event.
    &#34;&#34;&#34;
    self.selected_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)
    event.accept()</code></pre>
</details>
<div class="desc"><p>Resets the dialog when it is closed.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>event</code></strong> :&ensp;<code>QCloseEvent</code></dt>
<dd>The close event.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    &#34;&#34;&#34;
    Generates the R script based on selected variables and updates the script box.
    &#34;&#34;&#34;
    selected_columns = self.get_selected_columns()
    if not selected_columns:
        self.script_box.setPlainText(&#34;&#34;)
        return
    formatted_columns = &#39;, &#39;.join(f&#39;&#34;{col}&#34;&#39; for col in selected_columns)
    script = f&#34;summary_results &lt;- summary(data[, c({formatted_columns})])&#34;
    self.script_box.setPlainText(script)</code></pre>
</details>
<div class="desc"><p>Generates the R script based on selected variables and updates the script box.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.get_selected_columns"><code class="name flex">
<span>def <span class="ident">get_selected_columns</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_columns(self):
    &#34;&#34;&#34;
    Returns a list of selected columns without data types.
    
    Returns:
        list: A list of selected column names.
    &#34;&#34;&#34;
    return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]</code></pre>
</details>
<div class="desc"><p>Returns a list of selected columns without data types.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>A list of selected column names.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Mapping widget to model
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.selected_list: (self.selected_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    filtered_items = []
    contains_none = False

    for item in items:
        if &#34;[None]&#34; in item:
            contains_none = True
            continue

        if target_widget == self.selected_list:
            filtered_items.append(item)
        else:
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                filtered_items.append(item)

    # â—ï¸Tampilkan peringatan jika ada item [None]
    if contains_none:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Cannot drop variables with type None.&#34;)

    # Tambahkan item yang lolos ke model target
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Hapus dari model lain
    for other_widget, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Atur ulang urutan
    if target_widget == self.data_editor_list:
        ordered = [col for col in self.all_columns_model1 if col in current_items]
        target_model.setStringList(ordered)
    elif target_widget == self.data_output_list:
        ordered = [col for col in self.all_columns_model2 if col in current_items]
        target_model.setStringList(ordered)
    else:
        target_model.setStringList(current_items)

    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    &#34;&#34;&#34;
    Removes selected variables from the selected list and generates the R script.
    &#34;&#34;&#34;
    selected_indexes = self.selected_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    selected_list = self.selected_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Check if the item belongs to model1 (editor) or model2 (output)
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
                # Re-sort according to all_columns_model1
                editor_list = [col for col in self.all_columns_model1 if col in editor_list]

        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)
                # Re-sort according to all_columns_model2
                output_list = [col for col in self.all_columns_model2 if col in output_list]

        # Remove from selected
        if item in selected_list:
            selected_list.remove(item)

    self.selected_model.setStringList(selected_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Removes selected variables from the selected list and generates the R script.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    &#34;&#34;&#34;
    Sets the data models and updates the lists in the dialog.
    
    Args:
        model1 (Any): The first data model.
        model2 (Any): The second data model.
    &#34;&#34;&#34;
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"><p>Sets the data models and updates the lists in the dialog.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
</dl></div>
</dd>
<dt id="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button icon.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button icon.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.exploration" href="index.html">saePisan.view.components.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog">SummaryDataDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.accept" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.add_variable" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.add_variable">add_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.closeEvent" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.generate_r_script" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.get_column_with_dtype" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.get_selected_columns" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.get_selected_columns">get_selected_columns</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.handle_drop" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.remove_variable" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.set_model" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.toggle_r_script_visibility" href="#saePisan.view.components.exploration.SummaryDataDialog.SummaryDataDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_2">
                <div class="file-header">
                    <div>ğŸ“„ VariableSelectionDialog</div>
                    <div class="file-path">view/components/exploration/VariableSelectionDialog.html (62.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.exploration.VariableSelectionDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog"><code class="flex name class">
<span>class <span class="ident">VariableSelectionDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class VariableSelectionDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for selecting variables for regression analysis.
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns in model1.
        all_columns_model2 (list): List of all columns in model2.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (QListView): List view for the data output.
        remove_button1 (QPushButton): Button to remove selected variables.
        add_dependent_variable_button (QPushButton): Button to add a dependent variable.
        add_independent_variable_button (QPushButton): Button to add independent variables.
        dependent_variable_label (QLabel): Label for the dependent variable list.
        dependent_variable_model (QStringListModel): Model for the dependent variable list view.
        dependent_variable_list (QListView): List view for the dependent variable.
        independent_variable_label (QLabel): Label for the independent variable list.
        independent_variable_model (QStringListModel): Model for the independent variable list view.
        independent_variable_list (QListView): List view for the independent variable.
        forward_checkbox (QCheckBox): Checkbox for forward selection method.
        backward_checkbox (QCheckBox): Checkbox for backward selection method.
        stepwise_checkbox (QCheckBox): Checkbox for stepwise selection method.
        script_label (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        script_box (QTextEdit): Text box to display the generated R script.
        run_button (QPushButton): Button to run the variable selection.
    Methods:
        __init__(self, parent): Initializes the dialog.
        set_model(self, model1, model2): Sets the data models for the dialog.
        get_column_with_dtype(self, model): Returns a list of columns with their data types.
        dependent_variable(self): Adds a selected variable to the dependent variable list.
        independent_variables(self): Adds selected variables to the independent variable list.
        remove_variable(self): Removes selected variables from the dependent and independent variable lists.
        get_selected_dependent_variable(self): Returns the selected dependent variable.
        get_selected_independent_variables(self): Returns the selected independent variables.
        accept(self): Runs the variable selection process.
        closeEvent(self, event): Clears selected variables when the dialog is closed.
        get_selected_methods(self): Returns the selected variable selection methods.
        generate_r_script(self): Generates the R script for variable selection.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Variable Selection&#34;)

        # Menyimpan status variabel yang dipilih
        self.selected_status = {}

        # Layout utama
        self.main_layout = QVBoxLayout(self)

        # Layout konten utama
        content_layout = QHBoxLayout()

        # Layout kiri: Data Editor dan Data Output
        left_layout = QVBoxLayout()

        # Data Editor
        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        # Data Output
        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Central Layout: Buttons
        button_layout1 = QVBoxLayout()
        self.remove_button1 = QPushButton(&#34;ğŸ¡„&#34;, self)
        self.remove_button1.clicked.connect(self.remove_variable) 
        self.remove_button1.setStyleSheet(&#34;font-size: 24px;&#34;) 
        self.remove_button1.setFixedSize(50,35)
        button_layout1.addStretch(3)
        button_layout1.addWidget(self.remove_button1)
        button_layout1.addStretch(7)

        button_layout2 = QVBoxLayout()
        self.add_dependent_variable_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_dependent_variable_button.clicked.connect(self.add_dependent_variable)
        self.add_dependent_variable_button.setStyleSheet(&#34;font-size: 24px;&#34;)
        self.add_dependent_variable_button.setFixedSize(50,35)

        self.add_independent_variable_button = QPushButton(&#34;ğŸ¡†&#34;, self)  
        self.add_independent_variable_button.clicked.connect(self.add_independent_variables)
        self.add_independent_variable_button.setStyleSheet(&#34;font-size: 24px;&#34;)
        self.add_independent_variable_button.setFixedSize(50,35)

        button_layout2.addStretch(1)
        button_layout2.addWidget(self.add_dependent_variable_button)
        button_layout2.addStretch(4)
        button_layout2.addWidget(self.add_independent_variable_button)
        button_layout2.addStretch(6)

        # Menambahkan kedua layout tombol ke content_layout
        content_layout.addLayout(button_layout1)
        content_layout.addLayout(button_layout2)

        # Layout kanan: Variabel yang dipilih, metode, dan grafik
        right_layout = QVBoxLayout()

        # dependent_variable Axis
        dependent_variable_layout = QVBoxLayout()
        self.dependent_variable_label = QLabel(&#34;Dependent Variable&#34;, self)
        self.dependent_variable_model = QStringListModel()
        self.dependent_variable_list = DragDropListView(parent=self)
        self.dependent_variable_list.setModel(self.dependent_variable_model)
        self.dependent_variable_list.setSelectionMode(QListView.SelectionMode.MultiSelection)

        # Batasi tinggi 
        item_height = 30  
        self.dependent_variable_list.setFixedHeight(item_height + 4)  

        dependent_variable_layout.addWidget(self.dependent_variable_label)
        dependent_variable_layout.addWidget(self.dependent_variable_list)
        right_layout.addLayout(dependent_variable_layout)


        # independent_variable Axis
        independent_variable_layout = QVBoxLayout()
        self.independent_variable_label = QLabel(&#34;Independent Variable&#34;, self)
        self.independent_variable_model = QStringListModel()
        self.independent_variable_list = DragDropListView(parent=self)
        self.independent_variable_list.setModel(self.independent_variable_model)
        self.independent_variable_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        independent_variable_layout.addWidget(self.independent_variable_label)
        independent_variable_layout.addWidget(self.independent_variable_list)
        right_layout.addLayout(independent_variable_layout,1)

        # Grup Variable Selection Method (Dipisah)
        selection_method_group = QGroupBox(&#34;Variable Selection Method&#34;)
        selection_method_layout = QVBoxLayout()

        self.forward_checkbox = QCheckBox(&#34;Forward&#34;)
        self.backward_checkbox = QCheckBox(&#34;Backward&#34;)
        self.stepwise_checkbox = QCheckBox(&#34;Stepwise&#34;)

        # Tambahkan event listener untuk setiap checkbox
        self.forward_checkbox.stateChanged.connect(self.generate_r_script)
        self.backward_checkbox.stateChanged.connect(self.generate_r_script)
        self.stepwise_checkbox.stateChanged.connect(self.generate_r_script)

        # Tambahkan checkbox ke layout
        selection_method_layout.addWidget(self.forward_checkbox)
        selection_method_layout.addWidget(self.backward_checkbox)
        selection_method_layout.addWidget(self.stepwise_checkbox)
        selection_method_group.setLayout(selection_method_layout)
        right_layout.addWidget(selection_method_group)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        self.script_layout = QHBoxLayout() 
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # spacer removed because it was unused

        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)
        # Tombol Run
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)
        
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.independent_variable_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.dependent_variable_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)


    def handle_drop(self, target_widget, items):
        # Peta widget ke model dan daftar kolom asal
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.dependent_variable_list: (self.dependent_variable_model, None),
            self.independent_variable_list: (self.independent_variable_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        # Validasi: hanya 1 variabel untuk dependent
        if target_widget == self.dependent_variable_list:
            if len(items) &gt; 1 or len(current_items) &gt;= 1:
                QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
                return

        filtered_items = []
        contains_invalid = False

        for item in items:
            if target_widget in [self.dependent_variable_list, self.independent_variable_list]:
                # Tolak jika [String] atau [None]
                if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                    contains_invalid = True
                    continue
                filtered_items.append(item)
            else:
                # Editor/output hanya cocokkan dengan kolom aslinya
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and any(column_name == col.split(&#34; &#34;)[0] for col in allowed_columns):
                    filtered_items.append(item)

        # Tampilkan warning kalau ada item tidak valid, tapi tetap proses yang valid
        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Hapus dari semua model lain
        for _, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Tambahkan ke target jika belum ada
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Urutkan kembali jika editor atau output
        if target_widget in [self.data_editor_list, self.data_output_list]:
            if target_widget == self.data_editor_list:
                original_order = self.all_columns_model1
            else:
                original_order = self.all_columns_model2

            reference_map = {col: i for i, col in enumerate(original_order)}
            current_items = sorted(current_items, key=lambda x: reference_map.get(x, float(&#39;inf&#39;)))

        target_model.setStringList(current_items)
        self.generate_r_script()

    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns
    
    def add_dependent_variable(self):
        if len(self.dependent_variable_model.stringList()) &gt;= 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
            return

        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        if not selected_items:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select a variable first!&#34;)
            return

        if len(selected_items) &gt; 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select only one variable!&#34;)
            return

        item = selected_items[0]

        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variable must be of type Numeric.&#34;)
            return

        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        self.dependent_variable_model.setStringList([item])
        self.generate_r_script()

    
    def add_independent_variables(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.independent_variable_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
        selected_items = [item for item in selected_items if &#34;[String]&#34; not in item and &#34;[None]&#34; not in item]

        if contains_invalid:
            QMessageBox.warning(None, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.independent_variable_model.setStringList(selected_list)
        self.generate_r_script()



    def remove_variable(self):
        # Get selected indexes from dependent and independent lists
        selected_dependent_variable_indexes = self.dependent_variable_list.selectedIndexes()
        selected_independent_variable_indexes = self.independent_variable_list.selectedIndexes()

        # Get selected items
        selected_items = [index.data() for index in selected_dependent_variable_indexes + selected_independent_variable_indexes]

        # Get current variable lists
        dependent_variable_list = self.dependent_variable_model.stringList()
        independent_variable_list = self.independent_variable_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            # Check if it comes from model1 or model2 based on column name only (without type)
            column_name = item.split(&#34; &#34;)[0]

            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)

            # Remove from dependent and independent lists if present
            if item in dependent_variable_list:
                dependent_variable_list.remove(item)
            if item in independent_variable_list:
                independent_variable_list.remove(item)

        # Re-sort to maintain the original order
        editor_list.sort(key=lambda x: self.all_columns_model1.index(x) if x in self.all_columns_model1 else float(&#39;inf&#39;))
        output_list.sort(key=lambda x: self.all_columns_model2.index(x) if x in self.all_columns_model2 else float(&#39;inf&#39;))

        # Update models
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.dependent_variable_model.setStringList(dependent_variable_list)
        self.independent_variable_model.setStringList(independent_variable_list)

        # Update script
        self.generate_r_script()
        
    def get_selected_dependent_variable(self):
        return [
            item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
            for item in self.dependent_variable_model.stringList()
        ]
    
    def get_selected_independent_variables(self):
        return [
            item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
            for item in self.independent_variable_model.stringList()
        ]
    
    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return

        if len(self.get_selected_independent_variables()) &lt; 2:
            QMessageBox.warning(self, &#34;Invalid Independent Variables&#34;, &#34;Please select at least two independent variables.&#34;)
            return
        
        selected_methods = self.get_selected_methods()
        if not selected_methods:
            QMessageBox.warning(self, &#34;Invalid Selection Methods&#34;, &#34;Please select at least one selection method.&#34;)
            return
        
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)

        variable_selection = VariableSelection(self.model1, self.model2)

        controller =  VariableSelectionController(variable_selection)
        controller.run_model(r_script)

        if variable_selection.error:
            QMessageBox.critical(self, &#34;Variable Selection&#34;, variable_selection.result)
        else:
            QMessageBox.information(self, &#34;Variable Selection&#34;, &#34;Exploration has been completed.&#34;)
            
        # self.parent.add_output(script_text=r_script, result_text=variable_selection.result)
        display_script_and_output(self.parent,r_script, variable_selection.result)
        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        &#34;&#34;&#34;Menghapus variabel yang dipilih ketika dialog ditutup.&#34;&#34;&#34;
        self.dependent_variable_model.setStringList([]) 
        self.independent_variable_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)  
        event.accept()

    def get_selected_methods(self):
        &#34;&#34;&#34;Function to check selected selection methods&#34;&#34;&#34;
        selected_methods = []
        if self.forward_checkbox.isChecked():
            selected_methods.append(&#34;forward&#34;)
        if self.backward_checkbox.isChecked():
            selected_methods.append(&#34;backward&#34;)
        if self.stepwise_checkbox.isChecked():
            selected_methods.append(&#34;both&#34;)
        return selected_methods

    def generate_r_script(self):
        &#34;&#34;&#34;Function to generate R script for Variable Selection&#34;&#34;&#34;
        # Get selected dependent and independent variables
        dependent_var = self.get_selected_dependent_variable()
        independent_vars = self.get_selected_independent_variables()

        # Check if dependent_var and independent_vars are empty
        if not dependent_var or not independent_vars:
            self.script_box.setPlainText(&#34;&#34;) 
            return

        # Make sure dependent_var is a string and remove quotation marks
        if isinstance(dependent_var, list):
            dependent_var = dependent_var[0]  
        dependent_var = str(dependent_var).strip(&#34;[]&#39;\&#34;&#34;)  

        # Format independent variables with backticks if they contain special characters
        formatted_independent_vars = &#34; + &#34;.join(
            [f&#34;`{var}`&#34; for var in independent_vars]
        )

        # Initialize base model
        r_script = (
            f&#34;# Initial regression model\n&#34;
            f&#34;null_model &lt;- lm(`{dependent_var}` ~ 1, data=data)\n&#34;
            f&#34;full_model &lt;- lm(`{dependent_var}` ~ {formatted_independent_vars}, data=data)\n\n&#34;
        )

        selected_methods = self.get_selected_methods()
        # If no methods are selected, display a message
        if not selected_methods:
            self.script_box.setPlainText(&#34;&#34;)
            return

        # Add script for each selected method
        for method in selected_methods:
            model_var = f&#34;{method}_model&#34;  # Variable name for the model
            result_var = f&#34;{method}_result&#34;  # Variable name for the summary result

            r_script += (
            f&#34;{model_var} &lt;- stats::step(null_model, \n&#34;
            f&#34;                      scope = list(lower = null_model, upper = full_model), \n&#34;
            f&#34;                      direction = \&#34;{method}\&#34;)\n\n&#34;
            )

            # Add model summary
            r_script += f&#34;{result_var} &lt;- summary({model_var})\n\n&#34;

        # Display the generated script
        self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>A dialog for selecting variables for regression analysis.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in model1.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in model2.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>remove_button1</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>add_dependent_variable_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add a dependent variable.</dd>
<dt><strong><code>add_independent_variable_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add independent variables.</dd>
<dt><strong><code>dependent_variable_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the dependent variable list.</dd>
<dt><strong><code>dependent_variable_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the dependent variable list view.</dd>
<dt><strong><code>dependent_variable_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the dependent variable.</dd>
<dt><strong><code>independent_variable_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the independent variable list.</dd>
<dt><strong><code>independent_variable_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the independent variable list view.</dd>
<dt><strong><code>independent_variable_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the independent variable.</dd>
<dt><strong><code>forward_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for forward selection method.</dd>
<dt><strong><code>backward_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for backward selection method.</dd>
<dt><strong><code>stepwise_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox for stepwise selection method.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the variable selection.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(self, parent): Initializes the dialog.
set_model(self, model1, model2): Sets the data models for the dialog.
get_column_with_dtype(self, model): Returns a list of columns with their data types.
dependent_variable(self): Adds a selected variable to the dependent variable list.
independent_variables(self): Adds selected variables to the independent variable list.
remove_variable(self): Removes selected variables from the dependent and independent variable lists.
get_selected_dependent_variable(self): Returns the selected dependent variable.
get_selected_independent_variables(self): Returns the selected independent variables.
accept(self): Runs the variable selection process.
closeEvent(self, event): Clears selected variables when the dialog is closed.
get_selected_methods(self): Returns the selected variable selection methods.
generate_r_script(self): Generates the R script for variable selection.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return

    if len(self.get_selected_independent_variables()) &lt; 2:
        QMessageBox.warning(self, &#34;Invalid Independent Variables&#34;, &#34;Please select at least two independent variables.&#34;)
        return
    
    selected_methods = self.get_selected_methods()
    if not selected_methods:
        QMessageBox.warning(self, &#34;Invalid Selection Methods&#34;, &#34;Please select at least one selection method.&#34;)
        return
    
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)

    variable_selection = VariableSelection(self.model1, self.model2)

    controller =  VariableSelectionController(variable_selection)
    controller.run_model(r_script)

    if variable_selection.error:
        QMessageBox.critical(self, &#34;Variable Selection&#34;, variable_selection.result)
    else:
        QMessageBox.information(self, &#34;Variable Selection&#34;, &#34;Exploration has been completed.&#34;)
        
    # self.parent.add_output(script_text=r_script, result_text=variable_selection.result)
    display_script_and_output(self.parent,r_script, variable_selection.result)
    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.add_dependent_variable"><code class="name flex">
<span>def <span class="ident">add_dependent_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_dependent_variable(self):
    if len(self.dependent_variable_model.stringList()) &gt;= 1:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
        return

    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    if not selected_items:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select a variable first!&#34;)
        return

    if len(selected_items) &gt; 1:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select only one variable!&#34;)
        return

    item = selected_items[0]

    if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variable must be of type Numeric.&#34;)
        return

    if item in self.data_editor_model.stringList():
        editor_list = self.data_editor_model.stringList()
        editor_list.remove(item)
        self.data_editor_model.setStringList(editor_list)
    elif item in self.data_output_model.stringList():
        output_list = self.data_output_model.stringList()
        output_list.remove(item)
        self.data_output_model.setStringList(output_list)

    self.dependent_variable_model.setStringList([item])
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.add_independent_variables"><code class="name flex">
<span>def <span class="ident">add_independent_variables</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_independent_variables(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.independent_variable_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
    selected_items = [item for item in selected_items if &#34;[String]&#34; not in item and &#34;[None]&#34; not in item]

    if contains_invalid:
        QMessageBox.warning(None, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.independent_variable_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    &#34;&#34;&#34;Menghapus variabel yang dipilih ketika dialog ditutup.&#34;&#34;&#34;
    self.dependent_variable_model.setStringList([]) 
    self.independent_variable_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)  
    event.accept()</code></pre>
</details>
<div class="desc"><p>Menghapus variabel yang dipilih ketika dialog ditutup.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    &#34;&#34;&#34;Function to generate R script for Variable Selection&#34;&#34;&#34;
    # Get selected dependent and independent variables
    dependent_var = self.get_selected_dependent_variable()
    independent_vars = self.get_selected_independent_variables()

    # Check if dependent_var and independent_vars are empty
    if not dependent_var or not independent_vars:
        self.script_box.setPlainText(&#34;&#34;) 
        return

    # Make sure dependent_var is a string and remove quotation marks
    if isinstance(dependent_var, list):
        dependent_var = dependent_var[0]  
    dependent_var = str(dependent_var).strip(&#34;[]&#39;\&#34;&#34;)  

    # Format independent variables with backticks if they contain special characters
    formatted_independent_vars = &#34; + &#34;.join(
        [f&#34;`{var}`&#34; for var in independent_vars]
    )

    # Initialize base model
    r_script = (
        f&#34;# Initial regression model\n&#34;
        f&#34;null_model &lt;- lm(`{dependent_var}` ~ 1, data=data)\n&#34;
        f&#34;full_model &lt;- lm(`{dependent_var}` ~ {formatted_independent_vars}, data=data)\n\n&#34;
    )

    selected_methods = self.get_selected_methods()
    # If no methods are selected, display a message
    if not selected_methods:
        self.script_box.setPlainText(&#34;&#34;)
        return

    # Add script for each selected method
    for method in selected_methods:
        model_var = f&#34;{method}_model&#34;  # Variable name for the model
        result_var = f&#34;{method}_result&#34;  # Variable name for the summary result

        r_script += (
        f&#34;{model_var} &lt;- stats::step(null_model, \n&#34;
        f&#34;                      scope = list(lower = null_model, upper = full_model), \n&#34;
        f&#34;                      direction = \&#34;{method}\&#34;)\n\n&#34;
        )

        # Add model summary
        r_script += f&#34;{result_var} &lt;- summary({model_var})\n\n&#34;

    # Display the generated script
    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>Function to generate R script for Variable Selection</p></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_dependent_variable"><code class="name flex">
<span>def <span class="ident">get_selected_dependent_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_dependent_variable(self):
    return [
        item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
        for item in self.dependent_variable_model.stringList()
    ]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_independent_variables"><code class="name flex">
<span>def <span class="ident">get_selected_independent_variables</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_independent_variables(self):
    return [
        item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
        for item in self.independent_variable_model.stringList()
    ]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_methods"><code class="name flex">
<span>def <span class="ident">get_selected_methods</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_methods(self):
    &#34;&#34;&#34;Function to check selected selection methods&#34;&#34;&#34;
    selected_methods = []
    if self.forward_checkbox.isChecked():
        selected_methods.append(&#34;forward&#34;)
    if self.backward_checkbox.isChecked():
        selected_methods.append(&#34;backward&#34;)
    if self.stepwise_checkbox.isChecked():
        selected_methods.append(&#34;both&#34;)
    return selected_methods</code></pre>
</details>
<div class="desc"><p>Function to check selected selection methods</p></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Peta widget ke model dan daftar kolom asal
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.dependent_variable_list: (self.dependent_variable_model, None),
        self.independent_variable_list: (self.independent_variable_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    # Validasi: hanya 1 variabel untuk dependent
    if target_widget == self.dependent_variable_list:
        if len(items) &gt; 1 or len(current_items) &gt;= 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the dependent_variable Axis!&#34;)
            return

    filtered_items = []
    contains_invalid = False

    for item in items:
        if target_widget in [self.dependent_variable_list, self.independent_variable_list]:
            # Tolak jika [String] atau [None]
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                contains_invalid = True
                continue
            filtered_items.append(item)
        else:
            # Editor/output hanya cocokkan dengan kolom aslinya
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and any(column_name == col.split(&#34; &#34;)[0] for col in allowed_columns):
                filtered_items.append(item)

    # Tampilkan warning kalau ada item tidak valid, tapi tetap proses yang valid
    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Hapus dari semua model lain
    for _, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Tambahkan ke target jika belum ada
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Urutkan kembali jika editor atau output
    if target_widget in [self.data_editor_list, self.data_output_list]:
        if target_widget == self.data_editor_list:
            original_order = self.all_columns_model1
        else:
            original_order = self.all_columns_model2

        reference_map = {col: i for i, col in enumerate(original_order)}
        current_items = sorted(current_items, key=lambda x: reference_map.get(x, float(&#39;inf&#39;)))

    target_model.setStringList(current_items)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    # Get selected indexes from dependent and independent lists
    selected_dependent_variable_indexes = self.dependent_variable_list.selectedIndexes()
    selected_independent_variable_indexes = self.independent_variable_list.selectedIndexes()

    # Get selected items
    selected_items = [index.data() for index in selected_dependent_variable_indexes + selected_independent_variable_indexes]

    # Get current variable lists
    dependent_variable_list = self.dependent_variable_model.stringList()
    independent_variable_list = self.independent_variable_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        # Check if it comes from model1 or model2 based on column name only (without type)
        column_name = item.split(&#34; &#34;)[0]

        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)

        # Remove from dependent and independent lists if present
        if item in dependent_variable_list:
            dependent_variable_list.remove(item)
        if item in independent_variable_list:
            independent_variable_list.remove(item)

    # Re-sort to maintain the original order
    editor_list.sort(key=lambda x: self.all_columns_model1.index(x) if x in self.all_columns_model1 else float(&#39;inf&#39;))
    output_list.sort(key=lambda x: self.all_columns_model2.index(x) if x in self.all_columns_model2 else float(&#39;inf&#39;))

    # Update models
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.dependent_variable_model.setStringList(dependent_variable_list)
    self.independent_variable_model.setStringList(independent_variable_list)

    # Update script
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.exploration" href="index.html">saePisan.view.components.exploration</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog">VariableSelectionDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.accept" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.add_dependent_variable" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.add_dependent_variable">add_dependent_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.add_independent_variables" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.add_independent_variables">add_independent_variables</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.closeEvent" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.generate_r_script" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_column_with_dtype" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_dependent_variable" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_dependent_variable">get_selected_dependent_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_independent_variables" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_independent_variables">get_selected_independent_variables</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_methods" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.get_selected_methods">get_selected_methods</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.handle_drop" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.remove_variable" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.set_model" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.toggle_r_script_visibility" href="#saePisan.view.components.exploration.VariableSelectionDialog.VariableSelectionDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_3">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">view/components/exploration/index.html (9.1 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.view.components.exploration</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.view.components.exploration.CorrelationMatrikDialog" href="CorrelationMatrikDialog.html">saePisan.view.components.exploration.CorrelationMatrikDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.exploration.MulticollinearityDialog" href="MulticollinearityDialog.html">saePisan.view.components.exploration.MulticollinearityDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.exploration.NormalityTestDialog" href="NormalityTestDialog.html">saePisan.view.components.exploration.NormalityTestDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.exploration.SummaryDataDialog" href="SummaryDataDialog.html">saePisan.view.components.exploration.SummaryDataDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.exploration.VariableSelectionDialog" href="VariableSelectionDialog.html">saePisan.view.components.exploration.VariableSelectionDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="../index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.view.components.exploration.CorrelationMatrikDialog" href="CorrelationMatrikDialog.html">saePisan.view.components.exploration.CorrelationMatrikDialog</a></code></li>
<li><code><a title="saePisan.view.components.exploration.MulticollinearityDialog" href="MulticollinearityDialog.html">saePisan.view.components.exploration.MulticollinearityDialog</a></code></li>
<li><code><a title="saePisan.view.components.exploration.NormalityTestDialog" href="NormalityTestDialog.html">saePisan.view.components.exploration.NormalityTestDialog</a></code></li>
<li><code><a title="saePisan.view.components.exploration.SummaryDataDialog" href="SummaryDataDialog.html">saePisan.view.components.exploration.SummaryDataDialog</a></code></li>
<li><code><a title="saePisan.view.components.exploration.VariableSelectionDialog" href="VariableSelectionDialog.html">saePisan.view.components.exploration.VariableSelectionDialog</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_4">
                <div class="file-header">
                    <div>ğŸ“„ BoxPlotDialog</div>
                    <div class="file-path">view/components/graph/BoxPlotDialog.html (46.9 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.graph.BoxPlotDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog"><code class="flex name class">
<span>class <span class="ident">BoxPlotDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BoxPlotDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for creating and displaying box plots using selected variables from two data models.
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns from the first data model.
        all_columns_model2 (list): List of all columns from the second data model.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor list.
        data_editor_model (QStringListModel): Model for the data editor list.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output list.
        data_output_model (QStringListModel): Model for the data output list.
        data_output_list (QListView): List view for the data output.
        add_button (QPushButton): Button to add selected variables.
        remove_button (QPushButton): Button to remove selected variables.
        selected_label (QLabel): Label for the selected variables list.
        selected_model (QStringListModel): Model for the selected variables list.
        selected_list (QListView): List view for the selected variables.
        method_combo (QComboBox): Combo box to select the box plot method.
        script_layout (QHBoxLayout): Layout for the R script display.
        script_label (QLabel): Label for the R script.
        icon_label (QLabel): Label to display the running icon.
        script_box (QTextEdit): Text box to display the generated R script.
        run_button (QPushButton): Button to run the generated R script.
    Methods:
        set_model(model1, model2): Sets the data models and updates the data editor and output lists.
        get_column_with_dtype(model): Returns a list of columns with their data types from the given model.
        add_variable(): Adds selected variables from the data editor and output lists to the selected variables list.
        remove_variable(): Removes selected variables from the selected variables list and adds them back to the data editor or output lists.
        get_selected_columns(): Returns a list of selected columns formatted for R script.
        generate_r_script(): Generates the R script based on the selected variables and method.
        accept(): Runs the generated R script and displays the result.
        closeEvent(event): Resets the dialog when it is closed.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Box Plot&#34;)

        # Menyimpan status variabel yang dipilih
        self.selected_status = {}

        # Layout utama
        self.main_layout = QVBoxLayout(self)
        content_layout = QHBoxLayout()

        # Layout kiri untuk Data Editor dan Data Output
        left_layout = QVBoxLayout()

        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Layout tengah untuk tombol
        button_layout = QVBoxLayout()
        self.add_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_button.clicked.connect(self.add_variable)
        self.add_button.setFixedSize(50, 35) 
        self.add_button.setStyleSheet(&#34;font-size: 24px;&#34;)  
        self.remove_button = QPushButton(&#34;ğŸ¡„&#34;, self)
        self.remove_button.clicked.connect(self.remove_variable)
        self.remove_button.setFixedSize(50, 35)
        self.remove_button.setStyleSheet(&#34;font-size: 24px;&#34;) 
        button_layout.addStretch()
        button_layout.addWidget(self.add_button)
        button_layout.addWidget(self.remove_button)
        button_layout.addStretch()
        content_layout.addLayout(button_layout)

        # Layout kanan
        right_layout = QVBoxLayout()
        self.selected_label = QLabel(&#34;Variabel&#34;, self)
        self.selected_model = QStringListModel()
        self.selected_list = DragDropListView(parent=self)
        self.selected_list.setModel(self.selected_model)
        self.selected_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        right_layout.addWidget(self.selected_label)
        right_layout.addWidget(self.selected_list)

        # Grup metode
        method_group = QGroupBox(&#34;Metode&#34;)
        method_layout = QVBoxLayout()
        self.method_combo = QComboBox(self)
        self.method_combo.addItems([&#34;Single Box plot&#34;, &#34;Multiple Box Plot&#34;])
        self.method_combo.currentIndexChanged.connect(self.generate_r_script)
        method_layout.addWidget(self.method_combo)
        method_group.setLayout(method_layout)
        right_layout.addWidget(method_group)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)


        # Horizontal layout for label and icon
        script_layout = QHBoxLayout()
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Spacer to keep the icon_label on the right end
        spacer = QSpacerItem(40, 10, QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Minimum)
        
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Tombol Run
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)

        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.selected_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Map widget to model
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.selected_list: (self.selected_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        filtered_items = []
        contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

        for item in items:
            # Reject if String or None type
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                continue

            if target_widget == self.selected_list:
                filtered_items.append(item)
            else:
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                    filtered_items.append(item)

        # â—ï¸Show warning if there are String or None types
        if contains_string:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Add valid items to the target model
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Remove from other models
        for other_widget, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Reorder items
        if target_widget == self.data_editor_list:
            ordered = [col for col in self.all_columns_model1 if col in current_items]
            target_model.setStringList(ordered)
        elif target_widget == self.data_output_list:
            ordered = [col for col in self.all_columns_model2 if col in current_items]
            target_model.setStringList(ordered)
        else:
            target_model.setStringList(current_items)

        self.generate_r_script()

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))

    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns

    def add_variable(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.selected_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

        selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

        # Tampilkan warning jika ada yang tidak valid
        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()


    def remove_variable(self):
        &#34;&#34;&#34;
        Removes selected variables from the selected list and generates the R script.
        &#34;&#34;&#34;
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        selected_list = self.selected_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Check if the item belongs to model1 (editor) or model2 (output)
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
                    # Re-sort according to all_columns_model1
                    editor_list = [col for col in self.all_columns_model1 if col in editor_list]

            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)
                    # Re-sort according to all_columns_model2
                    output_list = [col for col in self.all_columns_model2 if col in output_list]

            # Remove from selected
            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.generate_r_script()

    def get_selected_columns(self):
        return [f&#34;`{item.rsplit(&#39; [String]&#39;, 1)[0].rsplit(&#39; [Numeric]&#39;, 1)[0]}`&#34; 
                for item in self.selected_model.stringList()]

    def generate_r_script(self):
        # Get selected columns
        selected_columns = self.get_selected_columns()
        if not selected_columns:
            self.script_box.setPlainText(&#34;&#34;)
            return

        # Get selected method
        method = self.method_combo.currentText()
        formatted_columns = &#39;, &#39;.join(selected_columns)  # Tetap gunakan backticks di sini
        r_script = &#34;&#34;

        # Single Box Plot: Jika ada banyak variabel, buat plot terpisah
        if method == &#34;Single Box plot&#34;:
            for col in selected_columns:
                clean_name = re.sub(r&#34;\W+&#34;, &#34;_&#34;, col.strip(&#34;`&#34;))  # Bersihkan nama untuk penamaan objek
                r_script += (
                    f&#34;# Box plot for {col}\n&#34;
                    f&#34;boxplot_{clean_name} &lt;- ggplot(data, aes(y = {col})) +\n&#34;
                    f&#34;    geom_boxplot(fill = &#39;darkorange3&#39;) +\n&#34;
                    f&#34;    ggtitle(&#39;Box Plot: {col.strip(&#39;`&#39;)}&#39;) +\n&#34;
                    f&#34;    ylab(&#39;{col.strip(&#39;`&#39;)}&#39;) +\n&#34;
                    f&#34;    theme_minimal()\n\n&#34;
                )

        # Multiple Box Plot: Gabungkan semua variabel dalam satu plot
        elif method == &#34;Multiple Box Plot&#34;:
            r_script += (
                f&#34;# Convert to long format for ggplot compatibility\n&#34;
                f&#34;data_long &lt;- pivot_longer(data, cols = c({formatted_columns}), \n&#34;
                f&#34;    names_to = &#39;variable&#39;, values_to = &#39;value&#39;)\n\n&#34;
                f&#34;# Create multiple box plot\n&#34;
                f&#34;boxplot_multiple &lt;- ggplot(data_long, aes(x = variable, y = value, fill = variable)) +\n&#34;
                f&#34;    geom_boxplot() +\n&#34;
                f&#34;    ggtitle(&#39;Multiple Box Plot&#39;) +\n&#34;
                f&#34;    xlab(&#39;Variable&#39;) +\n&#34;
                f&#34;    ylab(&#39;Value&#39;) +\n&#34;
                f&#34;    theme_minimal()\n&#34;
            )

        # Show script in text box
        self.script_box.setPlainText(r_script)

    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        if len(self.selected_model.stringList()) == 0:
            QMessageBox.warning(self, &#34;No Variables Selected&#34;, &#34;Please select at least one variable.&#34;)
            return
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)
        box_plot = BoxPlot(self.model1, self.model2, self.parent)
        controller = BoxPlotController(box_plot)
        controller.run_model(r_script)
        if box_plot.error:
            QMessageBox.critical(self, &#34;Box Plot&#34;, box_plot.result)
        else:
            QMessageBox.information(self, &#34;Box Plot&#34;, &#34;Graph has been generated&#34;)

        display_script_and_output(self.parent, r_script, box_plot.result, box_plot.plot)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        self.selected_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)
        event.accept()</code></pre>
</details>
<div class="desc"><p>A dialog for creating and displaying box plots using selected variables from two data models.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns from the first data model.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns from the second data model.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor list.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output list.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>add_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add selected variables.</dd>
<dt><strong><code>remove_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>selected_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the selected variables list.</dd>
<dt><strong><code>selected_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the selected variables list.</dd>
<dt><strong><code>selected_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the selected variables.</dd>
<dt><strong><code>method_combo</code></strong> :&ensp;<code>QComboBox</code></dt>
<dd>Combo box to select the box plot method.</dd>
<dt><strong><code>script_layout</code></strong> :&ensp;<code>QHBoxLayout</code></dt>
<dd>Layout for the R script display.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label to display the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the generated R script.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>set_model(model1, model2): Sets the data models and updates the data editor and output lists.
get_column_with_dtype(model): Returns a list of columns with their data types from the given model.
add_variable(): Adds selected variables from the data editor and output lists to the selected variables list.
remove_variable(): Removes selected variables from the selected variables list and adds them back to the data editor or output lists.
get_selected_columns(): Returns a list of selected columns formatted for R script.
generate_r_script(): Generates the R script based on the selected variables and method.
accept(): Runs the generated R script and displays the result.
closeEvent(event): Resets the dialog when it is closed.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    if len(self.selected_model.stringList()) == 0:
        QMessageBox.warning(self, &#34;No Variables Selected&#34;, &#34;Please select at least one variable.&#34;)
        return
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)
    box_plot = BoxPlot(self.model1, self.model2, self.parent)
    controller = BoxPlotController(box_plot)
    controller.run_model(r_script)
    if box_plot.error:
        QMessageBox.critical(self, &#34;Box Plot&#34;, box_plot.result)
    else:
        QMessageBox.information(self, &#34;Box Plot&#34;, &#34;Graph has been generated&#34;)

    display_script_and_output(self.parent, r_script, box_plot.result, box_plot.plot)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.add_variable"><code class="name flex">
<span>def <span class="ident">add_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.selected_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

    selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

    # Tampilkan warning jika ada yang tidak valid
    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.selected_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    self.selected_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    # Get selected columns
    selected_columns = self.get_selected_columns()
    if not selected_columns:
        self.script_box.setPlainText(&#34;&#34;)
        return

    # Get selected method
    method = self.method_combo.currentText()
    formatted_columns = &#39;, &#39;.join(selected_columns)  # Tetap gunakan backticks di sini
    r_script = &#34;&#34;

    # Single Box Plot: Jika ada banyak variabel, buat plot terpisah
    if method == &#34;Single Box plot&#34;:
        for col in selected_columns:
            clean_name = re.sub(r&#34;\W+&#34;, &#34;_&#34;, col.strip(&#34;`&#34;))  # Bersihkan nama untuk penamaan objek
            r_script += (
                f&#34;# Box plot for {col}\n&#34;
                f&#34;boxplot_{clean_name} &lt;- ggplot(data, aes(y = {col})) +\n&#34;
                f&#34;    geom_boxplot(fill = &#39;darkorange3&#39;) +\n&#34;
                f&#34;    ggtitle(&#39;Box Plot: {col.strip(&#39;`&#39;)}&#39;) +\n&#34;
                f&#34;    ylab(&#39;{col.strip(&#39;`&#39;)}&#39;) +\n&#34;
                f&#34;    theme_minimal()\n\n&#34;
            )

    # Multiple Box Plot: Gabungkan semua variabel dalam satu plot
    elif method == &#34;Multiple Box Plot&#34;:
        r_script += (
            f&#34;# Convert to long format for ggplot compatibility\n&#34;
            f&#34;data_long &lt;- pivot_longer(data, cols = c({formatted_columns}), \n&#34;
            f&#34;    names_to = &#39;variable&#39;, values_to = &#39;value&#39;)\n\n&#34;
            f&#34;# Create multiple box plot\n&#34;
            f&#34;boxplot_multiple &lt;- ggplot(data_long, aes(x = variable, y = value, fill = variable)) +\n&#34;
            f&#34;    geom_boxplot() +\n&#34;
            f&#34;    ggtitle(&#39;Multiple Box Plot&#39;) +\n&#34;
            f&#34;    xlab(&#39;Variable&#39;) +\n&#34;
            f&#34;    ylab(&#39;Value&#39;) +\n&#34;
            f&#34;    theme_minimal()\n&#34;
        )

    # Show script in text box
    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.get_selected_columns"><code class="name flex">
<span>def <span class="ident">get_selected_columns</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_columns(self):
    return [f&#34;`{item.rsplit(&#39; [String]&#39;, 1)[0].rsplit(&#39; [Numeric]&#39;, 1)[0]}`&#34; 
            for item in self.selected_model.stringList()]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Map widget to model
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.selected_list: (self.selected_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    filtered_items = []
    contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

    for item in items:
        # Reject if String or None type
        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            continue

        if target_widget == self.selected_list:
            filtered_items.append(item)
        else:
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                filtered_items.append(item)

    # â—ï¸Show warning if there are String or None types
    if contains_string:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Add valid items to the target model
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Remove from other models
    for other_widget, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Reorder items
    if target_widget == self.data_editor_list:
        ordered = [col for col in self.all_columns_model1 if col in current_items]
        target_model.setStringList(ordered)
    elif target_widget == self.data_output_list:
        ordered = [col for col in self.all_columns_model2 if col in current_items]
        target_model.setStringList(ordered)
    else:
        target_model.setStringList(current_items)

    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    &#34;&#34;&#34;
    Removes selected variables from the selected list and generates the R script.
    &#34;&#34;&#34;
    selected_indexes = self.selected_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    selected_list = self.selected_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Check if the item belongs to model1 (editor) or model2 (output)
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
                # Re-sort according to all_columns_model1
                editor_list = [col for col in self.all_columns_model1 if col in editor_list]

        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)
                # Re-sort according to all_columns_model2
                output_list = [col for col in self.all_columns_model2 if col in output_list]

        # Remove from selected
        if item in selected_list:
            selected_list.remove(item)

    self.selected_model.setStringList(selected_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Removes selected variables from the selected list and generates the R script.</p></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.graph" href="index.html">saePisan.view.components.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog">BoxPlotDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.accept" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.add_variable" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.add_variable">add_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.closeEvent" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.generate_r_script" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.get_column_with_dtype" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.get_selected_columns" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.get_selected_columns">get_selected_columns</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.handle_drop" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.remove_variable" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.set_model" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.toggle_r_script_visibility" href="#saePisan.view.components.graph.BoxPlotDialog.BoxPlotDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_5">
                <div class="file-header">
                    <div>ğŸ“„ HistogramDialog</div>
                    <div class="file-path">view/components/graph/HistogramDialog.html (49.6 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.graph.HistogramDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog"><code class="flex name class">
<span>class <span class="ident">HistogramDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class HistogramDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for creating histograms using selected variables from data models.
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns from model1.
        all_columns_model2 (list): List of all columns from model2.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor section.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output section.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (QListView): List view for the data output.
        add_button (QPushButton): Button to add selected variables.
        remove_button (QPushButton): Button to remove selected variables.
        selected_label (QLabel): Label for the selected variables section.
        selected_model (QStringListModel): Model for the selected variables list view.
        selected_list (QListView): List view for the selected variables.
        method_combo (QComboBox): Combo box to select the histogram method.
        graph_option_combo (QComboBox): Combo box to select between Bins or Binwidth.
        graph_option_spinbox (QSpinBox): Spin box to set the value for Bins or Binwidth.
        script_layout (QHBoxLayout): Layout for the R script section.
        script_label (QLabel): Label for the R script section.
        icon_label (QLabel): Label to display the running icon.
        script_box (QTextEdit): Text edit to display the generated R script.
        run_button (QPushButton): Button to run the generated R script.
    Methods:
        set_model(model1, model2): Sets the data models and updates the list views.
        get_column_with_dtype(model): Returns a list of columns with their data types.
        add_variable(): Adds selected variables to the selected list and updates the R script.
        remove_variable(): Removes selected variables from the selected list and updates the R script.
        get_selected_columns(): Returns a list of selected columns formatted for R script.
        generate_r_script(): Generates the R script based on selected variables and options.
        accept(): Runs the generated R script and handles the result.
        closeEvent(event): Resets the dialog when it is closed.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Histogram&#34;)

        # Menyimpan status variabel yang dipilih
        self.selected_status = {}

        # Layout utama
        self.main_layout = QVBoxLayout(self)
        content_layout = QHBoxLayout()

        # Layout kiri untuk Data Editor dan Data Output
        left_layout = QVBoxLayout()

        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Layout tengah untuk tombol
        button_layout = QVBoxLayout()
        self.add_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_button.clicked.connect(self.add_variable)
        self.add_button.setFixedSize(50, 35) 
        self.add_button.setStyleSheet(&#34;font-size: 24px;&#34;)  
        self.remove_button = QPushButton(&#34;ğŸ¡„&#34;, self)
        self.remove_button.clicked.connect(self.remove_variable)
        self.remove_button.setFixedSize(50, 35)
        self.remove_button.setStyleSheet(&#34;font-size: 24px;&#34;) 
        button_layout.addStretch()
        button_layout.addWidget(self.add_button)
        button_layout.addWidget(self.remove_button)
        button_layout.addStretch()
        content_layout.addLayout(button_layout)

        # Layout kanan
        right_layout = QVBoxLayout()
        self.selected_label = QLabel(&#34;Variabel&#34;, self)
        self.selected_model = QStringListModel()
        self.selected_list = DragDropListView(parent=self)
        self.selected_list.setModel(self.selected_model)
        self.selected_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        right_layout.addWidget(self.selected_label)
        right_layout.addWidget(self.selected_list)
        
        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        # Grup metode
        method_group = QGroupBox(&#34;Metode&#34;)
        method_layout = QVBoxLayout()
        self.method_combo = QComboBox(self)
        self.method_combo.addItems([&#34;Single Histogram&#34;, &#34;Multiple Histogram&#34;])
        self.method_combo.currentIndexChanged.connect(self.generate_r_script)
        method_layout.addWidget(self.method_combo)
        method_group.setLayout(method_layout)
        right_layout.addWidget(method_group)

        # Grup Graph Options
        graph_option_group = QGroupBox(&#34;Graph Options&#34;)
        graph_option_layout = QVBoxLayout()

        # Dropdown untuk memilih antara Bins atau Binwidth
        self.graph_option_combo = QComboBox(self)
        self.graph_option_combo.addItems([&#34;Bins&#34;, &#34;Binwidth&#34;])
        self.graph_option_combo.currentIndexChanged.connect(self.generate_r_script)
        graph_option_layout.addWidget(self.graph_option_combo)

        # Spinbox untuk nilai Bins atau Binwidth
        self.graph_option_spinbox = QSpinBox(self)
        self.graph_option_spinbox.setMinimum(1)
        self.graph_option_spinbox.setMaximum(100)
        self.graph_option_spinbox.setValue(10)
        graph_option_layout.addWidget(self.graph_option_spinbox)

        graph_option_group.setLayout(graph_option_layout)
        right_layout.addWidget(graph_option_group)

  
        # Horizontal layout for label and icon
        script_layout = QHBoxLayout()
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Spacer to keep the icon_label on the right end
        spacer = QSpacerItem(40, 10, QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Minimum)
        
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)
        # Tombol Run
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)

        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.selected_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Map widget to model
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.selected_list: (self.selected_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        filtered_items = []
        contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

        for item in items:
            # Reject if String or None type
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                continue

            if target_widget == self.selected_list:
                filtered_items.append(item)
            else:
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                    filtered_items.append(item)

        # â—ï¸Show warning if there are String or None types
        if contains_string:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Add valid items to the target model
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Remove from other models
        for other_widget, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Reorder items
        if target_widget == self.data_editor_list:
            ordered = [col for col in self.all_columns_model1 if col in current_items]
            target_model.setStringList(ordered)
        elif target_widget == self.data_output_list:
            ordered = [col for col in self.all_columns_model2 if col in current_items]
            target_model.setStringList(ordered)
        else:
            target_model.setStringList(current_items)

        self.generate_r_script()

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
    
    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns


    def add_variable(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.selected_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

        selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

        # Tampilkan warning jika ada yang tidak valid
        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()

    def remove_variable(self):
        &#34;&#34;&#34;
        Removes selected variables from the selected list and generates the R script.
        &#34;&#34;&#34;
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        selected_list = self.selected_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Check if the item belongs to model1 (editor) or model2 (output)
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
                    # Re-sort according to all_columns_model1
                    editor_list = [col for col in self.all_columns_model1 if col in editor_list]

            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)
                    # Re-sort according to all_columns_model2
                    output_list = [col for col in self.all_columns_model2 if col in output_list]

            # Remove from selected
            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.generate_r_script()


    def get_selected_columns(self):
        return [f&#34;`{item.rsplit(&#39; [String]&#39;, 1)[0].rsplit(&#39; [Numeric]&#39;, 1)[0]}`&#34; 
                for item in self.selected_model.stringList()]

   
    def generate_r_script(self):
        # Get selected columns
        selected_columns = self.get_selected_columns()
        if not selected_columns:
            self.script_box.setPlainText(&#34;Tidak ada kolom yang dipilih.&#34;)
            return

        # Get selected method
        method = self.method_combo.currentText()
        graph_option = self.graph_option_combo.currentText()  # Bins atau Binwidth
        bin_value = self.graph_option_spinbox.value()  # Nilai dari spinbox

        # Pastikan bin_value valid
        if bin_value &lt;= 0:
            self.script_box.setPlainText(&#34;Nilai bin harus lebih besar dari 0.&#34;)
            return

        r_script = &#34;&#34;

        if method == &#34;Single Histogram&#34;:
            for col in selected_columns:
                col_safe = col.strip(&#34;`&#34;)  # Bersihkan backticks agar tidak dobel
                r_script += (
                    f&#34;histogram_{col_safe.replace(&#39; &#39;, &#39;_&#39;)} &lt;- ggplot(data, aes(x = `{col_safe}`)) +\n&#34;  
                    f&#34;    geom_histogram(&#34;
                    f&#34;{&#39;bins = &#39; + str(bin_value) if graph_option == &#39;Bins&#39; else &#39;binwidth = &#39; + str(bin_value)}, &#34;
                    f&#34;fill = &#39;darkorange3&#39;, color = &#39;black&#39;) +\n&#34;
                    f&#34;    ggtitle(&#39;Histogram: {col_safe}&#39;) +\n&#34;  # Tidak pakai backticks
                    f&#34;    xlab(&#39;{col_safe}&#39;) +\n&#34;  # Tidak pakai backticks
                    f&#34;    ylab(&#39;Frequency&#39;) +\n&#34;
                    f&#34;    theme_minimal()\n\n&#34;
                )

        elif method == &#34;Multiple Histogram&#34;:
            formatted_columns = &#39;, &#39;.join(f&#39;`{col.strip(&#34;`&#34;)}`&#39; for col in selected_columns)  # Hapus backticks dobel
            r_script += (
                f&#34;data_long &lt;- pivot_longer(data, cols = c({formatted_columns}), \n&#34;
                f&#34;    names_to = &#39;variable&#39;, values_to = &#39;value&#39;)\n\n&#34;
                f&#34;histogram_multiple &lt;- ggplot(data_long, aes(x = value, fill = variable)) +\n&#34;
                f&#34;    geom_histogram(&#34;
                f&#34;{&#39;bins = &#39; + str(bin_value) if graph_option == &#39;Bins&#39; else &#39;binwidth = &#39; + str(bin_value)}, &#34;
                f&#34;alpha = 0.6, position = &#39;identity&#39;, color = &#39;black&#39;) +\n&#34;
                f&#34;    ggtitle(&#39;Multiple Histogram&#39;) +\n&#34;
                f&#34;    xlab(&#39;Value&#39;) +\n&#34;
                f&#34;    ylab(&#39;Frequency&#39;) +\n&#34;
                f&#34;    theme_minimal()\n&#34;
            )

        # Tampilkan script di text box
        self.script_box.setPlainText(r_script)

    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        if len(self.selected_model.stringList()) == 0:
            QMessageBox.warning(self, &#34;No Variables Selected&#34;, &#34;Please select at least one variable.&#34;)
            return
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)
        histogram = Histogram(self.model1, self.model2, self.parent)
        controller = HistogramController(histogram)
        controller.run_model(r_script)
        if histogram.error:
            QMessageBox.critical(self, &#34;Histogram&#34;, histogram.result)
        else:
            QMessageBox.information(self, &#34;Histogram&#34;, &#34;Graph has been generated.&#34;)

        # self.parent.add_output(script_text=r_script, result_text=histogram.result, plot_paths=histogram.plot)
        display_script_and_output(self.parent, r_script, histogram.result, histogram.plot)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)
        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        self.selected_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)
        event.accept()</code></pre>
</details>
<div class="desc"><p>A dialog for creating histograms using selected variables from data models.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns from model1.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns from model2.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor section.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output section.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>add_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add selected variables.</dd>
<dt><strong><code>remove_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>selected_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the selected variables section.</dd>
<dt><strong><code>selected_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the selected variables list view.</dd>
<dt><strong><code>selected_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the selected variables.</dd>
<dt><strong><code>method_combo</code></strong> :&ensp;<code>QComboBox</code></dt>
<dd>Combo box to select the histogram method.</dd>
<dt><strong><code>graph_option_combo</code></strong> :&ensp;<code>QComboBox</code></dt>
<dd>Combo box to select between Bins or Binwidth.</dd>
<dt><strong><code>graph_option_spinbox</code></strong> :&ensp;<code>QSpinBox</code></dt>
<dd>Spin box to set the value for Bins or Binwidth.</dd>
<dt><strong><code>script_layout</code></strong> :&ensp;<code>QHBoxLayout</code></dt>
<dd>Layout for the R script section.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script section.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label to display the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the generated R script.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>set_model(model1, model2): Sets the data models and updates the list views.
get_column_with_dtype(model): Returns a list of columns with their data types.
add_variable(): Adds selected variables to the selected list and updates the R script.
remove_variable(): Removes selected variables from the selected list and updates the R script.
get_selected_columns(): Returns a list of selected columns formatted for R script.
generate_r_script(): Generates the R script based on selected variables and options.
accept(): Runs the generated R script and handles the result.
closeEvent(event): Resets the dialog when it is closed.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    if len(self.selected_model.stringList()) == 0:
        QMessageBox.warning(self, &#34;No Variables Selected&#34;, &#34;Please select at least one variable.&#34;)
        return
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)
    histogram = Histogram(self.model1, self.model2, self.parent)
    controller = HistogramController(histogram)
    controller.run_model(r_script)
    if histogram.error:
        QMessageBox.critical(self, &#34;Histogram&#34;, histogram.result)
    else:
        QMessageBox.information(self, &#34;Histogram&#34;, &#34;Graph has been generated.&#34;)

    # self.parent.add_output(script_text=r_script, result_text=histogram.result, plot_paths=histogram.plot)
    display_script_and_output(self.parent, r_script, histogram.result, histogram.plot)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)
    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.add_variable"><code class="name flex">
<span>def <span class="ident">add_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.selected_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

    selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

    # Tampilkan warning jika ada yang tidak valid
    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.selected_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    self.selected_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)
    event.accept()</code></pre>
</details>
<div class="desc"><p>closeEvent(self, a0: Optional[QCloseEvent])</p></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    # Get selected columns
    selected_columns = self.get_selected_columns()
    if not selected_columns:
        self.script_box.setPlainText(&#34;Tidak ada kolom yang dipilih.&#34;)
        return

    # Get selected method
    method = self.method_combo.currentText()
    graph_option = self.graph_option_combo.currentText()  # Bins atau Binwidth
    bin_value = self.graph_option_spinbox.value()  # Nilai dari spinbox

    # Pastikan bin_value valid
    if bin_value &lt;= 0:
        self.script_box.setPlainText(&#34;Nilai bin harus lebih besar dari 0.&#34;)
        return

    r_script = &#34;&#34;

    if method == &#34;Single Histogram&#34;:
        for col in selected_columns:
            col_safe = col.strip(&#34;`&#34;)  # Bersihkan backticks agar tidak dobel
            r_script += (
                f&#34;histogram_{col_safe.replace(&#39; &#39;, &#39;_&#39;)} &lt;- ggplot(data, aes(x = `{col_safe}`)) +\n&#34;  
                f&#34;    geom_histogram(&#34;
                f&#34;{&#39;bins = &#39; + str(bin_value) if graph_option == &#39;Bins&#39; else &#39;binwidth = &#39; + str(bin_value)}, &#34;
                f&#34;fill = &#39;darkorange3&#39;, color = &#39;black&#39;) +\n&#34;
                f&#34;    ggtitle(&#39;Histogram: {col_safe}&#39;) +\n&#34;  # Tidak pakai backticks
                f&#34;    xlab(&#39;{col_safe}&#39;) +\n&#34;  # Tidak pakai backticks
                f&#34;    ylab(&#39;Frequency&#39;) +\n&#34;
                f&#34;    theme_minimal()\n\n&#34;
            )

    elif method == &#34;Multiple Histogram&#34;:
        formatted_columns = &#39;, &#39;.join(f&#39;`{col.strip(&#34;`&#34;)}`&#39; for col in selected_columns)  # Hapus backticks dobel
        r_script += (
            f&#34;data_long &lt;- pivot_longer(data, cols = c({formatted_columns}), \n&#34;
            f&#34;    names_to = &#39;variable&#39;, values_to = &#39;value&#39;)\n\n&#34;
            f&#34;histogram_multiple &lt;- ggplot(data_long, aes(x = value, fill = variable)) +\n&#34;
            f&#34;    geom_histogram(&#34;
            f&#34;{&#39;bins = &#39; + str(bin_value) if graph_option == &#39;Bins&#39; else &#39;binwidth = &#39; + str(bin_value)}, &#34;
            f&#34;alpha = 0.6, position = &#39;identity&#39;, color = &#39;black&#39;) +\n&#34;
            f&#34;    ggtitle(&#39;Multiple Histogram&#39;) +\n&#34;
            f&#34;    xlab(&#39;Value&#39;) +\n&#34;
            f&#34;    ylab(&#39;Frequency&#39;) +\n&#34;
            f&#34;    theme_minimal()\n&#34;
        )

    # Tampilkan script di text box
    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.get_selected_columns"><code class="name flex">
<span>def <span class="ident">get_selected_columns</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_columns(self):
    return [f&#34;`{item.rsplit(&#39; [String]&#39;, 1)[0].rsplit(&#39; [Numeric]&#39;, 1)[0]}`&#34; 
            for item in self.selected_model.stringList()]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Map widget to model
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.selected_list: (self.selected_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    filtered_items = []
    contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

    for item in items:
        # Reject if String or None type
        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            continue

        if target_widget == self.selected_list:
            filtered_items.append(item)
        else:
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                filtered_items.append(item)

    # â—ï¸Show warning if there are String or None types
    if contains_string:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Add valid items to the target model
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Remove from other models
    for other_widget, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Reorder items
    if target_widget == self.data_editor_list:
        ordered = [col for col in self.all_columns_model1 if col in current_items]
        target_model.setStringList(ordered)
    elif target_widget == self.data_output_list:
        ordered = [col for col in self.all_columns_model2 if col in current_items]
        target_model.setStringList(ordered)
    else:
        target_model.setStringList(current_items)

    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    &#34;&#34;&#34;
    Removes selected variables from the selected list and generates the R script.
    &#34;&#34;&#34;
    selected_indexes = self.selected_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    selected_list = self.selected_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Check if the item belongs to model1 (editor) or model2 (output)
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
                # Re-sort according to all_columns_model1
                editor_list = [col for col in self.all_columns_model1 if col in editor_list]

        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)
                # Re-sort according to all_columns_model2
                output_list = [col for col in self.all_columns_model2 if col in output_list]

        # Remove from selected
        if item in selected_list:
            selected_list.remove(item)

    self.selected_model.setStringList(selected_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Removes selected variables from the selected list and generates the R script.</p></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.HistogramDialog.HistogramDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.graph" href="index.html">saePisan.view.components.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog">HistogramDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.accept" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.add_variable" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.add_variable">add_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.closeEvent" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.generate_r_script" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.get_column_with_dtype" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.get_selected_columns" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.get_selected_columns">get_selected_columns</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.handle_drop" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.remove_variable" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.set_model" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog.HistogramDialog.toggle_r_script_visibility" href="#saePisan.view.components.graph.HistogramDialog.HistogramDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_6">
                <div class="file-header">
                    <div>ğŸ“„ LinePlotDialog</div>
                    <div class="file-path">view/components/graph/LinePlotDialog.html (56.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.graph.LinePlotDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog"><code class="flex name class">
<span>class <span class="ident">LinePlotDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LinePlotDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for creating line plots using selected data from two models.
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns from model1.
        all_columns_model2 (list): List of all columns from model2.
        selected_status (dict): Dictionary to store the status of selected variables.
        data_editor_label (QLabel): Label for the data editor section.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output section.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (QListView): List view for the data output.
        remove_button1 (QPushButton): Button to remove selected variables.
        add_horizontal_button (QPushButton): Button to add selected variable to the horizontal axis.
        add_vertical_button (QPushButton): Button to add selected variables to the vertical axis.
        horizontal_label (QLabel): Label for the horizontal axis section.
        horizontal_model (QStringListModel): Model for the horizontal axis list view.
        horizontal_list (QListView): List view for the horizontal axis.
        vertical_label (QLabel): Label for the vertical axis section.
        vertical_model (QStringListModel): Model for the vertical axis list view.
        vertical_list (QListView): List view for the vertical axis.
        method_combo (QComboBox): Combo box to select the plotting method.
        script_label (QLabel): Label for the R script section.
        icon_label (QLabel): Label to display the running icon.
        script_box (QTextEdit): Text edit box to display the generated R script.
        run_button (QPushButton): Button to run the generated R script.
    Methods:
        set_model(model1, model2): Sets the data models and updates the data editor and output lists.
        get_column_with_dtype(model): Returns a list of columns with their data types from the given model.
        add_variable_horizontal(): Adds a selected variable to the horizontal axis.
        add_variable_vertical(): Adds selected variables to the vertical axis.
        remove_variable(): Removes selected variables from the horizontal and vertical axes.
        get_selected_horizontal(): Returns a list of selected variables for the horizontal axis.
        get_selected_vertical(): Returns a list of selected variables for the vertical axis.
        accept(): Runs the generated R script and displays the result.
        closeEvent(event): Clears selected variables and script when the dialog is closed.
        generate_r_script(): Generates the R script based on selected variables and method.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Line Plot&#34;)

        
        # Menyimpan status variabel yang dipilih
        self.selected_status = {}

        # Layout utama
        self.main_layout = QVBoxLayout(self)

        # Layout konten utama
        content_layout = QHBoxLayout()

        # Layout kiri: Data Editor dan Data Output
        left_layout = QVBoxLayout()

        # Data Editor
        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        # Data Output
        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Layout tengah: Tombol
        button_layout1 = QVBoxLayout()
        self.remove_button1 = QPushButton(&#34;ğŸ¡„&#34;, self)  
        self.remove_button1.clicked.connect(self.remove_variable) 
        self.remove_button1.setStyleSheet(&#34;font-size: 24px;&#34;) 
        self.remove_button1.setFixedSize(50,35)
        button_layout1.addStretch(3)
        button_layout1.addWidget(self.remove_button1)
        button_layout1.addStretch(7)

        button_layout2 = QVBoxLayout()
        self.add_horizontal_button = QPushButton(&#34;ğŸ¡†&#34;, self)  
        self.add_horizontal_button.clicked.connect(self.add_variable_horizontal)
        self.add_horizontal_button.setFixedSize(50,35)
        self.add_horizontal_button.setStyleSheet(&#34;font-size: 24px;&#34;)
        self.add_vertical_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_vertical_button.clicked.connect(self.add_variable_vertical)
        self.add_vertical_button.setFixedSize(50,35)
        self.add_vertical_button.setStyleSheet(&#34;font-size: 24px;&#34;)
        button_layout2.addStretch(1)
        button_layout2.addWidget(self.add_horizontal_button)
        button_layout2.addStretch(5)
        button_layout2.addWidget(self.add_vertical_button)
        button_layout2.addStretch(6)

        # Menambahkan kedua layout tombol ke content_layout
        content_layout.addLayout(button_layout1)
        content_layout.addLayout(button_layout2)

        # Layout kanan: Variabel yang dipilih, metode, dan grafik
        right_layout = QVBoxLayout()

        # Horizontal Axis
        horizontal_layout = QVBoxLayout()
        self.horizontal_label = QLabel(&#34;Horizontal Axis&#34;, self)
        self.horizontal_model = QStringListModel()
        self.horizontal_list = DragDropListView(parent=self)
        self.horizontal_list.setModel(self.horizontal_model)
        self.horizontal_list.setSelectionMode(QListView.SelectionMode.MultiSelection)

        # Batasi tinggi 
        item_height = 30  
        self.horizontal_list.setFixedHeight(item_height + 4)  

        horizontal_layout.addWidget(self.horizontal_label)
        horizontal_layout.addWidget(self.horizontal_list)
        right_layout.addLayout(horizontal_layout)


        # Vertical Axis
        vertical_layout = QVBoxLayout()
        self.vertical_label = QLabel(&#34;Vertical Axis&#34;, self)
        self.vertical_model = QStringListModel()
        self.vertical_list = DragDropListView(parent=self)
        self.vertical_list.setModel(self.vertical_model)
        self.vertical_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        vertical_layout.addWidget(self.vertical_label)
        vertical_layout.addWidget(self.vertical_list)
        right_layout.addLayout(vertical_layout,1)


        # Grup metode
        method_group = QGroupBox(&#34;Metode&#34;)
        method_layout = QVBoxLayout()
        self.method_combo = QComboBox(self)
        self.method_combo.addItems([&#34;Single Lineplot&#34;, &#34;Multiple Lineplot&#34;])
        self.method_combo.currentIndexChanged.connect(self.generate_r_script)
        method_layout.addWidget(self.method_combo)
        method_group.setLayout(method_layout)
        right_layout.addWidget(method_group)


        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        # Horizontal layout for label and icon
        script_layout = QHBoxLayout()
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)

        # Spacer to keep the icon_label on the right end
        spacer = QSpacerItem(40, 10, QSizePolicy.Policy.Expanding, QSizePolicy.Policy.Minimum)
        
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Tombol Run
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)
        
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.vertical_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.horizontal_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
    
    def handle_drop(self, target_widget, items):
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.horizontal_list: (self.horizontal_model, None),
            self.vertical_list: (self.vertical_model, None),
        }

        if target_widget not in widget_model_map:
            return
        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        # Validasi: hanya 1 variabel untuk horizontal
        if target_widget == self.horizontal_list:
            if len(items) &gt; 1 or len(current_items) &gt;= 1:
                QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the horizontal Axis!&#34;)
                return

        filtered_items = []
        contains_invalid = False
        rejected_items = []

        for item in items:
            if target_widget in [self.horizontal_list, self.vertical_list]:
                # Tolak jika [String] atau [None]
                if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                    contains_invalid = True
                    rejected_items.append(item)
                    continue
                filtered_items.append(item)
            else:
                # Editor/output: cocokkan dengan kolom aslinya
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and any(column_name == col.split(&#34; &#34;)[0] for col in allowed_columns):
                    filtered_items.append(item)

        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Hapus dari semua model lain
        for _, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Tambahkan ke target jika belum ada
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Urutkan kembali jika editor atau output
        if target_widget in [self.data_editor_list, self.data_output_list]:
            original_order = self.all_columns_model1 if target_widget == self.data_editor_list else self.all_columns_model2
            reference_map = {col: i for i, col in enumerate(original_order)}
            current_items = sorted(current_items, key=lambda x: reference_map.get(x, float(&#39;inf&#39;)))

        target_model.setStringList(current_items)
        self.generate_r_script()


    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns
    
    def add_variable_horizontal(self):
        if len(self.horizontal_model.stringList()) &gt;= 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the Horizontal Axis!&#34;)
            return

        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        if not selected_items:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select a variable first!&#34;)
            return

        if len(selected_items) &gt; 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select only one variable!&#34;)
            return

        item = selected_items[0]

        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variable must be of type Numeric.&#34;)
            return

        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        self.horizontal_model.setStringList([item])
        self.generate_r_script()


    
    def add_variable_vertical(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.vertical_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
        selected_items = [item for item in selected_items if &#34;[String]&#34; not in item and &#34;[None]&#34; not in item]

        if contains_invalid:
            QMessageBox.warning(None, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.vertical_model.setStringList(selected_list)
        self.generate_r_script()


    def remove_variable(self):
        # Ambil item terpilih
        selected_indexes = self.horizontal_list.selectedIndexes() + self.vertical_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        # Ambil semua list sekarang
        horizontal_list = self.horizontal_model.stringList()
        vertical_list = self.vertical_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Kembalikan ke model asal
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)

            # Hapus dari horizontal/vertical
            if item in horizontal_list:
                horizontal_list.remove(item)
            if item in vertical_list:
                vertical_list.remove(item)

        # Sort ulang sesuai urutan awal
        editor_list = sorted(editor_list, key=lambda x: self.all_columns_model1.index(x) if x in self.all_columns_model1 else float(&#39;inf&#39;))
        output_list = sorted(output_list, key=lambda x: self.all_columns_model2.index(x) if x in self.all_columns_model2 else float(&#39;inf&#39;))

        # Update model
        self.horizontal_model.setStringList(horizontal_list)
        self.vertical_model.setStringList(vertical_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)

        # Update R script
        self.generate_r_script()


    def get_selected_horizontal(self):
        return [
            item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
            for item in self.horizontal_model.stringList()
        ]

    def get_selected_vertical(self):
        return [
            item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
            for item in self.vertical_model.stringList()
        ]
    
    def accept(self):
        r_script = self.script_box.toPlainText()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)

        line_plot = Lineplot(self.model1, self.model2, self.parent)
        controller = LinePlotController(line_plot)
        controller.run_model(r_script)

        if line_plot.error:
            QMessageBox.critical(self, &#34;Line Plot&#34;, line_plot.result)
        else:
            QMessageBox.information(self, &#34;Line Plot&#34;, &#34;Graph has been generated.&#34;)

        # self.parent.add_output(script_text = r_script, result_text = line_plot.result, plot_paths = line_plot.plot)
        display_script_and_output(self.parent, r_script, line_plot.result, line_plot.plot)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        &#34;&#34;&#34;Menghapus variabel yang dipilih ketika dialog ditutup.&#34;&#34;&#34;
        self.horizontal_model.setStringList([]) 
        self.vertical_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)  
        event.accept()

    def generate_r_script(self): 
        # Get selected variables
        selected_var_horizontal = self.get_selected_horizontal()
        selected_var_vertical = self.get_selected_vertical()

        # Get selected method
        method = self.method_combo.currentText()

        r_script = &#34;&#34;

        # Pastikan hanya mengambil elemen pertama untuk horizontal
        selected_var_horizontal = selected_var_horizontal[0] if selected_var_horizontal else None
        if not selected_var_horizontal or not selected_var_vertical:
            self.script_box.setPlainText(&#34;&#34;)
            return

        # Bersihkan nama horizontal untuk objek (hilangkan spasi &amp; karakter tak valid)
        clean_horizontal = re.sub(r&#34;\W+&#34;, &#34;_&#34;, selected_var_horizontal.strip(&#34;`&#34;))

        # Single Line Plot
        if method == &#34;Single Lineplot&#34;:
            for var in selected_var_vertical:
                clean_var = re.sub(r&#34;\W+&#34;, &#34;_&#34;, var.strip(&#34;`&#34;))  # Bersihkan nama untuk objek
                r_script += (
                    f&#34;lineplot_{clean_var} &lt;- ggplot(data, aes(x = `{selected_var_horizontal}`, y = `{var}`)) +\n&#34;
                    f&#34;    geom_line(color = &#39;darkorange3&#39;) +\n&#34;
                    f&#34;    geom_point() +\n&#34;
                    f&#34;    ggtitle(\&#34;Line Plot: {selected_var_horizontal} vs. {var.strip(&#39;`&#39;)}\&#34;) +\n&#34;
                    f&#34;    xlab(\&#34;{selected_var_horizontal}\&#34;) +\n&#34;
                    f&#34;    ylab(\&#34;{var.strip(&#39;`&#39;)}\&#34;) +\n&#34;
                    f&#34;    theme_minimal()\n\n&#34;
                )

        # Multiple Line Plot
        elif method == &#34;Multiple Lineplot&#34;:
            vertical_vars = &#34;, &#34;.join(f&#34;`{var}`&#34; for var in selected_var_vertical)  # Pakai backticks
            formatted_var_list = &#34;, &#34;.join(var.strip(&#34;`&#34;) for var in selected_var_vertical)

            r_script = (
                f&#34;data_long &lt;- pivot_longer(data, cols = c({vertical_vars}),\n&#34;
                f&#34;                        names_to = \&#34;variable\&#34;, values_to = \&#34;value\&#34;)\n\n&#34;
                f&#34;lineplot_{clean_horizontal}_multiple &lt;- ggplot(data_long, aes(x = `{selected_var_horizontal}`, y = value, color = variable)) +\n&#34;
                f&#34;    geom_line() +\n&#34;
                f&#34;    geom_point() +\n&#34;
                f&#34;    ggtitle(\&#34;Multiple Line Plot: {selected_var_horizontal} vs. {formatted_var_list}\&#34;) +\n&#34;
                f&#34;    xlab(\&#34;{selected_var_horizontal}\&#34;) +\n&#34;
                f&#34;    ylab(\&#34;Value\&#34;) +\n&#34;
                f&#34;    theme_minimal()\n&#34;
            )

        self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>A dialog for creating line plots using selected data from two models.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns from model1.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns from model2.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store the status of selected variables.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor section.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output section.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>remove_button1</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove selected variables.</dd>
<dt><strong><code>add_horizontal_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add selected variable to the horizontal axis.</dd>
<dt><strong><code>add_vertical_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add selected variables to the vertical axis.</dd>
<dt><strong><code>horizontal_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the horizontal axis section.</dd>
<dt><strong><code>horizontal_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the horizontal axis list view.</dd>
<dt><strong><code>horizontal_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the horizontal axis.</dd>
<dt><strong><code>vertical_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the vertical axis section.</dd>
<dt><strong><code>vertical_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the vertical axis list view.</dd>
<dt><strong><code>vertical_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the vertical axis.</dd>
<dt><strong><code>method_combo</code></strong> :&ensp;<code>QComboBox</code></dt>
<dd>Combo box to select the plotting method.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script section.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label to display the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text edit box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the generated R script.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p>set_model(model1, model2): Sets the data models and updates the data editor and output lists.
get_column_with_dtype(model): Returns a list of columns with their data types from the given model.
add_variable_horizontal(): Adds a selected variable to the horizontal axis.
add_variable_vertical(): Adds selected variables to the vertical axis.
remove_variable(): Removes selected variables from the horizontal and vertical axes.
get_selected_horizontal(): Returns a list of selected variables for the horizontal axis.
get_selected_vertical(): Returns a list of selected variables for the vertical axis.
accept(): Runs the generated R script and displays the result.
closeEvent(event): Clears selected variables and script when the dialog is closed.
generate_r_script(): Generates the R script based on selected variables and method.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)

    line_plot = Lineplot(self.model1, self.model2, self.parent)
    controller = LinePlotController(line_plot)
    controller.run_model(r_script)

    if line_plot.error:
        QMessageBox.critical(self, &#34;Line Plot&#34;, line_plot.result)
    else:
        QMessageBox.information(self, &#34;Line Plot&#34;, &#34;Graph has been generated.&#34;)

    # self.parent.add_output(script_text = r_script, result_text = line_plot.result, plot_paths = line_plot.plot)
    display_script_and_output(self.parent, r_script, line_plot.result, line_plot.plot)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.add_variable_horizontal"><code class="name flex">
<span>def <span class="ident">add_variable_horizontal</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable_horizontal(self):
    if len(self.horizontal_model.stringList()) &gt;= 1:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the Horizontal Axis!&#34;)
        return

    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    if not selected_items:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select a variable first!&#34;)
        return

    if len(selected_items) &gt; 1:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Please select only one variable!&#34;)
        return

    item = selected_items[0]

    if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variable must be of type Numeric.&#34;)
        return

    if item in self.data_editor_model.stringList():
        editor_list = self.data_editor_model.stringList()
        editor_list.remove(item)
        self.data_editor_model.setStringList(editor_list)
    elif item in self.data_output_model.stringList():
        output_list = self.data_output_model.stringList()
        output_list.remove(item)
        self.data_output_model.setStringList(output_list)

    self.horizontal_model.setStringList([item])
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.add_variable_vertical"><code class="name flex">
<span>def <span class="ident">add_variable_vertical</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable_vertical(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.vertical_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)
    selected_items = [item for item in selected_items if &#34;[String]&#34; not in item and &#34;[None]&#34; not in item]

    if contains_invalid:
        QMessageBox.warning(None, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.vertical_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    &#34;&#34;&#34;Menghapus variabel yang dipilih ketika dialog ditutup.&#34;&#34;&#34;
    self.horizontal_model.setStringList([]) 
    self.vertical_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)  
    event.accept()</code></pre>
</details>
<div class="desc"><p>Menghapus variabel yang dipilih ketika dialog ditutup.</p></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self): 
    # Get selected variables
    selected_var_horizontal = self.get_selected_horizontal()
    selected_var_vertical = self.get_selected_vertical()

    # Get selected method
    method = self.method_combo.currentText()

    r_script = &#34;&#34;

    # Pastikan hanya mengambil elemen pertama untuk horizontal
    selected_var_horizontal = selected_var_horizontal[0] if selected_var_horizontal else None
    if not selected_var_horizontal or not selected_var_vertical:
        self.script_box.setPlainText(&#34;&#34;)
        return

    # Bersihkan nama horizontal untuk objek (hilangkan spasi &amp; karakter tak valid)
    clean_horizontal = re.sub(r&#34;\W+&#34;, &#34;_&#34;, selected_var_horizontal.strip(&#34;`&#34;))

    # Single Line Plot
    if method == &#34;Single Lineplot&#34;:
        for var in selected_var_vertical:
            clean_var = re.sub(r&#34;\W+&#34;, &#34;_&#34;, var.strip(&#34;`&#34;))  # Bersihkan nama untuk objek
            r_script += (
                f&#34;lineplot_{clean_var} &lt;- ggplot(data, aes(x = `{selected_var_horizontal}`, y = `{var}`)) +\n&#34;
                f&#34;    geom_line(color = &#39;darkorange3&#39;) +\n&#34;
                f&#34;    geom_point() +\n&#34;
                f&#34;    ggtitle(\&#34;Line Plot: {selected_var_horizontal} vs. {var.strip(&#39;`&#39;)}\&#34;) +\n&#34;
                f&#34;    xlab(\&#34;{selected_var_horizontal}\&#34;) +\n&#34;
                f&#34;    ylab(\&#34;{var.strip(&#39;`&#39;)}\&#34;) +\n&#34;
                f&#34;    theme_minimal()\n\n&#34;
            )

    # Multiple Line Plot
    elif method == &#34;Multiple Lineplot&#34;:
        vertical_vars = &#34;, &#34;.join(f&#34;`{var}`&#34; for var in selected_var_vertical)  # Pakai backticks
        formatted_var_list = &#34;, &#34;.join(var.strip(&#34;`&#34;) for var in selected_var_vertical)

        r_script = (
            f&#34;data_long &lt;- pivot_longer(data, cols = c({vertical_vars}),\n&#34;
            f&#34;                        names_to = \&#34;variable\&#34;, values_to = \&#34;value\&#34;)\n\n&#34;
            f&#34;lineplot_{clean_horizontal}_multiple &lt;- ggplot(data_long, aes(x = `{selected_var_horizontal}`, y = value, color = variable)) +\n&#34;
            f&#34;    geom_line() +\n&#34;
            f&#34;    geom_point() +\n&#34;
            f&#34;    ggtitle(\&#34;Multiple Line Plot: {selected_var_horizontal} vs. {formatted_var_list}\&#34;) +\n&#34;
            f&#34;    xlab(\&#34;{selected_var_horizontal}\&#34;) +\n&#34;
            f&#34;    ylab(\&#34;Value\&#34;) +\n&#34;
            f&#34;    theme_minimal()\n&#34;
        )

    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_selected_horizontal"><code class="name flex">
<span>def <span class="ident">get_selected_horizontal</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_horizontal(self):
    return [
        item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
        for item in self.horizontal_model.stringList()
    ]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_selected_vertical"><code class="name flex">
<span>def <span class="ident">get_selected_vertical</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_vertical(self):
    return [
        item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0]
        for item in self.vertical_model.stringList()
    ]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.horizontal_list: (self.horizontal_model, None),
        self.vertical_list: (self.vertical_model, None),
    }

    if target_widget not in widget_model_map:
        return
    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    # Validasi: hanya 1 variabel untuk horizontal
    if target_widget == self.horizontal_list:
        if len(items) &gt; 1 or len(current_items) &gt;= 1:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;You can only add one variable to the horizontal Axis!&#34;)
            return

    filtered_items = []
    contains_invalid = False
    rejected_items = []

    for item in items:
        if target_widget in [self.horizontal_list, self.vertical_list]:
            # Tolak jika [String] atau [None]
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                contains_invalid = True
                rejected_items.append(item)
                continue
            filtered_items.append(item)
        else:
            # Editor/output: cocokkan dengan kolom aslinya
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and any(column_name == col.split(&#34; &#34;)[0] for col in allowed_columns):
                filtered_items.append(item)

    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Hapus dari semua model lain
    for _, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Tambahkan ke target jika belum ada
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Urutkan kembali jika editor atau output
    if target_widget in [self.data_editor_list, self.data_output_list]:
        original_order = self.all_columns_model1 if target_widget == self.data_editor_list else self.all_columns_model2
        reference_map = {col: i for i, col in enumerate(original_order)}
        current_items = sorted(current_items, key=lambda x: reference_map.get(x, float(&#39;inf&#39;)))

    target_model.setStringList(current_items)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    # Ambil item terpilih
    selected_indexes = self.horizontal_list.selectedIndexes() + self.vertical_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    # Ambil semua list sekarang
    horizontal_list = self.horizontal_model.stringList()
    vertical_list = self.vertical_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Kembalikan ke model asal
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)

        # Hapus dari horizontal/vertical
        if item in horizontal_list:
            horizontal_list.remove(item)
        if item in vertical_list:
            vertical_list.remove(item)

    # Sort ulang sesuai urutan awal
    editor_list = sorted(editor_list, key=lambda x: self.all_columns_model1.index(x) if x in self.all_columns_model1 else float(&#39;inf&#39;))
    output_list = sorted(output_list, key=lambda x: self.all_columns_model2.index(x) if x in self.all_columns_model2 else float(&#39;inf&#39;))

    # Update model
    self.horizontal_model.setStringList(horizontal_list)
    self.vertical_model.setStringList(vertical_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)

    # Update R script
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.graph" href="index.html">saePisan.view.components.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog">LinePlotDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.accept" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.add_variable_horizontal" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.add_variable_horizontal">add_variable_horizontal</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.add_variable_vertical" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.add_variable_vertical">add_variable_vertical</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.closeEvent" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.generate_r_script" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_column_with_dtype" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_selected_horizontal" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_selected_horizontal">get_selected_horizontal</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_selected_vertical" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.get_selected_vertical">get_selected_vertical</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.handle_drop" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.remove_variable" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.set_model" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.toggle_r_script_visibility" href="#saePisan.view.components.graph.LinePlotDialog.LinePlotDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_7">
                <div class="file-header">
                    <div>ğŸ“„ ScatterPlotDialog</div>
                    <div class="file-path">view/components/graph/ScatterPlotDialog.html (46.5 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Module <code>saePisan.view.components.graph.ScatterPlotDialog</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog"><code class="flex name class">
<span>class <span class="ident">ScatterPlotDialog</span></span>
<span>(</span><span>parent)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ScatterPlotDialog(QDialog):
    &#34;&#34;&#34;
    A dialog for creating scatter plots with various options.
    Attributes:
        parent (QWidget): The parent widget.
        model1 (Any): The first data model.
        model2 (Any): The second data model.
        all_columns_model1 (list): List of all columns in the first model.
        all_columns_model2 (list): List of all columns in the second model.
        selected_status (dict): Dictionary to store selected variable status.
        data_editor_label (QLabel): Label for the data editor.
        data_editor_model (QStringListModel): Model for the data editor list view.
        data_editor_list (QListView): List view for the data editor.
        data_output_label (QLabel): Label for the data output.
        data_output_model (QStringListModel): Model for the data output list view.
        data_output_list (QListView): List view for the data output.
        add_button (QPushButton): Button to add variables.
        remove_button (QPushButton): Button to remove variables.
        selected_label (QLabel): Label for the selected variables.
        selected_model (QStringListModel): Model for the selected variables list view.
        selected_list (QListView): List view for the selected variables.
        regression_line_checkbox (QCheckBox): Checkbox to show regression line.
        correlation_checkbox (QCheckBox): Checkbox to show correlation.
        density_plot_checkbox (QCheckBox): Checkbox to show density plot.
        script_label (QLabel): Label for the R script.
        icon_label (QLabel): Label for the running icon.
        script_box (QTextEdit): Text box to display the generated R script.
        run_button (QPushButton): Button to run the script.
    Methods:
        __init__(self, parent): Initializes the dialog.
        set_model(self, model1, model2): Sets the data models for the dialog.
        get_column_with_dtype(self, model): Gets columns with their data types from the model.
        add_variable(self): Adds selected variables to the selected list.
        remove_variable(self): Removes selected variables from the selected list.
        get_selected_columns(self): Gets the selected columns without data types.
        accept(self): Runs the R script and generates the scatter plot.
        closeEvent(self, event): Clears selected variables when the dialog is closed.
        generate_r_script(self): Generates the R script based on selected options.
    &#34;&#34;&#34;
    
    def __init__(self, parent):
        super().__init__(parent)
        self.parent = parent
        self.model1 = None
        self.model2 = None
        self.all_columns_model1 = []
        self.all_columns_model2 = []

        self.setWindowTitle(&#34;Scatter Plot&#34;)

        # Store selected variable status
        self.selected_status = {}

        # Main layout
        self.main_layout = QVBoxLayout(self)

        # Main content layout
        content_layout = QHBoxLayout()

        # Left layout: Data Editor and Data Output
        left_layout = QVBoxLayout()

        # Data Editor
        self.data_editor_label = QLabel(&#34;Data Editor&#34;, self)
        self.data_editor_model = QStringListModel()
        self.data_editor_list = DragDropListView(parent=self)
        self.data_editor_list.setModel(self.data_editor_model)
        self.data_editor_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_editor_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_editor_label)
        left_layout.addWidget(self.data_editor_list)

        # Data Output
        self.data_output_label = QLabel(&#34;Data Output&#34;, self)
        self.data_output_model = QStringListModel()
        self.data_output_list = DragDropListView(parent=self)
        self.data_output_list.setModel(self.data_output_model)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        self.data_output_list.setEditTriggers(QListView.EditTrigger.NoEditTriggers)
        left_layout.addWidget(self.data_output_label)
        left_layout.addWidget(self.data_output_list)

        content_layout.addLayout(left_layout)

        # Middle layout for buttons
        button_layout = QVBoxLayout()
        self.add_button = QPushButton(&#34;ğŸ¡†&#34;, self)
        self.add_button.clicked.connect(self.add_variable)
        self.add_button.setFixedSize(50, 35) 
        self.add_button.setStyleSheet(&#34;font-size: 24px;&#34;)  
        self.remove_button = QPushButton(&#34;ğŸ¡„&#34;, self)
        self.remove_button.clicked.connect(self.remove_variable)
        self.remove_button.setFixedSize(50, 35)
        self.remove_button.setStyleSheet(&#34;font-size: 24px;&#34;) 
        button_layout.addStretch()
        button_layout.addWidget(self.add_button)
        button_layout.addWidget(self.remove_button)
        button_layout.addStretch()
        content_layout.addLayout(button_layout)

        # Right layout
        right_layout = QVBoxLayout()
        self.selected_label = QLabel(&#34;Variable&#34;, self)
        self.selected_model = QStringListModel()
        self.selected_list = DragDropListView(parent=self)
        self.selected_list.setModel(self.selected_model)
        self.selected_list.setSelectionMode(QListView.SelectionMode.MultiSelection)
        right_layout.addWidget(self.selected_label)
        right_layout.addWidget(self.selected_list)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        # Graph group
        graph_group = QGroupBox(&#34;Graph Options&#34;) 
        graph_layout = QVBoxLayout()
        self.regression_line_checkbox = QCheckBox(&#34;Show Regression Line&#34;, self) 
        self.regression_line_checkbox.stateChanged.connect(self.generate_r_script)
        graph_layout.addWidget(self.regression_line_checkbox) 

        self.correlation_checkbox = QCheckBox(&#34;Show Correlation&#34;, self)  
        self.correlation_checkbox.stateChanged.connect(self.generate_r_script)
        graph_layout.addWidget(self.correlation_checkbox) 

        self.density_plot_checkbox = QCheckBox(&#34;Show Density Plot&#34;, self) 
        self.density_plot_checkbox.stateChanged.connect(self.generate_r_script)
        graph_layout.addWidget(self.density_plot_checkbox)

        graph_group.setLayout(graph_layout)
        right_layout.addWidget(graph_group)

        content_layout.addLayout(right_layout)
        self.main_layout.addLayout(content_layout)

        # Horizontal layout for label and icon
        script_layout = QHBoxLayout()
        self.script_label = QLabel(&#34;R Script:&#34;, self)
        self.icon_label = QLabel()
        self.icon_label.setPixmap(QIcon(&#34;assets/running.svg&#34;).pixmap(QSize(16, 30)))
        self.icon_label.setFixedSize(16, 30)
        self.icon_label.setAlignment(Qt.AlignmentFlag.AlignRight | Qt.AlignmentFlag.AlignTop)
        self.toggle_script_button = QToolButton()
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))
        self.toggle_script_button.setIconSize(QSize(16, 16))
        self.toggle_script_button.setCheckable(True)
        self.toggle_script_button.setChecked(False)
        self.toggle_script_button.clicked.connect(self.toggle_r_script_visibility)

        self.button_layout = QHBoxLayout()
        self.button_layout.addWidget(self.script_label)
        self.button_layout.addWidget(self.toggle_script_button)
        self.button_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)
        self.button_layout.setAlignment(self.toggle_script_button, Qt.AlignmentFlag.AlignLeft)

        self.script_layout = QHBoxLayout()
        self.script_layout.addLayout(self.button_layout)
        self.script_layout.addStretch()
        self.script_layout.addWidget(self.icon_label)
        self.icon_label.setVisible(False)
        self.script_layout.setAlignment(self.script_label, Qt.AlignmentFlag.AlignLeft)

        self.main_layout.addLayout(self.script_layout)

        self.script_box = QTextEdit()
        self.script_box.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Expanding)
        self.script_box.setReadOnly(False)
        self.script_box.setVisible(False)
        self.main_layout.addWidget(self.script_box)

        # Run button
        button_row_layout = QHBoxLayout()
        self.run_button = QPushButton(&#34;Run&#34;, self)
        self.run_button.clicked.connect(self.accept)
        button_row_layout.addWidget(self.run_button, alignment=Qt.AlignmentFlag.AlignRight)
        self.main_layout.addLayout(button_row_layout)

        self.data_editor_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.data_output_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)
        self.selected_list.setSelectionMode(QListView.SelectionMode.ExtendedSelection)

    def handle_drop(self, target_widget, items):
        # Map widget to model
        widget_model_map = {
            self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
            self.data_output_list: (self.data_output_model, self.all_columns_model2),
            self.selected_list: (self.selected_model, None),
        }

        if target_widget not in widget_model_map:
            return

        target_model, allowed_columns = widget_model_map[target_widget]
        current_items = target_model.stringList()

        filtered_items = []
        contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

        for item in items:
            # Reject if String or None type
            if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
                continue

            if target_widget == self.selected_list:
                filtered_items.append(item)
            else:
                column_name = item.split(&#34; &#34;)[0]
                if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                    filtered_items.append(item)

        # â—ï¸Show warning if there are String or None types
        if contains_string:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        # Add valid items to the target model
        for item in filtered_items:
            if item not in current_items:
                current_items.append(item)

        # Remove from other models
        for other_widget, (model, _) in widget_model_map.items():
            if model == target_model:
                continue
            other_items = model.stringList()
            for item in filtered_items:
                if item in other_items:
                    other_items.remove(item)
            model.setStringList(other_items)

        # Reorder items
        if target_widget == self.data_editor_list:
            ordered = [col for col in self.all_columns_model1 if col in current_items]
            target_model.setStringList(ordered)
        elif target_widget == self.data_output_list:
            ordered = [col for col in self.all_columns_model2 if col in current_items]
            target_model.setStringList(ordered)
        else:
            target_model.setStringList(current_items)

        self.generate_r_script()


    def set_model(self, model1, model2):
        self.model1 = model1
        self.model2 = model2
        self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
        self.data_output_model.setStringList(self.get_column_with_dtype(model2))
        self.all_columns_model1 = self.get_column_with_dtype(model1)
        self.all_columns_model2 = self.get_column_with_dtype(model2)

    def toggle_r_script_visibility(self):
        &#34;&#34;&#34;
        Toggles the visibility of the R script text edit area and updates the toggle button text.
        &#34;&#34;&#34;
        is_visible = self.script_box.isVisible()
        self.script_box.setVisible(not is_visible)
        if not is_visible:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
        else:
            self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))

    def get_column_with_dtype(self, model):
        &#34;&#34;&#34;
        Returns a list of columns with simplified data types:
        String, Numeric, or None.
        &#34;&#34;&#34;
        self.columns = []
        for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
            if dtype == pl.Utf8:
                tipe = &#34;String&#34;
            elif dtype == pl.Null:
                tipe = &#34;None&#34;
            else:
                tipe = &#34;Numeric&#34;
            self.columns.append(f&#34;{col} [{tipe}]&#34;)
        return self.columns


    def add_variable(self):
        selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]
        selected_list = self.selected_model.stringList()

        contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

        selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

        # Tampilkan warning jika ada yang tidak valid
        if contains_invalid:
            QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

        for item in selected_items:
            if item in self.data_editor_model.stringList():
                editor_list = self.data_editor_model.stringList()
                editor_list.remove(item)
                self.data_editor_model.setStringList(editor_list)
            elif item in self.data_output_model.stringList():
                output_list = self.data_output_model.stringList()
                output_list.remove(item)
                self.data_output_model.setStringList(output_list)

            if item not in selected_list:
                selected_list.append(item)

        self.selected_model.setStringList(selected_list)
        self.generate_r_script()

    def remove_variable(self):
        &#34;&#34;&#34;
        Removes selected variables from the selected list and generates the R script.
        &#34;&#34;&#34;
        selected_indexes = self.selected_list.selectedIndexes()
        selected_items = [index.data() for index in selected_indexes]

        selected_list = self.selected_model.stringList()
        editor_list = self.data_editor_model.stringList()
        output_list = self.data_output_model.stringList()

        for item in selected_items:
            column_name = item.split(&#34; &#34;)[0]

            # Check if the item belongs to model1 (editor) or model2 (output)
            if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
                if item not in editor_list:
                    editor_list.append(item)
                    # Re-sort according to all_columns_model1
                    editor_list = [col for col in self.all_columns_model1 if col in editor_list]

            elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
                if item not in output_list:
                    output_list.append(item)
                    # Re-sort according to all_columns_model2
                    output_list = [col for col in self.all_columns_model2 if col in output_list]

            # Remove from selected
            if item in selected_list:
                selected_list.remove(item)

        self.selected_model.setStringList(selected_list)
        self.data_editor_model.setStringList(editor_list)
        self.data_output_model.setStringList(output_list)
        self.generate_r_script()

    def get_selected_columns(self):
        return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]
    

    def accept(self):
        r_script = self.script_box.toPlainText()
        selected_columns = self.get_selected_columns()
        if not r_script:
            QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
            return
        if len(selected_columns) &lt; 2:
            QMessageBox.warning(self, &#34;Scatter Plot&#34;, &#34;Please select at least 2 variables.&#34;)
            return

        r_script = self.script_box.toPlainText()
        if not r_script:
            return
        self.run_button.setEnabled(False)
        self.run_button.setText(&#34;Running...&#34;)
        self.icon_label.setVisible(True)
        
        scatter_plot = Scatterplot(self.model1, self.model2, self.parent)
        controller = ScatterPlotController(scatter_plot)
        controller.run_model(r_script)

        if scatter_plot.error:
            QMessageBox.critical(self, &#34;Scatter Plot&#34;, scatter_plot.result)
        else:
            QMessageBox.information(self, &#34;Scatter Plot&#34;, &#34;Graph has been generated&#34;)

        # self.parent.add_output(script_text=r_script, result_text=scatter_plot.result, plot_paths=scatter_plot.plot)
        display_script_and_output(self.parent, r_script, scatter_plot.result, scatter_plot.plot)
        self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

        self.icon_label.setVisible(False)
        self.run_button.setText(&#34;Run&#34;)
        self.run_button.setEnabled(True)
        self.close()

    def closeEvent(self, event):
        &#34;&#34;&#34;Clear selected variables when the dialog is closed.&#34;&#34;&#34;
        self.selected_model.setStringList([])
        self.script_box.setPlainText(&#34;&#34;)  
        event.accept()

    def generate_r_script(self):
        selected_columns = self.get_selected_columns()
        # Get checkbox status
        show_regression = self.regression_line_checkbox.isChecked()
        show_correlation = self.correlation_checkbox.isChecked()
        show_density = self.density_plot_checkbox.isChecked()
        # Check the number of selected variables
        if len(selected_columns) &lt; 2:
            self.script_box.setPlainText(&#34;&#34;)
            return

        # Start creating R script for scatterplot matrix
        r_script = &#34;data_plot &lt;- data[, c(&#34; + &#34;, &#34;.join(f&#39;&#34;{col}&#34;&#39; for col in selected_columns) + &#34;)]\n\n&#34;
        r_script += &#34;scatterplot &lt;- ggpairs(\n&#34;
        r_script += &#34;    data_plot,\n&#34;
        r_script += &#34;    lower = list(continuous = &#34; + (&#39;wrap(&#34;smooth&#34;, method=&#34;lm&#34;)&#39; if show_regression else &#39;&#34;points&#34;&#39;) + &#34;),\n&#34;
        r_script += &#34;    upper = list(continuous = &#34; + (&#39;&#34;cor&#34;&#39; if show_correlation else &#39;&#34;blank&#34;&#39;) + &#34;),\n&#34;
        r_script += &#34;    diag = list(continuous = &#34; + (&#39;&#34;densityDiag&#34;&#39; if show_density else &#39;&#34;blankDiag&#34;&#39;) + &#34;)\n&#34;
        r_script += &#34;)\n&#34;

        self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"><p>A dialog for creating scatter plots with various options.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>parent</code></strong> :&ensp;<code>QWidget</code></dt>
<dd>The parent widget.</dd>
<dt><strong><code>model1</code></strong> :&ensp;<code>Any</code></dt>
<dd>The first data model.</dd>
<dt><strong><code>model2</code></strong> :&ensp;<code>Any</code></dt>
<dd>The second data model.</dd>
<dt><strong><code>all_columns_model1</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in the first model.</dd>
<dt><strong><code>all_columns_model2</code></strong> :&ensp;<code>list</code></dt>
<dd>List of all columns in the second model.</dd>
<dt><strong><code>selected_status</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary to store selected variable status.</dd>
<dt><strong><code>data_editor_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data editor.</dd>
<dt><strong><code>data_editor_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data editor list view.</dd>
<dt><strong><code>data_editor_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data editor.</dd>
<dt><strong><code>data_output_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the data output.</dd>
<dt><strong><code>data_output_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the data output list view.</dd>
<dt><strong><code>data_output_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the data output.</dd>
<dt><strong><code>add_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to add variables.</dd>
<dt><strong><code>remove_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to remove variables.</dd>
<dt><strong><code>selected_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the selected variables.</dd>
<dt><strong><code>selected_model</code></strong> :&ensp;<code>QStringListModel</code></dt>
<dd>Model for the selected variables list view.</dd>
<dt><strong><code>selected_list</code></strong> :&ensp;<code>QListView</code></dt>
<dd>List view for the selected variables.</dd>
<dt><strong><code>regression_line_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox to show regression line.</dd>
<dt><strong><code>correlation_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox to show correlation.</dd>
<dt><strong><code>density_plot_checkbox</code></strong> :&ensp;<code>QCheckBox</code></dt>
<dd>Checkbox to show density plot.</dd>
<dt><strong><code>script_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the R script.</dd>
<dt><strong><code>icon_label</code></strong> :&ensp;<code>QLabel</code></dt>
<dd>Label for the running icon.</dd>
<dt><strong><code>script_box</code></strong> :&ensp;<code>QTextEdit</code></dt>
<dd>Text box to display the generated R script.</dd>
<dt><strong><code>run_button</code></strong> :&ensp;<code>QPushButton</code></dt>
<dd>Button to run the script.</dd>
</dl>
<h2 id="methods">Methods</h2>
<p><strong>init</strong>(self, parent): Initializes the dialog.
set_model(self, model1, model2): Sets the data models for the dialog.
get_column_with_dtype(self, model): Gets columns with their data types from the model.
add_variable(self): Adds selected variables to the selected list.
remove_variable(self): Removes selected variables from the selected list.
get_selected_columns(self): Gets the selected columns without data types.
accept(self): Runs the R script and generates the scatter plot.
closeEvent(self, event): Clears selected variables when the dialog is closed.
generate_r_script(self): Generates the R script based on selected options.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>PyQt6.QtWidgets.QDialog</li>
<li>PyQt6.QtWidgets.QWidget</li>
<li>PyQt6.QtCore.QObject</li>
<li>PyQt6.sip.wrapper</li>
<li>PyQt6.QtGui.QPaintDevice</li>
<li>PyQt6.sip.simplewrapper</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.accept"><code class="name flex">
<span>def <span class="ident">accept</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def accept(self):
    r_script = self.script_box.toPlainText()
    selected_columns = self.get_selected_columns()
    if not r_script:
        QMessageBox.warning(self, &#34;Empty Script&#34;, &#34;Please generate a script before running.&#34;)
        return
    if len(selected_columns) &lt; 2:
        QMessageBox.warning(self, &#34;Scatter Plot&#34;, &#34;Please select at least 2 variables.&#34;)
        return

    r_script = self.script_box.toPlainText()
    if not r_script:
        return
    self.run_button.setEnabled(False)
    self.run_button.setText(&#34;Running...&#34;)
    self.icon_label.setVisible(True)
    
    scatter_plot = Scatterplot(self.model1, self.model2, self.parent)
    controller = ScatterPlotController(scatter_plot)
    controller.run_model(r_script)

    if scatter_plot.error:
        QMessageBox.critical(self, &#34;Scatter Plot&#34;, scatter_plot.result)
    else:
        QMessageBox.information(self, &#34;Scatter Plot&#34;, &#34;Graph has been generated&#34;)

    # self.parent.add_output(script_text=r_script, result_text=scatter_plot.result, plot_paths=scatter_plot.plot)
    display_script_and_output(self.parent, r_script, scatter_plot.result, scatter_plot.plot)
    self.parent.tab_widget.setCurrentWidget(self.parent.output_tab)

    self.icon_label.setVisible(False)
    self.run_button.setText(&#34;Run&#34;)
    self.run_button.setEnabled(True)
    self.close()</code></pre>
</details>
<div class="desc"><p>accept(self)</p></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.add_variable"><code class="name flex">
<span>def <span class="ident">add_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_variable(self):
    selected_indexes = self.data_editor_list.selectedIndexes() + self.data_output_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]
    selected_list = self.selected_model.stringList()

    contains_invalid = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in selected_items)

    selected_items = [item for item in selected_items if &#34;[Numeric]&#34; in item]

    # Tampilkan warning jika ada yang tidak valid
    if contains_invalid:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    for item in selected_items:
        if item in self.data_editor_model.stringList():
            editor_list = self.data_editor_model.stringList()
            editor_list.remove(item)
            self.data_editor_model.setStringList(editor_list)
        elif item in self.data_output_model.stringList():
            output_list = self.data_output_model.stringList()
            output_list.remove(item)
            self.data_output_model.setStringList(output_list)

        if item not in selected_list:
            selected_list.append(item)

    self.selected_model.setStringList(selected_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.closeEvent"><code class="name flex">
<span>def <span class="ident">closeEvent</span></span>(<span>self, event)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def closeEvent(self, event):
    &#34;&#34;&#34;Clear selected variables when the dialog is closed.&#34;&#34;&#34;
    self.selected_model.setStringList([])
    self.script_box.setPlainText(&#34;&#34;)  
    event.accept()</code></pre>
</details>
<div class="desc"><p>Clear selected variables when the dialog is closed.</p></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.generate_r_script"><code class="name flex">
<span>def <span class="ident">generate_r_script</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_r_script(self):
    selected_columns = self.get_selected_columns()
    # Get checkbox status
    show_regression = self.regression_line_checkbox.isChecked()
    show_correlation = self.correlation_checkbox.isChecked()
    show_density = self.density_plot_checkbox.isChecked()
    # Check the number of selected variables
    if len(selected_columns) &lt; 2:
        self.script_box.setPlainText(&#34;&#34;)
        return

    # Start creating R script for scatterplot matrix
    r_script = &#34;data_plot &lt;- data[, c(&#34; + &#34;, &#34;.join(f&#39;&#34;{col}&#34;&#39; for col in selected_columns) + &#34;)]\n\n&#34;
    r_script += &#34;scatterplot &lt;- ggpairs(\n&#34;
    r_script += &#34;    data_plot,\n&#34;
    r_script += &#34;    lower = list(continuous = &#34; + (&#39;wrap(&#34;smooth&#34;, method=&#34;lm&#34;)&#39; if show_regression else &#39;&#34;points&#34;&#39;) + &#34;),\n&#34;
    r_script += &#34;    upper = list(continuous = &#34; + (&#39;&#34;cor&#34;&#39; if show_correlation else &#39;&#34;blank&#34;&#39;) + &#34;),\n&#34;
    r_script += &#34;    diag = list(continuous = &#34; + (&#39;&#34;densityDiag&#34;&#39; if show_density else &#39;&#34;blankDiag&#34;&#39;) + &#34;)\n&#34;
    r_script += &#34;)\n&#34;

    self.script_box.setPlainText(r_script)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.get_column_with_dtype"><code class="name flex">
<span>def <span class="ident">get_column_with_dtype</span></span>(<span>self, model)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_column_with_dtype(self, model):
    &#34;&#34;&#34;
    Returns a list of columns with simplified data types:
    String, Numeric, or None.
    &#34;&#34;&#34;
    self.columns = []
    for col, dtype in zip(model.get_data().columns, model.get_data().dtypes):
        if dtype == pl.Utf8:
            tipe = &#34;String&#34;
        elif dtype == pl.Null:
            tipe = &#34;None&#34;
        else:
            tipe = &#34;Numeric&#34;
        self.columns.append(f&#34;{col} [{tipe}]&#34;)
    return self.columns</code></pre>
</details>
<div class="desc"><p>Returns a list of columns with simplified data types:
String, Numeric, or None.</p></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.get_selected_columns"><code class="name flex">
<span>def <span class="ident">get_selected_columns</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_selected_columns(self):
    return [item.rsplit(&#34; [String]&#34;, 1)[0].rsplit(&#34; [Numeric]&#34;, 1)[0] for item in self.selected_model.stringList()]</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.handle_drop"><code class="name flex">
<span>def <span class="ident">handle_drop</span></span>(<span>self, target_widget, items)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def handle_drop(self, target_widget, items):
    # Map widget to model
    widget_model_map = {
        self.data_editor_list: (self.data_editor_model, self.all_columns_model1),
        self.data_output_list: (self.data_output_model, self.all_columns_model2),
        self.selected_list: (self.selected_model, None),
    }

    if target_widget not in widget_model_map:
        return

    target_model, allowed_columns = widget_model_map[target_widget]
    current_items = target_model.stringList()

    filtered_items = []
    contains_string = any(&#34;[String]&#34; in item or &#34;[None]&#34; in item for item in items)

    for item in items:
        # Reject if String or None type
        if &#34;[String]&#34; in item or &#34;[None]&#34; in item:
            continue

        if target_widget == self.selected_list:
            filtered_items.append(item)
        else:
            column_name = item.split(&#34; &#34;)[0]
            if allowed_columns and column_name in [col.split(&#34; &#34;)[0] for col in allowed_columns]:
                filtered_items.append(item)

    # â—ï¸Show warning if there are String or None types
    if contains_string:
        QMessageBox.warning(self, &#34;Warning&#34;, &#34;Selected variables must be of type Numeric.&#34;)

    # Add valid items to the target model
    for item in filtered_items:
        if item not in current_items:
            current_items.append(item)

    # Remove from other models
    for other_widget, (model, _) in widget_model_map.items():
        if model == target_model:
            continue
        other_items = model.stringList()
        for item in filtered_items:
            if item in other_items:
                other_items.remove(item)
        model.setStringList(other_items)

    # Reorder items
    if target_widget == self.data_editor_list:
        ordered = [col for col in self.all_columns_model1 if col in current_items]
        target_model.setStringList(ordered)
    elif target_widget == self.data_output_list:
        ordered = [col for col in self.all_columns_model2 if col in current_items]
        target_model.setStringList(ordered)
    else:
        target_model.setStringList(current_items)

    self.generate_r_script()</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.remove_variable"><code class="name flex">
<span>def <span class="ident">remove_variable</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_variable(self):
    &#34;&#34;&#34;
    Removes selected variables from the selected list and generates the R script.
    &#34;&#34;&#34;
    selected_indexes = self.selected_list.selectedIndexes()
    selected_items = [index.data() for index in selected_indexes]

    selected_list = self.selected_model.stringList()
    editor_list = self.data_editor_model.stringList()
    output_list = self.data_output_model.stringList()

    for item in selected_items:
        column_name = item.split(&#34; &#34;)[0]

        # Check if the item belongs to model1 (editor) or model2 (output)
        if column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model1]:
            if item not in editor_list:
                editor_list.append(item)
                # Re-sort according to all_columns_model1
                editor_list = [col for col in self.all_columns_model1 if col in editor_list]

        elif column_name in [col.split(&#34; &#34;)[0] for col in self.all_columns_model2]:
            if item not in output_list:
                output_list.append(item)
                # Re-sort according to all_columns_model2
                output_list = [col for col in self.all_columns_model2 if col in output_list]

        # Remove from selected
        if item in selected_list:
            selected_list.remove(item)

    self.selected_model.setStringList(selected_list)
    self.data_editor_model.setStringList(editor_list)
    self.data_output_model.setStringList(output_list)
    self.generate_r_script()</code></pre>
</details>
<div class="desc"><p>Removes selected variables from the selected list and generates the R script.</p></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.set_model"><code class="name flex">
<span>def <span class="ident">set_model</span></span>(<span>self, model1, model2)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_model(self, model1, model2):
    self.model1 = model1
    self.model2 = model2
    self.data_editor_model.setStringList(self.get_column_with_dtype(model1))
    self.data_output_model.setStringList(self.get_column_with_dtype(model2))
    self.all_columns_model1 = self.get_column_with_dtype(model1)
    self.all_columns_model2 = self.get_column_with_dtype(model2)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.toggle_r_script_visibility"><code class="name flex">
<span>def <span class="ident">toggle_r_script_visibility</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def toggle_r_script_visibility(self):
    &#34;&#34;&#34;
    Toggles the visibility of the R script text edit area and updates the toggle button text.
    &#34;&#34;&#34;
    is_visible = self.script_box.isVisible()
    self.script_box.setVisible(not is_visible)
    if not is_visible:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/less.svg&#34;))
    else:
        self.toggle_script_button.setIcon(QIcon(&#34;assets/more.svg&#34;))</code></pre>
</details>
<div class="desc"><p>Toggles the visibility of the R script text edit area and updates the toggle button text.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components.graph" href="index.html">saePisan.view.components.graph</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog">ScatterPlotDialog</a></code></h4>
<ul class="">
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.accept" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.accept">accept</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.add_variable" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.add_variable">add_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.closeEvent" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.closeEvent">closeEvent</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.generate_r_script" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.generate_r_script">generate_r_script</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.get_column_with_dtype" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.get_column_with_dtype">get_column_with_dtype</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.get_selected_columns" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.get_selected_columns">get_selected_columns</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.handle_drop" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.handle_drop">handle_drop</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.remove_variable" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.remove_variable">remove_variable</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.set_model" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.set_model">set_model</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.toggle_r_script_visibility" href="#saePisan.view.components.graph.ScatterPlotDialog.ScatterPlotDialog.toggle_r_script_visibility">toggle_r_script_visibility</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_8">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">view/components/graph/index.html (8.4 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.view.components.graph</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.view.components.graph.BoxPlotDialog" href="BoxPlotDialog.html">saePisan.view.components.graph.BoxPlotDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.graph.HistogramDialog" href="HistogramDialog.html">saePisan.view.components.graph.HistogramDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.graph.LinePlotDialog" href="LinePlotDialog.html">saePisan.view.components.graph.LinePlotDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.graph.ScatterPlotDialog" href="ScatterPlotDialog.html">saePisan.view.components.graph.ScatterPlotDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view.components" href="../index.html">saePisan.view.components</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.view.components.graph.BoxPlotDialog" href="BoxPlotDialog.html">saePisan.view.components.graph.BoxPlotDialog</a></code></li>
<li><code><a title="saePisan.view.components.graph.HistogramDialog" href="HistogramDialog.html">saePisan.view.components.graph.HistogramDialog</a></code></li>
<li><code><a title="saePisan.view.components.graph.LinePlotDialog" href="LinePlotDialog.html">saePisan.view.components.graph.LinePlotDialog</a></code></li>
<li><code><a title="saePisan.view.components.graph.ScatterPlotDialog" href="ScatterPlotDialog.html">saePisan.view.components.graph.ScatterPlotDialog</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_10_9">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">view/components/index.html (12.8 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.view.components</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.view.components.AboutDialog" href="AboutDialog.html">saePisan.view.components.AboutDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ComputeVariableDialog" href="ComputeVariableDialog.html">saePisan.view.components.ComputeVariableDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ConsoleDialog" href="ConsoleDialog.html">saePisan.view.components.ConsoleDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.CsvDialogOption" href="CsvDialogOption.html">saePisan.view.components.CsvDialogOption</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.CustomToast" href="CustomToast.html">saePisan.view.components.CustomToast</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.DragDropListView" href="DragDropListView.html">saePisan.view.components.DragDropListView</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ExcelDialogOption" href="ExcelDialogOption.html">saePisan.view.components.ExcelDialogOption</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.MenuContext" href="MenuContext.html">saePisan.view.components.MenuContext</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ModelingSaeEblupAreaDialog" href="ModelingSaeEblupAreaDialog.html">saePisan.view.components.ModelingSaeEblupAreaDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog" href="ModelingSaeEblupPseudoDialog.html">saePisan.view.components.ModelingSaeEblupPseudoDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ModelingSaeEblupUnitDialog" href="ModelingSaeEblupUnitDialog.html">saePisan.view.components.ModelingSaeEblupUnitDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ModellingSaeHBDialog" href="ModellingSaeHBDialog.html">saePisan.view.components.ModellingSaeHBDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ModellingSaeHbNormal" href="ModellingSaeHbNormal.html">saePisan.view.components.ModellingSaeHbNormal</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.ProjectionDialog" href="ProjectionDialog.html">saePisan.view.components.ProjectionDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.SplashScreen" href="SplashScreen.html">saePisan.view.components.SplashScreen</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.exploration" href="exploration/index.html">saePisan.view.components.exploration</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components.graph" href="graph/index.html">saePisan.view.components.graph</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan.view" href="../index.html">saePisan.view</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.view.components.AboutDialog" href="AboutDialog.html">saePisan.view.components.AboutDialog</a></code></li>
<li><code><a title="saePisan.view.components.ComputeVariableDialog" href="ComputeVariableDialog.html">saePisan.view.components.ComputeVariableDialog</a></code></li>
<li><code><a title="saePisan.view.components.ConsoleDialog" href="ConsoleDialog.html">saePisan.view.components.ConsoleDialog</a></code></li>
<li><code><a title="saePisan.view.components.CsvDialogOption" href="CsvDialogOption.html">saePisan.view.components.CsvDialogOption</a></code></li>
<li><code><a title="saePisan.view.components.CustomToast" href="CustomToast.html">saePisan.view.components.CustomToast</a></code></li>
<li><code><a title="saePisan.view.components.DragDropListView" href="DragDropListView.html">saePisan.view.components.DragDropListView</a></code></li>
<li><code><a title="saePisan.view.components.ExcelDialogOption" href="ExcelDialogOption.html">saePisan.view.components.ExcelDialogOption</a></code></li>
<li><code><a title="saePisan.view.components.MenuContext" href="MenuContext.html">saePisan.view.components.MenuContext</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupAreaDialog" href="ModelingSaeEblupAreaDialog.html">saePisan.view.components.ModelingSaeEblupAreaDialog</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupPseudoDialog" href="ModelingSaeEblupPseudoDialog.html">saePisan.view.components.ModelingSaeEblupPseudoDialog</a></code></li>
<li><code><a title="saePisan.view.components.ModelingSaeEblupUnitDialog" href="ModelingSaeEblupUnitDialog.html">saePisan.view.components.ModelingSaeEblupUnitDialog</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHBDialog" href="ModellingSaeHBDialog.html">saePisan.view.components.ModellingSaeHBDialog</a></code></li>
<li><code><a title="saePisan.view.components.ModellingSaeHbNormal" href="ModellingSaeHbNormal.html">saePisan.view.components.ModellingSaeHbNormal</a></code></li>
<li><code><a title="saePisan.view.components.ProjectionDialog" href="ProjectionDialog.html">saePisan.view.components.ProjectionDialog</a></code></li>
<li><code><a title="saePisan.view.components.SplashScreen" href="SplashScreen.html">saePisan.view.components.SplashScreen</a></code></li>
<li><code><a title="saePisan.view.components.exploration" href="exploration/index.html">saePisan.view.components.exploration</a></code></li>
<li><code><a title="saePisan.view.components.graph" href="graph/index.html">saePisan.view.components.graph</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
            <div class="file-section page-break" id="file_11_0">
                <div class="file-header">
                    <div>ğŸ“„ index</div>
                    <div class="file-path">view/index.html (7.7 KB)</div>
                </div>
                <div class="file-content">
                    
<main>
<article id="content">
<header>
<h1 class="title">Namespace <code>saePisan.view</code></h1>
</header>
<section id="section-intro">
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="saePisan.view.EditColumnDialog" href="EditColumnDialog.html">saePisan.view.EditColumnDialog</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.MainWindow" href="MainWindow.html">saePisan.view.MainWindow</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="saePisan.view.components" href="components/index.html">saePisan.view.components</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="saePisan" href="../index.html">saePisan</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="saePisan.view.EditColumnDialog" href="EditColumnDialog.html">saePisan.view.EditColumnDialog</a></code></li>
<li><code><a title="saePisan.view.MainWindow" href="MainWindow.html">saePisan.view.MainWindow</a></code></li>
<li><code><a title="saePisan.view.components" href="components/index.html">saePisan.view.components</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>

                </div>
            </div>
            
    <div style="text-align: center; margin-top: 50px; padding: 30px; border-top: 2px solid #eee; color: #666;">
        <p><strong>ğŸ“š Dokumentasi saePisan</strong></p>
        <p>Dibuat secara otomatis pada 19 July 2025, 08:36</p>
        <p>Total 111 file HTML dari folder: <code>d:\saePisan\saePisan</code></p>
    </div>
    
</body>
</html>